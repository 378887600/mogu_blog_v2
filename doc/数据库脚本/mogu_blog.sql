/*
SQLyog Ultimate v12.09 (64 bit)
MySQL - 5.5.60-MariaDB : Database - mogu_blog
*********************************************************************
*/

/*!40101 SET NAMES utf8 */;

/*!40101 SET SQL_MODE=''*/;

/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;
CREATE DATABASE /*!32312 IF NOT EXISTS*/`mogu_blog` /*!40100 DEFAULT CHARACTER SET utf8 */;

USE `mogu_blog`;

/*Table structure for table `t_admin` */

DROP TABLE IF EXISTS `t_admin`;

CREATE TABLE `t_admin` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `user_name` varchar(255) NOT NULL COMMENT '用户名',
  `pass_word` varchar(255) NOT NULL COMMENT '密码',
  `gender` varchar(1) DEFAULT NULL COMMENT '性别(1:男2:女)',
  `avatar` varchar(100) DEFAULT NULL COMMENT '个人头像',
  `email` varchar(255) NOT NULL COMMENT '邮箱',
  `birthday` date DEFAULT NULL COMMENT '出生年月日',
  `mobile` varchar(11) DEFAULT NULL COMMENT '手机',
  `valid_code` varchar(50) DEFAULT NULL COMMENT '邮箱验证码',
  `summary` varchar(200) DEFAULT NULL COMMENT '自我简介最多150字',
  `login_count` int(11) unsigned DEFAULT '0' COMMENT '登录次数',
  `last_login_time` datetime DEFAULT NULL COMMENT '最后登录时间',
  `last_login_ip` varchar(50) DEFAULT '127.0.0.1' COMMENT '最后登录IP',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `nick_name` varchar(255) DEFAULT NULL COMMENT '昵称',
  `qq_number` varchar(255) DEFAULT NULL COMMENT 'QQ号',
  `we_chat` varchar(255) DEFAULT NULL COMMENT '微信号',
  `occupation` varchar(255) DEFAULT NULL COMMENT '职业',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='管理员表';

/*Data for the table `t_admin` */

insert  into `t_admin`(`uid`,`user_name`,`pass_word`,`gender`,`avatar`,`email`,`birthday`,`mobile`,`valid_code`,`summary`,`login_count`,`last_login_time`,`last_login_ip`,`status`,`create_time`,`update_time`,`nick_name`,`qq_number`,`we_chat`,`occupation`) values ('1f01cd1d2f474743b241d74008b12333','admin','$2a$10$FrHbye0RSyU.EfgDAFJIbupIMfdaWBX/R9Mfv1fGaijyhgnxZKrmq','1',',b8a7b24a3de8401597548e71c6b5d399','1595833114@qq.com','2018-09-29',' ',NULL,'一个95后！一直潜心研究和学习Java后端技术，一边学习一边积累经验',38,'2018-12-30 12:36:33','116.1.3.204',1,'2018-09-06 11:05:05','2018-11-12 06:47:00','陌溪_','1595833114','','Java开发'),('1f01cd1d2f474743b241d74008b12334','那遗留的晴天','$2a$10$FrHbye0RSyU.EfgDAFJIbupIMfdaWBX/R9Mfv1fGaijyhgnxZKrmq','0',',ea6943fef5154910add617c96c4cf740','196430606@qq.com','2018-09-04','14798521755',NULL,NULL,3,'2018-12-17 08:58:16','116.1.3.205',1,'2018-09-05 03:05:12','2018-11-08 19:18:16',NULL,NULL,NULL,NULL),('1f01cd1d2f474743b241d74008b12335','或许无所谓','$2a$10$zVgAJn0hcMwWvora8GAYfOWdjqBLVLF2jchx.coc4ERrgcvJp4Tpq','1',',11696ee83574446b8c87c0533b4dcd53','460929265@qq.com','2018-09-19','26151631845',NULL,NULL,8,'2018-12-24 20:39:11','39.166.106.86',1,'2018-08-08 03:06:11','2018-08-08 03:06:17','或许无所谓',NULL,NULL,NULL),('434994947c5a4ee3a710cd277357c7c5','巴拉巴拉','$2a$10$TdvL8GnIMdddF7PDToTkU.y9N','2',',f3855d0c865148f18d7e73a18dcea81d','404033544@qq.com','2018-10-14','13803544785',NULL,'我是魔法师',0,NULL,'127.0.0.1',0,'2018-10-14 11:55:43','2018-10-14 11:55:43',NULL,NULL,NULL,NULL),('b1cf10413a60446cbf22cbc8c8f6d4dc','噜啦啦','$2a$10$xw37/WuRgBJaR06U6aynvOJtI','1',',f3855d0c865148f18d7e73a18dcea81d','345678941@qq.com','2018-10-12','15078211234',NULL,NULL,0,'2018-10-12 19:45:42','string',1,'2018-10-12 19:51:37','2018-10-12 19:51:37',NULL,NULL,NULL,NULL);

/*Table structure for table `t_admin_role` */

DROP TABLE IF EXISTS `t_admin_role`;

CREATE TABLE `t_admin_role` (
  `uid` varchar(32) NOT NULL COMMENT '主键',
  `admin_uid` varchar(32) NOT NULL COMMENT '管理员id',
  `role_uid` varchar(32) NOT NULL COMMENT '角色id',
  `status` tinyint(4) DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*Data for the table `t_admin_role` */

insert  into `t_admin_role`(`uid`,`admin_uid`,`role_uid`,`status`,`create_time`,`update_time`) values ('bd3ffb1012074783bd3311b897d6bc96','1f01cd1d2f474743b241d74008b12335','434994947c5a4ee3a710cd277357c7c3',1,'2018-10-15 12:17:32','2018-10-15 12:17:32'),('eefd69c58c79490cbad06240b6f84952','1f01cd1d2f474743b241d74008b12333','434994947c5a4ee3a710cd277357c7c3',1,'2018-10-14 20:17:32','2018-10-14 20:17:32'),('eefd69c58c79490cbad06240b6f84953','1f01cd1d2f474743b241d74008b12334','434994947c5a4ee3a710cd277357c7c4',1,'2018-12-16 20:31:15','2018-12-16 20:31:15');

/*Table structure for table `t_blog` */

DROP TABLE IF EXISTS `t_blog`;

CREATE TABLE `t_blog` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `title` varchar(200) DEFAULT NULL COMMENT '博客标题',
  `summary` varchar(200) DEFAULT NULL COMMENT '博客简介',
  `content` longtext COMMENT '博客内容',
  `tag_uid` varchar(255) DEFAULT NULL COMMENT '标签uid',
  `click_count` int(11) DEFAULT '0' COMMENT '博客点击数',
  `collect_count` int(11) DEFAULT '0' COMMENT '博客收藏数',
  `file_uid` varchar(255) DEFAULT NULL COMMENT '标题图片uid',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `admin_uid` varchar(32) DEFAULT NULL COMMENT '管理员uid',
  `is_original` varchar(1) DEFAULT '1' COMMENT '是否原创（0:不是 1：是）',
  `author` varchar(255) DEFAULT NULL COMMENT '作者',
  `articles_part` varchar(255) DEFAULT NULL COMMENT '文章出处',
  `blog_sort_uid` varchar(32) DEFAULT NULL COMMENT '博客分类UID',
  `level` tinyint(1) DEFAULT '0' COMMENT '推荐等级(0:正常)',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='博客表';

/*Data for the table `t_blog` */

insert  into `t_blog`(`uid`,`title`,`summary`,`content`,`tag_uid`,`click_count`,`collect_count`,`file_uid`,`status`,`create_time`,`update_time`,`admin_uid`,`is_original`,`author`,`articles_part`,`blog_sort_uid`,`level`) values ('086f5b8d6e464a5ca81a1a738b9f5612','STS如何设置代码自动格式化','STS如何设置代码自动格式化','<p>很多同学不知道Eclipse有个很有用的功能，就是自动格式源代码的功能，一般大家都是直接Ctrl+Shift+F手动格式化，多浪费时间。&nbsp;其实Eclipse里已经带有自动格式化功能了，默认是没有代开该功能的。&nbsp;具体方法：windows--&gt;Preferences--&gt;Java --&gt; Editor--&gt;Save Actions, 看到右边的选项了吧，勾选&ldquo;Perform the selected actions on save&rdquo;，其他选项根据需要自己选择或者配置就可以了。 不过需要注意一点是，如果我们使用的是协同开发，开启此功能，可能会造成比较多的冲突哦~</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542787018092.png\" style=\"height:544px; width:800px\" /></p>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',1,0,'5531611e57134eef906bdf393f7e6503',1,'2018-11-21 15:57:40','2018-11-21 15:57:40',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('08d759825ce945f1801ac08067d71bd8','如何将字符串数组，转换成数组','如何将字符串数组，转换成数组','<p>方法1：使用eval() 函数,可计算某个字符串，并执行其中的的 JavaScript 代码。</p>\n\n<pre>\n<code>//对于字符串数组\nvar str = \"[ \'1\', \'2\' , \'3\']\";\n\n//通过eval就能转换成js中的数组\neval(\"(\" + str + \")\" );</code></pre>\n\n<p>&nbsp;</p>\n','ca928e8718654aa5a802e2f69277b137',1,0,'4addade94eab49d9b3b13e120d593c82',1,'2018-11-27 11:02:02','2018-11-27 11:02:02',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('1b3dadeffa9c489a9a2f5c5f93313aca','Vue项目项目用如何添加畅言','Vue项目项目用如何添加畅言-专业的社会化评论系统','<p>&nbsp; &nbsp; &nbsp;最近博客在写评论这一块，看到有一款专门做评论的插件-畅言，所以想着加入到我的博客中，作为一部分，不过可能这只是暂时的，后期可能会自己完整的搭建一下博客的评论系统。</p>\n\n<p>&nbsp; &nbsp; &nbsp;首先，先给大家介绍一下<a href=\"http://changyan.kuaizhan.com/\">畅言</a>是什么吧，搜狐畅言是由搜狐推出的一个简单而强大的社会化评论及聚合平台。用户可以直接用自己的社会化网络账户在第三方网站发表评论，并且一键评论同步至社交网络将网站内容和自己的评论分享给好友。增加第三方网站用户活跃度，调动好友参与评论，帮助网站实现社会化网络优化，有效提升网站社会化流量。</p>\n\n<p>&nbsp; &nbsp; &nbsp; 总的来说，畅言是搜狐提供的一款评论插件。下面言归正传，怎么在我们的博客项目中添加畅言呢。</p>\n\n<p>1）首先先注册，一个畅言的账号，然后进去后台系统中。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542243930045.png\" style=\"height:260px; width:554px\" /></p>\n\n<p>2）然后选中&nbsp; 安装畅言=》通用代码安装=》自适应安装代码</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542243947351.png\" style=\"height:238px; width:554px\" /></p>\n\n<p>3）为了以后我们方便使用评论插件，所以我们可以把改评论插件做成一个component组件。我们首先将刚刚复制的&nbsp; &lt;script&gt; &lt;/srcipt&gt; 放到 我们vue的&nbsp; static&nbsp; js文件夹，取名叫&nbsp; changyan.js</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542243953281.png\" style=\"height:305px; width:354px\" /></p>\n\n<p>然后在 changyan.js文件夹下，复制刚刚&nbsp; &lt;script&gt;&lt;/script&gt;下的内容，也就是下面部分。在这里我们需要注意的是，需要换成自己的 appid&nbsp; 和 conf号</p>\n\n<pre>\n<code class=\"language-javascript\">(function() {\n    var appid = \"cytUIrElb\";\n    var conf = \"prod_93fff6d19c0fab5bbb58f3e0a674154a\";\n    var width = window.innerWidth || document.documentElement.clientWidth;\n    if (width &lt; 960) {\n      window.document.write(\n        \'&lt;script id=\"changyan_mobile_js\" charset=\"utf-8\" type=\"text/javascript\" src=\"http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=\' +\n          appid +\n          \"&amp;conf=\" +\n          conf +\n          \'\"&gt;&lt;//script&gt;\'\n      );\n    } else {\n      var loadJs = function(d, a) {\n        var c =\n          document.getElementsByTagName(\"head\")[0] ||\n          document.head ||\n          document.documentElement;\n        var b = document.createElement(\"script\");\n        b.setAttribute(\"type\", \"text/javascript\");\n        b.setAttribute(\"charset\", \"UTF-8\");\n        b.setAttribute(\"src\", d);\n        if (typeof a === \"function\") {\n          if (window.attachEvent) {\n            b.onreadystatechange = function() {\n              var e = b.readyState;\n              if (e === \"loaded\" || e === \"complete\") {\n                b.onreadystatechange = null;\n                a();\n              }\n            };\n          } else {\n            b.onload = a;\n          }\n        }\n        c.appendChild(b);\n      };\n      loadJs(\"http://changyan.sohu.com/upload/changyan.js\", function() {\n        window.changyan.api.config({ appid: appid, conf: conf });\n      });\n    }\n  })();</code></pre>\n\n<p>4）下面我们就需要在components下创建自己的评论组件了。在这里我把组件名叫 ChangYan</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542243960147.png\" style=\"height:52px; width:307px\" /></p>\n\n<p>index.vue文件是这样写的，这里通过prop接受到一个sid，sid的作用是为了区分不同页面不同的评论的，就比如我在这里我的sid是我每篇博客的uid，通过不同的uid，那么就加载出不同的评论出来。然后通过 import，把刚刚我们写的&nbsp; &nbsp;changyan.js引入进来。</p>\n\n<pre>\n<code class=\"language-javascript\">&lt;template&gt;\n    &lt;div id=\"SOHUCS\" :sid=\"sid\" &gt;&lt;/div&gt;  \n&lt;/template&gt;\n\n&lt;script&gt;\nimport changyan from \'../../../static/js/changyan.js\'\nexport default {\n  props: [\"sid\"],\n  mounted() {\n\n  },\n  created() {\n    console.log(this.sid);\n  },\n  data() {\n    return {\n\n    }    \n  },\n\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>5）最后我们就可以开始使用组件了</p>\n\n<pre>\n<code class=\"language-javascript\">&lt;template&gt;\n    &lt;div&gt;\n        &lt;ChangYan :sid=\"sid\"&gt;&lt;/ChangYan&gt;  \n    &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nimport ChangYan from \"../components/ChangYan\";\nexport default {\n  components: {\n    ChangYan,\n  },\n  created() {\n\n  },\n  data() {\n    return {\n        sid: \"uid11111111111\"\n    }    \n  },\n\n}\n&lt;/script&gt;\n</code></pre>\n\n<p>6）最后的效果是这样的，怎么样，是不是还不错呢~！</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542243966711.png\" style=\"height:229px; width:554px\" /></p>\n','f90d3c2fd9434302951130e897a89164',0,0,'44704768e62f48bb9a04ae1cac453dd8',1,'2018-11-14 19:05:22','2018-11-14 19:05:22',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('1e1bc0784fcd44a8bef950d6156e2bd8','VUE项目如何快速删除node_modules文件夹下的依赖','VUE项目如何快速删除node_modules文件夹下的依赖','<p>有的时候，我们需要重新安装node的依赖，或者需要清空某个文件夹下面的东西，但是如果这个文件夹下面存在node_modules我们使用正常的删除方法发现会非常的慢，有的时候可能需要大概十多分钟才能删除，那么使用什么方法能够快速安装呢？</p>\n\n<p>下面介绍的是&nbsp;使用npm的一个名为<code>rimraf</code>的模块进行删除</p>\n\n<p>rimraf是什么呢？其实就相当于 linux系统下的 rm -rf&nbsp; ，如果我们用过这个命令的话，会发现他删除文件的速度是非常快的。</p>\n\n<pre>\n<code>//全局方式安装 rimraf模块\nnpm install -g rimraf\n\n//然后到对应的目录下\nrimraf node_modules</code></pre>\n\n<p>&nbsp;</p>\n','ca928e8718654aa5a802e2f69277b137',3,0,'088c7dc30f8b4f8bb4be5bee0a041cf2',1,'2018-12-10 09:22:10','2018-12-10 09:22:10',NULL,'1','陌溪','蘑菇博客','093d8bdd01c84890a928e923d5c235fe',0),('208692b2a7a242f4942993abb8eebf8b','哥们，消息中间件在你们项目里是如何落地的？','哥们，消息中间件在你们项目里是如何落地的？','<p>来源：石杉的架构笔记</p>\n\n<h1><strong><strong>一、前情回顾</strong></strong></h1>\n\n<p>之前给大家聊了一下，面试时如果遇到消息中间件这个话题，面试官上来可能问的两个问题：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>你们的系统架构中为什么要引入消息中间件？</p>\n	</li>\n	<li>\n	<p>系统架构中引入消息中间件有什么缺点？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>关于这两个问题的回答，可以参见之前的两篇文章：</p>\n\n<ul>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件？</a>》</p>\n	</li>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=bcdb3ee0332a440994216682cf850ed6\" target=\"_blank\">哥们，那你说说系统架构中引入消息中间件有什么缺点？</a>》</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>在问完这两个问题之后，不同风格的面试官可能会展开不同的发问。</p>\n\n<p>&nbsp;</p>\n\n<p>针对那种工作年限比较长的资深的同学，可能会开始就候选人所在公司使用的消息中间件，深入里面的技术细节，比如让你聊聊RocketMQ的架构原理和核心源码？</p>\n\n<p>&nbsp;</p>\n\n<p>但是另外一种面试风格，会先从你们的项目和业务入手进行考察，比如像下面这样：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>消息中间件在你们生产项目里具体是哪个业务场景下落地的？</p>\n	</li>\n	<li>\n	<p>这个业务场景有什么技术挑战？</p>\n	</li>\n	<li>\n	<p>为什么必须要在这个业务场景里用消息中间件技术？</p>\n	</li>\n	<li>\n	<p>具体使用消息中间件的时候是怎么来用的？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>好！这篇文章，咱们从第二种风格来聊聊。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>二、业务场景介绍</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>我们会落地到某个具体业务系统的某个场景下，看看如何使用消息中间件，然后其效果是什么。</p>\n\n<p>&nbsp;</p>\n\n<p>业务场景的话，咱们就用大家都很熟悉的<strong>电商业务</strong>为例，这里为了便于理解，对其做了一定的抽象和简化。</p>\n\n<p>&nbsp;</p>\n\n<p>大家还是来考虑一个下订单的业务流程，比如你下个订单，此时需要干几件事情：</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>更新订单状态为&ldquo;待发货&rdquo;（耗时20ms）</p>\n	</li>\n	<li>\n	<p>扣减商品库存（耗时100ms）</p>\n	</li>\n	<li>\n	<p>增加会员积分（耗时80ms）</p>\n	</li>\n	<li>\n	<p>附赠优惠券（耗时50ms）</p>\n	</li>\n	<li>\n	<p>仓储调度发货（耗时几十秒）。</p>\n	</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>说明一下：上述环节，为了便于大家理解，做了简化。实际真正复杂的电商系统里，整体环节和业务流程会比这个复杂很多倍，而且耗时也绝对不是上面那么简单的。</p>\n\n<p>&nbsp;</p>\n\n<p>老规矩！我们还是通过一张手绘图，来看看这整个的业务流程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144696893.png\" style=\"height:400px; width:675px\" /></p>\n\n<p>如上图，这个下订单的业务流程中：</p>\n\n<p>更新订单状态（20ms） + &nbsp;扣减商品库存（100ms） + &nbsp;增加会员积分（80ms） + &nbsp;附赠优惠券（50ms） = &nbsp;250ms。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，仅仅是这4个流程的话，也就200多毫秒的耗时。</p>\n\n<p>&nbsp;</p>\n\n<p>200多毫秒的耗时，对用户下单体验来说是非常快速的，几乎就是一瞬间就完成了，不会感到过多的停顿，也就是一下子就可以看到自己下单成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是，如果加上那个调度仓储发货呢？</p>\n\n<p>&nbsp;</p>\n\n<p>那个环节需要读取大量的数据、使用多仓库/多货位的调度算法、还要跟C/S架构的仓储系统进行网络通信，因此我们这里假设这个环节可能会耗时数十秒。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦加上那个调度仓储发货的环节到这个下单流程里，就可能导致用户要等页面卡顿几十秒后才会看到下单成功的提示，这个用户体验就相当的差了。</p>\n\n<p>&nbsp;</p>\n\n<p>按照之前一篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件呢？</a>》的说法。对于这种场景，完全适合使用消息中间件来进行异步化调用。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，订单服务对仓储调度发货，仅仅是发送一个消息到MQ里，然后仓储服务消费消息之后再慢慢的执行调度算法，然后分配商品发货任务给对应的仓库即可。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以把耗时几十秒的仓储调度发货的环节，从下单流程里摘除出去了。进而保证下单流程就仅仅是耗时200多毫秒而已。</p>\n\n<p>&nbsp;</p>\n\n<p>至于那个耗时几十秒的仓储调度发货环节，我们通过异步的方式慢慢执行即可，不会影响用户下单的体验。</p>\n\n<p>&nbsp;</p>\n\n<p>以上过程，我们同样来一张图，大家直观的感受一下：</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144724851.png\" style=\"height:408px; width:690px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>三、初步落地</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>好！接下来我们就假设大家在实际生产中还没用过消息中间件，咱们从0开始，看看如何落地？</p>\n\n<p>&nbsp;</p>\n\n<p>对于已经在生产中使用过消息中间件的小伙伴，不妨也看看，权当复习，温故知新！</p>\n\n<p>&nbsp;</p>\n\n<p>我们以RabbitMQ为例，假如你用的消息中间件是RabbitMQ，那么我们对这个消息中间件应该如何安装和部署呢？</p>\n\n<p>&nbsp;</p>\n\n<p>很简单，RabbitMQ的官方文档里提供了非常详细的安装部署步骤，你可以在自己的笔记本电脑本地安装，也可以在公司的服务器上部署。</p>\n\n<p>&nbsp;</p>\n\n<p>现在假设你已经参考了官方文档并安装完成，那么接下来在代码层面应该怎么来引入RabbitMQ以及在系统里实现收发消息呢？</p>\n\n<p>&nbsp;</p>\n\n<p>下面通过一些HelloWorld级别的代码和一些简单的示例图，给大家演示一下RabbitMQ是如何收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>对于很多在实际生产中使用过MQ的同学，这些代码可能对实际生产中使用过MQ的同学，显得太简单了。</p>\n\n<p>&nbsp;</p>\n\n<p>不过考虑到很多初学者可能连用都没有用过MQ，甚至是才听说消息中间件不久，所以笔者认为这些demo代码以及手工绘图，还是很有必要。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144746252.png\" style=\"height:412px; width:675px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144758533.png\" style=\"height:489px; width:676px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144769467.png\" style=\"height:629px; width:677px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144782745.png\" style=\"height:171px; width:678px\" /></p>\n\n<p>好！看完了代码，这个时候，我们可以通过一张图来想象一下两个服务之间的通信。<br />\n&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>订单服务你可以启动多个，不同的订单服务都可以往一个RabbitMQ的queue里推送消息。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务你也可以启动多个，多个仓储服务会采用<strong>round-robin</strong>的轮询算法，每个服务实例都可以从RabbitMQ queue里消费到一部分的消息。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144796282.png\" style=\"height:349px; width:623px\" /></p>\n\n<p>上面的图里，订单服务在MQ专业术语中叫做<strong>&ldquo;生产者&rdquo;</strong>，英文是&ldquo;Producer&rdquo;，意思就是这个服务是专门负责生产消息投递到MQ的。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务在MQ专业术语中叫做<strong>&ldquo;消费者&rdquo;</strong>，英文是&ldquo;Consumer&rdquo;，意思就是这个服务专门是负责从MQ消费消息然后处理的。</p>\n\n<p>&nbsp;</p>\n\n<p>这个时候，这套异步通信的架构就可以跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>好了，到目前为止，虽然这个代码还存在不少问题，但是没关系，大体上我们已经给一些不太熟悉MQ技术的同学，从一个比较形象易于理解简化后的电商业务场景出发，通过HelloWorld级别的示例代码和手工绘图，将MQ这个技术落地跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>更进一步，各位同学完全可以参照这个文章里的案例，思考一下：自己负责的项目里，有没有类似的业务场景可以使用MQ的？</p>\n\n<p>&nbsp;</p>\n\n<p>然后想办法在自己的项目里落地使用MQ的技术来做一下异步化，提升核心流程的性能。</p>\n\n<p>&nbsp;</p>\n\n<p>这样未来在跳槽面试的时候，才可以做到游刃有余，有自己的一套东西可以说。</p>\n\n<p><strong>END</strong></p>\n','1c76b9848f5f4d71a5e88b20dbaf38f4',1,0,'52b6106a19524aa8ab5543342e5152b9',1,'2018-12-30 12:41:46','2018-12-30 12:41:46',NULL,'1','陌溪_','蘑菇博客','e60df954efcd47c48463a504bb70bbe9',1),('2c581c60ae6743a7a37bbe7543915483','拜托！面试请不要再问我Spring Cloud底层原理！','拜托！面试请不要再问我Spring Cloud底层原理！','<p>本文转载自：https://blog.csdn.net/qq_42046105/article/details/83793787</p>\n\n<p>&nbsp;</p>\n\n<p><strong>概述</strong></p>\n\n<p>毫无疑问，Spring Cloud是目前微服务架构领域的翘楚，无数的书籍博客都在讲解这个技术。不过大多数讲解还停留在对Spring Cloud功能使用的层面，其底层的很多原理，很多人可能并不知晓。<strong>因此本文将通过大量的手绘图</strong>，给大家谈谈Spring Cloud微服务架构的底层原理。<br />\n<br />\n实际上，Spring Cloud是一个全家桶式的技术栈，包含了很多组件。本文先从其最核心的几个组件入手，来剖析一下其底层的工作原理。<strong>也就是Eureka、Ribbon、Feign、Hystrix、Zuul这几个组件。</strong></p>\n\n<p>&nbsp;</p>\n\n<h1><strong>一、业务场景介绍</strong></h1>\n\n<p>先来给大家说一个业务场景，假设咱们现在开发一个电商网站，要实现支付订单的功能，流程如下：</p>\n\n<ul>\n	<li>\n	<p>创建一个订单之后，如果用户立刻支付了这个订单，我们需要将订单状态更新为&ldquo;已支付&rdquo;</p>\n	</li>\n	<li>\n	<p>扣减相应的商品库存</p>\n	</li>\n	<li>\n	<p>通知仓储中心，进行发货</p>\n	</li>\n	<li>\n	<p>给用户的这次购物增加相应的积分</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>针对上述流程，<strong>我们需要有订单服务、库存服务、仓储服务、积分服务</strong>。整个流程的大体思路如下：</p>\n\n<ul>\n	<li>\n	<p>用户针对一个订单完成支付之后，就会去找订单服务，更新订单状态</p>\n	</li>\n	<li>\n	<p>订单服务调用库存服务，完成相应功能</p>\n	</li>\n	<li>\n	<p>订单服务调用仓储服务，完成相应功能</p>\n	</li>\n	<li>\n	<p>订单服务调用积分服务，完成相应功能</p>\n	</li>\n</ul>\n\n<p><strong>至此，整个支付订单的业务流程结束</strong></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>下图这张图，清晰表明了各服务间的调用过程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258601185.png\" style=\"height:333px; width:690px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>好！有了业务场景之后，咱们就一起来看看Spring&nbsp;Cloud微服务架构中，这几个组件如何相互协作，各自发挥的作用以及其背后的原理。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、Spring Cloud核心组件：Eureka</strong></p>\n\n<p><strong>咱们来考虑第一个问题</strong>：订单服务想要调用库存服务、仓储服务，或者是积分服务，怎么调用？</p>\n\n<ul>\n	<li>\n	<p>订单服务压根儿就不知道人家库存服务在哪台机器上啊！他就算想要发起一个请求，都不知道发送给谁，有心无力！</p>\n	</li>\n	<li>\n	<p>这时候，就轮到Spring Cloud Eureka出场了。Eureka是微服务架构中的注册中心，专门负责服务的注册与发现。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;咱们来看看下面的这张图，结合图来仔细剖析一下整个流程：&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542330274039.png\" style=\"height:396px; width:965px\" /></p>\n\n<p>如上图所示，库存服务、仓储服务、积分服务中都有一个Eureka Client组件，这个组件专门负责将这个服务的信息注册到Eureka Server中。说白了，就是告诉Eureka Server，自己在哪台机器上，监听着哪个端口。而Eureka Server是一个注册中心，里面有一个注册表，保存了各服务所在的机器和端口号</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>订单服务里也有一个Eureka Client组件，这个Eureka Client组件会找Eureka Server问一下：库存服务在哪台机器啊？监听着哪个端口啊？仓储服务呢？积分服务呢？然后就可以把这些相关信息从Eureka Server的注册表中拉取到自己本地缓存起来。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>这时如果订单服务想要调用库存服务，不就可以找自己本地的Eureka Client问一下库存服务在哪台机器？监听哪个端口吗？收到响应后，紧接着就可以发送一个请求过去，调用库存服务扣减库存的那个接口！同理，如果订单服务要调用仓储服务、积分服务，也是如法炮制。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>总结一下：</p>\n\n<ul>\n	<li>\n	<p><strong>Eureka</strong><strong>&nbsp;</strong><strong>Client：</strong>负责将这个服务的信息注册到Eureka Server中</p>\n	</li>\n	<li>\n	<p><strong>Eureka Server：</strong>注册中心，里面有一个注册表，保存了各个服务所在的机器和端口号</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>三、Spring Cloud核心组件：Feign</strong></h1>\n\n<p>现在订单服务确实知道库存服务、积分服务、仓库服务在哪里了，同时也监听着哪些端口号了。<strong>但是新问题又来了：难道订单服务要自己写一大堆代码，跟其他服务建立网络连接，然后构造一个复杂的请求，接着发送请求过去，最后对返回的响应结果再写一大堆代码来处理吗？</strong></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>这是上述流程翻译的代码片段，咱们一起来看看，体会一下这种绝望而无助的感受！！！</p>\n\n<p>&nbsp;</p>\n\n<p><strong>友情提示，前方高能：</strong></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258628966.png\" style=\"height:611px; width:673px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>看完上面那一大段代码，有没有感到后背发凉、一身冷汗？实际上你进行服务间调用时，如果每次都手写代码，代码量比上面那段要多至少几倍，所以这个事儿压根儿就不是地球人能干的。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>既然如此，那怎么办呢？别急，Feign早已为我们提供好了优雅的解决方案。来看看如果用Feign的话，你的订单服务调用库存服务的代码会变成啥样？</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258640136.png\" style=\"height:428px; width:673px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>看完上面的代码什么感觉？是不是感觉整个世界都干净了，又找到了活下去的勇气！没有底层的建立连接、构造请求、解析响应的代码，直接就是用注解定义一个 FeignClient接口，然后调用那个接口就可以了。人家Feign Client会在底层根据你的注解，跟你指定的服务建立连接、构造请求、发起靕求、获取响应、解析响应，等等。这一系列脏活累活，人家Feign全给你干了。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>那么问题来了，Feign是如何做到这么神奇的呢？很简单，<strong>Feign的一个关键机制就是使用了动态代理</strong>。咱们一起来看看下面的图，结合图来分析：</p>\n\n<ul>\n	<li>\n	<p>首先，如果你对某个接口定义了@FeignClient注解，Feign就会针对这个接口创建一个动态代理</p>\n	</li>\n	<li>\n	<p>接着你要是调用那个接口，本质就是会调用&nbsp;Feign创建的动态代理，这是核心中的核心</p>\n	</li>\n	<li>\n	<p>Feign的动态代理会根据你在接口上的@RequestMapping等注解，来动态构造出你要请求的服务的地址</p>\n	</li>\n	<li>\n	<p>最后针对这个地址，发起请求、解析响应</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542330312620.png\" style=\"height:270px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>四、Spring Cloud核心组件：</strong><strong>Ribbon</strong></h1>\n\n<p>说完了Feign，还没完。现在新的问题又来了，如果人家库存服务部署在了5台机器上，如下所示：</p>\n\n<ul>\n	<li>\n	<p>192.168.169:9000</p>\n	</li>\n	<li>\n	<p>192.168.170:9000</p>\n	</li>\n	<li>\n	<p>192.168.171:9000</p>\n	</li>\n	<li>\n	<p>192.168.172:9000</p>\n	</li>\n	<li>\n	<p>192.168.173:9000</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>这下麻烦了！</strong><strong>人家Feign怎么知道该请求哪台机器呢？</strong></p>\n\n<ul>\n	<li>\n	<p>这时Spring Cloud&nbsp;Ribbon就派上用场了。Ribbon就是专门解决这个问题的。它的作用是负载均衡，会帮你在每次请求时选择一台机器，均匀的把请求分发到各个机器上</p>\n\n	<p>&nbsp;</p>\n\n	<p>&nbsp;</p>\n	</li>\n	<li>\n	<p>Ribbon的负载均衡默认使用的最经典的Round&nbsp;Robin轮询算法。这是啥？简单来说，就是如果订单服务对库存服务发起10次请求，那就先让你请求第1台机器、然后是第2台机器、第3台机器、第4台机器、第5台机器，接着再来&mdash;个循环，第1台机器、第2台机器。。。以此类推。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;<strong>此外，Ribbon是和Feign以及Eureka紧密协作，完成工作的，具体如下：</strong></p>\n\n<ul>\n	<li>\n	<p>首先Ribbon会从&nbsp;Eureka Client里获取到对应的服务注册表，也就知道了所有的服务都部署在了哪些机器上，在监听哪些端口号。</p>\n	</li>\n	<li>\n	<p>然后Ribbon就可以使用默认的Round&nbsp;Robin算法，从中选择一台机器</p>\n	</li>\n	<li>\n	<p>Feign就会针对这台机器，构造并发起请求。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>对上述整个过程，再来一张图，帮助大家更深刻的理解：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542330209181.png\" style=\"height:248px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>五、Spring Cloud核心组件：Hystrix</strong></p>\n\n<p>在微服务架构里，一个系统会有很多的服务。以本文的业务场景为例：订单服务在一个业务流程里需要调用三个服务。现在假设订单服务自己最多只有100个线程可以处理请求，然后呢，积分服务不幸的挂了，每次订单服务调用积分服务的时候，都会卡住几秒钟，然后抛出&mdash;个超时异常。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>咱们一起来分析一下，这样会导致什么问题？</strong></p>\n\n<ol>\n	<li>\n	<p>如果系统处于高并发的场景下，大量请求涌过来的时候，订单服务的100个线程都会卡在请求积分服务这块。导致订单服务没有一个线程可以处理请求</p>\n	</li>\n	<li>\n	<p>然后就会导致别人请求订单服务的时候，发现订单服务也挂了，不响应任何请求了</p>\n	</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>上面这个，就是<strong>微服务架构中恐怖的服务雪崩问题</strong>，如下图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258783013.png\" style=\"height:471px; width:676px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>如上图，这么多服务互相调用，要是不做任何保护的话，某一个服务挂了，就会引起连锁反应，导致别的服务也挂。比如积分服务挂了，会导致订单服务的线程全部卡在请求积分服务这里，没有一个线程可以工作，瞬间导致订单服务也挂了，别人请求订单服务全部会卡住，无法响应。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>但是我们思考一下，就算积分服务挂了，订单服务也可以不用挂啊！</strong><strong>为什么？</strong></p>\n\n<ul>\n	<li>\n	<p>我们结合业务来看：支付订单的时候，只要把库存扣减了，然后通知仓库发货就OK了</p>\n	</li>\n	<li>\n	<p>如果积分服务挂了，大不了等他恢复之后，慢慢人肉手工恢复数据！为啥一定要因为一个积分服务挂了，就直接导致订单服务也挂了呢？不可以接受！</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>现在问题分析完了，如何解决？</strong></p>\n\n<p>这时就轮到Hystrix闪亮登场了。Hystrix是隔离、熔断以及降级的一个框架。啥意思呢？说白了，Hystrix会搞很多个小小的线程池，比如订单服务请求库存服务是一个线程池，请求仓储服务是一个线程池，请求积分服务是一个线程池。每个线程池里的线程就仅仅用于请求那个服务。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>打个比方：现在很不幸，积分服务挂了，会咋样？</strong></p>\n\n<p>当然会导致订单服务里的那个用来调用积分服务的线程都卡死不能工作了啊！但是由于订单服务调用库存服务、仓储服务的这两个线程池都是正常工作的，所以这两个服务不会受到任何影响。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>这个时候如果别人请求订单服务，订单服务还是可以正常调用库存服务扣减库存，调用仓储服务通知发货。只不过调用积分服务的时候，每次都会报错。<strong>但是如果积分服务都挂了，每次调用都要去卡住几秒钟干啥呢？</strong><strong>有意义吗？当然没有！</strong>所以我们直接对积分服务熔断不就得了，比如在5分钟内请求积分服务直接就返回了，不要去走网络请求卡住几秒钟，这个过程，就是所谓的熔断！</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>那人家又说，兄弟，积分服务挂了你就熔断，好歹你干点儿什么啊！别啥都不干就直接返回啊？</strong>没问题，咱们就来个降级：每次调用积分服务，你就在数据库里记录一条消息，说给某某用户增加了多少积分，因为积分服务挂了，导致没增加成功！这样等积分服务恢复了，你可以根据这些记录手工加一下积分。这个过程，就是所谓的降级。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>为帮助大家更直观的理解，接下来用一张图，梳理一下Hystrix隔离、熔断和降级的全流程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258802533.png\" style=\"height:529px; width:689px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>六、Spring Cloud核心组件：</strong><strong>Zuul</strong></h1>\n\n<p>说完了Hystrix，接着给大家说说最后一个组件：Zuul，也就是微服务网关。这个组件是负责网络路由的。不懂网络路由？行，那我给你说说，如果没有Zuul的日常工作会怎样？</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>假设你后台部署了几百个服务，现在有个前端兄弟，人家请求是直接从浏览器那儿发过来的。<strong>打个比方</strong>：人家要请求一下库存服务，你难道还让人家记着这服务的名字叫做inventory-service？部署在5台机器上？就算人家肯记住这一个，你后台可有几百个服务的名称和地址呢？难不成人家请求一个，就得记住一个？你要这样玩儿，那真是友谊的小船，说翻就翻！</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>上面这种情况，压根儿是不现实的。所以一般微服务架构中都必然会设计一个网关在里面，像android、ios、pc前端、微信小程序、H5等等，不用去关心后端有几百个服务，就知道有一个网关，所有请求都往网关走，网关会根据请求中的一些特征，将请求转发给后端的各个服务。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>而且有一个网关之后，还有很多好处，比如可以做统一的降级、限流、认证授权、安全，等等。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>七、总结：</strong></p>\n\n<p>最后再来总结一下，上述几个Spring&nbsp;Cloud核心组件，在微服务架构中，分别扮演的角色：</p>\n\n<ul>\n	<li>\n	<p><strong>Eureka</strong>：各个服务启动时，Eureka&nbsp;Client都会将服务注册到Eureka&nbsp;Server，并且Eureka&nbsp;Client还可以反过来从Eureka&nbsp;Server拉取注册表，从而知道其他服务在哪里</p>\n	</li>\n	<li>\n	<p><strong>Ribbon</strong>：服务间发起请求的时候，基于Ribbon做负载均衡，从一个服务的多台机器中选择一台</p>\n	</li>\n	<li>\n	<p><strong>Feign</strong>：基于Feign的动态代理机制，根据注解和选择的机器，拼接请求URL地址，发起请求</p>\n	</li>\n	<li>\n	<p><strong>Hystrix</strong>：发起请求是通过Hystrix的线程池来走的，不同的服务走不同的线程池，实现了不同服务调用的隔离，避免了服务雪崩的问题</p>\n	</li>\n	<li>\n	<p><strong>Zuul</strong>：如果前端、移动端要调用后端系统，统一从Zuul网关进入，由Zuul网关转发请求给对应的服务</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>以上就是我们通过一个电商业务场景，阐述了Spring&nbsp;Cloud微服务架构几个核心组件的底层原理。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>文字总结还不够直观？没问题！</strong>我们将Spring Cloud的5个核心组件通过一张图串联起来，再来直观的感受一下其底层的架构原理：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258843261.png\" style=\"height:470px; width:825px\" /></p>\n','e81bc2dca42c4031be7d66fef4a71e16',0,0,'760f5d83f561440c8ec0691c66ca0338',1,'2018-11-15 13:15:50','2018-11-15 13:15:50',NULL,'0','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',4),('3008b19a20cd46aba7b62d619e7c5700','哥们，你们的系统架构中为什么要引入消息中间件？','哥们，你们的系统架构中为什么要引入消息中间件？','<p>本文来自微信公众号：石杉的架构笔记</p>\n\n<p>&nbsp;</p>\n\n<p>这篇文章开始，我们把消息中间件这块高频的面试题给大家说一下，也会涵盖一些MQ中间件常见的技术问题。</p>\n\n<p>&nbsp;</p>\n\n<p>假如面试官看你简历里写了MQ中间件的使用经验，很可能会有如下问题：</p>\n\n<ul>\n	<li>\n	<p>你们公司生产环境用的是什么消息中间件？</p>\n	</li>\n	<li>\n	<p>为什么要在系统里引入消息中间件？</p>\n	</li>\n	<li>\n	<p>引入消息中间件之后会有什么好处以及坏处？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>好，我们一个个的来分析！</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>你们公司生产环境用的是什么消息中间件？</strong></h1>\n\n<p>&nbsp;</p>\n\n<p>这个首先你可以说下你们公司选用的是什么消息中间件，比如用的是RabbitMQ，然后可以初步给一些你对不同MQ中间件技术的选型分析。</p>\n\n<p>&nbsp;</p>\n\n<p>举个例子：比如说ActiveMQ是老牌的消息中间件，国内很多公司过去运用的还是非常广泛的，功能很强大。</p>\n\n<p>&nbsp;</p>\n\n<p>但是问题在于没法确认ActiveMQ可以支撑互联网公司的高并发、高负载以及高吞吐的复杂场景，在国内互联网公司落地较少。而且使用较多的是一些传统企业，用ActiveMQ做异步调用和系统解耦。</p>\n\n<p>&nbsp;</p>\n\n<p>然后你可以说说RabbitMQ，他的好处在于可以支撑高并发、高吞吐、性能很高，同时有非常完善便捷的后台管理界面可以使用。</p>\n\n<p>&nbsp;</p>\n\n<p>另外，他还支持集群化、高可用部署架构、消息高可靠支持，功能较为完善。</p>\n\n<p>&nbsp;</p>\n\n<p>而且经过调研，国内各大互联网公司落地大规模RabbitMQ集群支撑自身业务的case较多，国内各种中小型互联网公司使用RabbitMQ的实践也比较多。</p>\n\n<p>&nbsp;</p>\n\n<p>除此之外，RabbitMQ的开源社区很活跃，较高频率的迭代版本，来修复发现的bug以及进行各种优化，因此综合考虑过后，公司采取了RabbitMQ。</p>\n\n<p>&nbsp;</p>\n\n<p>但是RabbitMQ也有一点缺陷，就是他自身是基于erlang语言开发的，所以导致较为难以分析里面的源码，也较难进行深层次的源码定制和改造，毕竟需要较为扎实的erlang语言功底才可以。</p>\n\n<p>&nbsp;</p>\n\n<p>然后可以聊聊RocketMQ，是阿里开源的，经过阿里的生产环境的超高并发、高吞吐的考验，性能卓越，同时还支持分布式事务等特殊场景。</p>\n\n<p>&nbsp;</p>\n\n<p>而且RocketMQ是基于Java语言开发的，适合深入阅读源码，有需要可以站在源码层面解决线上生产问题，包括源码的二次开发和改造。</p>\n\n<p>&nbsp;</p>\n\n<p>另外就是Kafka。Kafka提供的消息中间件的功能明显较少一些，相对上述几款MQ中间件要少很多。</p>\n\n<p>&nbsp;</p>\n\n<p>但是Kafka的优势在于专为超高吞吐量的实时日志采集、实时数据同步、实时数据计算等场景来设计。</p>\n\n<p>&nbsp;</p>\n\n<p>因此Kafka在大数据领域中配合实时计算技术（比如Spark Streaming、Storm、Flink）使用的较多。但是在传统的MQ中间件使用场景中较少采用。</p>\n\n<p>&nbsp;</p>\n\n<p><em>PS：如果大家对上述一些MQ技术还没在自己电脑部署过，没写几个helloworld体验一下的话，建议先上各个技术的官网找到helloworld demo，自己跑一遍玩玩；</em></p>\n\n<p>&nbsp;</p>\n\n<h1><strong>为什么在你们系统架构中要引入消息中间件？</strong></h1>\n\n<p>&nbsp;</p>\n\n<p>回答这个问题，其实就是让你先说说消息中间件的常见使用场景。</p>\n\n<p>&nbsp;</p>\n\n<p>然后结合你们自身系统对应的使用场景，说一下在你们系统中引入消息中间件是解决了什么问题。</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>1）系统解耦</strong></strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>假设你有个系统A，这个系统A会产出一个核心数据，现在下游有系统B和系统C需要这个数据。</p>\n\n<p>&nbsp;</p>\n\n<p>那简单，系统A就是直接调用系统B和系统C的接口发送数据给他们就好了。</p>\n\n<p>&nbsp;</p>\n\n<p>整个过程，如下图所示。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp; &nbsp; &nbsp;<img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748147901.png\" style=\"height:414px; width:500px\" /></p>\n\n<p>但是现在要是来了系统D、系统E、系统F、系统G，等等，十来个其他系统慢慢的都需要这份核心数据呢？如下图所示。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748190242.png\" style=\"height:344px; width:595px\" /></p>\n\n<p>大家可别以为这是开玩笑，一个大规模系统，往往会拆分为几十个甚至上百个子系统，每个子系统又对应N多个服务，这些系统与系统之间有着错综复杂的关系网络。</p>\n\n<p>&nbsp;</p>\n\n<p>如果某个系统产出一份核心数据，可能下游无数的其他系统都需要这份数据来实现各种业务逻辑。</p>\n\n<p>&nbsp;</p>\n\n<p>此时如果你要是采取上面那种模式来设计系统架构，那么绝对你负责系统A的同学要被烦死了。</p>\n\n<p>&nbsp;</p>\n\n<p>先是来一个人找他要求发送数据给一个新的系统H，系统A的同学要修改代码然后在那个代码里加入调用新系统H的流程。</p>\n\n<p>&nbsp;</p>\n\n<p>一会那个系统B是个陈旧老系统要下线了，告诉系统A的同学：别给我发送数据了，接着系统A再次修改代码不再给这个系统B。</p>\n\n<p>&nbsp;</p>\n\n<p>然后如果要是某个下游系统突然宕机了呢？系统A的调用代码里是不是会抛异常？那系统A的同学会收到报警说异常了，结果他还要去care是下游哪个系统宕机了。</p>\n\n<p>&nbsp;</p>\n\n<p>所以在实际的系统架构设计中，如果全部采取这种系统耦合的方式，在某些场景下绝对是不合适的，系统耦合度太严重。</p>\n\n<p>&nbsp;</p>\n\n<p>并且互相耦合起来并不是核心链路的调用，而是一些非核心的场景（比如上述的数据消费）导致了系统耦合，这样会严重的影响上下游系统的开发和维护效率。</p>\n\n<p>&nbsp;</p>\n\n<p>因此在上述系统架构中，就可以<strong>采用MQ中间件来实现系统解耦</strong>。</p>\n\n<p>&nbsp;</p>\n\n<p>系统A就把自己的一份核心数据发到MQ里，下游哪个系统感兴趣自己去消费即可，不需要了就取消数据的消费，如下图所示。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748216357.png\" style=\"height:358px; width:674px\" /></p>\n\n<p><strong><strong>2）异步调用</strong></strong>&nbsp;</p>\n\n<p>假设你有一个系统调用链路，是系统A调用系统B，一般耗时20ms；系统B调用系统C，一般耗时200ms；系统C调用系统D，一般耗时2s，如下图所示。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748239599.png\" style=\"height:141px; width:675px\" /></p>\n\n<p>现在最大的问题就是：用户一个请求过来巨慢无比，因为走完一个链路，需要耗费20ms + 200ms + 2000ms（2s） = 2220ms，也就是2秒多的时间。</p>\n\n<p>&nbsp;</p>\n\n<p>但是实际上，链路中的系统A调用系统B，系统B调用系统C，这两个步骤起来也就220ms。</p>\n\n<p>&nbsp;</p>\n\n<p>就因为引入了系统C调用系统D这个步骤，导致最终链路执行时间是2秒多，直接将链路调用性能降低了10倍，这就是导致链路执行过慢的罪魁祸首。</p>\n\n<p>&nbsp;</p>\n\n<p>那此时我们可以思考一下，是不是可以将系统D从链路中抽离出去做成异步调用呢？其实很多的业务场景是可以允许异步调用的。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>举个例子</strong>，你平时点个外卖，咔嚓一下子下订单然后付款了，此时账户扣款、创建订单、通知商家给你准备菜品。</p>\n\n<p>&nbsp;</p>\n\n<p>接着，是不是需要找个骑手给你送餐？那这个找骑手的过程，是需要一套复杂算法来实现调度的，比较耗时。</p>\n\n<p>&nbsp;</p>\n\n<p>但是其实稍微晚个几十秒完成骑手的调度都是ok的，因为实际并不需要在你支付的一瞬间立马给你找好骑手，也没那个必要。</p>\n\n<p>&nbsp;</p>\n\n<p>那么我们是不是就可以把找骑手给你送餐的这个步骤从链路中抽离出去，做成异步化的，哪怕延迟个几十秒，但是只要在一定时间范围内给你找到一个骑手去送餐就可以了。</p>\n\n<p>&nbsp;</p>\n\n<p>这样是不是就可以让你下订单点外卖的速度变得超快？支付成功之后，直接创建好订单、账户扣款、通知商家立马给你准备做菜就ok了，这个过程可能就几百毫秒。</p>\n\n<p>&nbsp;</p>\n\n<p>然后后台异步化的耗费可能几十秒通过调度算法给你找到一个骑手去送餐，但是这个步骤不影响我们快速下订单。</p>\n\n<p>&nbsp;</p>\n\n<p>当然我们不是说那些大家熟悉的外卖平台的技术架构就一定是这么实现的，只不过是用一个生活中常见的例子给大家举例说明而已。</p>\n\n<p>&nbsp;</p>\n\n<p>所以上面的链路也是同理，如果业务流程支持异步化的话，是不是就可以考虑把系统C对系统D的调用抽离出去做成异步化的，不要放在链路中同步依次调用。</p>\n\n<p>&nbsp;</p>\n\n<p>这样，实现思路就是系统A -&gt; 系统B -&gt; 系统C，直接就耗费220ms后直接成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>然后系统C就是发送个消息到MQ中间件里，由系统D消费到消息之后慢慢的异步来执行这个耗时2s的业务处理。通过这种方式直接将核心链路的执行性能提升了10倍。</p>\n\n<p>&nbsp;</p>\n\n<p>整个过程，如下图所示。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748265828.png\" style=\"height:260px; width:677px\" /></p>\n\n<p><strong><strong>3）流量削峰</strong></strong>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>假设你有一个系统，平时正常的时候每秒可能就几百个请求，系统部署在8核16G的机器的上，正常处理都是ok的，每秒几百请求是可以轻松抗住的。</p>\n\n<p>&nbsp;</p>\n\n<p>但是如下图所示，在高峰期一下子来了每秒钟几千请求，瞬时出现了流量高峰，此时你的选择是要搞10台机器，抗住每秒几千请求的瞬时高峰吗？</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748282895.png\" style=\"height:332px; width:416px\" /></p>\n\n<p>那如果瞬时高峰每天就那么半个小时，接着直接就降低为了每秒就几百请求，如果你线上部署了很多台机器，那么每台机器就处理每秒几十个请求就可以了，这不是有点浪费机器资源吗？</p>\n\n<p>&nbsp;</p>\n\n<p>大部分时候，每秒几百请求，一台机器就足够了，但是为了抗那每天瞬时的高峰，硬是部署了10台机器，每天就那半个小时有用，别的时候都是浪费资源的。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748295494.png\" style=\"height:339px; width:410px\" /></p>\n\n<p>但是如果你就部署一台机器，那会导致瞬时高峰时，一下子压垮你的系统，因为绝对无法抗住每秒几千的请求高峰。</p>\n\n<p>&nbsp;</p>\n\n<p>此时我们就可以用MQ中间件来进行流量削峰。所有机器前面部署一层MQ，平时每秒几百请求大家都可以轻松接收消息。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦到了瞬时高峰期，一下涌入每秒几千的请求，就可以积压在MQ里面，然后那一台机器慢慢的处理和消费。</p>\n\n<p>&nbsp;</p>\n\n<p>等高峰期过了，再消费一段时间，MQ里积压的数据就消费完毕了。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748307907.png\" style=\"height:355px; width:679px\" /></p>\n\n<p>这个就是很典型的一个MQ的用法，用有限的机器资源承载高并发请求，如果业务场景允许异步削峰，高峰期积压一些请求在MQ里，</p>\n\n<p>&nbsp;</p>\n\n<p>然后高峰期过了，后台系统在一定时间内消费完毕不再积压的话，那就很适合用这种技术方案。</p>\n\n<p>&nbsp;</p>\n\n<p>关于第三个问题：引入消息中间件之后会有什么好处以及坏处。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n','ca928e8718654aa5a802e2f69277b137',8,0,'647d9656f86444dea6eeec18457f3866',1,'2018-12-14 08:46:05','2018-12-14 08:46:05',NULL,'0','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',1),('4000982427cb47edb8c626f409d5377d','Linux下Mysql定时备份','Linux下Mysql定时备份','<p>&nbsp; &nbsp; &nbsp; &nbsp;记得原来第一次使用服务器的时候，当初写了一个小网站，想要上传到服务器上去，当初服务器是买的国外的，因为部署的时候，为了方便，就在控制台把防火墙关闭了！（特别提醒，以后千万别干这种傻事），关闭后就开始安装MariaDB，（MariaDB是mysql的社区版），然后端口号和密码都采用的是初始化的，3306，admin admin，所以网站部署完成以后，第二天就被黑客进行端口扫描后，暴力破解了。留下一条索要比特币恢复数据的记录。&nbsp;&nbsp;&nbsp;</p>\n\n<p>&nbsp; &nbsp; &nbsp; 虽然说我们这个网站也没啥人访问，数据丢了也损失不大，但是如果平时写的博客，上传的图片不见了，也会郁闷一阵子。为了防范未然，我们还是采取一点挽救的措施，比如在服务器上面设置定时备份数据库的任务。好啦，下面进入正题！</p>\n\n<p>&nbsp;</p>\n\n<p>1）我们首先创建一个 &nbsp;bak.sh 的脚本文件，然后输入下面的（下面的命令是我给我现在博客设计的，大概意思就是进入 /bak目录下，然后使用 mysqldump 命令对 mogu_picture 和 mogu_blog表进行备份，然后完事后将数据库添加到压缩文件，同时最后就是讲八天前的数据删除，只保留七天的）</p>\n\n<pre>\n<code class=\"language-bash\">#!/bin/sh\n\nbseDir=\"/bak\";\n\ncd \"$baseDir\";\n\necho \"开始备份数据库\";\n\n#开始备份mogu_blog数据库\n\necho `mysqldump  -uroot -p\'admin\' --default-character-set=utf8  mogu_blog &gt; mogu_blog_$(date +%Y%m%d).sql`;\n\n#开始备份mogu_picture数据库\n\necho `mysqldump  -uroot -p\'w1313375\' --default-character-set=utf8  mogu_picture &gt; mogu_picture_$(date +%Y%m%d).sql`;\n\necho \"正在进行备份文件打包\"\n\necho `tar zcvf mogu_blog_$(date +%Y%m%d).tar.gz  mogu_blog_$(date +%Y%m%d).sql mogu_picture_$(date +%Y%m%d).sql `;\n\necho `rm -rf mogu_blog_$(date +%Y%m%d).sql`;\n\necho `rm -rf mogu_picture_$(date +%Y%m%d).sql`;\n\necho \"备份数据完成\";\n\noldDate=`date --date=\'8 day ago\' +%Y%m%d`;\n\n#删除当前日期-8的备份\n\necho `rm -rf mogu_blog_$oldDate*`;\n\necho \"删除$oldDate的备份成功\"</code></pre>\n\n<p>2) 下面就是使用定时任务，每天执行一次 脚本, 这是使用的是crond</p>\n\n<p>&nbsp; &nbsp; crond是linux下用来周期性的执行某种任务或等待处理某些事件的一个守护进程，与windows下的计划任务类似，当安装完成操作系统后，默认会安装此服务工具，并且会自动启动crond进程，crond进程每分钟会定期检查是否有要执行的任务，如果有要执行的任务，则自动执行该任务。</p>\n\n<p>&nbsp; &nbsp; 用户定期要执行的工作，比如用户数据备份、定时邮件提醒等。用户可以使用&nbsp;crontab&nbsp;工具来定制自己的计划任务。所有用户定义的crontab&nbsp;文件都被保存在&nbsp;/var/spool/cron目录中。其文件名与用户名一致。</p>\n\n<p><strong>crontab文件的含义：</strong></p>\n\n<p>用户所建立的crontab文件中，每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：</p>\n\n<p>minute&nbsp;&nbsp;&nbsp;hour&nbsp;&nbsp;&nbsp;day&nbsp;&nbsp;&nbsp;month&nbsp;&nbsp;&nbsp;week&nbsp;&nbsp;&nbsp;command</p>\n\n<p>其中：</p>\n\n<p>minute：&nbsp;表示分钟，可以是从0到59之间的任何整数。</p>\n\n<p>hour：表示小时，可以是从0到23之间的任何整数。</p>\n\n<p>day：表示日期，可以是从1到31之间的任何整数。</p>\n\n<p>month：表示月份，可以是从1到12之间的任何整数。</p>\n\n<p>week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。</p>\n\n<p>command：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541314306339.png\" style=\"height:450px; width:542px\" /></p>\n\n<p><strong>在以上各个字段中，还可以使用以下特殊字符：</strong></p>\n\n<p>星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。</p>\n\n<p>逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，&ldquo;1,2,5,7,8,9&rdquo;</p>\n\n<p>中杠（-）：可以用整数之间的中杠表示一个整数范围，例如&ldquo;2-6&rdquo;表示&ldquo;2,3,4,5,6&rdquo;</p>\n\n<p>正斜线（/）：可以用正斜线指定时间的间隔频率，例如&ldquo;0-23/2&rdquo;表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。</p>\n\n<pre>\n<code>1、首先先按照crond\n\nyum install crontabs\n\n2、crond启动命令\n\nsystemctl start crond\n\n3、关闭\n\nsystemctl stop crond\n\n4、开启自启\n\nsystemctl enable crond</code></pre>\n\n<p>&nbsp;</p>\n\n<p>那么介绍就到这里了，下面我们需要开始创建定时任务了！</p>\n\n<p>首先使用&nbsp; crontab -e 命令 ，会打开一个创建定时任务的vi窗口</p>\n\n<pre>\n<code>0 2 * * * /bak/mogu_blog.sh</code></pre>\n\n<p>然后我们输入上面的命令，就是每天2点，执行&nbsp; /bak文件夹下的定时备份脚本</p>\n\n<p>&nbsp;</p>\n','1d1fd6d26c8e40a38637ef6126c45cd0,0b51c75ed5744cdcadefe0ad947be9b6',2,0,'8f1b96ca6c844882858efca25923a62c',1,'2018-11-04 11:23:49','2018-11-04 11:23:49',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',4),('5358c7c8696d4f4facc5d6e1a7f9e031','如何让网页“看起来”展现地更快？骨架屏二三事','如何让网页“看起来”展现地更快？骨架屏二三事','<p>让网页展现的更快，官方说法叫做首屏绘制，First Paint 或者简称 FP，直白的说法叫做白屏时间，就是从输入 URL 到真的看到内容（不必可交互，那个叫 TTI, Time to Interactive）之间经历的时间。当然这个时间越短越好。</p>\n\n<p>&nbsp;</p>\n\n<p>但这里要注意，和首屏相关的除了 FP 还有两个指标，分别称为 FCP (First Contentful Paint，页面有效内容的绘制) 和 FMP (First Meaningful Paint，页面有意义的内容绘制)。虽然这几个概念可能会让我们绕晕，但我们只需要了解一点：<strong>首屏时间 FP 并不要求内容是真实的，有效的，有意义的，可交互的。</strong>换言之，随便&nbsp;给用户看点啥都行。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058813640.png\" style=\"height:278px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>这就是本文标题的玄机了：&ldquo;看起来&rdquo;。是的，只是看起来更快，实际上还是那样。所以本文并不讨论性能优化，讨论的是一个投机取巧的小伎俩，但的确能够实实在在的提升体验。打个比方，性能优化是修炼内功，提升你本身的各项机能；而本文接下来要讨论的是一些招式，能让你在第一时间就唬住对手。</p>\n\n<p>&nbsp;</p>\n\n<p>这所谓的招式就是我接下来要谈的内容，学名骨架屏，也叫 Skeleton。你可能没听过这个名字，但你不可能没见过它。</p>\n\n<h3>骨架屏长什么样</h3>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058854701.png\" style=\"height:662px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>这种应该是最常见的形式，使用各种形状的灰色矩形来模拟图片和文字。有些 APP 也会使用圆形，但重点都是和实际内容结构近似，不能差距太大。</p>\n\n<p>&nbsp;</p>\n\n<p>如果追求效果，还可以在色块表面添加动画（如波纹），显示出一种动态的效果，算是致敬 Loading 了。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058879692.png\" style=\"height:453px; width:659px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>在图片居多的站点，这将会是一个很好的体验，因为图片通常加载较慢。如上图演示中的占位图片采用了低像素的图片，即大体配色和变化是和实际内容一致的。</p>\n\n<p>&nbsp;</p>\n\n<p>如果无法生成这样的低像素图片，稍微降级的方案是通过算法获取图片的主体颜色，使用纯色块占位。</p>\n\n<p>&nbsp;</p>\n\n<p>再退一级，还可以使用全站相同的站位图片，或者直接一个统一颜色的色块。虽说效果肯定不如上面两种，但也聊胜于无。</p>\n\n<p>&nbsp;</p>\n\n<p>骨架屏完全是自定义的，想做成什么样全凭你的想象。你想做圆形的，三角形的，立体的都可以，但&ldquo;占位&rdquo;决定了它的特性：它不能太复杂，必须第一时间，最快展现出来。</p>\n\n<h3>骨架屏有哪些优势</h3>\n\n<p><strong>大</strong><strong>体来说，骨架屏的优势在于：</strong></p>\n\n<p>&nbsp;</p>\n\n<p>1、在页面加载初期预先渲染内容，提升感官上的体验。</p>\n\n<p>2、一般情况骨架屏和实际内容的结构是类似的，因此之后的切换不会过于突兀。这点和传统的 Loading 动图不同，可以认为是其升级版。</p>\n\n<p>3、只需要简单的 CSS 支持 (涉及图片懒加载可能还需要 JS )，不要求 HTTPS 协议，没有额外的学习和维护成本。</p>\n\n<p>4、如果页面采用组件化开发，每个组件可以根据自身状态定义自身的骨架屏及其切换时机，同时维持了组件之间的独立性。</p>\n\n<h3>骨架屏能用在哪里</h3>\n\n<p>现在的 WEB 站点，大致有两种渲染模式：</p>\n\n<h3>前端渲染</h3>\n\n<p>由于最近几年 Angular/React/Vue 的相继推出和流行，前端渲染开始占据主导。这种模式的应用也叫单页应用（SPA, Single Page Application）。</p>\n\n<p>&nbsp;</p>\n\n<p>前端渲染的模式是服务器（多为静态服务器）返回一个固定的 HTML。通常这个 HTML 包含一个空的容器节点，没有其他内容。之后内部包含的 JS 包含路由管理，页面渲染，页面切换，绑定事件等等逻辑，所以称之为前端渲染。</p>\n\n<p>&nbsp;</p>\n\n<p>因为前端要管理的事情很多，所以 JS 通常很大很复杂，执行起来也要花较多的时间。<strong>在 JS 渲染出实际内容之前，骨架屏就是一个很好的替补队员</strong>。</p>\n\n<h3>后端渲染</h3>\n\n<p>在这波前端渲染流行之前，早期的传统网站采用的模式叫做后端渲染，即服务器直接返回网站的 HTML 页面，已经包含首页的全部（或绝大部分） DOM 元素。其中包含的 JS 的作用大多是绑定事件，定义用户交互后的行为等。少量会额外添加/修改一些 DOM，但无碍大局。</p>\n\n<p>&nbsp;</p>\n\n<p>此外，前端渲染的模式存在 SEO 不友好的问题，因为它返回的 HTML 是一个空的容器。如果搜索引擎没有执行 JS 的能力（称为 Deep Render），那它就不知道你的站点究竟是什么内容，自然也就无法把站点排到搜索结果中去。这对于绝大部分站点来说是不可接受的，于是前端框架又相继推出了服务端渲染（简称 SSR, Server Side Rendering）模式。这个模式和传统网站很接近，在于返回的 HTML 也是包含所有的 DOM，而非前端渲染。而前端 JS 除了绑定事件之外，还会多做一个事情叫做&ldquo;激活&rdquo;（hydration），这里就不再赘述了。</p>\n\n<p>&nbsp;</p>\n\n<p>不论是传统模式还是 SSR，只要是后端渲染，就不需要骨架屏。<strong>因为页面的内容直接存在于 HTML，所以并没有骨架屏出场的余地。</strong></p>\n\n<h3>骨架屏怎么用</h3>\n\n<p>讨论了一波背景，我们来看如何使用。首先先无视具体的实现细节，先看思路。</p>\n\n<h3>实现思路</h3>\n\n<p>大体分为几个步骤：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>往本应为空的容器节点内部注入骨架屏的 HTML。<br />\n	骨架屏为了尽快展现，要求快速和简单，所以骨架屏多数使用静态的图片。而且把图片编译成 base64 编码格式可以节省网络请求，使得骨架屏更快展现，更加有效。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre>\n<code class=\"language-html\">&lt;html&gt;\n    &lt;head&gt;\n        &lt;style&gt;\n            .skeleton-wrapper {\n                // styles\n            }\n        &lt;/style&gt;\n        &lt;!-- 声明 meta 或者引入其他 CSS --&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"app\"&gt;\n            &lt;div class=\"skeleton-wrapper\"&gt;\n                &lt;img src=\"data:image/svg+xml;base64,XXXXXX\"&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;!-- 引用 JS --&gt;\n    &lt;/body&gt;\n&lt;/html&gt;</code></pre>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在执行 JS 开始真正内容的渲染之前，清空骨架屏 HTML<br />\n	以 Vue 为例，即在&nbsp;mount&nbsp;之前清空内容即可。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre>\n<code class=\"language-javascript\">let app = new Vue({...})\nlet container = document.querySelector(\'#app\')\nif (container) {\n    container.innerHTML = \'\'\n}\napp.$mount(container)</code></pre>\n\n<p>&nbsp;</p>\n\n<p>仅此两步，并不牵涉多么复杂的机制和高端的 API，因此非常容易应用，赶快用起来！</p>\n\n<h3>示例</h3>\n\n<p>我编写了一个示例，用于快速展现骨架屏的效果，代码在此。</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p><strong>index.html</strong><br />\n	默认包含了骨架屏，并且内联了样式（以&nbsp;&lt;style&gt;&nbsp;标签添加在头部）。</p>\n	</li>\n	<li>\n	<p><strong>render.js</strong><br />\n	它负责创建 DOM 元素并添加到&nbsp;&lt;body&gt;&nbsp;上，渲染页面实际的内容，用来模拟常见的前端渲染模式。</p>\n	</li>\n	<li>\n	<p><strong>index.css</strong><br />\n	页面实际内容的样式表，不包含骨架屏的样式。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>代码的三个文件各司其职，配合上面的实现思路，应该还是很好理解的。可以在&nbsp;这里&nbsp;查看效果。</p>\n\n<p>&nbsp;</p>\n\n<p>因为这个示例的逻辑太过简单，而实际的前端渲染框架复杂得多，包含的功能也不单纯是渲染，还有状态管理，路由管理，虚拟 DOM 等等，所以文件大小和执行时间都更大更长。<strong>我们在查看例子的时候，把网络调成 &quot;Fast 3G&quot; 或者 &quot;Slow 3G&quot; 能够稍微真实一些。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>但匪夷所思的是，对着这个地址刷新试几次，我也基本看不到骨架屏（骨架屏的内容是一个居中的蓝色方形图片，外加一条白色横线反复侧滑的高亮动画）。是我们的实现思路有问题吗？</p>\n\n<h3>浏览器的奥秘：减少重排</h3>\n\n<p>为了排除肉眼的遗漏和干扰，我们用 Chrome Dev Tools 的 Performance 工具来记录刚才发生了什么，截图如下：（截图时的网络设置为 &quot;Fast 3G&quot;）</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058991079.png\" style=\"height:519px; width:951px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>我们可以很明显地看到 3 个时间点：</strong></p>\n\n<p>&nbsp;</p>\n\n<p>1、HTML 加载完成了。浏览器在解析 HTML 的同时，发现了它需要引用的 2 个外部资源&nbsp;index.js&nbsp;和&nbsp;index.css，于是发送网络请求去获取。</p>\n\n<p>2、获取成功后，执行 JS 并注册 CSS 的规则。</p>\n\n<p>3、JS 一执行，很自然的渲染出了实际的内容，并应用了样式规则（随机颜色的横条）。</p>\n\n<p>&nbsp;</p>\n\n<p>我们的骨架屏呢？按照预想，骨架屏应该出现在 1 和 2 之间，也就是在获取 JS 和 CSS 的同时，就应该渲染骨架屏了。这也是我们当时把骨架屏的 HTML 注入到&nbsp;index.html， 还把 CSS 从&nbsp;index.css&nbsp;中分离出来的良苦用心，然而浏览器并不买账。</p>\n\n<p>&nbsp;</p>\n\n<p>这其实和浏览器的渲染顺序有关。</p>\n\n<p>&nbsp;</p>\n\n<p>相信大家都整理过行李箱。我们在整理行李箱时，会根据每个行李的大小合理安排，大的和小的配合，填满一层再放上面一层。现在突然有人跑来跟你说，你的电脑不用带了，你要多带两件衣服，你不能带那么多瓶矿泉水。除了想打他之外，为了重新整理行李箱，必然需要把整理好的行李拿出来再重新放。在浏览器中这个过程叫做重排 (reflow)，而那个馊主意就是新加载的 CSS。显而易见，重排的开销是很大的。</p>\n\n<p>&nbsp;</p>\n\n<p>熟能生巧，箱子理多了，就能想出解决办法。既然每个 CSS 文件加载都可能触发重绘，那我能不能等所有 CSS 加载完了一起渲染呢？正是基于这一点，浏览器会等 HTML 中所有的 CSS 都加载完，注册完，一起应用样式，力求一次排列完成工作，不要反复重排。看起来浏览器的设计者经常出差，因为这是一个很正确的优化思路，但应用在骨架屏上就出了问题。</p>\n\n<p>&nbsp;</p>\n\n<p>我们为了尽早展现骨架屏，把骨架屏的样式从&nbsp;index.css&nbsp;分离出来。但浏览器不知道，它以为骨架屏的 HTML 还依赖&nbsp;index.css，所以必须等它加载完。而它加载完之后，render.js&nbsp;也差不多加载完开始执行了，于是骨架屏的 HTML 又被替换了，自然就看不到了。而且在等待 JS, CSS 加载的时候依然是个白屏，骨架屏的效果大打折扣。</p>\n\n<p>&nbsp;</p>\n\n<p>所以我们要做的是告诉浏览器，你放心大胆的先画骨架屏，它和后面的&nbsp;index.css&nbsp;是无关的。那怎么告诉它呢？</p>\n\n<h3>告诉浏览器先渲染骨架屏</h3>\n\n<p>我们在引用 CSS 时，会使用&nbsp;&lt;link rel=&quot;stylesheet&quot; href=&quot;xxxx&gt;&nbsp;这样的语法。但实际上，浏览器还提供了其他一些机制确保（后续）页面的性能，我们称之为 preload，中文叫预加载。具体来说，使用&nbsp;&lt;link rel=&quot;preload&quot; href=&quot;xxxx&quot;&gt;，提前把后续要使用的资源先声明一下。在浏览器空闲的时候会提前加载并放入缓存。之后再使用就可以节省一个网络请求。</p>\n\n<p>&nbsp;</p>\n\n<p>这看似无关的技术，在这里将起到很大的作用，因为&nbsp;预加载的资源是不会影响当前页面的。</p>\n\n<p>&nbsp;</p>\n\n<p>我们可以通过这种方式，告诉浏览器：先不要管&nbsp;index.css，直接画骨架屏。之后&nbsp;index.css加载回来之后，再应用这个样式。具体来说代码如下：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;link rel=\"preload\" href=\"index.css\" as=\"style\" onload=\"this.rel=\'stylesheet\'\"&gt;\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>方法的核心是通过改变&nbsp;rel&nbsp;可以让浏览器重新界定&nbsp;&lt;link&gt;&nbsp;标签的角色，从预加载变成当页样式。（另外也有文章采用修改&nbsp;media&nbsp;的方法，但浏览器支持度较低，这里不作展开了。我把文章列在最后了）这样的话，浏览器在 CSS 尚未获取完成时，会先渲染骨架屏（因为此时的 CSS 还是&nbsp;preload，也就是后续使用的，并不妨碍当前页面）。而当 CSS 加载完成并修改了自己的&nbsp;rel之后，浏览器重新应用样式，目的达成。</p>\n\n<h3>不得不考虑的注意点</h3>\n\n<p>事实上，并不是把&nbsp;rel=&quot;stylesheet&quot;&nbsp;改成&nbsp;rel=&quot;preload&quot;&nbsp;就完事儿了。在真正应用到生产环境之前，我们还有很多事情要考虑。</p>\n\n<h3>兼容性考虑</h3>\n\n<p>首先，在&nbsp;&lt;link&gt;&nbsp;内部我们使用了&nbsp;onload，也就是使用了 JS。为了应对用户的浏览器没有开启脚本功能的情况，我们需要添加一个 fallback。（不过这点对于单页应用来说可能也无所谓，因为如果没有脚本，那页面实际内容也渲染不出来的）</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;noscript&gt;&lt;link rel=\"stylesheet\" href=\"index.css\"&gt;&lt;/noscript&gt;</code></pre>\n\n<p>&nbsp;</p>\n\n<p>其次，rel=&quot;preload&quot;&nbsp;并不是没有兼容性问题。对于不支持 preload 的浏览器，我们可以添加一些&nbsp;polyfill 代码（来使所有浏览器获得一致的效果。</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;script&gt;\n/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */\n(function(){ ... }());\n&lt;/script&gt;</code></pre>\n\n<p>&nbsp;</p>\n\n<p>polyfill 的压缩代码可以参见 Lavas 的 SPA 模板第 29 行。</p>\n\n<h3>加载顺序</h3>\n\n<p>不同于传统页面，我们的实际 DOM 是通过&nbsp;render.js&nbsp;生成的。所以如果 JS 先于 CSS 执行，那将会发生跳动。（因为先渲染了实际内容却没有样式，而后样式加载，页面出现很明显的变化）所以这里我们需要严格控制 CSS 早于渲染。</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;link rel=\"preload\" href=\"index.css\" as=\"style\" onload=\"this.rel=\'stylesheet\';window.STYLE_READY=true;window.mountApp &amp;&amp; window.mountApp()\"&gt;\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>JS 对外暴露一个&nbsp;mountApp&nbsp;方法用于渲染页面（其实是模拟 Vue 的&nbsp;mount）</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>// render.js\n\nfunction mountApp() {\n    // 方法内部就是把实际内容添加到 &lt;body&gt; 上面\n}\n\n// 本来直接调用方法完成渲染\n// mountApp()\n\n// 改成挂到 window 由 CSS 来调用\nwindow.mountApp = mountApp()\n// 如果 JS 晚于 CSS 加载完成，那直接执行渲染。\nif (window.STYLE_READY) {\n    mountApp()\n}</code></pre>\n\n<p>&nbsp;</p>\n\n<p>如果 CSS 更快加载完成，那么通过设置&nbsp;window.STYLE_READY&nbsp;允许 JS 加载完成后直接执行；而如果 JS 更快，则先不自己执行，而是把机会留给 CSS 的&nbsp;onload。</p>\n\n<h3>清空 onload</h3>\n\n<p>loadCSS&nbsp;的开发者提出，某些浏览器会在&nbsp;rel&nbsp;改变时重新出发&nbsp;onload，导致后面的逻辑走了两次。为了消除这个影响，我们再在&nbsp;onload&nbsp;里面添加一句&nbsp;this.onload=null。</p>\n\n<h3>最终的 CSS 引用方式</h3>\n\n<pre>\n<code>&lt;link rel=\"preload\" href=\"index.css\" as=\"style\" onload=\"this.onload=null;this.rel=\'stylesheet\';window.STYLE_READY=true;window.mountApp &amp;&amp; window.mountApp()\"&gt;\n\n&lt;!-- 为了方便阅读，折行重复一遍 --&gt;\n&lt;!-- this.onload=null --&gt;\n&lt;!-- this.rel=\'stylesheet\' --&gt;\n&lt;!-- window.STYLE_READY=true --&gt;\n&lt;!-- window.mountApp &amp;&amp; window.mountApp() --&gt;</code></pre>\n\n<h3>修改后的效果</h3>\n\n<p>修改后的代码在&nbsp;这里，访问地址在&nbsp;这里。（为了简便，我省去了处理兼容性的代码，即&nbsp;&lt;noscript&gt;&nbsp;和 preload polyfill）</p>\n\n<p>&nbsp;</p>\n\n<p>Performance 截图如下：（依然采用了 &quot;Fast 3G&quot; 的网络设置）</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543059015113.png\" style=\"height:517px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>这次在&nbsp;render.js&nbsp;和&nbsp;index.css&nbsp;还在加载的时候页面已经呈现出骨架屏的内容，实际肉眼也可以观测到。在截图的情况下，骨架屏的展现大约持续了 300ms，占据整个网络请求的大约一半时间。</p>\n\n<p>&nbsp;</p>\n\n<p>至于说为什么不是 HTML 加载完成立马展现骨架屏，而是还要等大约 300ms 才展现，从图上看是浏览器 ParseHTML 所花费的时间，可能在 Dev Tools 打开的情况下计算资源有限，不过可优化空间已经不大。（可能简化骨架屏的结构能起一些作用吧）</p>\n\n<h3>多骨架屏的支持</h3>\n\n<p>一般来说一个站点的所有页面不太可能是同一种展示类型。例如说首页和内部页面就展示风格而言会很有区别，另外例如列表页和搜索页比较接近（可能都有列表展示），但和详情页（可能是商品，服务，个人信息，博客文章等等）就会很不相同。但单页应用的&nbsp;index.html&nbsp;只有一个，所有的变化都源自前端渲染框架在容器节点内部进行改变。所以直接将骨架屏注入到&nbsp;index.html中会导致所有的页面都用同一个骨架屏，那就很难达成&ldquo;和实际内容结构类似&rdquo;的目标了，骨架屏就退化为 Loading 了。</p>\n\n<p>&nbsp;</p>\n\n<p>为了要支持多种骨架屏，我们需要在&nbsp;index.html&nbsp;里面进行判断逻辑（独立于主体 JS 之外），具体来说：</p>\n\n<p>&nbsp;</p>\n\n<p>1、把所有种类的骨架屏的 HTML 和样式全部写入&nbsp;index.html</p>\n\n<p>2、在&nbsp;index.html&nbsp;底下新增内联的脚本&nbsp;&lt;script&gt;，根据当前路由判断应该展示哪一个骨架屏</p>\n\n<p>&nbsp;</p>\n\n<p>这样会导致&nbsp;index.html&nbsp;体积变大一点，但整体感觉依然是收益大于付出，我认为是值得的。</p>\n\n<h3>后记</h3>\n\n<p>这个优化点最早由我的前同事&nbsp;xiaop 同学&nbsp;在开发 Lavas 的 SPA 模板中发现并完成的，Issue 记录在此。我在他的基础上，做了一个分离 Lavas 和 Vue 环境并且更直白的例子，让截图也尽可能易于理解，方便阅读。在此非常感谢他的工作！</p>\n\n<p>&nbsp;</p>\n\n<p>另外骨架屏的编写我全部采用的是纯粹的手写 HTML 和 CSS，不止展现逻辑，包括开发流程也是独立于单页应用其他常规页面的。当然这可能给开发者带来一点不便，所以这时候需要推出 xiaop 同学的利器：vue-skeleton-webpack-plugin&nbsp;https://github.com/lavas-project/vue-skeleton-webpack-plugin。它的作用是把骨架屏本身也当成一个 Vue 组件，配上单独的路由规则来统一在 Vue 项目中的开发体验，最后使用 webpack 在打包构建的时候加以区分并注入，对于使用 Vue + webpack 开发的同学来说可以一试。</p>\n\n<h3>参考文章</h3>\n\n<ul>\n	<li>\n	<p><strong>让骨架屏更快渲染</strong>&nbsp;https://zhuanlan.zhihu.com/p/34550387- xiaop 同学原作</p>\n	</li>\n	<li>\n	<p><strong>Loading CSS without blocking render</strong>&nbsp;https://keithclark.co.uk/articles/loading-css-without-blocking-render/- 使用修改&nbsp;media&nbsp;的方式达成目的。</p>\n	</li>\n	<li>\n	<p><strong>filamentgroup/loadCSS&nbsp;</strong>https://github.com/filamentgroup/loadCSS&nbsp;- 同样使用修改&nbsp;rel&nbsp;的方式，并提供了 preload polyfill</p>\n	</li>\n</ul>\n','ca928e8718654aa5a802e2f69277b137',0,0,'44704768e62f48bb9a04ae1cac453dd8',1,'2018-11-24 19:31:55','2018-11-24 19:31:55',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',4),('567c7e0fc0e44b608521eae8ba8d5b15','JavaScript深拷贝与浅拷贝的区别，实现深拷贝的几种方法','深拷贝与浅拷贝的区别，实现深拷贝的几种方法','<p>原文链接：https://www.cnblogs.com/echolun/p/7889848.html</p>\n\n<p>&nbsp;</p>\n\n<p>今天遇到一个问题就是我在初始化一个二维数组的时候</p>\n\n<pre>\n<code class=\"language-javascript\">var arr = new Array(10).fill(new Array(5).fill(0));\nconsole.log(arr);\narr[1][1] = 6;\nconsole.log(arr[1][1]);</code></pre>\n\n<p>我使用的是fill填充一个一位数组，将它变成 10*5的二维数组，然后我尝试修改某个值的时候，发现第二列全部变成了6，如下图所示</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544061748311.png\" style=\"height:321px; width:850px\" /></p>\n\n<p>&nbsp;经过思考，我觉得可能是因为JavaScript中的深拷贝 和 浅拷贝所引起的。</p>\n\n<p>&nbsp;既 fill 方法只是对数组进行了浅拷贝，复制了一下堆中的数组地址。</p>\n\n<p>&nbsp;那么如何区分深拷贝和浅拷贝呢？下面有个小诀窍</p>\n\n<p>&nbsp;简单点来说，就是假设B复制了A，当修改A时，看B是否会发生变化，如果B也跟着变了，说明这是浅拷贝，拿人手短，如果B没变，那就是深拷贝，自食其力。</p>\n\n<p>那么这里，就得引入基本数据类型与引用数据类型的概念了。</p>\n\n<p>面试常问，基本数据类型有哪些，number,string,boolean,null,undefined五类。</p>\n\n<p>引用数据类型(Object类)有常规名值对的无序对象{a:1}，数组[1,2,3]，以及函数等。</p>\n\n<p>而这两类数据存储分别是这样的：</p>\n\n<p><strong>a.基本类型--名值存储在栈内存中</strong>，例如let a=1;</p>\n\n<p><img alt=\"\" src=\"https://images2018.cnblogs.com/blog/1213309/201711/1213309-20171124130901890-511917244.jpg\" /><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544061942948.png\" style=\"height:174px; width:349px\" /></p>\n\n<p>当你b=a复制时，栈内存会新开辟一个内存，例如这样：</p>\n\n<p>&nbsp;<img alt=\"\" src=\"https://images2018.cnblogs.com/blog/1213309/201711/1213309-20171124131822437-430949998.jpg\" /><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544061962757.png\" style=\"height:260px; width:350px\" /></p>\n\n<p>所以当你此时修改a=2，对b并不会造成影响，因为此时的b已自食其力，翅膀硬了，不受a的影响了。当然，let a=1,b=a;虽然b不受a影响，但这也算不上深拷贝，因为深拷贝本身只针对较为复杂的object类型数据。</p>\n\n<p>b.引用数据类型--名存在栈内存中，值存在于堆内存中，但是栈内存会提供一个引用的地址指向堆内存中的值，我们以上面浅拷贝的例子画个图：</p>\n\n<p><img alt=\"\" src=\"https://images2018.cnblogs.com/blog/1213309/201711/1213309-20171124133428359-1292133331.jpg\" /><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544061980537.png\" style=\"height:150px; width:500px\" /></p>\n\n<p>当b=a进行拷贝时，其实复制的是a的引用地址，而并非堆里面的值。</p>\n\n<p><img alt=\"\" src=\"https://images2018.cnblogs.com/blog/1213309/201711/1213309-20171124133647796-1390255671.jpg\" /><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544062010110.png\" style=\"height:151px; width:500px\" /></p>\n\n<p>而当我们<strong>a[0]=1</strong>时进行数组修改时，由于a与b指向的是同一个地址，所以自然b也受了影响，这就是所谓的浅拷贝了。</p>\n\n<p>&nbsp;<img alt=\"\" src=\"https://images2018.cnblogs.com/blog/1213309/201711/1213309-20171124133934328-67216865.jpg\" /><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544062030361.png\" style=\"height:148px; width:500px\" /></p>\n\n<p>那，要是在堆内存中也开辟一个新的内存专门为b存放值，就像基本类型那样，岂不就达到深拷贝的效果了</p>\n\n<p><img alt=\"\" src=\"https://images2018.cnblogs.com/blog/1213309/201711/1213309-20171124140906203-2099568933.jpg\" /><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544062047847.png\" style=\"height:147px; width:500px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>解决思路：</p>\n\n<p><strong>1）封装一个深拷贝函数</strong></p>\n\n<pre>\n<code class=\"language-javascript\">function deepClone(obj){\n    let objClone = Array.isArray(obj)?[]:{};\n    if(obj &amp;&amp; typeof obj===\"object\"){\n        for(key in obj){\n            if(obj.hasOwnProperty(key)){\n                //判断ojb子元素是否为对象，如果是，递归复制\n                if(obj[key]&amp;&amp;typeof obj[key] ===\"object\"){\n                    objClone[key] = deepClone(obj[key]);\n                }else{\n                    //如果不是，简单复制\n                    objClone[key] = obj[key];\n                }\n            }\n        }\n    }\n    return objClone;\n}    \nlet a=[1,2,3,4],\n    b=deepClone(a);\na[0]=2;\nconsole.log(a,b);</code></pre>\n\n<p>可以看到，现在已经改变了值</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544085269477.png\" style=\"height:134px; width:336px\" /></p>\n\n<pre>\n跟之前想象的一样，现在b脱离了a的控制，不再受a影响了。\n这里再次强调，深拷贝，是拷贝对象各个层级的属性，可以看个例子。JQ里有一个extend方法也可以拷贝对象，我们来看看</pre>\n\n<pre>\n<code class=\"language-javascript\">let a=[1,2,3,4],\n    b=a.slice();\na[0]=2;\nconsole.log(a,b);</code></pre>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544085324640.png\" style=\"height:136px; width:329px\" /></p>\n\n<p>那是不是说slice方法也是深拷贝了，毕竟b也没受a的影响，上面说了，深拷贝是会拷贝所有层级的属性，还是这个例子，我们把a改改</p>\n\n<pre>\n<code class=\"language-javascript\">let a=[0,1,[2,3],4],\nb=a.slice();\na[0]=1;\na[2][0]=1;\nconsole.log(a,b);</code></pre>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544085349654.png\" style=\"height:145px; width:406px\" /></p>\n\n<p>拷贝的不彻底啊，b对象的一级属性确实不受影响了，但是二级属性还是没能拷贝成功，仍然脱离不了a的控制，说明slice根本不是真正的深拷贝。</p>\n\n<p>这里引用知乎问答里面的一张图</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544085376992.png\" style=\"height:241px; width:644px\" /></p>\n\n<p>第一层的属性确实深拷贝，拥有了独立的内存，但更深的属性却仍然公用了地址，所以才会造成上面的问题。</p>\n\n<p>同理，concat方法与slice也存在这样的情况，他们都不是真正的深拷贝，这里需要注意。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>2）使用JSON对象的parse 和 stringify</strong></p>\n\n<pre>\n<code class=\"language-javascript\">function deepClone(obj){\n let _obj = JSON.stringify(obj),\n objClone = JSON.parse(_obj);\n return objClone\n}    \nlet a=[0,1,[2,3],4],\nb=deepClone(a);\na[0]=1;\na[2][0]=1;\nconsole.log(a,b);</code></pre>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544085512349.png\" style=\"height:135px; width:392px\" /></p>\n\n<p>可以看到，这下b是完全不受a的影响了。</p>\n\n<p><strong>3）使用JQ的extend方法</strong></p>\n\n<p><strong><em>$</em>.extend( [deep ], target, object1 [, objectN ] )</strong></p>\n\n<p><strong>deep</strong>表示是否深拷贝，为true为深拷贝，为false，则为浅拷贝</p>\n\n<p><strong>target</strong><strong>&nbsp;Object</strong>类型 目标对象，其他对象的成员属性将被附加到该对象上。</p>\n\n<p><strong>object1&nbsp;&nbsp;objectN</strong>可选。 Object类型 第一个以及第N个被合并的对象。&nbsp;</p>\n\n<pre>\n<code class=\"language-javascript\">let a=[0,1,[2,3],4],\nb=$.extend(true,[],a);\na[0]=1;\na[2][0]=1;\nconsole.log(a,b);</code></pre>\n\n<p>可以看到，效果与上面方法一样，只是需要依赖JQ库。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544085596933.png\" style=\"height:128px; width:383px\" /></p>\n\n<p>说了这么多，了解深拷贝也不仅仅是为了应付面试题，在实际开发中也是非常有用的。例如后台返回了一堆数据，你需要对这堆数据做操作，但多人开发情况下，你是没办法明确这堆数据是否有其它功能也需要使用，直接修改可能会造成隐性问题，深拷贝能帮你更安全安心的去操作数据，根据实际情况来使用深拷贝，大概就是这个意思。</p>\n','e2c7913050cf4ab9aa92902316aaf075',1,0,'de7d864ef19c4f56b8e7d7ecb59c2145',1,'2018-12-06 10:07:53','2018-12-06 10:07:53',NULL,'0','陌溪_','博客园','2c93dfab0e754006866f8ed486923a41',0),('6c5d0f1850ee4204b3669d9cd4a3b080','微服务注册中心如何承载大型系统的千万级访问？','Spring Cloud架构体系中，Eureka是一个至关重要的组件，它扮演着微服务注册中心的角色，所有的服务注册与服务发现，都是依赖Eureka的。','<p><strong>一、问题起源</strong></p>\n\n<p>Spring Cloud架构体系中，Eureka是一个至关重要的组件，它扮演着微服务注册中心的角色，所有的服务注册与服务发现，都是依赖Eureka的。</p>\n\n<p><br />\n不少初学Spring Cloud的朋友在落地公司生产环境部署时，经常会问：</p>\n\n<ul>\n	<li>\n	<p>Eureka Server到底要部署几台机器？</p>\n	</li>\n	<li>\n	<p>我们的系统那么多服务，到底会对Eureka Server产生多大的访问压力？</p>\n	</li>\n	<li>\n	<p>Eureka Server能不能抗住一个大型系统的访问压力？</p>\n	</li>\n</ul>\n\n<p><br />\n如果你也有这些疑问，别着急！咱们这就一起去看看，Eureka作为微服务注册中心的核心原理</p>\n\n<p>&nbsp;</p>\n\n<p>下面这些问题，大家先看看，有个大概印象。带着这些问题，来看后面的内容，效果更佳</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>Eureka注册中心使用什么样的方式来储存各个服务注册时发送过来的机器地址和端口号？</p>\n	</li>\n	<li>\n	<p>各个服务找Eureka Server拉取注册表的时候，是什么样的频率？</p>\n	</li>\n	<li>\n	<p>各个服务是如何拉取注册表的？</p>\n	</li>\n	<li>\n	<p>一个几百服务，部署上千台机器的大型分布式系统，会对Eureka Server造成多大的访问压力？</p>\n	</li>\n	<li>\n	<p>Eureka Server从技术层面是如何抗住日千万级访问量的？</p>\n	</li>\n</ol>\n\n<p>先给大家说一个基本的知识点，各个服务内的Eureka Client组件，默认情况下，每隔30秒会发送一个请求到Eureka Server，来拉取最近有变化的服务信息</p>\n\n<p>&nbsp;</p>\n\n<p><strong>举个例子</strong>：</p>\n\n<ul>\n	<li>\n	<p>库存服务原本部署在1台机器上，现在扩容了，部署到了3台机器，并且均注册到了Eureka Server上。</p>\n	</li>\n	<li>\n	<p>然后订单服务的Eureka Client会每隔30秒去找Eureka Server拉取最近注册表的变化，看看其他服务的地址有没有变化。</p>\n	</li>\n</ul>\n\n<p>除此之外，Eureka还有一个心跳机制，各个Eureka Client每隔30秒会发送一次心跳到Eureka Server，通知人家说，哥们，我这个服务实例还活着！</p>\n\n<p>如果某个Eureka Client很长时间没有发送心跳给Eureka Server，那么就说明这个服务实例已经挂了。</p>\n\n<p>光看上面的文字，大家可能没什么印象。老规矩！咱们还是来一张图，一起来直观的感受一下这个过程。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462396419.png\" style=\"height:359px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、Eureka Server设计精妙的注册表存储结构</strong></p>\n\n<p>现在咱们假设手头有一套大型的分布式系统，一共100个服务，每个服务部署在20台机器上，机器是4核8G的标准配置。</p>\n\n<p>也就是说，相当于你一共部署了100 * 20 = 2000个服务实例，有2000台机器。</p>\n\n<p>每台机器上的服务实例内部都有一个Eureka Client组件，它会每隔30秒请求一次Eureka Server，拉取变化的注册表。</p>\n\n<p>此外，每个服务实例上的Eureka Client都会每隔30秒发送一次心跳请求给Eureka Server。</p>\n\n<p>&nbsp;</p>\n\n<p>那么大家算算，Eureka Server作为一个微服务注册中心，<strong>每秒钟要被请求多少次？一天要被请求多少次？</strong></p>\n\n<ul>\n	<li>\n	<p>按标准的算法，每个服务实例每分钟请求2次拉取注册表，每分钟请求2次发送心跳</p>\n	</li>\n	<li>\n	<p>这样一个服务实例每分钟会请求4次，2000个服务实例每分钟请求8000次</p>\n	</li>\n	<li>\n	<p>换算到每秒，则是8000 / 60 = 133次左右，我们就大概估算为Eureka Server每秒会被请求150次</p>\n	</li>\n	<li>\n	<p>那一天的话，就是8000 * 60 * 24 = 1152万，也就是<strong>每天千万级访问量</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>好！经过这么一个测算，大家是否发现这里的奥秘了？</strong></p>\n\n<ul>\n	<li>\n	<p>首先，对于微服务注册中心这种组件，在一开始设计它的拉取频率以及心跳发送频率时，就已经考虑到了一个大型系统的各个服务请求时的压力，每秒会承载多大的请求量。</p>\n	</li>\n	<li>\n	<p>所以各服务实例<strong>每隔30秒</strong>发起请求拉取变化的注册表，以及<strong>每隔30秒</strong>发送心跳给Eureka Server，其实这个时间安排是有其用意的。</p>\n	</li>\n</ul>\n\n<p>按照我们的测算，一个上百个服务，几千台机器的系统，按照这样的频率请求Eureka Server，日请求量在千万级，每秒的访问量在150次左右。</p>\n\n<p>即使算上其他一些额外操作，我们姑且就算每秒钟请求Eureka Server在200次~300次吧。</p>\n\n<p>所以通过设置一个适当的拉取注册表以及发送心跳的频率，可以保证大规模系统里对Eureka Server的请求压力不会太大。</p>\n\n<p><strong>关键问题来了</strong><strong>，Eureka Server是如何保证轻松抗住这每秒数百次请求，每天千万级请求的呢？</strong></p>\n\n<p>要搞清楚这个，首先得清楚Eureka&nbsp;Server到底是用什么来存储注册表的？三个字，<strong>看源码</strong></p>\n\n<p>&nbsp;</p>\n\n<p><strong>接下来咱们就一起进入Eureka源码里一探究竟：</strong></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462475383.png\" style=\"height:160px; width:800px\" /></p>\n\n<ul>\n	<li>\n	<p>如上图所示，图中的这个名字叫做<strong>registry</strong>的<strong>CocurrentHashMap</strong>，就是注册表的核心结构。看完之后忍不住先赞叹一下，精妙的设计！</p>\n	</li>\n	<li>\n	<p>从代码中可以看到，Eureka&nbsp;Server的注册表直接基于<strong>纯内存</strong>，即在内存里维护了一个数据结构。</p>\n	</li>\n	<li>\n	<p>各个服务的注册、服务下线、服务故障，全部会在内存里维护和更新这个注册表。</p>\n	</li>\n	<li>\n	<p>各个服务每隔30秒拉取注册表的时候，Eureka&nbsp;Server就是直接提供内存里存储的有变化的注册表数据给他们就可以了。</p>\n	</li>\n	<li>\n	<p>同样，每隔30秒发起心跳时，也是在这个纯内存的Map数据结构里更新心跳时间。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>一句话概括</strong>：维护注册表、拉取注册表、更新心跳时间，全部发生在内存里！这是Eureka Server非常核心的一个点。</p>\n\n<p>搞清楚了这个，咱们再来分析一下registry这个东西的数据结构，大家千万别被它复杂的外表唬住了，沉下心来，一层层的分析！</p>\n\n<ul>\n	<li>\n	<p>首先，这个ConcurrentHashMap的key就是服务名称，比如&ldquo;inventory-service&rdquo;，就是一个服务名称。</p>\n	</li>\n	<li>\n	<p>value则代表了一个服务的多个服务实例。</p>\n	</li>\n	<li>\n	<p>举例：比如&ldquo;inventory-service&rdquo;是可以有3个服务实例的，每个服务实例部署在一台机器上。</p>\n	</li>\n</ul>\n\n<p>再来看看作为value的这个Map：</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Map&lt;String, Lease&lt;InstanceInfo</strong><strong>&gt;</strong>&gt;</p>\n\n<ul>\n	<li>\n	<p>这个Map的key就是<strong>服务实例的id</strong></p>\n	</li>\n	<li>\n	<p>value是一个叫做<strong>Lease</strong>的类，它的泛型是一个叫做<strong>InstanceInfo</strong>的东东，你可能会问，这俩又是什么鬼？</p>\n	</li>\n	<li>\n	<p>首先说下InstanceInfo，其实啊，我们见名知义，这个InstanceInfo就代表了<strong>服务实例的具体信息</strong>，比如机器的ip地址、hostname以及端口号。</p>\n	</li>\n	<li>\n	<p>而这个Lease，里面则会维护每个服务<strong>最近一次发送心跳的时间</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>三、Eureka Server端优秀的多级缓存机制</strong></p>\n\n<p>假设Eureka Server部署在4核8G的普通机器上，那么<strong>基于内存来承载各个服务的请求，每秒钟最多可以处理多少请求呢？</strong></p>\n\n<ul>\n	<li>\n	<p>根据之前的测试，单台4核8G的机器，处理纯内存操作，哪怕加上一些网络的开销，每秒处理几百请求也是轻松加愉快的。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>而且Eureka Server为了避免同时读写内存数据结构造成的并发冲突问题，还采用了<strong>多级缓存机制</strong>来进一步提升服务请求的响应速度。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在拉取注册表的时候：首先从<strong>ReadOnlyCacheMap</strong>里查缓存的注册表。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>若没有，就找<strong>ReadWriteCacheMap</strong>里缓存的注册表。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>如果还没有，就从<strong>内存中获取实际的注册表数据。</strong></li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在注册表发生变更的时候：会在内存中更新变更的注册表数据，同时<strong>过期掉ReadWriteCacheMap</strong>。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>此过程不会影响ReadOnlyCacheMap提供人家查询注册表。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>一段时间内（默认30秒），各服务拉取注册表会直接读ReadOnlyCacheMap</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>30秒过后，Eureka Server的后台线程发现ReadWriteCacheMap已经清空了，也会清空ReadOnlyCacheMap中的缓存</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>下次有服务拉取注册表，又会从内存中获取最新的数据了，同时填充各个缓存。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>多级缓存机制的优点是什么？</strong></p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>尽可能保证了内存注册表数据不会出现频繁的读写冲突问题。</p>\n	</li>\n	<li>\n	<p>并且进一步保证对Eureka Server的大量请求，都是快速从纯内存走，性能极高。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>为方便大家更好的理解，同样来一张图，大家跟着图再来回顾一下这整个过程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462665485.png\" style=\"height:396px; width:800px\" /></p>\n\n<p><strong>四、总结</strong></p>\n\n<ul>\n	<li>\n	<p>通过上面的分析可以看到，Eureka通过设置适当的请求频率<strong>（拉取注册表30秒间隔，发送心跳30秒间隔）</strong>，可以保证一个大规模的系统每秒请求Eureka Server的次数在几百次。</p>\n	</li>\n	<li>\n	<p>同时通过纯内存的注册表，保证了所有的请求都可以在内存处理，确保了极高的性能</p>\n	</li>\n	<li>\n	<p>另外,多级缓存机制，确保了不会针对内存数据结构发生频繁的读写并发冲突操作，进一步提升性能。</p>\n	</li>\n</ul>\n\n<p>上述就是Spring Cloud架构中，Eureka作为微服务注册中心可以承载大规模系统每天千万级访问量的原理。</p>\n','e81bc2dca42c4031be7d66fef4a71e16',0,0,'e94e738ed04f4471b673de155e393a0b',1,'2018-11-17 21:51:55','2018-11-17 21:51:55',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',4),('6f0fc50433cf4a9194e01df4dcb56fb7','今日头条是怎么做推荐的——基于用户的协同过滤','今日头条是怎么做推荐的——基于用户的协同过滤','<p><em>目前我正在写一系列&quot;电商的推荐系统&quot;相关的文章。主要包括基于物品相似度的推荐、基于用户相似度的推荐、基于内容的推荐、推荐系统冷启动的问题、推荐系统的时效性问题、给用户重复推荐已购买的物品的问题等等内容。对这一方面内容感兴趣的请关注我。</em></p>\n\n<p><strong>一、基于用户的协同过滤</strong></p>\n\n<p>我们经常会找身边的朋友给我们推荐电影、电视剧，我们会发现一个规律，跟我们兴趣类似的人，推荐的往往比较符合我们口味。其实这就是基于用户的协同过滤。</p>\n\n<p><img src=\"//upload-images.jianshu.io/upload_images/268138-4f0353510a431910.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp\" style=\"height:298px; width:800px\" /></p>\n\n<p>上一篇文章《亚马逊和淘宝的&quot;猜你喜欢&quot;是怎么实现的？》[1]中谈到了，基于领域的协同过滤算法主要有两种，一种是基于物品的，一种是基于用户的。所谓基于物品，就是用户喜欢了X商品，我们给他推荐与X商品相似的商品。所谓基于用户，就是用户A和用户B相似，用户A买了X、Y，用户B买了X、Y、Z，我们就给用户A推荐商品Z。</p>\n\n<p><img src=\"//upload-images.jianshu.io/upload_images/268138-29858ea4fa18e24f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp\" style=\"height:392px; width:800px\" /></p>\n\n<p>基于物品的协同过滤的一个优点是容易解释推荐原因，第二个是电商网站中物品的相似度是相对不变的，物品相似度的矩阵维护起来相对容易。</p>\n\n<p><img src=\"//upload-images.jianshu.io/upload_images/268138-c032e5fa35c2488b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp\" style=\"height:161px; width:800px\" /></p>\n\n<p>使用基于物品的协同过滤，需要维护一个物品相似度矩阵；使用基于用户的协同过滤，需要维护一个用户相似度矩阵。可以设想，如果物品之间的相似度经常变化，那么物品相似度的矩阵则需要经常更新。如果物品经常增加，那么物品相似度的矩阵也会增长的非常快。新闻网站就同时具有这两个特点，所以基于物品的协同过滤并不适用于新闻的推荐。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、谁在用基于用户的协同过滤</strong></p>\n\n<p>物品增长很快，同时物品之间相似度频繁变化的网站，并不适用基于物品的协同过滤，所以他们可以选择基于用户的协同过滤。目前业界使用基于用户的协同过滤作为推荐系统核心算法的并不多，今日头条是其中一个。个人认为，像简书、知乎这种，内容频繁增加，但是用户相似对相对固定的网站，也适合使用基于用户给的协同过滤。</p>\n\n<p>今日头条核心算法负责人杨震原说：</p>\n\n<blockquote>\n<p>一开始今日头条的推荐算法，首先入手的是&quot;非个性化推荐&quot;&mdash;&mdash;解决的<strong>热门文章推荐</strong>，以及新文章冷启动的问题。&hellip;&hellip;之后，今日头条开始逐步引入个性化推荐的策略。他们所采用的，是<strong>协同过滤</strong>+<strong>基于内容推荐</strong>，直到今天依然构成今日头条推荐算法的基础[2]。</p>\n</blockquote>\n\n<p>他提到的算法有三种：1）热门推荐，2）协同过滤，3）基于内容推荐。</p>\n\n<p>热门推荐就是优先推荐热门的文章。协同过滤就是通过物品、用户的相似度来推荐。基于内容的推荐，就是判断两篇文章是否相似，比如用算法判断两篇文章都是关于健身、饮食的，进而可以给喜欢这些内容的用户推荐这两篇文章。</p>\n\n<p>本文会主要介绍基于内容的推荐。接下来的文章会介绍基于内容的推荐。关于热门推荐，大家可以参考《产品经理需要了解的算法&mdash;&mdash;热度算法和个性化推荐》[3]，后面的文章可能也会介绍这一算法。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>三、基于用户的协同过滤的算法</strong></p>\n\n<p>两用户之间的相似度的计算其实很简单，用户i与用户j的相似度 = （i、j都打开过的网页数）/根号（i或j打开过的网页总数）。这个计算与&ldquo;基于物品的协同过滤&rdquo;中的物品之间相似度的计算是类似的，大家可以参考《亚马逊和淘宝的&quot;猜你喜欢&quot;是怎么实现的？》[1]。</p>\n\n<p><img src=\"//upload-images.jianshu.io/upload_images/268138-76039b5259168d93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp\" style=\"height:493px; width:800px\" /></p>\n\n<p>上面是一个用户相似度计算的案例[4]。我们试着计算A和D之间的相似度。从&ldquo;用户打开过的网页&rdquo;可以看出，A和D都打开过的网页只有d，也就是1个。用户A打开过的网页数=3，用户D打开过的网页数=3。所以A和D的相似度=1/根号（3*3）。其他的计算也是类似的。</p>\n\n<p>有了用户之间的相似度之后，就可以计算推荐度了。假设e是刚刚发布的文章，这时候用户B、C、D都浏览到e新闻的标题，其中C、D点击了，我们就可以计算A对e的兴趣度。</p>\n\n<p>A对e的兴趣度=A与B的相似度*B对e的兴趣度 + A与C的相似度*C对e的兴趣度 + A与D的相似度*D对e的兴趣度。 因为我们这里用的不是评分制，而是考虑是否点击，那么D点击了e，D对e的兴趣度=1。</p>\n\n<p>A对e的兴趣度 = 1/根号(6)*1 + &nbsp;1/根号(6)*1 + &nbsp;1/根号(9)*1</p>\n\n<p>所以，比如100篇新的文章出来之后，对部分用户进行了曝光，然后就可以根据用户相似度，来预计其他用户对这篇文章的兴趣度，进而挑选这100篇中预计兴趣度最高的30篇曝光给这群用户。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>四、基于用户的协同过滤的缺陷</strong></p>\n\n<p>我们知道，今日头条的推荐，不单单用了协同过滤，还用了基于内容的推荐。刚刚的例子说到，新文章出来之后，必须选定一定量的用户来进行曝光，那么怎么选这一群用户呢？这个问题是协同过滤解决不了的。但是基于内容的推荐可以解决。后面将聊聊基于内容的推荐。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>五、参考资料</strong></p>\n\n<pre>\n<code>[1]《亚马逊和淘宝的\"猜你喜欢\"是怎么实现的？》http://www.jianshu.com/p/d03fb6d68716\n\n[2]《今日头条是怎么做新闻推荐的？这篇文章告诉你》http://www.ifanr.com/649620\n\n[3]《产品经理需要了解的算法——热度算法和个性化推荐》https://mp.weixin.qq.com/s/W-q2IY2IZ9OFQyLWT5G8Yw\n\n[4]《基于用户的协同过滤推荐算法原理和实现》http://www.cnblogs.com/technology/p/4467895.html\n\n</code></pre>\n\n<p><br />\n<br />\n作者：晓健周<br />\n链接：https://www.jianshu.com/p/e56665c54df8<br />\n來源：简书</p>\n','d3c3fc43f38445389c970ff0732a6586',1,0,'f86040ccdddf4bdc9eafe4fdc5a3e823',1,'2018-11-21 21:00:23','2018-11-21 21:00:23',NULL,'0','陌溪_','简书','9d2019983d91490aaa758eddd7c07caf',0),('7936b17678e84ddb81ac0af74f22c355','Java工程师学习指南（入门篇）','Java工程师学习指南（入门篇）','<h1><strong>前期准备工作</strong></h1>\n\n<p>&nbsp;</p>\n\n<h2><strong>开发环境搭建</strong></h2>\n\n<p>这一步我们往往会直接跳过，但既然是面向小白的教程，这里就提一下吧。首先你需要一台电脑，然后安装好JDK和JRE，JDK提供的是Java开发工具，也就是一些必备的jar包，JRE则是Java的运行环境组件，我们熟悉的JVM就在这里面。</p>\n\n<p>安装好这两个东东之后，一般还要配置一下环境变量，否则有一些目录可能无法被正确找到。</p>\n\n<h2><strong>IDE选择和安装</strong></h2>\n\n<p>IDE指的就是本地开发编辑器，没有了它，你就只能直接在记事本这类工具里敲代码了。IDE最大的好处就是整合了大量的工具和功能模块，让你非常轻松地完成开发。</p>\n\n<p>以前大家都用eclipse，不过eclipse已经不流行了，现在我推荐你直接用intellij idea 或者 STS作为你的第一个代码编辑器。如果是用过eclipse的同学，基本上也可以无痛切换STS。</p>\n\n<p>intellij idea可以直接在官网上下载，试用版30天，如果想要永久使用，网上也有一些办法滴。</p>\n\n<p>STS是spring boot官方推荐的IDE，可以直接在官网上下载。</p>\n\n<h2><strong>关于jar包</strong></h2>\n\n<p>jar包是什么，其实就是将一堆class格式文件打包，Java中把它称为jar包，这些jar包在编译器中能被直接识别，让开发者使用。</p>\n\n<p>对于新手来说，可能只需要用到JDK自带的一些API，但是如果你要引用外部jar包，可能就会遇到一些困难了。对于idea来说，导入外部jar包有两种办法，一种是手动导入jar包，一种是使用maven。后者会在Java Web相关的文章中讲起。</p>\n\n<p>手动导入jar包其实也不难，你需要先下载好jar包，然后在对应的项目下选择导入jar包即可，具体的方法这里就不展开说了，因为在网上都找得到。</p>\n\n<h1><strong>学习Java基础的几种方法</strong></h1>\n\n<h2><strong>了解基础语法</strong></h2>\n\n<p>学习一门语言，最开始要做的事情就是学习它的语法。我最早学习Java语法是在Runoob（菜鸟教程），这个网站可以让你对任意一门语言完成最快速的语法入门，当然，这只是相当于你浏览了一遍基础语法。</p>\n\n<p>想要真正掌握Java语言基础，光看基础语法还远远不够，我在大三第一次接触Java课程，听老师讲面向对象三大特征听得一头雾水，连数组的初始化方式都理不清楚，但这些内容都是我们需要掌握的。所以，为了学好Java基础，我们还需要看视频或者看书进行学习。</p>\n\n<h2><strong>看视频</strong></h2>\n\n<p>视频的话，可以到极客学院或者慕课网听Java基础课程，当然也可以看我分享的Java视频课程。大家也都知道，现在Java的培训班非常多，基本上学的东西也都大同小异，不过它们的有些课程还不错，大家有渠道的话也可以去看一看。</p>\n\n<p>看视频的好处是你可以更好地接收知识，同时也会耗费你更多时间，所以，有时候你也可以选择看书。</p>\n\n<h2><strong>看书</strong></h2>\n\n<p>看书的话，对于小白来说不推荐太复杂的书，比如《Java编程思想》这种书，新手千万不要看。我个人建议，你只需要先看看《Java入门到精通》这种类型的书就足够了，因为这个部分的学习只是为你后面的学习开个头，你以后可能还要回过头来重新研究这些内容。</p>\n\n<p>现在市面上介绍Java基础的书籍实在太多了，质量参差不齐，内容同质化严重，笔者看过的其实也不多。给大家一个建议，你只需要挑一两本书来看即可，这里推荐两本最简单的吧，《head first java》和《Java从入门到精通》。</p>\n\n<h2><strong>看博客</strong></h2>\n\n<p>这里再推荐另一种学习方式，就是看博客，博客比起书籍来说，更适合对于某个技术点的学习，你可以很容易地在网上找到这个知识点相关的原理，实现方法，以及代码范例。</p>\n\n<p>我的博客里没有讲解特别基础的东西，如果你看一些比较基础的文章，可以到Runoob等网站上查看。如果你有一个很明确的知识点想要学习，相信搜搜引擎会给你更好的答案。</p>\n\n<h2><strong>代码实践</strong></h2>\n\n<p>除此之外，一般的Java书籍或者视频课程都会要求你相应完成一些练习题，这部分内容你需要自己在电脑里使用IDE完成。</p>\n\n<p>在IDE里，你可以很好地熟悉Java语言的使用，基本代码的实现，同时可以尝试各种各样的API,并且测试一些语言特性，比如继承，封装，多态等等。</p>\n\n<p>另外，这也是你熟悉IDE的一个好机会，因为在公司里做开发可能要用到IDE各种各样的功能，提前熟悉好IDE绝对是有益无害的。</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>Java入门必备知识点梳理</strong></h1>\n\n<p>在Java入门阶段，你可能需要接触到以下这部分知识，不管你是从通过哪种方式学习，这些内容都是你学习Java基础时绕不过的重点。</p>\n\n<h2>Java基础知识</h2>\n\n<p>这部分内容是你必须要掌握的内容，在入门阶段你需要把这些基础打扎实，以便于在学习后面的内容时可以更上一层楼。</p>\n\n<p>如何把基础打扎实呢，最好的办法就是在IDE上把书上或者视频上的每个例子都实现一遍，当然有的时候你也可以自己写一些有意思的例子。</p>\n\n<h3><strong>1 基本数据类型</strong></h3>\n\n<p>比如int，double，char，以及其包装类。</p>\n\n<p>熟悉基本数据类型的使用，了解每种类型所占的字节数，以及它们和包装类之间的相互转换。</p>\n\n<h3><strong>2 流程控制</strong></h3>\n\n<p>比如for循环，if else，while循环等等</p>\n\n<p>如果是学过c语言的同学，这部分可以跳过了。</p>\n\n<h3><strong>3 字符串类型String的使用</strong></h3>\n\n<p>字符串类型是Java中很重要的类型，它不是基本数据类型，但却很常用，熟悉和实践String相关的api，开始你对字符串的学习吧。</p>\n\n<h3><strong>4 数组</strong></h3>\n\n<p>数组的初始化方式有哪些，二维数组应该怎么写，把数组当成方法参数又该怎么处理？</p>\n\n<h3><strong>5 类和对象</strong></h3>\n\n<p>Java中最重要的两个概念：类和对象，它们有什么用呢，有什么区别和联系呢，请在代码中实践它们吧。</p>\n\n<p>&nbsp;</p>\n\n<h2><strong>Java核心技术</strong></h2>\n\n<p>对于这部分内容，我相信很多小白只能了解它们的基本使用方法，但是并不明白其背后的一些原理：比如为什么接口和抽象类有这些区别，多态的意义是什么，为什么要有反射。</p>\n\n<p>新手在学习这部分内容时，只需要知道怎么用就可以了。当然，你最好把这些特性都实现一遍，以加深印象。</p>\n\n<p>至于为什么有这些特性，这些特性背后的原理是什么，不是我们现在讨论的内容，这些内容我们将在初级和中级篇中讲述。因为，要了解这些原理，你得了解JVM，了解并发技术的基础，了解网络基础，甚至更多。显然，这不是你现在能做到的。</p>\n\n<h3><strong>1 接口和抽象类</strong></h3>\n\n<p>写一些接口，同时写一些实现类去实现这些接口，并且了解一下为什么我们需要接口，为什么子类需要实现接口里的方法。</p>\n\n<p>同理，去实现一些抽象类吧。然后，看看它和接口有什么不同。</p>\n\n<h3><strong>2 继承，封装和多态</strong></h3>\n\n<p>如何理解继承，子类和父类之间有什么联系呢。</p>\n\n<p>封装是一种保护代码的方式，有哪些方式可以实现封装呢。</p>\n\n<p>多态一般分为重载和重写，它们分别怎么使用？</p>\n\n<h3><strong>3 异常处理</strong></h3>\n\n<p>Java中的异常处理主要用于捕获和处理错误，请你写一些try catch代码块去捕获错误吧。</p>\n\n<h3><strong>4 集合类</strong></h3>\n\n<p>集合类是我们经常需要打交道的东西，List，Map，Set等等，赶快去熟悉API，然后写一些测试例子吧。</p>\n\n<h3><strong>5 IO输入流和输出流</strong></h3>\n\n<p>IO输入流和输出流可以操作文件，网络数据等内容，如何在Java代码中完成这么复杂的操作呢，其实只需要简单的几个api就可以了。</p>\n\n<h3><strong>6 多线程</strong></h3>\n\n<p>为了让系统资源最合理地分配和调度，我们需要多线程，多线程会让程序变得有趣，也会带来很多问题，使用Thread和相关API，去尝试这些有趣的事情吧。</p>\n\n<p><strong>可选内容：</strong></p>\n\n<p>1 反射（了解即可，不是入门必须）</p>\n\n<p>2 枚举类型和泛型（了解即可，不是入门必须）</p>\n\n<p>3 网络通信（了解基本的socket使用即可，需要网络基础）</p>\n\n<p>4 数据库操作（了解基本的JDBC即可，需要数据库基础）</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>总结</strong></h1>\n\n<p>总而言之，对于一个Java小白来说，入门Java可以分为这几步：</p>\n\n<blockquote>\n<p>1 首先搭建好Java开发环境</p>\n\n<p>2 通过Runoob等一些网站熟悉Java的基本语法</p>\n\n<p>3 通过看书看视频等方式熟悉Java基础知识，通过代码实践加深理解</p>\n\n<p>4 通过看书看视频等方式初步了解Java核心技术，通过代码实践加深理解。</p>\n</blockquote>\n\n<p>&nbsp;</p>\n\n<p>本文主要是为大家提供一个学习的思路，以及推荐一些学习方法，如果你能够按照这样的步骤去学习，并且配合上一些适合你自己的学习方法来完成学习计划，相信你可以很好地完成对Java的入门。</p>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',6,0,'8f48f07f30314960a38a0b85c4f1f34a',1,'2018-12-19 21:24:50','2018-12-19 21:24:50',NULL,'1','陌溪_','蘑菇博客','093d8bdd01c84890a928e923d5c235fe',0),('80b7fb49e91d4930a7b5f0c084f12cbc','【性能优化之道】每秒上万并发下的Spring Cloud参数优化实战','【性能优化之道】每秒上万并发下的Spring Cloud参数优化实战','<p>本文转载自：石杉的架构笔记</p>\n\n<p><strong>一、写在前面</strong></p>\n\n<p>相信不少朋友都在自己公司使用Spring Cloud框架来构建微服务架构，毕竟现在这是非常火的一门技术。</p>\n\n<p>如果只是用户量很少的传统IT系统，使用Spring Cloud可能还暴露不出什么问题。</p>\n\n<p>如果是较多用户量，高峰每秒高达上万并发请求的互联网公司的系统，使用Spring Cloud技术就有一些问题需要注意了。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、场景引入，问题初现</strong></p>\n\n<p>先不空聊原理、理论，来讲一个真实的例子，这是我的一个朋友在创业互联网公司发生过的真实案例。</p>\n\n<p>朋友A的公司做互联网类的创业，组建了一个小型研发团队，上来就用了Spring Cloud技术栈来构建微服务架构的系统。</p>\n\n<p>一段时间没日没夜的加班，好不容易核心业务系统给做出来了，平时正常QA测试没发现什么大毛病，感觉性能还不错，一切都很完美。</p>\n\n<p>然后系统就这么上线了，一开始用户规模很小，注册用户量小几十万，日活几千用户。</p>\n\n<p>每天都有新的数据进入数据库的表中，就这么日积月累的，没想到数据规模居然慢慢吞吞增长到了单表几百万。</p>\n\n<p>这个时候呢，看起来也没太大的毛病，就是有用户反映，系统有些操作，会感觉卡顿几秒钟，会刷不出来页面。</p>\n\n<p>这是为啥呢？</p>\n\n<ul>\n	<li>核心原因是单表数据量大了一些，达到了几百万。</li>\n</ul>\n\n<ul>\n	<li>有个别服务，跑的SQL比较复杂，一大堆的多表关联</li>\n</ul>\n\n<ul>\n	<li>并且还没有设计好索引，或者是设计了索引，但无奈一些小弟写了上百行的大SQL，SQL实在太复杂了，那么一个SQL跑出来好几秒肯定是正常的。</li>\n</ul>\n\n<p>如果大家对微服务框架有点了解的话，应该知道，比如Feign + Ribbon组成的服务调用框架，是有接口调用超时这一说的，有一些参数可以设置接口调用的超时时间。</p>\n\n<p>&nbsp;</p>\n\n<p>如果你调用一个接口，好几秒刷不出来，人家就超时异常返回，用户就刷不出来页面了。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>三、扬汤止沸，饮鸩止渴</strong></p>\n\n<p>一般碰到这种事情，一大坨屎一样的SQL摆在那儿，写SQL的人过一个月自己都看不懂了，80%的工程师看着都不愿意去花时间重写和优化。</p>\n\n<p>一是修改的人力成本太高，二是谁敢负担这责任呢？</p>\n\n<p>系统跑的好好的，就是慢了点而已，结果你硬是乱改一通，重构，把系统核心业务流程搞挂了怎么办？</p>\n\n<p>所以，那些兄弟第一反应是：增加超时时间啊！接口慢点可以，但是别超时不响应啊！</p>\n\n<p>咱们让接口执行个几秒把结果返回，用户不就可以刷出来页面了！不用重构系统了啊！轻松+愉快！</p>\n\n<p>如何增加呢？很简单，看下面的参数就知道了：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544014558121.png\" style=\"height:389px; width:850px\" /></p>\n\n<p>大家如果看过之前的文章，应该知道，Spring Cloud里一般会用hystrix的线程池来执行接口调用的请求。</p>\n\n<p>&nbsp;</p>\n\n<p>如果忘了这一点的，可以回头看看<a href=\"http://www.moguit.cn/#/info?blogUid=2c581c60ae6743a7a37bbe7543915483\" target=\"_blank\">《拜托，面试请不要再问我Spring Cloud底层原理！》</a>。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>所以设置超时一般设置两个地方，feign和ribbon那块的超时，还有hystrix那块的超时。其中后者那块的超时一般必须大于前者。</p>\n\n<p>&nbsp;</p>\n\n<p>Spring Cloud玩儿的好的兄弟，可千万别看着这些配置发笑，因为我确实见过不少Spring Cloud玩儿的没那么溜的哥们，真的就这么干了。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>好了，日子在继续。。。</strong></p>\n\n<p>优化了参数后，看上去效果不错，用户虽然觉得有的页面慢是慢点，但是起码过几秒能刷出来。</p>\n\n<p>这个时候，日活几千的用户量，压根儿没什么并发可言，高峰期每秒最多一二十并发请求罢了。</p>\n\n<p>&nbsp;</p>\n\n<p>大家看看下面这张图，感受一下现场氛围：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544014558146.png\" style=\"height:287px; width:850px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>四、问题爆发，洪水猛兽</strong></p>\n\n<p>随着时间的推移，公司业务高速发展&hellip;&hellip;</p>\n\n<p>那位兄弟的公司，在系统打磨成熟，几万用户试点都ok之后，老板立马拿到一轮几千万的融资。</p>\n\n<p>公司上上下下意气风发啊！紧接着就是组建运营团队，地推团队，全国大范围的推广。</p>\n\n<p>总之就是三个字：推！推！推！</p>\n\n<p>这一推不打紧！研发人员在后台系统发现，自己的用户量蹭蹭蹭的直线增长。</p>\n\n<p>注册用户增长了几十倍，突破了千万级别，日活用户也翻了几十倍，在活动之类的高峰期，居然达到了上百万的日活用户量！</p>\n\n<p>幸福的烦恼。。。</p>\n\n<p>为什么这么说？因为用户量上来后，悲剧的事情就发生了。</p>\n\n<p>高峰期每秒的并发请求居然达到了近万的程度，研发团队的兄弟们哪里敢怠慢！在这个过程中，先是紧张的各种扩容服务，一台变两台，两台变四台。</p>\n\n<p>然后数据库主从架构挂上去，读写分离是必须的，否则单个数据库服务器哪能承载那么大的请求！多搞几个从库，扛一下大量的读请求，这样基本就扛住了。</p>\n\n<p>正准备坐下来喝口茶、松口气，更加悲剧的事情就发生了。</p>\n\n<p>在这个过程中，那些兄弟经常会发现高峰期，系统的某个功能页面，突然就整个hang死了，就是没法再响应任何请求！所有用户刷新这个页面全部都是无法响应！</p>\n\n<p>这是为什么呢？原因很简单啊！一个服务A的实例里，专门调用服务B的那个线程池里的线程，总共可能就几十个。每个线程调用服务B都会卡住5秒钟。</p>\n\n<p>那如果每秒钟过来几百个请求这个服务实例呢？一下子那个线程池里的线程就全部hang死了，没法再响应任何请求了。大家来看看下面这张图，再直观的感受一下这个无助的过程</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544014558114.png\" style=\"height:372px; width:850px\" /></p>\n\n<p>这个时候咋办？兄弟们只能祭出程序员最古老的法宝，重启机器！</p>\n\n<p>遇到页面刷不出来，只能重启机器，相当于短暂的初始化了一下机器内的资源。</p>\n\n<p>然后接着运行一段时间，又卡死，再次重启！真是令人崩溃啊！用户们的体验是极差的，老板的心情是愤怒的！</p>\n\n<p>&nbsp;</p>\n\n<p>画外音：</p>\n\n<p>其实这个问题本身不大，但如果对Spring Cloud没有高并发场景的真实经验，确实可能会跟这帮兄弟一样，搞出些莫名其妙的问题。</p>\n\n<p>比如这个公司，明明应该去优化服务接口性能，结果硬是调大了超时时间。结果导致并发量高了，对那个服务的调用直接hang死，系统的核心页面刷不出来，影响用户体验了，这怪谁呢？</p>\n\n<p><strong>五、追本溯源，治标治本</strong></p>\n\n<p>没法子了，那帮兄弟们只能找人求助。下面就是作者全程指导他们完成系统优化的过程。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>第一步</strong></p>\n\n<p>关键点，优化图中核心服务B的性能。互联网公司，核心业务逻辑，面向C端用户高并发的请求，不要用上百行的大SQL，多表关联，那样单表几百万行数据量的话，会导致一下执行好几秒。</p>\n\n<p>其实最佳的方式，就是对数据库就执行简单的单表查询和更新，然后复杂的业务逻辑全部放在java系统中来执行，比如一些关联，或者是计算之类的工作。</p>\n\n<p>这一步干完了之后，那个核心服务B的响应速度就已经优化成几十毫秒了，是不是很开心？从几秒变成了几十毫秒！</p>\n\n<p>&nbsp;</p>\n\n<p><strong>第二步</strong></p>\n\n<p>那个超时的时间，也就是上面那段ribbon和hystrix的超时时间设置。</p>\n\n<p>奉劝各位同学，不要因为系统接口的性能过差而懒惰，搞成几秒甚至几十秒的超时，一般超时定义在1秒以内，是比较通用以及合理的。</p>\n\n<p>为什么这么说？</p>\n\n<p>因为一个接口，理论的最佳响应速度应该在200ms以内，或者慢点的接口就几百毫秒。</p>\n\n<p>如果一个接口响应时间达到1秒+，建议考虑用缓存、索引、NoSQL等各种你能想到的技术手段，优化一下性能。</p>\n\n<p>否则你要是胡乱设置超时时间是几秒，甚至几十秒，万一下游服务偶然出了点问题响应时间长了点呢？那你这个线程池里的线程立马全部卡死！</p>\n\n<p>具体hystrix的线程池以及超时时间的最佳生产实践，请见下一篇文章：《微服务架构如何保障双11狂欢下的99.99%高可用》</p>\n\n<p>这两步解决之后，其实系统表现就正常了，核心服务B响应速度很快，而且超时时间也在1秒以内，不会出现hystrix线程池频繁卡死的情况了。<br />\n&nbsp;</p>\n\n<p><strong>第三步</strong></p>\n\n<p>&nbsp;</p>\n\n<p>事儿还没完，你要真觉得两步就搞定了，那还是经验不足。</p>\n\n<p>如果你要是超时时间设置成了1秒，如果就是因为偶然发生的网络抖动，导致接口某次调用就是在1.5秒呢？这个是经常发生的，因为网络的问题，接口调用偶然超时。</p>\n\n<p>&nbsp;</p>\n\n<p>所以此时配合着超时时间，一般都会设置一个合理的重试，如下所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544014558081.png\" style=\"height:167px; width:379px\" /></p>\n\n<p>设置这段重试之后，Spring Cloud中的Feign + Ribbon的组合，在进行服务调用的时候，如果发现某台机器超时请求失败，会自动重试这台机器，如果还是不行会换另外一台机器重试。</p>\n\n<p>&nbsp;</p>\n\n<p>这样由于偶尔的网络请求造成的超时，不也可以通过自动重试避免了？</p>\n\n<p>&nbsp;</p>\n\n<p><strong>第四步</strong></p>\n\n<p><br />\n&nbsp;</p>\n\n<p>其实事儿还没完，如果把重试参数配置了，结果你居然就放手了，那还是没对人家负责任啊</p>\n\n<p>你的系统架构中，只要涉及到了重试，那么必须上接口的幂等性保障机制。</p>\n\n<p>否则的话，试想一下，你要是对一个接口重试了好几次，结果人家重复插入了多条数据，该怎么办呢？</p>\n\n<p>其实幂等性保证本身并不复杂，根据业务来，常见的方案：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>可以在数据库里建一个唯一索引，插入数据的时候如果唯一索引冲突了就不会插入重复数据</li>\n	<li>或者是通过redis里放一个唯一id值，然后每次要插入数据，都通过redis判断一下，那个值如果已经存在了，那么就不要插入重复数据了。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>类似这样的方案还有一些。总之，要保证一个接口被多次调用的时候，不能插入重复的数据。<br />\n&nbsp;</p>\n\n<p><strong>六、总结全文，回眸再看</strong></p>\n\n<p>有图有真相！老规矩，最后给大家上一张图，最终优化后的系统表现大概是长下面这样子的。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544014558152.png\" style=\"height:363px; width:850px\" /></p>\n\n<p>&nbsp;</p>\n','e81bc2dca42c4031be7d66fef4a71e16',3,0,'760f5d83f561440c8ec0691c66ca0338',1,'2018-12-05 20:56:41','2018-12-05 20:56:41',NULL,'0','陌溪_','石杉的架构笔记','2c93dfab0e754006866f8ed486923a41',2),('88f251b04fed4496b9b95e054efbc0c1','windows下Console的安装和启动','windows下Console的安装和启动','<p>关于Consul的介绍和学习，可以参考这篇博客&nbsp;</p>\n\n<p>http://www.cnblogs.com/Summer7C/p/7327109.html</p>\n\n<p>&nbsp;</p>\n\n<p>官网下载Console的包：<a href=\"https://www.consul.io/downloads.html\" target=\"_blank\">https://www.consul.io/downloads.html</a></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544321156587.png\" style=\"height:460px; width:800px\" /></p>\n\n<p>下载好自己对应的版本后，加压发现就只有一个exe文件，我们需要做的就是，打开命令窗口，在当前目录下，然后输入</p>\n\n<pre>\n<code>./consul agent -dev</code></pre>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544321267334.png\" style=\"height:676px; width:800px\" /></p>\n\n<p>这就算启动成功了，如果想在任何地方都能使用的话，需要在path下配置环境变量</p>\n\n<p>最后我们打开 localhost:8500, 如果能访问到下面的页面就算开启成功</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544321416597.png\" style=\"height:215px; width:800px\" /></p>\n','e81bc2dca42c4031be7d66fef4a71e16',1,0,'4f1939b3ce064363b14ca1577f188753',1,'2018-12-09 10:10:26','2018-12-09 10:10:26',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('891ca107b434453790c49719e47c53a1','Java并发编程73道面试题','Java并发编程73道面试题','<p><strong>1、在java中守护线程和本地线程区别？</strong></p>\n\n<p>java中的线程分为两种：守护线程（Daemon）和用户线程（User）。</p>\n\n<p>任何线程都可以设置为守护线程和用户线程，通过方法Thread.setDaemon(bool on)；true则把该线程设置为守护线程，反之则为用户线程。Thread.setDaemon()必须在Thread.start()之前调用，否则运行时会抛出异常。</p>\n\n<p>两者的区别：&nbsp;<br />\n唯一的区别是判断虚拟机(JVM)何时离开，Daemon是为其他线程提供服务，如果全部的User Thread已经撤离，Daemon 没有可服务的线程，JVM撤离。也可以理解为守护线程是JVM自动创建的线程（但不一定），用户线程是程序创建的线程；比如JVM的垃圾回收线程是一个守护线程，当所有线程已经撤离，不再产生垃圾，守护线程自然就没事可干了，当垃圾回收线程是Java虚拟机上仅剩的线程时，Java虚拟机会自动离开。</p>\n\n<p>扩展：Thread Dump打印出来的线程信息，含有daemon字样的线程即为守护进程，可能会有：服务守护进程、编译守护进程、windows下的监听Ctrl+break的守护进程、Finalizer守护进程、引用处理守护进程、GC守护进程。<br />\n<br />\n<strong>2、线程与进程的区别？</strong></p>\n\n<p>进程是操作系统分配资源的最小单元，线程是操作系统调度的最小单元。</p>\n\n<p>一个程序至少有一个进程,一个进程至少有一个线程。<br />\n<br />\n<strong>3、什么是多线程中的上下文切换？</strong></p>\n\n<p>多线程会共同使用一组计算机上的CPU，而线程数大于给程序分配的CPU数量时，为了让各个线程都有执行的机会，就需要轮转使用CPU。不同的线程切换使用CPU发生的切换数据等就是上下文切换。<br />\n<br />\n<strong>4、死锁与活锁的区别，死锁与饥饿的区别？</strong></p>\n\n<p><strong>死锁</strong>：是指两个或两个以上的进程（或线程）在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。&nbsp;</p>\n\n<p>产生死锁的必要条件：&nbsp;</p>\n\n<ul>\n	<li>\n	<p>互斥条件：所谓互斥就是进程在某一时间内独占资源。</p>\n	</li>\n	<li>\n	<p>请求与保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放。&nbsp;</p>\n	</li>\n	<li>\n	<p>不剥夺条件:进程已获得资源，在末使用完之前，不能强行剥夺。&nbsp;&nbsp;</p>\n	</li>\n	<li>\n	<p>循环等待条件:若干进程之间形成一种头尾相接的循环等待资源关系。</p>\n	</li>\n</ul>\n\n<p><strong>活锁</strong>：任务或者执行者没有被阻塞，由于某些条件没有满足，导致一直重复尝试，失败，尝试，失败。</p>\n\n<p><strong>活锁</strong>和<strong>死锁</strong>的区别在于，处于活锁的实体是在不断的改变状态，所谓的&ldquo;活&rdquo;， 而处于死锁的实体表现为等待；活锁有可能自行解开，死锁则不能。</p>\n\n<p><strong>饥饿</strong>：一个或者多个线程因为种种原因无法获得所需要的资源，导致一直无法执行的状态。&nbsp;</p>\n\n<p>Java中导致饥饿的原因：&nbsp;</p>\n\n<ul>\n	<li>\n	<p>高优先级线程吞噬所有的低优先级线程的CPU时间。&nbsp;</p>\n	</li>\n	<li>\n	<p>线程被永久堵塞在一个等待进入同步块的状态，因为其他线程总是能在它之前持续地对该同步块进行访问。&nbsp;</p>\n	</li>\n	<li>\n	<p>线程在等待一个本身也处于永久等待完成的对象(比如调用这个对象的wait方法)，因为其他线程总是被持续地获得唤醒。</p>\n	</li>\n</ul>\n\n<p><strong>5、Java中用到的线程调度算法是什么？</strong></p>\n\n<p>采用时间片轮转的方式。可以设置线程的优先级，会映射到下层的系统上面的优先级上，如非特别需要，尽量不要用，防止线程饥饿。<br />\n<br />\n<strong>6、什么是线程组，为什么在Java中不推荐使用？</strong></p>\n\n<p>ThreadGroup类，可以把线程归属到某一个线程组中，线程组中可以有线程对象，也可以有线程组，组中还可以有线程，这样的组织结构有点类似于树的形式。</p>\n\n<p>为什么不推荐使用？因为使用有很多的安全隐患吧，没有具体追究，如果需要使用，推荐使用线程池。<br />\n<br />\n<strong>7、为什么使用Executor框架？</strong></p>\n\n<ol>\n	<li>\n	<p>每次执行任务创建线程 new Thread()比较消耗性能，创建一个线程是比较耗时、耗资源的。</p>\n	</li>\n	<li>\n	<p>调用 new Thread()创建的线程缺乏管理，被称为野线程，而且可以无限制的创建，线程之间的相互竞争会导致过多占用系统资源而导致系统瘫痪，还有线程之间的频繁交替也会消耗很多系统资源。</p>\n	</li>\n	<li>\n	<p>接使用new Thread() 启动的线程不利于扩展，比如定时执行、定期执行、定时定期执行、线程中断等都不便实现。</p>\n	</li>\n</ol>\n\n<p><strong>8、在Java中Executor和Executors的区别？</strong></p>\n\n<p>Executors 工具类的不同方法按照我们的需求创建了不同的线程池，来满足业务的需求。&nbsp;</p>\n\n<p>Executor 接口对象能执行我们的线程任务。&nbsp;</p>\n\n<p>ExecutorService接口继承了Executor接口并进行了扩展，提供了更多的方法我们能获得任务执行的状态并且可以获取任务的返回值。&nbsp;</p>\n\n<p>使用ThreadPoolExecutor 可以创建自定义线程池。&nbsp;</p>\n\n<p>Future 表示异步计算的结果，他提供了检查计算是否完成的方法，以等待计算的完成，并可以使用get()方法获取计算的结果。<br />\n<br />\n<strong>9、什么是原子操作？在Java Concurrency API中有哪些原子类(atomic classes)？</strong></p>\n\n<p>原子操作（atomic operation）意为&rdquo;不可被中断的一个或一系列操作&rdquo; 。&nbsp;</p>\n\n<p>处理器使用基于对缓存加锁或总线加锁的方式来实现多处理器之间的原子操作。&nbsp;</p>\n\n<p>在Java中可以通过锁和循环CAS的方式来实现原子操作。 CAS操作&mdash;&mdash;Compare &amp; Set，或是 Compare &amp; Swap，现在几乎所有的CPU指令都支持CAS的原子操作。<br />\n<br />\n原子操作是指一个不受其他操作影响的操作任务单元。原子操作是在多线程环境下避免数据不一致必须的手段。&nbsp;</p>\n\n<p>int++并不是一个原子操作，所以当一个线程读取它的值并加1时，另外一个线程有可能会读到之前的值，这就会引发错误。&nbsp;</p>\n\n<p>为了解决这个问题，必须保证增加操作是原子的，在JDK1.5之前我们可以使用同步技术来做到这一点。到JDK1.5，java.util.concurrent.atomic包提供了int和long类型的原子包装类，它们可以自动的保证对于他们的操作是原子的并且不需要使用同步。<br />\n<br />\njava.util.concurrent这个包里面提供了一组原子类。其基本的特性就是在多线程环境下，当有多个线程同时执行这些类的实例包含的方法时，具有排他性，即当某个线程进入方法，执行其中的指令时，不会被其他线程打断，而别的线程就像自旋锁一样，一直等到该方法执行完成，才由JVM从等待队列中选择一个另一个线程进入，这只是一种逻辑上的理解。<br />\n<br />\n原子类：AtomicBoolean，AtomicInteger，AtomicLong，AtomicReference&nbsp;</p>\n\n<p>原子数组：AtomicIntegerArray，AtomicLongArray，AtomicReferenceArray&nbsp;</p>\n\n<p>原子属性更新器：AtomicLongFieldUpdater，AtomicIntegerFieldUpdater，AtomicReferenceFieldUpdater&nbsp;</p>\n\n<p>解决ABA问题的原子类：AtomicMarkableReference（通过引入一个boolean来反映中间有没有变过），AtomicStampedReference（通过引入一个int来累加来反映中间有没有变过）<br />\n<br />\n<strong>10、Java Concurrency API中的Lock接口(Lock interface)是什么？对比同步它有什么优势？</strong></p>\n\n<p>Lock接口比同步方法和同步块提供了更具扩展性的锁操作。&nbsp;</p>\n\n<p>他们允许更灵活的结构，可以具有完全不同的性质，并且可以支持多个相关类的条件对象。</p>\n\n<p>它的优势有：</p>\n\n<ul>\n	<li>\n	<p>可以使锁更公平</p>\n	</li>\n	<li>\n	<p>可以使线程在等待锁的时候响应中断</p>\n	</li>\n	<li>\n	<p>可以让线程尝试获取锁，并在无法获取锁的时候立即返回或者等待一段时间</p>\n	</li>\n	<li>\n	<p>可以在不同的范围，以不同的顺序获取和释放锁</p>\n	</li>\n</ul>\n\n<p>整体上来说Lock是synchronized的扩展版，Lock提供了无条件的、可轮询的(tryLock方法)、定时的(tryLock带参方法)、可中断的(lockInterruptibly)、可多条件队列的(newCondition方法)锁操作。另外Lock的实现类基本都支持非公平锁(默认)和公平锁，synchronized只支持非公平锁，当然，在大部分情况下，非公平锁是高效的选择。<br />\n<br />\n<strong>11、什么是Executors框架？</strong></p>\n\n<p>Executor框架是一个根据一组执行策略调用，调度，执行和控制的异步任务的框架。</p>\n\n<p>无限制的创建线程会引起应用程序内存溢出。所以创建一个线程池是个更好的的解决方案，因为可以限制线程的数量并且可以回收再利用这些线程。利用Executors框架可以非常方便的创建一个线程池。<br />\n<br />\n<strong>12、什么是阻塞队列？阻塞队列的实现原理是什么？如何使用阻塞队列来实现生产者-消费者模型？</strong></p>\n\n<p>阻塞队列（BlockingQueue）是一个支持两个附加操作的队列。</p>\n\n<p>这两个附加的操作是：在队列为空时，获取元素的线程会等待队列变为非空。当队列满时，存储元素的线程会等待队列可用。</p>\n\n<p>阻塞队列常用于生产者和消费者的场景，生产者是往队列里添加元素的线程，消费者是从队列里拿元素的线程。阻塞队列就是生产者存放元素的容器，而消费者也只从容器里拿元素。</p>\n\n<p>JDK7提供了7个阻塞队列。分别是：&nbsp;</p>\n\n<p>ArrayBlockingQueue ：一个由数组结构组成的有界阻塞队列。&nbsp;</p>\n\n<p>LinkedBlockingQueue ：一个由链表结构组成的有界阻塞队列。&nbsp;</p>\n\n<p>PriorityBlockingQueue ：一个支持优先级排序的无界阻塞队列。&nbsp;</p>\n\n<p>DelayQueue：一个使用优先级队列实现的无界阻塞队列。&nbsp;</p>\n\n<p>SynchronousQueue：一个不存储元素的阻塞队列。&nbsp;</p>\n\n<p>LinkedTransferQueue：一个由链表结构组成的无界阻塞队列。&nbsp;</p>\n\n<p>LinkedBlockingDeque：一个由链表结构组成的双向阻塞队列。</p>\n\n<p>Java 5之前实现同步存取时，可以使用普通的一个集合，然后在使用线程的协作和线程同步可以实现生产者，消费者模式，主要的技术就是用好，wait ,notify,notifyAll,sychronized这些关键字。而在java 5之后，可以使用阻塞队列来实现，此方式大大简少了代码量，使得多线程编程更加容易，安全方面也有保障。&nbsp;</p>\n\n<p>BlockingQueue接口是Queue的子接口，它的主要用途并不是作为容器，而是作为线程同步的的工具，因此他具有一个很明显的特性，当生产者线程试图向BlockingQueue放入元素时，如果队列已满，则线程被阻塞，当消费者线程试图从中取出一个元素时，如果队列为空，则该线程会被阻塞，正是因为它所具有这个特性，所以在程序中多个线程交替向BlockingQueue中放入元素，取出元素，它可以很好的控制线程之间的通信。</p>\n\n<p>阻塞队列使用最经典的场景就是socket客户端数据的读取和解析，读取数据的线程不断将数据放入队列，然后解析线程不断从队列取数据解析。<br />\n<br />\n<strong>13、什么是Callable和Future?</strong></p>\n\n<p>Callable接口类似于Runnable，从名字就可以看出来了，但是Runnable不会返回结果，并且无法抛出返回结果的异常，而Callable功能更强大一些，被线程执行后，可以返回值，这个返回值可以被Future拿到，也就是说，Future可以拿到异步执行任务的返回值。&nbsp;</p>\n\n<p>可以认为是带有回调的Runnable。</p>\n\n<p>Future接口表示异步任务，是还没有完成的任务给出的未来结果。所以说Callable用于产生结果，Future用于获取结果。<br />\n<br />\n<strong>14、什么是FutureTask?使用ExecutorService启动任务。</strong></p>\n\n<p>在Java并发程序中FutureTask表示一个可以取消的异步运算。它有启动和取消运算、查询运算是否完成和取回运算结果等方法。只有当运算完成的时候结果才能取回，如果运算尚未完成get方法将会阻塞。一个FutureTask对象可以对调用了Callable和Runnable的对象进行包装，由于FutureTask也是调用了Runnable接口所以它可以提交给Executor来执行。<br />\n<br />\n<strong>15、什么是并发容器的实现？</strong></p>\n\n<p>何为同步容器：可以简单地理解为通过synchronized来实现同步的容器，如果有多个线程调用同步容器的方法，它们将会串行执行。比如Vector，Hashtable，以及Collections.synchronizedSet，synchronizedList等方法返回的容器。&nbsp;</p>\n\n<p>可以通过查看Vector，Hashtable等这些同步容器的实现代码，可以看到这些容器实现线程安全的方式就是将它们的状态封装起来，并在需要同步的方法上加上关键字synchronized。</p>\n\n<p>并发容器使用了与同步容器完全不同的加锁策略来提供更高的并发性和伸缩性，例如在ConcurrentHashMap中采用了一种粒度更细的加锁机制，可以称为分段锁，在这种锁机制下，允许任意数量的读线程并发地访问map，并且执行读操作的线程和写操作的线程也可以并发的访问map，同时允许一定数量的写操作线程并发地修改map，所以它可以在并发环境下实现更高的吞吐量。<br />\n<br />\n<strong>16、多线程同步和互斥有几种实现方法，都是什么？</strong></p>\n\n<p>线程同步是指线程之间所具有的一种制约关系，一个线程的执行依赖另一个线程的消息，当它没有得到另一个线程的消息时应等待，直到消息到达时才被唤醒。&nbsp;</p>\n\n<p>线程互斥是指对于共享的进程系统资源，在各单个线程访问时的排它性。当有若干个线程都要使用某一共享资源时，任何时刻最多只允许一个线程去使用，其它要使用该资源的线程必须等待，直到占用资源者释放该资源。线程互斥可以看成是一种特殊的线程同步。</p>\n\n<p>线程间的同步方法大体可分为两类：用户模式和内核模式。顾名思义，内核模式就是指利用系统内核对象的单一性来进行同步，使用时需要切换内核态与用户态，而用户模式就是不需要切换到内核态，只在用户态完成操作。&nbsp;</p>\n\n<p>用户模式下的方法有：原子操作（例如一个单一的全局变量），临界区。内核模式下的方法有：事件，信号量，互斥量。<br />\n<br />\n<strong>17、什么是竞争条件？你怎样发现和解决竞争？</strong></p>\n\n<p>当多个进程都企图对共享数据进行某种处理，而最后的结果又取决于进程运行的顺序时，则我们认为这发生了竞争条件（race condition）。<br />\n<br />\n<strong>18、你将如何使用thread dump？你将如何分析Thread dump？</strong></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546140834234.png\" style=\"height:381px; width:567px\" /></p>\n\n<ul>\n	<li>\n	<p><strong>新建状态（New）&nbsp;</strong></p>\n\n	<p>用new语句创建的线程处于新建状态，此时它和其他Java对象一样，仅仅在堆区中被分配了内存。</p>\n	</li>\n	<li>\n	<p><strong>就绪状态（Runnable）&nbsp;</strong></p>\n\n	<p>当一个线程对象创建后，其他线程调用它的start()方法，该线程就进入就绪状态，Java虚拟机会为它创建方法调用栈和程序计数器。处于这个状态的线程位于可运行池中，等待获得CPU的使用权。</p>\n	</li>\n	<li>\n	<p><strong>运行状态（Running）&nbsp;</strong></p>\n\n	<p>处于这个状态的线程占用CPU，执行程序代码。只有处于就绪状态的线程才有机会转到运行状态。</p>\n	</li>\n	<li>\n	<p><strong>阻塞状态（Blocked）&nbsp;</strong></p>\n\n	<p>阻塞状态是指线程因为某些原因放弃CPU，暂时停止运行。当线程处于阻塞状态时，Java虚拟机不会给线程分配CPU。直到线程重新进入就绪状态，它才有机会转到运行状态。&nbsp;</p>\n\n	<p>阻塞状态可分为以下3种：</p>\n\n	<p>① 位于对象等待池中的阻塞状态（Blocked in object&rsquo;s wait pool）：当线程处于运行状态时，如果执行了某个对象的wait()方法，Java虚拟机就会把线程放到这个对象的等待池中，这涉及到&ldquo;线程通信&rdquo;的内容。</p>\n\n	<p>② 位于对象锁池中的阻塞状态（Blocked in object&rsquo;s lock pool）：当线程处于运行状态时，试图获得某个对象的同步锁时，如果该对象的同步锁已经被其他线程占用，Java虚拟机就会把这个线程放到这个对象的锁池中，这涉及到&ldquo;线程同步&rdquo;的内容。</p>\n\n	<p>③ 其他阻塞状态（Otherwise Blocked）：当前线程执行了sleep()方法，或者调用了其他线程的join()方法，或者发出了I/O请求时，就会进入这个状态。</p>\n	</li>\n	<li>\n	<p><strong>死亡状态（Dead）</strong></p>\n\n	<p>当线程退出run()方法时，就进入死亡状态，该线程结束生命周期。</p>\n	</li>\n</ul>\n\n<p>我们运行之前的那个死锁代码SimpleDeadLock.java，然后尝试输出信息(/*这是注释，作者自己加的*/)：</p>\n\n<pre>\n<code class=\"language-java\">/* 时间，jvm信息 */\n2017-11-01 17:36:28\nFull thread dump Java HotSpot(TM) 64-Bit Server VM (25.144-b01 mixed mode):\n\n/* 线程名称：DestroyJavaVM\n编号：#13\n优先级：5\n系统优先级：0\njvm内部线程id：0x0000000001c88800\n对应系统线程id（NativeThread ID）：0x1c18\n线程状态： waiting on condition [0x0000000000000000]  （等待某个条件）\n线程详细状态：java.lang.Thread.State: RUNNABLE  及之后所有*/\n\"DestroyJavaVM\" #13 prio=5 os_prio=0 tid=0x0000000001c88800 nid=0x1c18 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Thread-1\" #12 prio=5 os_prio=0 tid=0x0000000018d49000 nid=0x17b8 waiting for monitor entry [0x0000000019d7f000]\n/* 线程状态：阻塞（在对象同步上）\n    代码位置：at com.leo.interview.SimpleDeadLock$B.run(SimpleDeadLock.java:56)\n    等待锁：0x00000000d629b4d8 \n    已经获得锁：0x00000000d629b4e8*/\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at com.leo.interview.SimpleDeadLock$B.run(SimpleDeadLock.java:56)\n    - waiting to lock &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n\n\"Thread-0\" #11 prio=5 os_prio=0 tid=0x0000000018d44000 nid=0x1ebc waiting for monitor entry [0x000000001907f000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at com.leo.interview.SimpleDeadLock$A.run(SimpleDeadLock.java:34)\n    - waiting to lock &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n\n\"Service Thread\" #10 daemon prio=9 os_prio=0 tid=0x0000000018ca5000 nid=0x1264 runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C1 CompilerThread2\" #9 daemon prio=9 os_prio=2 tid=0x0000000018c46000 nid=0xb8c waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread1\" #8 daemon prio=9 os_prio=2 tid=0x0000000018be4800 nid=0x1db4 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread0\" #7 daemon prio=9 os_prio=2 tid=0x0000000018be3800 nid=0x810 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Monitor Ctrl-Break\" #6 daemon prio=5 os_prio=0 tid=0x0000000018bcc800 nid=0x1c24 runnable [0x00000000193ce000]\n   java.lang.Thread.State: RUNNABLE\n    at java.net.SocketInputStream.socketRead0(Native Method)\n    at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\n    at java.net.SocketInputStream.read(SocketInputStream.java:171)\n    at java.net.SocketInputStream.read(SocketInputStream.java:141)\n    at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)\n    at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)\n    at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)\n    - locked &lt;0x00000000d632b928&gt; (a java.io.InputStreamReader)\n    at java.io.InputStreamReader.read(InputStreamReader.java:184)\n    at java.io.BufferedReader.fill(BufferedReader.java:161)\n    at java.io.BufferedReader.readLine(BufferedReader.java:324)\n    - locked &lt;0x00000000d632b928&gt; (a java.io.InputStreamReader)\n    at java.io.BufferedReader.readLine(BufferedReader.java:389)\n    at com.intellij.rt.execution.application.AppMainV2$1.run(AppMainV2.java:64)\n\n\"Attach Listener\" #5 daemon prio=5 os_prio=2 tid=0x0000000017781800 nid=0x524 runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Signal Dispatcher\" #4 daemon prio=9 os_prio=2 tid=0x000000001778f800 nid=0x1b08 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Finalizer\" #3 daemon prio=8 os_prio=1 tid=0x000000001776a800 nid=0xdac in Object.wait() [0x0000000018b6f000]\n   java.lang.Thread.State: WAITING (on object monitor)\n    at java.lang.Object.wait(Native Method)\n    - waiting on &lt;0x00000000d6108ec8&gt; (a java.lang.ref.ReferenceQueue$Lock)\n    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)\n    - locked &lt;0x00000000d6108ec8&gt; (a java.lang.ref.ReferenceQueue$Lock)\n    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)\n    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)\n\n\"Reference Handler\" #2 daemon prio=10 os_prio=2 tid=0x0000000017723800 nid=0x1670 in Object.wait() [0x00000000189ef000]\n   java.lang.Thread.State: WAITING (on object monitor)\n    at java.lang.Object.wait(Native Method)\n    - waiting on &lt;0x00000000d6106b68&gt; (a java.lang.ref.Reference$Lock)\n    at java.lang.Object.wait(Object.java:502)\n    at java.lang.ref.Reference.tryHandlePending(Reference.java:191)\n    - locked &lt;0x00000000d6106b68&gt; (a java.lang.ref.Reference$Lock)\n    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)\n\n\"VM Thread\" os_prio=2 tid=0x000000001771b800 nid=0x604 runnable \n\n\"GC task thread#0 (ParallelGC)\" os_prio=0 tid=0x0000000001c9d800 nid=0x9f0 runnable \n\n\"GC task thread#1 (ParallelGC)\" os_prio=0 tid=0x0000000001c9f000 nid=0x154c runnable \n\n\"GC task thread#2 (ParallelGC)\" os_prio=0 tid=0x0000000001ca0800 nid=0xcd0 runnable \n\n\"GC task thread#3 (ParallelGC)\" os_prio=0 tid=0x0000000001ca2000 nid=0x1e58 runnable \n\n\"VM Periodic Task Thread\" os_prio=2 tid=0x0000000018c5a000 nid=0x1b58 waiting on condition \n\nJNI global references: 33\n\n\n/* 此处可以看待死锁的相关信息！ */\nFound one Java-level deadlock:\n=============================\n\"Thread-1\":\n  waiting to lock monitor 0x0000000017729fc8 (object 0x00000000d629b4d8, a java.lang.Object),\n  which is held by \"Thread-0\"\n\"Thread-0\":\n  waiting to lock monitor 0x0000000017727738 (object 0x00000000d629b4e8, a java.lang.Object),\n  which is held by \"Thread-1\"\n\nJava stack information for the threads listed above:\n===================================================\n\"Thread-1\":\n    at com.leo.interview.SimpleDeadLock$B.run(SimpleDeadLock.java:56)\n    - waiting to lock &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n\"Thread-0\":\n    at com.leo.interview.SimpleDeadLock$A.run(SimpleDeadLock.java:34)\n    - waiting to lock &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n\nFound 1 deadlock.\n\n/* 内存使用状况，详情得看JVM方面的书 */\nHeap\n PSYoungGen      total 37888K, used 4590K [0x00000000d6100000, 0x00000000d8b00000, 0x0000000100000000)\n  eden space 32768K, 14% used [0x00000000d6100000,0x00000000d657b968,0x00000000d8100000)\n  from space 5120K, 0% used [0x00000000d8600000,0x00000000d8600000,0x00000000d8b00000)\n  to   space 5120K, 0% used [0x00000000d8100000,0x00000000d8100000,0x00000000d8600000)\n ParOldGen       total 86016K, used 0K [0x0000000082200000, 0x0000000087600000, 0x00000000d6100000)\n  object space 86016K, 0% used [0x0000000082200000,0x0000000082200000,0x0000000087600000)\n Metaspace       used 3474K, capacity 4500K, committed 4864K, reserved 1056768K\n  class space    used 382K, capacity 388K, committed 512K, reserved 1048576K\n</code></pre>\n\n<p><strong>19、为什么我们调用start()方法时会执行run()方法，为什么我们不能直接调用run()方法？</strong></p>\n\n<p>当你调用start()方法时你将创建新的线程，并且执行在run()方法里的代码。&nbsp;</p>\n\n<p>但是如果你直接调用run()方法，它不会创建新的线程也不会执行调用线程的代码，只会把run方法当作普通方法去执行。<br />\n<br />\n<strong>20、Java中你怎样唤醒一个阻塞的线程？</strong></p>\n\n<p>在Java发展史上曾经使用suspend()、resume()方法对于线程进行阻塞唤醒，但随之出现很多问题，比较典型的还是死锁问题。&nbsp;</p>\n\n<p>解决方案可以使用以对象为目标的阻塞，即利用Object类的wait()和notify()方法实现线程阻塞。&nbsp;</p>\n\n<p>首先，wait、notify方法是针对对象的，调用任意对象的wait()方法都将导致线程阻塞，阻塞的同时也将释放该对象的锁，相应地，调用任意对象的notify()方法则将随机解除该对象阻塞的线程，但它需要重新获取改对象的锁，直到获取成功才能往下执行；其次，wait、notify方法必须在synchronized块或方法中被调用，并且要保证同步块或方法的锁对象与调用wait、notify方法的对象是同一个，如此一来在调用wait之前当前线程就已经成功获取某对象的锁，执行wait阻塞后当前线程就将之前获取的对象锁释放。<br />\n<br />\n<strong>21、在Java中CycliBarriar和CountdownLatch有什么区别？</strong></p>\n\n<p>CyclicBarrier可以重复使用，而CountdownLatch不能重复使用。&nbsp;</p>\n\n<p>Java的concurrent包里面的CountDownLatch其实可以把它看作一个计数器，只不过这个计数器的操作是原子操作，同时只能有一个线程去操作这个计数器，也就是同时只能有一个线程去减这个计数器里面的值。&nbsp;</p>\n\n<p>你可以向CountDownLatch对象设置一个初始的数字作为计数值，任何调用这个对象上的await()方法都会阻塞，直到这个计数器的计数值被其他的线程减为0为止。&nbsp;</p>\n\n<p>所以在当前计数到达零之前，await 方法会一直受阻塞。之后，会释放所有等待的线程，await的所有后续调用都将立即返回。这种现象只出现一次&mdash;&mdash;计数无法被重置。如果需要重置计数，请考虑使用 CyclicBarrier。&nbsp;</p>\n\n<p>CountDownLatch的一个非常典型的应用场景是：有一个任务想要往下执行，但必须要等到其他的任务执行完毕后才可以继续往下执行。假如我们这个想要继续往下执行的任务调用一个CountDownLatch对象的await()方法，其他的任务执行完自己的任务后调用同一个CountDownLatch对象上的countDown()方法，这个调用await()方法的任务将一直阻塞等待，直到这个CountDownLatch对象的计数值减到0为止</p>\n\n<p>CyclicBarrier一个同步辅助类，它允许一组线程互相等待，直到到达某个公共屏障点 (common barrier point)。在涉及一组固定大小的线程的程序中，这些线程必须不时地互相等待，此时 CyclicBarrier 很有用。因为该 barrier 在释放等待线程后可以重用，所以称它为循环 的 barrier。<br />\n<br />\n<strong>22、什么是不可变对象，它对写并发应用有什么帮助？</strong></p>\n\n<p>不可变对象(Immutable Objects)即对象一旦被创建它的状态（对象的数据，也即对象属性值）就不能改变，反之即为可变对象(Mutable Objects)。&nbsp;</p>\n\n<p>不可变对象的类即为不可变类(Immutable Class)。Java平台类库中包含许多不可变类，如String、基本类型的包装类、BigInteger和BigDecimal等。&nbsp;</p>\n\n<p>不可变对象天生是线程安全的。它们的常量（域）是在构造函数中创建的。既然它们的状态无法修改，这些常量永远不会变。</p>\n\n<p>不可变对象永远是线程安全的。&nbsp;</p>\n\n<p>只有满足如下状态，一个对象才是不可变的；&nbsp;</p>\n\n<ul>\n	<li>\n	<p>它的状态不能在创建后再被修改；&nbsp;</p>\n	</li>\n	<li>\n	<p>所有域都是final类型；并且，&nbsp;</p>\n	</li>\n	<li>\n	<p>它被正确创建（创建期间没有发生this引用的逸出）。</p>\n	</li>\n</ul>\n\n<p><strong>23、什么是多线程中的上下文切换？</strong></p>\n\n<p>在上下文切换过程中，CPU会停止处理当前运行的程序，并保存当前程序运行的具体位置以便之后继续运行。从这个角度来看，上下文切换有点像我们同时阅读几本书，在来回切换书本的同时我们需要记住每本书当前读到的页码。在程序中，上下文切换过程中的&ldquo;页码&rdquo;信息是保存在进程控制块（PCB）中的。PCB还经常被称作&ldquo;切换桢&rdquo;（switchframe）。&ldquo;页码&rdquo;信息会一直保存到CPU的内存中，直到他们被再次使用。&nbsp;<br />\n上下文切换是存储和恢复CPU状态的过程，它使得线程执行能够从中断点恢复执行。上下文切换是多任务操作系统和多线程环境的基本特征。<br />\n<br />\n<strong>24、Java中用到的线程调度算法是什么？</strong></p>\n\n<p>计算机通常只有一个CPU,在任意时刻只能执行一条机器指令,每个线程只有获得CPU的使用权才能执行指令.所谓多线程的并发运行,其实是指从宏观上看,各个线程轮流获得CPU的使用权,分别执行各自的任务.在运行池中,会有多个处于就绪状态的线程在等待CPU,JAVA虚拟机的一项任务就是负责线程的调度,线程调度是指按照特定机制为多个线程分配CPU的使用权.</p>\n\n<p>有两种调度模型：分时调度模型和抢占式调度模型。&nbsp;</p>\n\n<p>分时调度模型是指让所有的线程轮流获得cpu的使用权,并且平均分配每个线程占用的CPU的时间片这个也比较好理解。</p>\n\n<p>java虚拟机采用抢占式调度模型，是指优先让可运行池中优先级高的线程占用CPU，如果可运行池中的线程优先级相同，那么就随机选择一个线程，使其占用CPU。处于运行状态的线程会一直运行，直至它不得不放弃CPU。</p>\n\n<p><strong>25、什么是线程组，为什么在Java中不推荐使用？</strong></p>\n\n<p>线程组和线程池是两个不同的概念，他们的作用完全不同，前者是为了方便线程的管理，后者是为了管理线程的生命周期，复用线程，减少创建销毁线程的开销。<br />\n<br />\n<strong>26、为什么使用Executor框架比使用应用创建和管理线程好？</strong></p>\n\n<p>为什么要使用Executor线程池框架&nbsp;</p>\n\n<ol>\n	<li>\n	<p>每次执行任务创建线程 new Thread()比较消耗性能，创建一个线程是比较耗时、耗资源的。&nbsp;</p>\n	</li>\n	<li>\n	<p>调用 new Thread()创建的线程缺乏管理，被称为野线程，而且可以无限制的创建，线程之间的相互竞争会导致过多占用系统资源而导致系统瘫痪，还有线程之间的频繁交替也会消耗很多系统资源。&nbsp;</p>\n	</li>\n	<li>\n	<p>直接使用new Thread() 启动的线程不利于扩展，比如定时执行、定期执行、定时定期执行、线程中断等都不便实现。</p>\n	</li>\n</ol>\n\n<p>使用Executor线程池框架的优点&nbsp;</p>\n\n<ol>\n	<li>\n	<p>能复用已存在并空闲的线程从而减少线程对象的创建从而减少了消亡线程的开销。&nbsp;</p>\n	</li>\n	<li>\n	<p>可有效控制最大并发线程数，提高系统资源使用率，同时避免过多资源竞争。&nbsp;</p>\n	</li>\n	<li>\n	<p>框架中已经有定时、定期、单线程、并发数控制等功能。&nbsp;</p>\n	</li>\n</ol>\n\n<p>综上所述使用线程池框架Executor能更好的管理线程、提供系统资源使用率。</p>\n\n<p><strong>27、java中有几种方法可以实现一个线程？</strong></p>\n\n<ul>\n	<li>\n	<p>继承 Thread 类</p>\n	</li>\n	<li>\n	<p>实现 Runnable 接口</p>\n	</li>\n	<li>\n	<p>实现 Callable 接口，需要实现的是 call() 方法</p>\n	</li>\n</ul>\n\n<p><strong>28、如何停止一个正在运行的线程？</strong></p>\n\n<ul>\n	<li>\n	<p>使用共享变量的方式&nbsp;</p>\n\n	<p>在这种方式中，之所以引入共享变量，是因为该变量可以被多个执行相同任务的线程用来作为是否中断的信号，通知中断线程的执行。</p>\n	</li>\n	<li>\n	<p>使用interrupt方法终止线程&nbsp;</p>\n\n	<p>如果一个线程由于等待某些事件的发生而被阻塞，又该怎样停止该线程呢？这种情况经常会发生，比如当一个线程由于需要等候键盘输入而被阻塞，或者调用Thread.join()方法，或者Thread.sleep()方法，在网络中调用ServerSocket.accept()方法，或者调用了DatagramSocket.receive()方法时，都有可能导致线程阻塞，使线程处于处于不可运行状态时，即使主程序中将该线程的共享变量设置为true，但该线程此时根本无法检查循环标志，当然也就无法立即中断。这里我们给出的建议是，不要使用stop()方法，而是使用Thread提供的interrupt()方法，因为该方法虽然不会中断一个正在运行的线程，但是它可以使一个被阻塞的线程抛出一个中断异常，从而使线程提前结束阻塞状态，退出堵塞代码。</p>\n	</li>\n</ul>\n\n<p><strong>29、notify()和notifyAll()有什么区别？</strong></p>\n\n<p>当一个线程进入wait之后，就必须等其他线程notify/notifyall,使用notifyall,可以唤醒所有处于wait状态的线程，使其重新进入锁的争夺队列中，而notify只能唤醒一个。</p>\n\n<p>如果没把握，建议notifyAll，防止notigy因为信号丢失而造成程序异常。</p>\n\n<p><strong>30、什么是Daemon线程？它有什么意义？</strong></p>\n\n<p>所谓后台(daemon)线程，是指在程序运行的时候在后台提供一种通用服务的线程，并且这个线程并不属于程序中不可或缺的部分。因此，当所有的非后台线程结束时，程序也就终止了，同时会杀死进程中的所有后台线程。</p>\n\n<p>反过来说， 只要有任何非后台线程还在运行，程序就不会终止。必须在线程启动之前调用setDaemon()方法，才能把它设置为后台线程。<strong>注意：</strong>后台进程在不执行finally子句的情况下就会终止其run()方法。</p>\n\n<p>比如：JVM的垃圾回收线程就是Daemon线程，Finalizer也是守护线程。</p>\n\n<p><strong>31、java如何实现多线程之间的通讯和协作？</strong></p>\n\n<p>中断和共享变量</p>\n\n<p><strong>32、什么是可重入锁（ReentrantLock）？</strong></p>\n\n<p>举例来说明锁的可重入性</p>\n\n<pre>\n<code class=\"language-java\">public class UnReentrant{\n    Lock lock = new Lock();\n    public void outer(){\n        lock.lock();\n        inner();\n        lock.unlock();\n    }\n    public void inner(){\n        lock.lock();\n        //do something\n        lock.unlock();\n    }\n}\n</code></pre>\n\n<p>outer中调用了inner，outer先锁住了lock，这样inner就不能再获取lock。其实调用outer的线程已经获取了lock锁，但是不能在inner中重复利用已经获取的锁资源，这种锁即称之为 不可重入可重入就意味着：线程可以进入任何一个它已经拥有的锁所同步着的代码块。</p>\n\n<p>synchronized、ReentrantLock都是可重入的锁，可重入锁相对来说简化了并发编程的开发。</p>\n\n<p><strong>33、当一个线程进入某个对象的一个synchronized的实例方法后，其它线程是否可进入此对象的其它方法？</strong></p>\n\n<p>如果其他方法没有synchronized的话，其他线程是可以进入的。</p>\n\n<p>所以要开放一个线程安全的对象时，得保证每个方法都是线程安全的。</p>\n\n<p><strong>34、乐观锁和悲观锁的理解及如何实现，有哪些实现方式？</strong></p>\n\n<p><strong>悲观锁：</strong>总是假设最坏的情况，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会阻塞直到它拿到锁。传统的关系型数据库里边就用到了很多这种锁机制，比如行锁，表锁等，读锁，写锁等，都是在做操作之前先上锁。再比如Java里面的同步原语synchronized关键字的实现也是悲观锁。</p>\n\n<p><strong>乐观锁：</strong>顾名思义，就是很乐观，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。乐观锁适用于多读的应用类型，这样可以提高吞吐量，像数据库提供的类似于write_condition机制，其实都是提供的乐观锁。在Java中java.util.concurrent.atomic包下面的原子变量类就是使用了乐观锁的一种实现方式CAS实现的。</p>\n\n<p>乐观锁的实现方式：&nbsp;</p>\n\n<ul>\n	<li>\n	<p>使用版本标识来确定读到的数据与提交时的数据是否一致。提交后修改版本标识，不一致时可以采取丢弃和再次尝试的策略。&nbsp;</p>\n	</li>\n	<li>\n	<p>java中的Compare and Swap即CAS ，当多个线程尝试使用CAS同时更新同一个变量时，只有其中一个线程能更新变量的值，而其它线程都失败，失败的线程并不会被挂起，而是被告知这次竞争中失败，并可以再次尝试。　CAS 操作中包含三个操作数 &mdash;&mdash; 需要读写的内存位置（V）、进行比较的预期原值（A）和拟写入的新值(B)。如果内存位置V的值与预期原值A相匹配，那么处理器会自动将该位置值更新为新值B。否则处理器不做任何操作。</p>\n	</li>\n</ul>\n\n<p>CAS缺点：&nbsp;&nbsp;</p>\n\n<ul>\n	<li>\n	<p><strong>ABA问题：</strong>&nbsp;</p>\n\n	<p>比如说一个线程one从内存位置V中取出A，这时候另一个线程two也从内存中取出A，并且two进行了一些操作变成了B，然后two又将V位置的数据变成A，这时候线程one进行CAS操作发现内存中仍然是A，然后one操作成功。尽管线程one的CAS操作成功，但可能存在潜藏的问题。从Java1.5开始JDK的atomic包里提供了一个类AtomicStampedReference来解决ABA问题。&nbsp;</p>\n	</li>\n	<li>\n	<p><strong>循环时间长开销大：&nbsp;</strong></p>\n\n	<p>对于资源竞争严重（线程冲突严重）的情况，CAS自旋的概率会比较大，从而浪费更多的CPU资源，效率低于synchronized。&nbsp;</p>\n	</li>\n	<li>\n	<p><strong>只能保证一个共享变量的原子操作：&nbsp;</strong></p>\n\n	<p>当对一个共享变量执行操作时，我们可以使用循环CAS的方式来保证原子操作，但是对多个共享变量操作时，循环CAS就无法保证操作的原子性，这个时候就可以用锁。</p>\n	</li>\n</ul>\n\n<p><strong>35、SynchronizedMap和ConcurrentHashMap有什么区别？</strong></p>\n\n<p>SynchronizedMap一次锁住整张表来保证线程安全，所以每次只能有一个线程来访为map。</p>\n\n<p>ConcurrentHashMap使用分段锁来保证在多线程下的性能。ConcurrentHashMap中则是一次锁住一个桶。ConcurrentHashMap默认将hash表分为16个桶，诸如get,put,remove等常用操作只锁当前需要用到的桶。这样，原来只能一个线程进入，现在却能同时有16个写线程执行，并发性能的提升是显而易见的。&nbsp;</p>\n\n<p>另外ConcurrentHashMap使用了一种不同的迭代方式。在这种迭代方式中，当iterator被创建后集合再发生改变就不再是抛出ConcurrentModificationException，取而代之的是在改变时new新的数据从而不影响原有的数据 ，iterator完成后再将头指针替换为新的数据 ，这样iterator线程可以使用原来老的数据，而写线程也可以并发的完成改变。</p>\n\n<p><strong>36、CopyOnWriteArrayList可以用于什么应用场景？</strong></p>\n\n<p>CopyOnWriteArrayList(免锁容器)的好处之一是当多个迭代器同时遍历和修改这个列表时，不会抛出ConcurrentModificationException。在CopyOnWriteArrayList中，写入将导致创建整个底层数组的副本，而源数组将保留在原地，使得复制的数组在被修改时，读取操作可以安全地执行。</p>\n\n<ol>\n	<li>\n	<p>由于写操作的时候，需要拷贝数组，会消耗内存，如果原数组的内容比较多的情况下，可能导致young gc或者full gc；&nbsp;</p>\n	</li>\n	<li>\n	<p>不能用于实时读的场景，像拷贝数组、新增元素都需要时间，所以调用一个set操作后，读取到数据可能还是旧的,虽然CopyOnWriteArrayList 能做到最终一致性,但是还是没法满足实时性要求；</p>\n	</li>\n</ol>\n\n<p>CopyOnWriteArrayList透露的思想&nbsp;</p>\n\n<ul>\n	<li>\n	<p>读写分离，读和写分开&nbsp;</p>\n	</li>\n	<li>\n	<p>最终一致性&nbsp;</p>\n	</li>\n	<li>\n	<p>使用另外开辟空间的思路，来解决并发冲突</p>\n	</li>\n</ul>\n\n<p><strong>37、什么叫线程安全？servlet是线程安全吗?</strong></p>\n\n<p>线程安全是编程中的术语，指某个函数、函数库在多线程环境中被调用时，能够正确地处理多个线程之间的共享变量，使程序功能正确完成。</p>\n\n<p>Servlet不是线程安全的，servlet是单实例多线程的，当多个线程同时访问同一个方法，是不能保证共享变量的线程安全性的。&nbsp;</p>\n\n<p>Struts2的action是多实例多线程的，是线程安全的，每个请求过来都会new一个新的action分配给这个请求，请求完成后销毁。&nbsp;</p>\n\n<p>SpringMVC的Controller是线程安全的吗？不是的，和Servlet类似的处理流程</p>\n\n<p>Struts2好处是不用考虑线程安全问题；Servlet和SpringMVC需要考虑线程安全问题，但是性能可以提升不用处理太多的gc，可以使用ThreadLocal来处理多线程的问题。</p>\n\n<p><strong>38、volatile有什么用？能否用一句话说明下volatile的应用场景？</strong></p>\n\n<p>volatile保证内存可见性和禁止指令重排。</p>\n\n<p>volatile用于多线程环境下的单次操作(单次读或者单次写)。</p>\n\n<p><strong>39、为什么代码会重排序？</strong></p>\n\n<p>在执行程序时，为了提供性能，处理器和编译器常常会对指令进行重排序，但是不能随意重排序，不是你想怎么排序就怎么排序，它需要满足以下两个条件：</p>\n\n<ul>\n	<li>\n	<p>在单线程环境下不能改变程序运行的结果；</p>\n	</li>\n	<li>\n	<p>存在数据依赖关系的不允许重排序</p>\n	</li>\n</ul>\n\n<p>需要注意的是：重排序不会影响单线程环境的执行结果，但是会破坏多线程的执行语义。</p>\n\n<p><strong>40、在java中wait和sleep方法的不同？</strong></p>\n\n<p>最大的不同是在等待时wait会释放锁，而sleep一直持有锁。Wait通常被用于线程间交互，sleep通常被用于暂停执行。</p>\n\n<p>直接了解的深入一点吧：&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546140795296.png\" style=\"height:410px; width:616px\" /></p>\n\n<p>在Java中线程的状态一共被分成6种：</p>\n\n<p><strong>初始态：NEW</strong></p>\n\n<p>创建一个Thread对象，但还未调用start()启动线程时，线程处于初始态。</p>\n\n<p><strong>运行态：RUNNABLE&nbsp;</strong></p>\n\n<p>在Java中，运行态包括就绪态和运行态。&nbsp;</p>\n\n<p>就绪态该状态下的线程已经获得执行所需的所有资源，只要CPU分配执行权就能运行。所有就绪态的线程存放在就绪队列中。&nbsp;</p>\n\n<p>运行态获得CPU执行权，正在执行的线程。由于一个CPU同一时刻只能执行一条线程，因此每个CPU每个时刻只有一条运行态的线程。</p>\n\n<p><strong>阻塞态</strong></p>\n\n<p>当一条正在执行的线程请求某一资源失败时，就会进入阻塞态。而在Java中，阻塞态专指请求锁失败时进入的状态。由一个阻塞队列存放所有阻塞态的线程。处于阻塞态的线程会不断请求资源，一旦请求成功，就会进入就绪队列，等待执行。PS：锁、IO、Socket等都资源。</p>\n\n<p><strong>等待态</strong></p>\n\n<p>当前线程中调用wait、join、park函数时，当前线程就会进入等待态。也有一个等待队列存放所有等待态的线程。线程处于等待态表示它需要等待其他线程的指示才能继续运行。进入等待态的线程会释放CPU执行权，并释放资源（如：锁）</p>\n\n<p><strong>超时等待态</strong></p>\n\n<p>当运行中的线程调用sleep(time)、wait、join、parkNanos、parkUntil时，就会进入该状态；它和等待态一样，并不是因为请求不到资源，而是主动进入，并且进入后需要其他线程唤醒；进入该状态后释放CPU执行权 和 占有的资源。与等待态的区别：到了超时时间后自动进入阻塞队列，开始竞争锁。</p>\n\n<p><strong>终止态</strong></p>\n\n<p>线程执行结束后的状态。</p>\n\n<p><strong>注意：</strong></p>\n\n<ul>\n	<li>\n	<p>wait()方法会释放CPU执行权 和 占有的锁。</p>\n	</li>\n	<li>\n	<p>sleep(long)方法仅释放CPU使用权，锁仍然占用；线程被放入超时等待队列，与yield相比，它会使线程较长时间得不到运行。</p>\n	</li>\n	<li>\n	<p>yield()方法仅释放CPU执行权，锁仍然占用，线程会被放入就绪队列，会在短时间内再次执行。</p>\n	</li>\n	<li>\n	<p>wait和notify必须配套使用，即必须使用同一把锁调用；</p>\n	</li>\n	<li>\n	<p>wait和notify必须放在一个同步块中调用wait和notify的对象必须是他们所处同步块的锁对象。</p>\n	</li>\n</ul>\n\n<p><strong>41、一个线程运行时发生异常会怎样？</strong></p>\n\n<p>如果异常没有被捕获该线程将会停止执行。Thread.UncaughtExceptionHandler是用于处理未捕获异常造成线程突然中断情况的一个内嵌接口。当一个未捕获异常将造成线程中断的时候JVM会使用Thread.getUncaughtExceptionHandler()来查询线程的UncaughtExceptionHandler并将线程和异常作为参数传递给handler的uncaughtException()方法进行处理。</p>\n\n<p><strong>42、如何在两个线程间共享数据？</strong></p>\n\n<p>在两个线程间共享变量即可实现共享。&nbsp;</p>\n\n<p>一般来说，共享变量要求变量本身是线程安全的，然后在线程内使用的时候，如果有对共享变量的复合操作，那么也得保证复合操作的线程安全性。</p>\n\n<p><strong>43、Java中notify 和 notifyAll有什么区别？</strong></p>\n\n<p>notify() 方法不能唤醒某个具体的线程，所以只有一个线程在等待的时候它才有用武之地。而notifyAll()唤醒所有线程并允许他们争夺锁确保了至少有一个线程能继续运行。</p>\n\n<p><strong>44、为什么wait, notify 和 notifyAll这些方法不在thread类里面？</strong></p>\n\n<p>一个很明显的原因是JAVA提供的锁是对象级的而不是线程级的，每个对象都有锁，通过线程获得。由于wait，notify和notifyAll都是锁级别的操作，所以把他们定义在Object类中因为锁属于对象。</p>\n\n<p><strong>45、什么是ThreadLocal变量？</strong></p>\n\n<p>ThreadLocal是Java里一种特殊的变量。每个线程都有一个ThreadLocal就是每个线程都拥有了自己独立的一个变量，竞争条件被彻底消除了。它是为创建代价高昂的对象获取线程安全的好方法，比如你可以用ThreadLocal让SimpleDateFormat变成线程安全的，因为那个类创建代价高昂且每次调用都需要创建不同的实例所以不值得在局部范围使用它，如果为每个线程提供一个自己独有的变量拷贝，将大大提高效率。首先，通过复用减少了代价高昂的对象的创建个数。其次，你在没有使用高代价的同步或者不变性的情况下获得了线程安全。</p>\n\n<p><strong>46、Java中interrupted 和 isInterrupted方法的区别？</strong></p>\n\n<p><strong>interrupt&nbsp;</strong></p>\n\n<p>interrupt方法用于中断线程。调用该方法的线程的状态为将被置为&rdquo;中断&rdquo;状态。&nbsp;<br />\n注意：线程中断仅仅是置线程的中断状态位，不会停止线程。需要用户自己去监视线程的状态为并做处理。支持线程中断的方法（也就是线程中断后会抛出interruptedException的方法）就是在监视线程的中断状态，一旦线程的中断状态被置为&ldquo;中断状态&rdquo;，就会抛出中断异常。</p>\n\n<p><strong>interrupted&nbsp;</strong></p>\n\n<p>查询当前线程的中断状态，并且清除原状态。如果一个线程被中断了，第一次调用interrupted则返回true，第二次和后面的就返回false了。</p>\n\n<p><strong>isInterrupted&nbsp;</strong></p>\n\n<p>仅仅是查询当前线程的中断状态</p>\n\n<p><strong>47、为什么wait和notify方法要在同步块中调用？</strong></p>\n\n<p>Java API强制要求这样做，如果你不这么做，你的代码会抛出IllegalMonitorStateException异常。还有一个原因是为了避免wait和notify之间产生竞态条件。</p>\n\n<p><strong>48、为什么你应该在循环中检查等待条件?</strong></p>\n\n<p>处于等待状态的线程可能会收到错误警报和伪唤醒，如果不在循环中检查等待条件，程序就会在没有满足结束条件的情况下退出。</p>\n\n<p><strong>49、Java中的同步集合与并发集合有什么区别？</strong></p>\n\n<p>同步集合与并发集合都为多线程和并发提供了合适的线程安全的集合，不过并发集合的可扩展性更高。在Java1.5之前程序员们只有同步集合来用且在多线程并发的时候会导致争用，阻碍了系统的扩展性。Java5介绍了并发集合像ConcurrentHashMap，不仅提供线程安全还用锁分离和内部分区等现代技术提高了可扩展性。</p>\n\n<p><strong>50、什么是线程池？ 为什么要使用它？</strong></p>\n\n<p>创建线程要花费昂贵的资源和时间，如果任务来了才创建线程那么响应时间会变长，而且一个进程能创建的线程数有限。为了避免这些问题，在程序启动的时候就创建若干线程来响应处理，它们被称为线程池，里面的线程叫工作线程。从JDK1.5开始，Java API提供了Executor框架让你可以创建不同的线程池。</p>\n\n<p><strong>51、怎么检测一个线程是否拥有锁？</strong></p>\n\n<p>在java.lang.Thread中有一个方法叫holdsLock()，它返回true如果当且仅当当前线程拥有某个具体对象的锁。<br />\n<br />\n<strong>52、你如何在Java中获取线程堆栈？</strong></p>\n\n<ul>\n	<li>\n	<p>kill -3 [java pid]&nbsp;</p>\n\n	<p>不会在当前终端输出，它会输出到代码执行的或指定的地方去。比如，kill -3 tomcat pid, 输出堆栈到log目录下。</p>\n	</li>\n	<li>\n	<p>Jstack [java pid]&nbsp;</p>\n\n	<p>这个比较简单，在当前终端显示，也可以重定向到指定文件中。&nbsp;</p>\n\n	<p>-JvisualVM：Thread Dump&nbsp;</p>\n\n	<p>不做说明，打开JvisualVM后，都是界面操作，过程还是很简单的。</p>\n	</li>\n</ul>\n\n<p><strong>53、JVM中哪个参数是用来控制线程的栈堆栈小的?</strong></p>\n\n<p>-Xss 每个线程的栈大小</p>\n\n<p><strong>54、Thread类中的yield方法有什么作用？</strong></p>\n\n<p>使当前线程从执行状态（运行状态）变为可执行态（就绪状态）。</p>\n\n<p>当前线程到了就绪状态，那么接下来哪个线程会从就绪状态变成执行状态呢？可能是当前线程，也可能是其他线程，看系统的分配了。</p>\n\n<p><strong>55、Java中ConcurrentHashMap的并发度是什么？</strong></p>\n\n<p>ConcurrentHashMap把实际map划分成若干部分来实现它的可扩展性和线程安全。这种划分是使用并发度获得的，它是ConcurrentHashMap类构造函数的一个可选参数，默认值为16，这样在多线程情况下就能避免争用。</p>\n\n<p>在JDK8后，它摒弃了Segment（锁段）的概念，而是启用了一种全新的方式实现,利用CAS算法。同时加入了更多的辅助变量来提高并发度，具体内容还是查看源码吧。</p>\n\n<p><strong>56、Java中Semaphore是什么？</strong></p>\n\n<p>Java中的Semaphore是一种新的同步类，它是一个计数信号。从概念上讲，从概念上讲，信号量维护了一个许可集合。如有必要，在许可可用前会阻塞每一个 acquire()，然后再获取该许可。每个 release()添加一个许可，从而可能释放一个正在阻塞的获取者。但是，不使用实际的许可对象，Semaphore只对可用许可的号码进行计数，并采取相应的行动。信号量常常用于多线程的代码中，比如数据库连接池。</p>\n\n<p><strong>57、Java线程池中submit() 和 execute()方法有什么区别？</strong></p>\n\n<p>两个方法都可以向线程池提交任务，execute()方法的返回类型是void，它定义在Executor接口中。</p>\n\n<p>而submit()方法可以返回持有计算结果的Future对象，它定义在ExecutorService接口中，它扩展了Executor接口，其它线程池类像ThreadPoolExecutor和ScheduledThreadPoolExecutor都有这些方法。</p>\n\n<p><strong>58、什么是阻塞式方法？</strong></p>\n\n<p>阻塞式方法是指程序会一直等待该方法完成期间不做其他事情，ServerSocket的accept()方法就是一直等待客户端连接。这里的阻塞是指调用结果返回之前，当前线程会被挂起，直到得到结果之后才会返回。此外，还有异步和非阻塞式方法在任务完成前就返回。</p>\n\n<p><strong>59、Java中的ReadWriteLock是什么？</strong></p>\n\n<p>读写锁是用来提升并发程序性能的锁分离技术的成果。</p>\n\n<p><strong>60、volatile 变量和 atomic 变量有什么不同？</strong></p>\n\n<p>Volatile变量可以确保先行关系，即写操作会发生在后续的读操作之前, 但它并不能保证原子性。例如用volatile修饰count变量那么 count++ 操作就不是原子性的。</p>\n\n<p>而AtomicInteger类提供的atomic方法可以让这种操作具有原子性如getAndIncrement()方法会原子性的进行增量操作把当前值加一，其它数据类型和引用变量也可以进行相似操作。</p>\n\n<p><strong>61、可以直接调用Thread类的run ()方法么？</strong></p>\n\n<p>当然可以。但是如果我们调用了Thread的run()方法，它的行为就会和普通的方法一样，会在当前线程中执行。为了在新的线程中执行我们的代码，必须使用Thread.start()方法。</p>\n\n<p><strong>62、如何让正在运行的线程暂停一段时间？</strong></p>\n\n<p>我们可以使用Thread类的Sleep()方法让线程暂停一段时间。需要注意的是，这并不会让线程终止，一旦从休眠中唤醒线程，线程的状态将会被改变为Runnable，并且根据线程调度，它将得到执行。</p>\n\n<p><strong>63、你对线程优先级的理解是什么？</strong></p>\n\n<p>每一个线程都是有优先级的，一般来说，高优先级的线程在运行时会具有优先权，但这依赖于线程调度的实现，这个实现是和操作系统相关的(OS dependent)。我们可以定义线程的优先级，但是这并不能保证高优先级的线程会在低优先级的线程前执行。线程优先级是一个int变量(从1-10)，1代表最低优先级，10代表最高优先级。</p>\n\n<p>java的线程优先级调度会委托给操作系统去处理，所以与具体的操作系统优先级有关，如非特别需要，一般无需设置线程优先级。</p>\n\n<p><strong>64、什么是线程调度器(Thread Scheduler)和时间分片(Time Slicing )？</strong></p>\n\n<p>线程调度器是一个操作系统服务，它负责为Runnable状态的线程分配CPU时间。一旦我们创建一个线程并启动它，它的执行便依赖于线程调度器的实现。&nbsp;<br />\n同上一个问题，线程调度并不受到Java虚拟机控制，所以由应用程序来控制它是更好的选择（也就是说不要让你的程序依赖于线程的优先级）。</p>\n\n<p>时间分片是指将可用的CPU时间分配给可用的Runnable线程的过程。分配CPU时间可以基于线程优先级或者线程等待的时间。</p>\n\n<p><strong>65、你如何确保main()方法所在的线程是Java 程序最后结束的线程？</strong></p>\n\n<p>我们可以使用Thread类的join()方法来确保所有程序创建的线程在main()方法退出前结束。</p>\n\n<p><strong>66、线程之间是如何通信的？</strong></p>\n\n<p>当线程间是可以共享资源时，线程间通信是协调它们的重要的手段。Object类中wait()\\notify()\\notifyAll()方法可以用于线程间通信关于资源的锁的状态。</p>\n\n<p><strong>67、为什么线程通信的方法wait(), notify()和notifyAll()被定义在Object 类里？</strong></p>\n\n<p>Java的每个对象中都有一个锁(monitor，也可以成为监视器) 并且wait()，notify()等方法用于等待对象的锁或者通知其他线程对象的监视器可用。在Java的线程中并没有可供任何对象使用的锁和同步器。这就是为什么这些方法是Object类的一部分，这样Java的每一个类都有用于线程间通信的基本方法。</p>\n\n<p><strong>68、为什么wait(), notify()和notifyAll ()必须在同步方法或者同步块中被调用？</strong></p>\n\n<p>当一个线程需要调用对象的wait()方法的时候，这个线程必须拥有该对象的锁，接着它就会释放这个对象锁并进入等待状态直到其他线程调用这个对象上的notify()方法。同样的，当一个线程需要调用对象的notify()方法时，它会释放这个对象的锁，以便其他在等待的线程就可以得到这个对象锁。由于所有的这些方法都需要线程持有对象的锁，这样就只能通过同步来实现，所以他们只能在同步方法或者同步块中被调用。</p>\n\n<p><strong>69、为什么Thread类的sleep()和yield ()方法是静态的？</strong></p>\n\n<p>Thread类的sleep()和yield()方法将在当前正在执行的线程上运行。所以在其他处于等待状态的线程上调用这些方法是没有意义的。这就是为什么这些方法是静态的。它们可以在当前正在执行的线程中工作，并避免程序员错误的认为可以在其他非运行线程调用这些方法。</p>\n\n<p><strong>70、如何确保线程安全？</strong></p>\n\n<p>在Java中可以有很多方法来保证线程安全&mdash;&mdash;同步，使用原子类(atomic concurrent classes)，实现并发锁，使用volatile关键字，使用不变类和线程安全类。</p>\n\n<p><strong>71、同步方法和同步块，哪个是更好的选择？</strong></p>\n\n<p>同步块是更好的选择，因为它不会锁住整个对象（当然你也可以让它锁住整个对象）。同步方法会锁住整个对象，哪怕这个类中有多个不相关联的同步块，这通常会导致他们停止执行并需要等待获得这个对象上的锁。</p>\n\n<p>同步块更要符合开放调用的原则，只在需要锁住的代码块锁住相应的对象，这样从侧面来说也可以避免死锁。</p>\n\n<p><strong>72、如何创建守护线程？</strong></p>\n\n<p>使用Thread类的setDaemon(true)方法可以将线程设置为守护线程，需要注意的是，需要在调用start()方法前调用这个方法，否则会抛出IllegalThreadStateException异常。</p>\n\n<p><strong>73、什么是Java Timer 类？如何创建一个有特定时间间隔的任务？</strong></p>\n\n<p>java.util.Timer是一个工具类，可以用于安排一个线程在未来的某个特定时间执行。Timer类可以用安排一次性任务或者周期任务。&nbsp;</p>\n\n<p>java.util.TimerTask是一个实现了Runnable接口的抽象类，我们需要去继承这个类来创建我们自己的定时任务并使用Timer去安排它的执行。&nbsp;</p>\n\n<p>目前有开源的Qurtz可以用来创建定时任务。</p>\n\n<p>本文来自：https://blog.csdn.net/qq_34039315/article/details/7854931</p>\n','7e0e93ea6cdb44ae92e58f48e6496ed7,ca928e8718654aa5a802e2f69277b137',1,0,'16018de3271d4c5fbafb03c1b342fb82',1,'2018-12-30 11:34:04','2018-12-30 11:34:04',NULL,'1','陌溪_','蘑菇博客','e60df954efcd47c48463a504bb70bbe9',0),('8a7a023fb6094a388dff50e478f295a9','RabbitMQ常用操作','RabbitMQ常用操作','<pre>\n<code>#Rabbit启动\n\nservice rabbitmq-server start\n\n#Rabbit关闭\n\nservice rabbitmq-server stop\n\n#Rabbit重启\n\nservice rabbitmq-server restart\n\n#设置开启启动\n\nchkconfig rabbitmq-server on\n\n#开启web界面管理工具\n\nrabbitmq-plugins enable rabbitmq_management</code></pre>\n\n<p>&nbsp;</p>\n','1c76b9848f5f4d71a5e88b20dbaf38f4',1,0,'1d067e9a0ff74faf9519995e64ecfdef',1,'2018-10-25 20:42:21','2018-10-25 20:42:21',NULL,'1','陌溪_','蘑菇博客','093d8bdd01c84890a928e923d5c235fe',0),('995e0fccd2b240aabd56a10a688e42d4','蘑菇博客配置RabbitMQ','蘑菇博客配置RabbitMQ','<p>这里我主要介绍的是蘑菇博客RabbitMQ需要如何安装和配置。</p>\n\n<p>首先需要安装Erlang，因为我的是64位，所以下载的是64位的安装包。</p>\n\n<p>http://www.erlang.org/downloads</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898213596.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898213596.png\" style=\"height:243px; width:554px\" /></p>\n\n<p>这里有一个特别注意的是，如果你原来有安装后，一定要使用360清理掉注册表，不然会安装后启动不了可视化界面的，之前我就是因为这个原因，一直失败。</p>\n\n<p>下载成功后，直接傻瓜式安装就行了，这里我就不提太多的安装步骤了。</p>\n\n<p>然后就是RabbitMQ的安装</p>\n\n<p>首先进入RabbitMQ官网，下载最新的RabbitMQ安装包&nbsp;&nbsp;http://www.rabbitmq.com/install-windows.html</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898385182.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898385182.png\" style=\"height:152px; width:554px\" /></p>\n\n<p>下载好了后，也是傻瓜式安装步骤，需要注意就是应该先安装Erlang后，才能够安装RabbitMQ，因为RabbitMQ是基于Eralng语言开发的。</p>\n\n<p>安装好后，启动RabbitMQ Server</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898510293.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898510293.png\" style=\"height:623px; width:379px\" /></p>\n\n<p>然后本地输入&nbsp;http://localhost:15672</p>\n\n<p>会打开图形化管理页面，账号和密码都是&nbsp; guest</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898558218.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898558218.png\" style=\"height:263px; width:553px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>登录后，我们首先需要配置交换机</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898620061.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898620061.png\" style=\"height:257px; width:554px\" /></p>\n\n<p>在下方我们能看到在 Exchanges选项卡的下方，我们能看到 Add a new exchange的按钮</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898701072.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898701072.png\" style=\"height:214px; width:554px\" /></p>\n\n<p>输入以下内容，点击&nbsp; Add exchange就配置好了。</p>\n\n<p>然后我们在配置 Queues队列</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898768504.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898768504.png\" style=\"height:285px; width:554px\" /></p>\n\n<p>队列的配置也是，需要配置三个， mogu.blog&nbsp; &nbsp;mogu.email&nbsp; &nbsp;mogu.sms这三个，步骤和刚刚交换机配置差不多。</p>\n\n<p>最后就是给交换机绑定我们添加的队列了。</p>\n\n<p>我们点击 exchange.direct</p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898845971.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898845971.png\" style=\"height:368px; width:554px\" /></p>\n\n<p><img alt=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898914615.png\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543898914615.png\" style=\"height:354px; width:553px\" /></p>\n\n<p>&nbsp; &nbsp; &nbsp;我们按照上面的三个，依次绑定好久大功告成了！</p>\n\n<p>&nbsp;</p>\n','1c76b9848f5f4d71a5e88b20dbaf38f4',0,0,'1d067e9a0ff74faf9519995e64ecfdef',1,'2018-12-04 12:51:45','2018-12-04 12:51:45',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('9b793e1ef4164f69a77f329dcce08ce4','如何让STS的Console不切换','如何让STS的Console不切换','<p>最近在使用STS进行微服务架构开发的时候，因为同时启动了多个项目，但我在某个项目进行DEBUG查看的时候，控制台console一会又切换到其他地方去了，每次换来换去，非常麻烦！</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540279747955.png\" style=\"height:79px; width:600px\" /></p>\n\n<p>上图就是启动的项目，其中eureka是用于服务发现，每个10多秒就会发送一个心跳包进行控制台输出。</p>\n\n<p>解决方法：</p>\n\n<p>1、在上方菜单栏中，找到 windown -&gt; Preferences -&gt; Run/Debug -&gt; Console</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540280176183.png\" style=\"height:531px; width:600px\" /></p>\n\n<p>2、将上述的两个&radic;取消掉，就不跳转了。</p>\n\n<p>上面两个选项的意思是指：当程序有输出或者错误的时候显示，所以每次当某个项目有输出的时候，就会切换。</p>\n\n<p>&nbsp;</p>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',1,0,'282f7a1ae2594c09b296daaa961313e3',1,'2018-10-23 15:39:06','2018-10-23 15:39:06',NULL,'1','陌溪_','蘑菇博客','093d8bdd01c84890a928e923d5c235fe',0),('9d45e0687cd84d4d878d71a168870553','关于使用@RequestBody出现JSON日期转换的问题','关于使用@RequestBody出现JSON日期转换的问题','<p>原因：主要问题就是实体类的Date转化Json过程出现错误，</p>\n\n<p>请求数据格式为：&nbsp;&#39;yyyy-MM-dd HH:mm:ss&#39;,但是在接收到数据的时候，需要通过jackson把数据转化成userDto对象。jackson转化的时候，默认的时间格式是&nbsp;&#39;yyyy-MM-dd&#39;T&#39;HH:mm:ss.SSS&rsquo;,所以就会出现上面的异常。</p>\n\n<p>方法： 在时间类上加入这两个注解就OK了</p>\n\n<p>@DateTimeFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</p>\n\n<p>@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</p>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',0,0,'371c9ed84b5f42bfa329dbbf4bcff917',1,'2018-10-23 15:50:50','2018-10-23 15:50:50',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('a0679b64e4ca4a7cbc8eab2f263b1dc9','CKeditor如何设置代码高亮','CKeditor如何设置代码高亮','<p>CKeditor如何设置代码高亮</p>\n\n<p>今天在看别人的写的博客的时候，发现别人的代码都是有代码高亮显示的。因为博客目前使用的是CKEditor，仔细观察了一波，上面是没有用于代码高亮的选项。</p>\n\n<p>&nbsp;</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541334603721.png\" style=\"height:119px; width:646px\" /></p>\n\n<p>后面进过查找相关的博客，发现我们需要配置相关的插件后才能使用。因为我当初下载的CKEditor是完整版本的，包含全部的插件内容，所以只需要在config.js里面进行配置即可</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;<em>// codesnippet: </em><em>代码块</em><em> </em></p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;config.extraPlugins = &#39;codesnippet&#39;;</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;<em>//</em><em>配置代码块风格</em></p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;codeSnippet_theme: &#39;zenburn&#39;;</p>\n\n<p>&nbsp;</p>\n\n<p>这里zenburn是黑色风格的，不配置的话是默认default风格。</p>\n\n<p>配置好了后，重新启动相关，发现在菜单栏中多了一个按钮</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541334627112.png\" style=\"height:131px; width:656px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>我们点击后，就能弹出代码段的窗口，</p>\n\n<p>&nbsp;</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541334635653.png\" style=\"height:688px; width:821px\" /></p>\n\n<p>最后就能插入代码上去了！</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541334662454.png\" style=\"height:703px; width:748px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>好了，到这里CKEditor已经支持高亮显示了。但是还有一个问题就是，我们前端页面还不能正常显示高亮，所以还需要下一步进行配置。</p>\n\n<p>首先我们需要下载一个highlight的js文件</p>\n\n<p><a href=\"https://highlightjs.org/\" target=\"_blank\">https://highlightjs.org/</a></p>\n\n<p>进去这个网站后，选择常用语言，然后点击download</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541334678680.png\" style=\"height:230px; width:796px\" /></p>\n\n<p>解压完成后会有两个文件</p>\n\n<p>&nbsp;</p>\n\n<p>Styles中存放的是一些样式</p>\n\n<p>Highlight.pack.js 是决定那部分变色</p>\n\n<p>&nbsp;</p>\n\n<p>最后我们需要把文件放到我们的前端vue项目中，然后在index.html中引入</p>\n\n<p>&nbsp;</p>\n\n<p><em>&lt;!--</em><em>引入代码高亮</em><em>--&gt;</em></p>\n\n<p><em>&lt;!--</em><em>开头这里的样式为默认的风格，可以根据自己的喜好更换风格</em><em>--&gt;</em></p>\n\n<p><em>&lt;!--</em><em>我的高亮效果是</em><em>zenburn--&gt;</em></p>\n\n<p>&lt;link rel=&quot;stylesheet&quot; href=&quot;static/highlight/styles/zenburn.css&quot;&gt;</p>\n\n<p>&lt;script src=&#39;static/highlight/highlight.pack.js&#39; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</p>\n\n<p>&nbsp;</p>\n\n<p>然后在main.js中加入这句</p>\n\n<p>&nbsp;</p>\n\n<p>Vue.directive(&#39;highlight&#39;, <strong>function</strong> (el) {</p>\n\n<p>&nbsp; <strong>let</strong> blocks = el.querySelectorAll(&#39;pre code&#39;);</p>\n\n<p>&nbsp; blocks.forEach((block)<strong>=&gt;</strong>{</p>\n\n<p>&nbsp;&nbsp;&nbsp; hljs.highlightBlock(block)</p>\n\n<p>&nbsp; })</p>\n\n<p>})</p>\n\n<p>&nbsp;</p>\n\n<p>最后一步就是渲染的时候，我们使用标签</p>\n\n<p>#在要使用高亮的地方使用v-highlight指令</p>\n\n<p>&lt;div v-html=&quot;Marked&quot; v-highlight&gt;</p>\n\n<p>&lt;/div&gt;</p>\n\n<p>&nbsp;</p>\n','a9a747d944c24845815356f72723ef8e',0,0,'4f016786d65a4abe83cb12b14a576948',1,'2018-11-04 20:32:15','2018-11-04 20:32:15',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',4),('a0c776a6698b4a0a95fce22b396cd0b4','SpringBoot从Redis中将字符串转换为POJO报错','SpringBoot从Redis中将字符串转换为POJO报错，Attempted to serialize java.lang.Class. Forgot to register a type adapter?','<p>今天在使用在用Redis做缓存的时候，通过JsonUtils工具类，将List&lt;Blog&gt;转换成字符串，缓存到Redis中，然后在通过JsonUtils.toCollection(list, Blog.class)操作将Redis取出来的字符串，变成List&lt;Blog&gt;，但是返回的时候，却出现了报错。</p>\n\n<p>Attempted to serialize java.lang.Class. Forgot to register a type adapter?</p>\n\n<p>从字面意思能看出，是序列化的时候出现了问题，忘记注册适配器？</p>\n\n<p>最后通过google查找，在overflow找到这问题</p>\n\n<p>https://stackoverflow.com/questions/29908128/gson-and-active-android-attempted-to-serialize-java-lang-class-forgot-to-regis</p>\n\n<p>大致是需要是初始化您的Gson，如下所示，以防止序列化Final，Transient或Static字段</p>\n\n<pre>\n<code>Gson gson = new GsonBuilder()\n            .excludeFieldsWithModifiers(Modifier.FINAL, Modifier.TRANSIENT, Modifier.STATIC)\n            .serializeNulls()\n            .create();</code></pre>\n\n<p><code>即在创建GsonBuilder的时候，需要加上serializeNulls，即支持空字符串的序列化，最后程序能够成功运行了。</code></p>\n\n<h1>&nbsp;</h1>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',0,0,'8f48f07f30314960a38a0b85c4f1f34a',1,'2018-10-27 17:03:50','2018-10-27 17:03:50',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('a31ef259e0514245938d20b9e70b71ed','入门Java一年进阿里，分享我学习Java的那些思考！','入门Java一年进阿里，分享我学习Java的那些思考！','<p>也许今天的你在公司做着 CRUD 的工作，也许你还在为面试造火箭、工作拧螺丝悻悻不已，也许挣扎了许久却找不到进步的方向。</p>\n\n<p>&nbsp;</p>\n\n<p>不是计算机相关专业的我，从开始学习 Java 到进入阿里，用了一年多点的时间，很多人觉得是进步比较快的，问我怎么学习 Java 才能快速进步，微信一一回复难以说的太明白，今天整理一下我的思考分享给大家。</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>打好计算机基础</strong></h1>\n\n<p>计算机基础是所有编程语言的根基，不理解计算机运作原理就无法真正理解编程的意义。就像我们大一要从计算机基本原理开始学习一样，如果你想真正吃透一门语言，就需要理解进程、线程、堆栈、内存寻址、函数调用&hellip;&hellip;</p>\n\n<p>&nbsp;</p>\n\n<p>这些内容与任何一门语言都没有关系，却是所有计算机语言的根基。打好计算机基础以后，对你来说不同的语言就真的只是语法和特性的差异，在语言之间转换就变得很容易。当我从 C 语言转向 Java 的时候，看了一天 Java 基础语法就开始写业务代码了。</p>\n\n<p>&nbsp;</p>\n\n<p>自学和培训的小伙伴往往在计算机基础上比较薄弱，一旦学习到比较复杂的概念就会感觉比较吃力，这个时候你需要好好补一下计算机基础知识。别说你没时间，今天不努力，明天就后悔。</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>熟练掌握 Java</strong></h1>\n\n<p>Java 编程思想》没有完整看完大体读懂两遍就不要说掌握了 Java。会用 Java 写代码只能说你入门了可以干活了，但也仅仅是初级阶段。</p>\n\n<p>&nbsp;</p>\n\n<p>我遇到过很多工作了三五年的人，做过很多项目，Java 水平却和工作了一年的应届生没多大区别。大部分人迷茫和无法进步的根本原因就在于你仅仅掌握了java基础，看不到 Java 的无限可能，也不知道做什么可以继续进步。</p>\n\n<p>&nbsp;</p>\n\n<p>熟练掌握 Java 需要你学习到 Java 特性的每个角落，不需要记住每个类和方法，但需要深刻理解每个特性的意义。工作中 SSM 框架为我们屏蔽了很多技术细节，Java 的特性可能并不经常用到。需要你主动学习，至少要把《Java 编程思想》看两遍以上，其中反射、泛型、容器、注解、并发需要重点掌握。</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>熟练掌握框架</strong></h1>\n\n<p>很多人参加培训是从 JavaEE 开始的，问我如何学好 JavaEE？我想说的是 JavaEE 其实已经过时了，现在要学 SSM。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>掌握框架的第一步是学会使用</strong>。学习 SSM 的基本用法能够帮助你完成绝大多数开发任务，掌握了高级用法能够提出更好的解决方案。学习框架没有捷径，在工作中一遍一遍地练习是唯一的方式。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>掌握框架的第二步是理解原理。</strong>很多人面试阿里失败就败在原理上，只知其一，不是其二，稍微问的深入一点就答不上来了。理解原理就是理解 SSM 框架的灵魂，这也是一个程序员从体力劳动进阶到脑力劳动的门槛。</p>\n\n<p>不理解原理只能做写代码的工具，理解原理才能成为真正的开发工程师。多思考、多总结、多请教，保持好奇心，多问一句是什么、为什么，才能探索到框架的奥秘。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>掌握框架的第三步是设计框架。</strong>试着去写一个简化版的 spring，实现 IOC 功能，你就会发现真 TM 难。泛型、容器、反射、注解、设计模式、重构等都会用到，通过设计框架，能够深刻地理解这些 Java 特性和框架的设计原理。如果你还没有写过框架，尝试着写一个吧，边做边思考，好好体会下框架的秘密。</p>\n\n<h1><strong>掌握应用技术</strong></h1>\n\n<p>随着技术的发展，分布式、缓存等使用越来越广泛。Java 程序员需要掌握的应用技术也越来越多，比如 spring boot、spring cloud、dubbo、Redis、RabbitMQ、ZooKeeper &hellip;&hellip;不使用这些技术也能写出很好的单机程序，但掌握这些技术才能做好大型架构。学习这些技术也很简单，就是多加练习。</p>\n\n<p>&nbsp;</p>\n\n<p>众所周知，阿里内部基本都是使用自己的技术，比如 hsf、diamond、metaq &hellip;&hellip;业界流行的这些技术用的很少。在阿里呆久了会感觉与社会脱节，于是我就每天抽出时间去看这些技术的文档，做自己的项目使用这些技术，通过日复一日的练习来掌握这些不常用技术。</p>\n\n<h1><strong>理解编程的本质</strong></h1>\n\n<p><strong>前面说了那么多，其实都是编程的术。</strong>相对于武功来说，都是外在的招式。掌握了招式可以御敌，但想要再上一层则需要掌握心法。对于程序员来说，编程的心法就是道。而我也是在阿里工作了很久才体会到道的意义。</p>\n\n<p>&nbsp;</p>\n\n<p>想必很多人都知道&ldquo;程序等于算法加数据结构&rdquo;的说法。算法和数据结构听起来都很高大上，也是大部分做业务的同学难以接触到的东西。很多人告诉我在公司自己是个 CRUD boy 不知道如何提高自己的能力，也有人抱怨&ldquo;面试造火箭，工作拧螺丝&rdquo;不知道该怎么办。</p>\n\n<p>&nbsp;</p>\n\n<p>实际上在日常工作中，程序 = 控制 + 逻辑 + 数据，也就是算法可以拆分为控制加逻辑。优秀的框架都实现了控制、逻辑、数据的分离，实现了很好的解耦和灵活性，这也是所有框架的演进方向。</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>数据容易理解，就是程序的配置、静态数据和运行时数据；</p>\n	</li>\n	<li>\n	<p>控制是程序的主流程，一般在微内核或框架底层实现，控制逻辑一般与具体业务逻辑关系不大，只是定义了流程；</p>\n	</li>\n	<li>\n	<p>逻辑就是具体的业务逻辑，在特定约束下被控制流程调用生产出符合预期的数据。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>试着从控制、逻辑、数据的维度去理解框架、设计框架、优化代码，你很快就能成为优秀的程序员。如果你觉得在公司做业务很难提高技术，不妨尝试一下梳理出控制、逻辑、数据，然后进行重构。</p>\n\n<p>&nbsp;</p>\n\n<p>最近问我如何学习 Java 的朋友有点多，这篇文章说的都是心里话。如果你觉得对你有帮助就支持一下我，欢迎留言。</p>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',4,0,'a8f63f64c55d4b8a8e7eb7a6fd7d1892',1,'2018-12-19 21:15:00','2018-12-19 21:15:00',NULL,'1','陌溪_','蘑菇博客','e60df954efcd47c48463a504bb70bbe9',0),('aca3f1f0528a4714a74493c6f0f28e22','37 个 MySQL 数据库小技巧','37 个 MySQL 数据库小技巧','<h2>无论是运维、开发、测试，还是架构师，数据库技术是一个必备加薪神器，那么，一直说学习数据库、学MySQL，到底是要学习它的哪些东西呢？</h2>\n\n<p>&nbsp;</p>\n\n<p><strong>1、如何快速掌握MySQL?</strong></p>\n\n<p><strong>培养兴趣</strong></p>\n\n<p>兴趣是最好的老师，不论学习什么知识，兴趣都可以极大地提高学习效率。当然学习MySQL 5.6也不例外。</p>\n\n<p><strong>夯实基础</strong></p>\n\n<p>计算机领域的技术非常强调基础，刚开始学习可能还认识不到这一点，随着技术应用的深 入，只有有着扎实的基础功底，才能在技术的道路上走得更快、更远。对于MySQL的学习来说， SQL语句是其中最为基础的部分，很多操作都是通过SQL语句来实现的。所以在学习的过程中， 读者要多编写SQL语句，对于同一个功能，使用不同的实现语句来完成，从而深刻理解其不同之处。</p>\n\n<p><strong>及时学习新知识</strong></p>\n\n<p>正确、有效地利用搜索引擎，可以搜索到很多关于MySQL 5.6的相关知识。同时，参考别 人解决问题的思路，也可以吸取别人的经验，及时获取最新的技术资料。</p>\n\n<p><strong>多实践操作</strong></p>\n\n<p>数据库系统具有极强的操作性，需要多动手上机操作。在实际操作的过程中才能发现问题， 并思考解决问题的方法和思路，只有这样才能提高实战的操作能力。</p>\n\n<p><strong>2、如何选择服务器的类型？</strong></p>\n\n<p>MySQL服务器配置窗口中各个参数的含义如下。<br />\n【Server Configuration Type】该选项用于设置服务器的类型。单击该选项右侧的向下按钮， 即可看到包括3个选项。</p>\n\n<p>3个选项的具体含义如下：</p>\n\n<ul>\n	<li>\n	<p>Development Machine(开发机器)：该选项代表典型个人用桌面工作站。假定机器上运行 着多个桌面应用程序。将MySQL服务器配置成使用最少的系统资源。</p>\n	</li>\n	<li>\n	<p>Server Machine (服务器)：该选项代表服务器，MySQL服务器可以同其它应用程序一起 运行，例如FTP、email和web服务器。MySQL服务器配置成使用适当比例的系统资源。</p>\n	</li>\n	<li>\n	<p>DedicatedMySQL Server Machine (专用 MySQL 服务器）：该选项代表只运行MySQL服务的服务器。假定运行没有运行其它应用程序。MySQL服务器配置成使用所有可用系统资源。作为初学者，建议选择【DevelopmentMachine】（开发者机器）选项，这样占用系统的资源 比较少。</p>\n	</li>\n</ul>\n\n<p><strong>3、如何选择存储引擎</strong></p>\n\n<p>不同存储引擎都有各自的特点，以适应不同的需求，如下表所示。为了做出选择：</p>\n\n<ul>\n	<li>\n	<p>首先需 要考虑每一个存储引擎提供了哪些不同的功能。如果要提供提交，回滚和崩溃恢复能力的事务安全（ACID兼容）能力，并要求实现并发控 制，InnoDB是个很好的选择。如果数据表主要用来插入和查询记录，则MyISAM引擎能提供较 高的处理效率；如果只是临时存放数据，数据量不大，并且不需要较高的数据安全性，可以选择将数据保存在内存中的Memory引擎，MySQL中使用该引擎作为临时表，存放查询的中间结果。如果只有INSERT和SELECT操作，可以选择Archive引擎，Archive存储引擎支持高并发的插 入操作，但是本身并不是事务安全的。Archive存储引擎非常适合存储归档数据，如记录日志信 息可以使用Archive引擎。</p>\n	</li>\n	<li>\n	<p>使用哪一种引擎要根据需要灵活选择，一个数据库中多个表可以使用不同引擎以满足各种性能和实际需求。</p>\n	</li>\n	<li>\n	<p>使用合适的存储引擎，将会提高整个数据库的性能。</p>\n	</li>\n</ul>\n\n<p><strong>4、如何查看默认存储引擎？</strong></p>\n\n<p>使用SHOW ENGINES语句查看系统中所有的存储引擎，其中包括默认的存储引擎。可以看出来当前数据库系统中有五种存储引擎，默认是MyISAM。还可以使用一种直接的方法查看默认存储引擎。执行结果直接显示了当前默认的存储引擎为MyISAM。</p>\n\n<p><strong>5、表删除操作须谨慎</strong></p>\n\n<p>表删除操作将把表的定义和表中的数据一起删除，并且MySQL在执行删除操作时，不会有 任何的确认信息提示，因此执行删除操时，应当慎重。在删除表前，最好对表中的数据进行备份， 这样当操作失误时，可以对数据进行恢复，以免造成无法挽回的后果。</p>\n\n<p>同样的，在使用ALTER TABLE进行表的基本修改操作时，在执行操作过程之前，也应该 确保对数据进行完整的备份，因为数据库的改变是无法撤销的，如果添加了一个不需要的字段， 可以将其删除；相同的，如果删除了一个需要的列，该列下面的所有数据都将会丢失。</p>\n\n<p><strong>6、每个表中都要有一个主键吗？</strong></p>\n\n<p>并不是每一个表中都需要主键，一般的，如果多个表之间进行连接操作时，需要用到主键。 因此并不需要为每个表建立主键，而且有些情况最好不使用主键。</p>\n\n<p><strong>7、每个表都可以任意选择存储引擎吗？</strong></p>\n\n<p>外键约束（FOREIGN KEY)不能跨引擎使用。MySQL支持多种存储引擎，每一个表都可 以指定一个不同的存储引擎，但是要注意：外键约束是用来保证数据的参照完整性，如果表之间 需要关联外键，却指定了不同的存储引擎，这些表之间是不能创建外键约束的。所以说，存储引 擎的选择也不完全是随意的。</p>\n\n<p><strong>8、带AUTO_INCREMENT约束的字段值是从1开始的吗？</strong></p>\n\n<p>默认的，在MySQL中，AUTO_INCREMENT的初始值是1，每新增一条记录，字段值自动加1。设置自增属性（AUTO_INCREMENT)的时候，还可以指定第一条插入记录的自增字段的 值，这样新插入的记录的自增字段值从初始值开始递增，如在tb_emp8中插入第一条记录，同时 指定id值为5,则以后插入的记录的id值就会从6开始往上增加。添加唯一性的主键约束时， 往往需要设置字段自动增加属性。</p>\n\n<p><strong>9、TIMESTAMP与DATATIME两者的区别</strong></p>\n\n<p>TIMESTAMP与DATETIME除了存储字节和支持的范围不同外，还有一个最大的区别就是： DATETIME在存储日期数据时，按实际输入的格式存储，即输入什么就存储什么，与时区无关； 而TIMESTAMP值的存储是以UTC(世界标准时间）格式保存的，存储时对当前时区进行转换， 检索时再转换回当前时区。即查询时，根据当前时区的不同，显示的时间值是不同的。</p>\n\n<p><strong>10、选择数据类型的方法和技巧是什么？</strong></p>\n\n<p>MySQL提供了大量的数据类型，为了优化存储，提高数据库性能，在任何情况下均应使用 最精确的类型。即在所有可以表示该列值的类型中，该类型使用的存储最少。</p>\n\n<p><strong>整数和浮点数</strong></p>\n\n<p>如果不需要小数部分，则使用整数来保存数据；如果需要表示小数部分，则使用浮点数类 型。对于浮点数据列，存入的数值会对该列定义的小数位进行四舍五入。例如如果列的值的范 围为1〜99999，若使用整数，则MEDIUMINT UNSIGNED是最好的类型；若需要存储小数，则 使用FLOAT类型。浮点类型包括FLOAT和DOUBLE类型。DOUBLE类型精度比FLOAT类型高，因此，如要求存储精度较高时，应选择DOUBLE类型。</p>\n\n<p><strong>浮点数和定点数</strong></p>\n\n<p>浮点数FLOAT，DOUBLE相对于定点数DECIMAL的优势是：在长度一定的情况下，浮点 数能表示更大的数据范围。但是由于浮点数容易产生误差，因此对精确度要求比较高时，建议使 用DECIMAL来存储。DECIMAL在MySQL中是以字符串存储的，用于定义货币等对精确度要 求较高的数据。在数据迁移中，float(M,D)是非标准SQL定义，数据库迁移可能会出现问题，最 好不要这样使用。另外两个浮点数进行减法和比较运算时也容易出问题，因此在进行计算的时候， 一定要小心。如果进行数值比较，最好使用DECIMAL类型。</p>\n\n<p><strong>日期与时间类型</strong></p>\n\n<p>MySQL对于不同种类的日期和时间有很多的数据类型，比如YEAR和TIME。如果只需要 记录年份，则使用YEAR类型即可；如果只记录时间，只须使用TIME类型。如果同时需要记录日期和时间，则可以使用TIMESTAMP或者DATETIME类型。由于 TIMESTAMP列的取值范围小于DATETIME的取值范围，因此存储范围较大的日期最好使用 DATETIME。TIMESTAMP也有一个DATETIME不具备的属性。默认的情况下，当插入一条记录但并没 有指定TIMESTAMP这个列值时，MySQL会把TIMESTAMP列设为当前的时间。因此当需要 插入记录同时插入当前时间时，使用TIMESTAMP是方便的，另外TIMESTAMP在空间上比 DATETIME更有效。</p>\n\n<p><strong>CHAR与VARCHAR之间的特点与选择</strong></p>\n\n<p>CHAR和VARCHAR的区别：</p>\n\n<ul>\n	<li>\n	<p>CHAR是固定长度字符，VARCHAR是可变长度字符；CHAR会自动删除插入数据的尾部 空格，VARCHAR不会删除尾部空格。</p>\n	</li>\n	<li>\n	<p>CHAR是固定长度，所以它的处理速度比VARCHAR的速度要快，但是它的缺点就是浪费 存储空间。所以对存储不大，但在速度上有要求的可以使用CHAR类型，反之可以使用 VARCHAR类型来实现。</p>\n	</li>\n</ul>\n\n<p>存储引擎对于选择CHAR和VARCHAR的影响：</p>\n\n<ul>\n	<li>\n	<p>对于MyISAM存储引擎：最好使用固定长度的数据列代替可变长度的数据列。这样可以使 整个表静态化，从而使数据检索更快，用空间换时间。</p>\n	</li>\n	<li>\n	<p>对于InnoDB存储引擎：使用可变长度的数据列，因为InnoDB数据表的存储格式不分固定 长度和可变长度，因此使用CHAR不一定比使用VARCHAR更好，但由于VARCHAR是按照 实际的长度存储，比较节省空间，所以对磁盘I/O和数据存储总量比较好。</p>\n	</li>\n</ul>\n\n<p><strong>ENUM 和 SET</strong></p>\n\n<p>ENUM只能取单值，它的数据列表是一个枚举集合。它的合法取值列表最多允许有65 535 个成员。因此，在需要从多个值中选取一个时，可以使用ENUM。比如：性别字段适合定义为 ENUM类型，每次只能从&rsquo;男&rsquo;或&rsquo;女&rsquo;中取一个值。SET可取多值。它的合法取值列表最多允许有64个成员。</p>\n\n<p>空字符串也是一个合法的SET值。 在需要取多个值的时候，适合使用SET类型，比如：要存储一个人兴趣爱好，最好使用SET类型。ENUM和SET的值是以字符串形式出现的，但在内部，MySQL以数值的形式存储它们。</p>\n\n<p><strong>BLOB 和 TEXT</strong></p>\n\n<p>BLOB是二进制字符串，TEXT是非二进制字符串，两者均可存放大容量的信息。BLOB主 要存储图片、音频信息等，而TEXT只能存储纯文本文件。应分清两者的用途。点击<a href=\"http://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&amp;mid=2247487012&amp;idx=1&amp;sn=e1a692458f97a14a0172bcc437aa9588&amp;chksm=eb538b12dc2402043e3e9c1703f2e64e5df39abdee87cc2804e3e4d9de444644ef93e5f2712f&amp;scene=21#wechat_redirect\" target=\"_blank\">这里</a>总结了55道去BAT面试的MYSQL面试题。</p>\n\n<p><strong>11、MySQL中如何使用特殊字符？</strong></p>\n\n<p>诸如单引号（&rsquo;），双引号（&quot;），反斜线（)等符号，这些符号在MySQL中不能直接输入 使用，否则会产生意料之外的结果。在MySQL中，这些特殊字符称为转义字符，在输入时需要 以反斜线符号（&rsquo;\\&rsquo;）开头，所以在使用单引号和双引号时应分别输入（\\&rsquo;）或者（\\&quot;)，输入反 斜线时应该输入（\\)，其他特殊字符还有回车符（\\r)，换行符（\\n)，制表符（\\tab)，退格 符（\\b)等。在向数据库中插入这些特殊字符时，一定要进行转义处理。</p>\n\n<p><strong>12、MySQL中可以存储文件吗？</strong></p>\n\n<p>MySQL中的BLOB和TEXT字段类型可以存储数据量较大的文件，可以使用这些数据类型 存储图像、声音或者是大容量的文本内容，例如网页或者文档。虽然使用BLOB或者TEXT可 以存储大容量的数据，但是对这些字段的处理会降低数据库的性能。如果并非必要，可以选择只 储存文件的路径。</p>\n\n<p><strong>13、MySQL中如何执行区分大小写的字符串比较？</strong></p>\n\n<p>在Windows平台下，MySQL是不区分大小的，因此字符串比较函数也不区分大小写。如果 想执行区分大小写的比较，可以在字符串前面添加BINARY关键字。例如默认情况下，&rsquo;a&rsquo;=&lsquo;A&rsquo; 返回结果为1，如果使用BINARY关键字，BINARY&rsquo;a&rsquo;=&lsquo;A&rsquo;结果为0,在区分大小写的情况下，&rsquo;a&rsquo; 与&rsquo;A&rsquo;并不相同。</p>\n\n<p><strong>14、如何从日期时间值中获取年、月、日等部分日期或时间值？</strong></p>\n\n<p>MySQL中，日期时间值以字符串形式存储在数据表中，因此可以使用字符串函数分别截取日期时间值的不同部分，例如某个名称为dt的字段有值&ldquo;2010-10-01 12:00:30&rdquo;，如果只需要获 得年值，可以输入LEFT(dt, 4)，这样就获得了字符串左边开始长度为4的子字符串，即YEAR 部分的值；如果要获取月份值，可以输入MID(dt,6,2)，字符串第6个字符开始，长度为2的子 字符串正好为dt中的月份值。同理，读者可以根据其他日期和时间的位置，计算并获取相应的值。</p>\n\n<p><strong>15、如何改变默认的字符集？</strong></p>\n\n<p>CONVERT()函数改变指定字符串的默认字符集，在开始的章节中，向读者介绍使用GUI图形化安装配置工具进行MySQL的安装和配置，其中的一个步骤是可以选择MySQL的默认字符集。但是，如果只改变字符集，没有必要把配置过程重新执行一遍，在这里，一个简单的方式是 修改配置文件。在Windows中，MySQL配置文件名称为my.ini，该文件在MySQL的安装目录下面。修改配置文件中的default-character-set和character-set-server参数值，将其改为想要的字 符集名称，如gbk、gb2312、latinl等，修改完之后重新启动MySQL服务，即可生效。读者可以在修改字符集时使用SHOW VARIABLES LIKE &rsquo;character_set_&deg;%&rsquo;;命令查看当前字符集，以进行对比。</p>\n\n<p><strong>16、DISTINCT可以应用于所有的列吗？</strong></p>\n\n<p>查询结果中，如果需要对列进行降序排序，可以使用DESC，这个关键字只能对其前面的列 进行降序排列。例如，要对多列都进行降序排序，必须要在每一列的列名后面加DESC关键字。&nbsp;</p>\n\n<p>而DISTINCT不同，DISTINCT不能部分使用。换句话说，DISTINCT关键字应用于所有列而不 仅是它后面的第一个指定列。例如，查询3个字段s_id，f_name，f_price，如果不同记录的这3个字段的组合值都不同，则所有记录都会被查询出来。</p>\n\n<p><strong>17、ORDER BY可以和LIMIT混合使用吗？</strong></p>\n\n<p>在使用ORDER BY子句时，应保证其位于FROM子句之后，如果使用LIMIT，则必须位 于ORDER BY之后，如果子句顺序不正确，MySQL将产生错误消息。</p>\n\n<p><strong>18、什么时候使用引号？</strong></p>\n\n<p>在查询的时候，会看到在WHERE子句中使用条件，有的值加上了单引号，而有的值未加。 单引号用来限定字符串，如果将值与字符串类型列进行比较，则需要限定引号；而用来与数值进 行比较则不需要用引号。</p>\n\n<p><strong>19、在WHERE子句中必须使用圆括号吗？</strong></p>\n\n<p>任何时候使用具有AND和OR操作符的WHERE子句，都应该使用圆括号明确操作顺序。 如果条件较多，即使能确定计算次序，默认的计算次序也可能会使SQL语句不易理解，因此使 用括号明确操作符的次序，是一个好的习惯。</p>\n\n<p><strong>20、更新或者删除表时必须指定WHERE子句吗？</strong></p>\n\n<p>在前面章节中可以看到，所有的UPDATE和DELETE语句全都在WHERE子句中指定了条 件。如果省略WHERE子句，则UPDATE或DELETE将被应用到表中所有的行。</p>\n\n<p>因此，除非 确实打算更新或者删除所有记录，否则要注意使用不带WHERE子句的UPDATE或DELETE 语句。建议在对表进行更新和删除操作之前，使用SELECT语句确认需要删除的记录，以免造 成无法挽回的结果。点击<a href=\"http://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&amp;mid=2247487012&amp;idx=1&amp;sn=e1a692458f97a14a0172bcc437aa9588&amp;chksm=eb538b12dc2402043e3e9c1703f2e64e5df39abdee87cc2804e3e4d9de444644ef93e5f2712f&amp;scene=21#wechat_redirect\" target=\"_blank\">这里</a>总结了55道去BAT面试的MYSQL面试题。</p>\n\n<p><strong>21、索引对数据库性能如此重要，应该如何使用它？</strong></p>\n\n<p>为数据库选择正确的索引是一项复杂的任务。如果索引列较少，则需要的磁盘空间和维护开销 都较少。如果在一个大表上创建了多种组合索引，索引文件也会膨胀很快。</p>\n\n<p>而另一方面，索引较多 可覆盖更多的查询。可能需要试验若干不同的设计，才能找到最有效的索引。可以添加、修改和删 除索引而不影响数据库架构或应用程序设计。因此，应尝试多个不同的索引从而建立最优的索引。</p>\n\n<p><strong>22、尽量使用短索引。</strong></p>\n\n<p>对字符串类型的字段进行索引，如果可能应该指定一个前缀长度。例如，如果有一个 CHAR(255)的列，如果在前10个或30个字符内，多数值是惟一的，则不需要对整个列进行索引。 短索引不仅可以提高查询速度而且可以节省磁盘空间、减少I/O操作。</p>\n\n<p><strong>23、MySQL存储过程和函数有什么区别？</strong></p>\n\n<p>在本质上它们都是存储程序。函数只能通过return语句返回单个值或者表对象；而存储过程 不允许执行return，但是可以通过out参数返回多个值。函数限制比较多，不能用临时表，只能用表变量，还有一些函数都不可用等等；而存储过程的限制相对就比较少。函数可以嵌入在SQL 语句中使用，可以在SELECT语句中作为查询语句的一个部分调用；而存储过程一般是作为一个独立的部分来执行。</p>\n\n<p><strong>24、存储过程中的代码可以改变吗？</strong></p>\n\n<p>目前，MySQL还不提供对已存在的存储过程代码的修改，如果必须要修改存储过程，必须使用DROP语句删除之后，再重新编写代码，或者创建一个新的存储过程。</p>\n\n<p><strong>25、存储过程中可以调用其他存储过程吗？</strong></p>\n\n<p>存储过程包含用户定义的SQL语句集合，可以使用CALL语句调用存储过程，当然在存储 过程中也可以使用CALL语句调用其他存储过程，但是不能使用DROP语句删除其他存储过程。</p>\n\n<p><strong>26、存储过程的参数不要与数据表中的字段名相同。</strong></p>\n\n<p>在定义存储过程参数列表时，应注意把参数名与数据库表中的字段名区别开来，否则将出 现无法预期的结果。</p>\n\n<p><strong>27、存储过程的参数可以使用中文吗？</strong></p>\n\n<p>一般情况下，可能会出现存储过程中传入中文参数的情况，例如某个存储过程根据用户的 名字查找该用户的信息，传入的参数值可能是中文。这时需要在定义存储过程的时候，在后面加 上character set gbk,不然调用存储过程使用中文参数会出错，比如定义userInfo存储过程，代码 如下：</p>\n\n<blockquote>\n<p>CREATE PROCEDURE useInfo(IN u_name VARCHAR(50) character set gbk, OUT u_age INT)&nbsp;</p>\n</blockquote>\n\n<p><strong>28、MySQL中视图和表的区别以及联系是什么？</strong></p>\n\n<p><strong>两者的区别：</strong></p>\n\n<ul>\n	<li>\n	<p>(1)视图是已经编译好的SQL语句，是基于SQL语句的结果集的可视化的表，而表不是。</p>\n	</li>\n	<li>\n	<p>(2)视图没有实际的物理记录，而基本表有。</p>\n	</li>\n	<li>\n	<p>(3)表是内容，视图是窗口。</p>\n	</li>\n	<li>\n	<p>(4)表占用物理空间而视图不占用物理空间，视图只是逻辑概念的存在，表可以及时对它 进行修改，但视图只能用创建的语句来修改。</p>\n	</li>\n	<li>\n	<p>(5)视图是查看数据表的一种方法，可以查询数据表中某些字段构成的数据，只是一些SQL 语句的集合。从安全的角度来说，视图可以防止用户接触数据表，因而用户不知道表结构。</p>\n	</li>\n	<li>\n	<p>(6)表属于全局模式中的表，是实表；视图属于局部模式的表，是虚表。</p>\n	</li>\n	<li>\n	<p>(7)视图的建立和删除只影响视图本身，不影响对应的基本表。</p>\n	</li>\n</ul>\n\n<p><strong>两者的联系：</strong></p>\n\n<ul>\n	<li>\n	<p>视图（view)是在基本表之上建立的表，它的结构（即所定义的列）和内容（即所有记录） 都来自基本表，它依据基本表存在而存在。一个视图可以对应一个基本表，也</p>\n	</li>\n	<li>\n	<p>可以对应多个基本 表。视图是基本表的抽象和在逻辑意义上建立的新关系。</p>\n	</li>\n</ul>\n\n<p><strong>29、使用触发器时须特别注意。</strong></p>\n\n<p>在使用触发器的时候需要注意，对于相同的表，相同的事件只能创建一个触发器，比如对 表account创建了一个BEFORE INSERT触发器，那么如果对表account再次创建一个BEFORE INSERT触发器，MySQL将会报错，此时，只可以在表account上创建AFTER INSERT或者 BEFORE UPDATE类型的触发器。灵活的运用触发器将为操作省去很多麻烦。点击<a href=\"http://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&amp;mid=2247487012&amp;idx=1&amp;sn=e1a692458f97a14a0172bcc437aa9588&amp;chksm=eb538b12dc2402043e3e9c1703f2e64e5df39abdee87cc2804e3e4d9de444644ef93e5f2712f&amp;scene=21#wechat_redirect\" target=\"_blank\">这里</a>总结了55道去BAT面试的MYSQL面试题。</p>\n\n<p><strong>30、及时删除不再需要的触发器。</strong></p>\n\n<p>触发器定义之后，每次执行触发事件，都会激活触发器并执行触发器中的语句。如果需求 发生变化，而触发器没有进行相应的改变或者删除，则触发器仍然会执行旧的语句，从而会影响 新的数据的完整性。因此，要将不再使用的触发器及时删除。</p>\n\n<p><strong>31、应该使用哪种方法创建用户？</strong></p>\n\n<p>创建用户有几种方法：GRANT语句、CREATE USER语句和直接操作user表。一般情况， 最好使用GRANT或者CREATE USER语句，而不要直接将用户信息插入user表，因为user表中存储了全局级别的权限以及其他的账户信息，如果意外破坏了 user表中的记录，则可能会对 MySQL服务器造成很大影响。</p>\n\n<p><strong>32、mysqldump备份的文件只能在MySQL中使用吗？</strong></p>\n\n<p>mysqldump备份的文本文件实际是数据库的一个副本，使用该文件不仅可以在MySQL中恢 复数据库，而且通过对该文件的简单修改，可以使用该文件在SQL Server或者Sybase等其他数 据库中恢复数据库。这在某种程度上实现了数据库之间的迁移。</p>\n\n<p><strong>33、如何选择备份工具？</strong></p>\n\n<p>直接复制数据文件是最为直接、快速的备份方法，但缺点是基本上不能实现增量备份。备 份时必须确保没有使用这些表。如果在复制一个表的同时服务器正在修改它，则复制无效。备份 文件时，最好关闭服务器，然后重新启动服务器。为了保证数据的一致性，需要在备份文件前， 执行以下SQL语句：</p>\n\n<blockquote>\n<p>CREATE PROCEDURE useInfo(IN u_name VARCHAR(50) character set gbk, OUT u_age INT)</p>\n</blockquote>\n\n<p>目录下即可。mysqlhotcopy 是一个 PERL 程序，它使用 LOCK TABLES、FLUSH TABLES 和 cp 或 scp来快速备份数据库。它是备份数据库或单个表的最快的途径，但它只能运行在数据库文件所在的 机器上，并且mysqlhotcopy只能用于备份MyISAM表。</p>\n\n<p>mysqlhotcopy适合于小型数据库的备份， 数据量不大，可以使用mysqlhotcopy程序每天进行一次完全备份。mysqldump将数据表导成SQL脚本文件，在不同的MySQL版本之间升级时相对比较合适， 这也是最常用的备份方法。mysqldump比直接复制要慢些。也就是把内存中的数据都刷新到磁盘中，同时锁定数据表，以保证复制过程中不会有新的 数据写入。这种方法备份出来的数据恢复也很简单，直接复制回原来的数据库</p>\n\n<p><strong>34、平时应该打开哪些日志？</strong></p>\n\n<p>日志既会影响MySQL的性能，又会占用大量磁盘空间。因此，如果不必要，应尽可能少地 开启日志。根据不同的使用环境，可以考虑开启不同的日志。例如，在开发环境中优化查询效率 低的语句，可以开启慢查询日志；如果需要记录用户的所有查询操作，可以开启通用查询日志； 如果需要记录数据的变更，可以开启二进制日志；错误日志是默认开启的。</p>\n\n<p><strong>35、如何使用二进制日志？</strong></p>\n\n<p>二进制日志主要用来记录数据变更。如果需要记录数据库的变化，可以开启二进制日志。 基于二进制日志的特性，不仅可以用来进行数据恢复，还可用于数据复制。</p>\n\n<p>在数据库定期备份的情况下，如果出现数据丢失，可以先用备份恢复大部分数据，然后使用二进制日志恢复最近备份 后变更的数据。在双机热备情况下，可以使用MySQL的二进制日志记录数据的变更，然后将变 更部分复制到备份服务器上。</p>\n\n<p><strong>36、如何使用慢查询日志？</strong></p>\n\n<p>慢查询日志主要用来记录查询时间较长的日志。在开发环境下，可以开启慢查询日志来记 录查询时间较长的查询语句，然后对这些语句进行优化。通过配long_query_time的值，可以灵活地掌握不同程度的慢查询语句。</p>\n\n<p><strong>37、是不是索引建立得越多越好？</strong></p>\n\n<p>合理的索引可以提高查询的速度，但不是索引越多越好。在执行插入语句的时候，MySQL 要为新插入的记录建立索引。所以过多的索引会导致插入操作变慢。原则上是只有查询用的字段 才建立索引。</p>\n','0b51c75ed5744cdcadefe0ad947be9b6',3,0,'8f1b96ca6c844882858efca25923a62c',1,'2018-12-27 09:28:42','2018-12-27 09:28:42',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('af053959672343f8a139ec27fd534c6c','如何使用百度云加速提升网站访问速度','如何使用百度云加速提升网站访问速度','<p>今天偶然的情况，看到了百度云加速能进行网站访问速度提升，因为现在我是用学生价买的阿里云服务器，1核2G 1M带宽的，所以第一次加载资源的时候，是非常慢的，所以就打算尝试一下。</p>\n\n<p>&nbsp;</p>\n\n<p>1）下面进入正题，打开百度云加速的官网&nbsp; <a href=\"https://su.baidu.com/\">https://su.baidu.com/</a></p>\n\n<p>&nbsp;</p>\n\n<p>2）选择免费开启，在这里可能会提示用户无效操作，或者什么的，这是因为没有实名认证，那么我们就需要登录后，进行实名认证才能使用该产品。</p>\n\n<p>&nbsp;</p>\n\n<p>3）实名认证完成后，我们首先需要添加网站，比如买的域名是&nbsp; moguit.cn 所以直接填写上去就行了。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542268540142.png\" style=\"height:290px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>4）下面是添加子域名记录。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542268547758.png\" style=\"height:384px; width:800px\" /></p>\n\n<p>注意，这里的子域名，只需要填写域名的前缀，不需要填全，比如&nbsp; <a href=\"http://www.moguit.cn\">www.moguit.cn</a> 这是错误的。&nbsp; 只需要填写 www 即可</p>\n\n<p>&nbsp;</p>\n\n<p>5）下面就是修改域名的DNS，因为我用的是阿里云，所以需要需要进入阿里云域名管理</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542268557491.png\" style=\"height:286px; width:420px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>然后选中DNS修改，点击确定就完成了</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542268563710.png\" style=\"height:388px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>5）最后选择免费版套餐，等待片刻后，就完成了，下面就可以体验一下加速效果了~！当然如果有能力的话，可以尝试一下使用CDN加速，效果估计更佳</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542331491353.png\" style=\"height:263px; width:800px\" /></p>\n','8d5ce3e0c0784b95adb7f9e7b76dca93',0,0,'ec3c91ada4994d1fb6a5181a716ab0dd',1,'2018-11-15 15:56:24','2018-11-15 15:56:24',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('b3f01d1429dc4be58123322b10fb318f','如何将SpringBoot项目打包成war包','如何将SpringBoot项目打包成war包','<p>&nbsp; &nbsp; &nbsp; &nbsp;这阵子在将博客部署在阿里云的时候，因为我的博客目前用到的微服务比较多，现在大概有五六个模块，如 eureka，pciture，sms，admin，web，这些是使用spring boot创建的项目，在加上solr搜索服务，如果采用spring boot 打包成jar包的方式，那么可能服务器内存就不够用了，因为一个jar里面集成了tomcat，所以五个jar，就相当于跑了5台tomcat服务器。</p>\n\n<p>&nbsp; &nbsp; &nbsp; &nbsp;以我用学生价买的阿里云服务器为例，大概1核2G，所以2G内存的话，大概就只是跑五个tomcat了，不然内存可能就不够了，哭穷~~~~~~。那么在加上mysql，redis，nginx，rabbitmq，solr，那些也需要占用的内存。。。所以想要用这台服务器采用jar的方式，很显然是不可能完成的，那么需要就只能采用打包成war的方式了。把5个模块 和solr 都丢到一个tomcat容器里面，这样就能节省下很多内存下来，使用其他了。下面进入正题。</p>\n\n<p>1）首先，我们需要修改的是pom文件，将打包方式 改成&nbsp; war&nbsp;</p>\n\n<pre>\n<code class=\"language-xml\">&lt;packaging&gt;war&lt;/packaging&gt;</code></pre>\n\n<p>2）排除掉 spring-boot-starter-web自带的tomcat</p>\n\n<pre>\n<code class=\"language-xml\">&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n  &lt;exclusions&gt;  \n    &lt;exclusion&gt;  \n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;  \n      &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;  \n    &lt;/exclusion&gt;  \n  &lt;/exclusions&gt;\n&lt;/dependency&gt;</code></pre>\n\n<p>3）然后修改&lt;build&gt;&lt;/build&gt;</p>\n\n<pre>\n<code class=\"language-xml\">    &lt;build&gt;\n          &lt;resources&gt;\n           &lt;resource&gt;\n               &lt;directory&gt;src/main/java&lt;/directory&gt;\n               &lt;includes&gt;\n                   &lt;include&gt;**/*.xml&lt;/include&gt;\n               &lt;/includes&gt;\n           &lt;/resource&gt;\n           &lt;resource&gt;\n               &lt;directory&gt;src/main/resources&lt;/directory&gt;\n               &lt;includes&gt;\n                   &lt;include&gt;**.*&lt;/include&gt;\n                   &lt;include&gt;**/*.*&lt;/include&gt;&lt;!-- i18n能读取到 --&gt;\n                    &lt;include&gt;**/*/*.*&lt;/include&gt;\n               &lt;/includes&gt;\n           &lt;/resource&gt;\n         &lt;/resources&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;warName&gt;mogu_sms&lt;/warName&gt;\n                    &lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt;\n                     &lt;outputDirectory&gt;webapps&lt;/outputDirectory&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n        &lt;finalName&gt;mogu_sms&lt;/finalName&gt;\n    &lt;/build&gt;</code></pre>\n\n<p>3) 然后在修改 Application.java 启动类，若打包成war包,则需要继承&nbsp;<strong>org.springframework.boot.context.web.SpringBootServletInitializer</strong>类,覆盖其config(SpringApplicationBuilder)方法</p>\n\n<pre>\n<code class=\"language-java\">@SpringBootApplication\npublic class APP extends SpringBootServletInitializer{\n    \n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {\n        return builder.sources(APP.class);\n    }\n\n    public static void main(String[] args){\n        SpringApplication.run(APP.class,args);\n    }\n}</code></pre>\n\n<p>4）完成后，使用maven clean install 命令，就能看到在 项目根目录的webapps目录下，看到 打包好的war包了。<br />\n&nbsp;</p>\n\n<p>最后将全部模块弄好后，丢到阿里云的tomcat容器里面，部署了6个项目，大概占用60%内存，还不错~<img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541210475637.png\" style=\"height:153px; width:582px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp; &nbsp; &nbsp;&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n','53c5a0f3142e4f54820315936f78383b',0,0,'2508670a57b54a5b8f66dd7547d52cd1',1,'2018-11-03 09:41:44','2018-11-03 09:41:44',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('b99887c838e544a0b2b2a3db89081b24','SpringBoot项目出现Durid超时问题','SpringBoot项目出现Durid超时问题','<p>&nbsp;今天在登录博客后台的时候，发现一直登录不了，于是就打开阿里云中的tomcat日志进行排查，发现报了下面的错误</p>\n\n<pre>\n<code>Caused by: org.springframework.jdbc.CannotGetJdbcConnectionException: Could not get JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 60000, active 20, maxActive 20, creating 0\n	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:80) ~[spring-jdbc-4.3.2.RELEASE.jar:4.3.2.RELEASE]\n	at org.mybatis.spring.transaction.SpringManagedTransaction.openConnection(SpringManagedTransaction.java:82) ~[mybatis-spring-1.3.2.jar:1.3.2]\n	at org.mybatis.spring.transaction.SpringManagedTransaction.getConnection(SpringManagedTransaction.java:68) ~[mybatis-spring-1.3.2.jar:1.3.2]\n	at org.apache.ibatis.executor.BaseExecutor.getConnection(BaseExecutor.java:338) ~[mybatis-3.4.6.jar:3.4.6]\n	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:84) ~[mybatis-3.4.6.jar:3.4.6]\n	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62) ~[mybatis-3.4.6.jar:3.4.6]\n	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326) ~[mybatis-3.4.6.jar:3.4.6]\n	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156) ~[mybatis-3.4.6.jar:3.4.6]\n	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:136) ~[mybatis-3.4.6.jar:3.4.6]\nat org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148) ~[mybatis-3.4.6.jar:3.4.6]</code></pre>\n\n<p>大概意思就是现在已经活跃的连接数有20个，而最大活跃数是20个，无法继续创建连接对象了，所以就一直在等待。</p>\n\n<p>大概知道了原因后，我们就把最大连接数改成50后重启，发现网站能够正常使用，连接也没有占满。</p>\n\n<pre>\n<code>    #连接等待超时时间\n    maxWait: 60000</code></pre>\n\n<p>不过到底是什么原因造成这个情况的呢？我琢磨了一些，可能是由于某些地方的连接一直被占用，没有关闭而造成连接池数的连接不够用的。所以这是我设置了开启超时删除的功能</p>\n\n<pre>\n<code>    dbcp:\n      remove-abandoned: true\n      #泄露的连接可以被删除的超时时间（秒），该值应设置为应用程序查询可能执行的最长时间\n      remove-abandoned-timeout: 180</code></pre>\n\n<p>&nbsp;</p>\n','53c5a0f3142e4f54820315936f78383b',0,0,'bf4f61f6599f48dda9ecf4a5149410e5',1,'2018-11-15 16:31:16','2018-11-15 16:31:16',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('bcdb3ee0332a440994216682cf850ed6','哥们，那你说说系统架构引入消息中间件有什么缺点？','哥们，那你说说系统架构引入消息中间件有什么缺点？','<h2><strong>前情回顾</strong></h2>\n\n<p>上篇文章<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\">《哥们，你们的系统架构中为什么要引入消息中间件呢？》</a>，给大家讲了讲消息中间件引入系统架构的作用，主要是解决哪些问题的。</p>\n\n<p>&nbsp;</p>\n\n<p>其比较常见的实践场景是：</p>\n\n<ul>\n	<li>\n	<p><strong>复杂系统的解耦</strong></p>\n	</li>\n	<li>\n	<p><strong>复杂链路的异步调用</strong></p>\n	</li>\n	<li>\n	<p><strong>瞬时高峰的削峰处理</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<h2><strong>&nbsp;正式开始</strong></h2>\n\n<p>这篇文章给大家讲讲，如果你在系统架构里引入了消息中间件之后，会有哪些缺点？</p>\n\n<p>&nbsp;</p>\n\n<h3><strong>1、 系统可用性降低</strong></h3>\n\n<p>首先是你的系统整体可用性绝对会降低，给你举个例子，我们就拿之前的一幅图来说明。</p>\n\n<p>&nbsp;</p>\n\n<p>比如说一个核心链路里面，系统A -&gt; 系统B -&gt; 系统C，然后系统C是通过MQ异步调用系统D的。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544748943344.png\" style=\"height:283px; width:676px\" /></p>\n\n<p>看起来很好，你用这个MQ异步化的手段解决了一个核心链路执行性能过差的问题。</p>\n\n<p>&nbsp;</p>\n\n<p>但是你有没有考虑另外一个问题，就是万一你依赖的那个MQ中间件突然挂掉了怎么办？这个还真的不是异想天开，MQ、Redis、MySQL这些组件都有可能会挂掉。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦你的MQ挂了，就导致你的系统的核心业务流程中断了。本来你要是不引入MQ中间件，那其实就是一些系统之间的调用，但是现在你引入了MQ，就导致你多了一个依赖。一旦多了一个依赖，就会导致你的可用性降低。</p>\n\n<p>&nbsp;</p>\n\n<p>因此，一旦引入了MQ中间件，你就必须去考虑这个MQ是如何部署的，如何保证高可用性。</p>\n\n<p>&nbsp;</p>\n\n<p>甚至在复杂的高可用的场景下，你还要考虑如果MQ一旦挂了以后，你的系统有没有备用兜底的技术方案，可以保证系统继续运行下去。</p>\n\n<p>之前写过两篇文章，都涉及到了<strong>MQ挂掉之后的高可用保障方案。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>大伙如果感兴趣，可以参考一下：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzU0OTk3ODQ3Ng==&amp;mid=2247483876&amp;idx=1&amp;sn=51f8eadc16efd6b89eb1f3c6abe67e25&amp;chksm=fba6e9e7ccd160f183b344d4773841ad8df9a2c099a16aae516ddb45aef7eaccb83570d171fe&amp;scene=21#wechat_redirect\" target=\"_blank\">《最终一致性分布式事务的99.99%高可用保障生产实践》</a></p>\n	</li>\n	<li>\n	<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzU0OTk3ODQ3Ng==&amp;mid=2247483996&amp;idx=1&amp;sn=698f5a2b07be1d29ec68532588b8df9e&amp;chksm=fba6ea5fccd16349b139a25a9fe04ba59d81777cb5f7097ee95110c6c38ec2d1cd90a8a6c560&amp;scene=21#wechat_redirect\" target=\"_blank\">《亿级流量系统架构之如何设计全链路99.99%高可用架构》</a></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>通过这两篇文章，具体看看我们在各种场景下遇到MQ故障采取的高可用降级方案。</p>\n\n<p>&nbsp;</p>\n\n<h3><strong>2、系统稳定性降低</strong></h3>\n\n<p>&nbsp;</p>\n\n<p>还是上面那张图，大家再来看一下。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1544749022517.png\" style=\"height:240px; width:665px\" /></p>\n\n<p>不知道大家有没有发现一个问题，这个链路除了MQ中间件挂掉这个可能存在的隐患之外，可能还有一些其他的技术问题。</p>\n\n<p>&nbsp;</p>\n\n<p>比如说，莫名其妙的，系统C发了一个消息到MQ，结果那个消息因为网络故障等问题，就丢失了。这就导致系统D没有收到那条消息。</p>\n\n<p>&nbsp;</p>\n\n<p>这可就惨了，这样会导致系统D没完成自己该做的任务，此时可能整个系统会出现业务错乱，数据丢失，严重的bug，用户体验很差等各种问题。</p>\n\n<p>&nbsp;</p>\n\n<p>这还只是其中之一，万一说系统C给MQ发送消息，不小心一抽风重复发了一条一模一样的，导致消息重复了，这个时候该怎么办？</p>\n\n<p>&nbsp;</p>\n\n<p>可能会导致系统D一下子把一条数据插入了两次，导致数据错误，<strong>脏数据的产生</strong>，最后一样会导致各种问题。</p>\n\n<p>&nbsp;</p>\n\n<p>或者说如果系统D突然宕机了几个小时，导致无法消费消息，结果大量的消息在MQ中间件里积压了很久，这个时候怎么办？</p>\n\n<p>&nbsp;</p>\n\n<p>即使系统D恢复了，也需要慢慢的消费数据来进行处理。</p>\n\n<p>&nbsp;</p>\n\n<p>所以这就是引入MQ中间件的第二个大问题，系统稳定性可能会下降，故障会增多，各种各样乱七八糟的问题都可能产生。</p>\n\n<p>&nbsp;</p>\n\n<p>而且一旦产生了一个问题，就会导致系统整体出问题。就需要为了解决各种MQ引发的技术问题，采取很多的技术方案。</p>\n\n<p>&nbsp;</p>\n\n<p>关于这个，我们后面会用专门的文章聊聊MQ中间件的这些问题的解决方案，包括：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p><strong>消息高可靠传递（0丢失）</strong></p>\n	</li>\n	<li>\n	<p><strong>消息幂等性传递</strong><strong>（绝对不重复）</strong></p>\n	</li>\n	<li>\n	<p><strong>百万消息积压的线上故障处理</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<h3><strong>3、分布式一致性问题</strong></h3>\n\n<p>引入消息中间件，还有分布式一致性的问题。</p>\n\n<p>&nbsp;</p>\n\n<p>举个例子，比如说系统C现在处理自己本地数据库成功了，然后发送了一个消息给MQ，系统D也确实是消费到了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是结果不幸的是，系统D操作自己本地数据库失败了，那这个时候咋办？</p>\n\n<p>&nbsp;</p>\n\n<p>系统C成功了，系统D失败了，会导致系统整体数据不一致了啊。</p>\n\n<p>&nbsp;</p>\n\n<p>所以此时又需要使用可靠消息最终一致性的分布式事务方案来保障。</p>\n\n<p>&nbsp;</p>\n\n<p>关于这个，可以参考之前的一篇文章：</p>\n\n<p>&nbsp;</p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzU0OTk3ODQ3Ng==&amp;mid=2247483876&amp;idx=1&amp;sn=51f8eadc16efd6b89eb1f3c6abe67e25&amp;chksm=fba6e9e7ccd160f183b344d4773841ad8df9a2c099a16aae516ddb45aef7eaccb83570d171fe&amp;scene=21#wechat_redirect\" target=\"_blank\">《最终一致性分布式事务的99.99%高可用保障生产实践》</a></p>\n\n<p>&nbsp;</p>\n\n<p>我们在里面详细阐述了系统之间异步调用场景下，如何采用分布式事务方案保证其数据一致性。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<h3><strong>3、总结</strong></h3>\n\n<p>&nbsp;</p>\n\n<p>最后，我们来做一个简单的小结。</p>\n\n<p>&nbsp;</p>\n\n<p>在面试中要答好这个问题，首先一定要熟悉MQ这个技术的优缺点。了解清楚把他引入系统是为了解决哪些问题的，但是他自身又会带来哪些问题。</p>\n\n<p>&nbsp;</p>\n\n<p>此外，对于引入MQ以后，是否对他自身可能引发的问题有一些方案的设计，来保证你的系统高可用、高可靠的运行，保证数据的一致性。这个也有做好相应的准备。</p>\n','ca928e8718654aa5a802e2f69277b137,1c76b9848f5f4d71a5e88b20dbaf38f4',6,0,'ea6943fef5154910add617c96c4cf740',1,'2018-12-14 08:58:52','2018-12-14 08:58:52',NULL,'0','陌溪','蘑菇博客','2c93dfab0e754006866f8ed486923a41',1),('c459e7c261884086b5e462fa4f26cc04','简单实现MySQL数据库的日志审计','简单实现MySQL数据库的日志审计','<p>来源：https://www.freebuf.com/articles/es/192062.html</p>\n\n<h2>0&times;0 背景&nbsp;</h2>\n\n<p><strong>由于MySQL社区版没有自带的审计功能或插件，对于等级保护当中对数据库管理的要求的就存在一定的不满足情况的，抛开条条框框不说数据库的日志是值得研究的，通过收集数据库的日志到企业SOC平台便于安全事件的溯源与故障分析，配合目前的UEBA技术能够轻松发现很多恶意事件。&nbsp;</strong></p>\n\n<p>根据等级保护内容第四章&ldquo;数据库管理系统安全技术要求&rdquo;中&nbsp;第四节&ldquo;数据库安全审计&rdquo;中明确提出数据库管理系统的安全审计应：</p>\n\n<blockquote>\n<p>1. 建立独立的安全审计系统；</p>\n\n<p>2. 定义与数据库安全相关的审计事件；</p>\n\n<p>3. 设置专门的安全审计员；</p>\n\n<p>4. 设置专门用于存储数据库系统审计数据的安全审计库；</p>\n\n<p>5. 提供适用于数据库系统的安全审计设置、分析和查阅的工具。&nbsp;</p>\n</blockquote>\n\n<h2>0&times;1 部署插件</h2>\n\n<p><strong>&nbsp;</strong>为了节省购买一些安全设备的费用，可以尝试使用一些开源的日志审计插件。Mysql-audit是macfee公司基于percona开发的MySQL的SQL审计插件。</p>\n\n<blockquote>\n<p>源码地址如下：<a href=\"https://github.com/mcafee/mysql-audit\">https://github.com/mcafee/mysql-audit</a></p>\n</blockquote>\n\n<p>首先确定当前mysql的版本去官网下载与之相对应的插件：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片1.png\" src=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片2.png\" src=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png!small\" style=\"width:690px\" /></a></p>\n\n<p>&nbsp;解压插件后需要确认mysql插件的安装目录：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片3.png\" src=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片4.png\" src=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png!small\" style=\"width:566px\" /></a></p>\n\n<p>将解压出来的插件libaudit_plugin.so复制到插件的目录下：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片5.png\" src=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png!small\" style=\"width:690px\" /></a></p>\n\n<p>使用mysql的函数install plugin导入此插件后通过show plugin确认是否导入成功。</p>\n\n<p>主要命令如下：</p>\n\n<pre>\n<code>install plugin audit soname ‘libaudit_plugin.so’</code></pre>\n\n<p><img alt=\"图片6.png\" src=\"https://image.3001.net/images/20181216/1544951819_5c16180b1c8a8.png!small\" style=\"width:690px\" /><img alt=\"图片7.png\" src=\"https://image.3001.net/images/20181216/1544951820_5c16180cb659a.png!small\" style=\"width:690px\" /></p>\n\n<p>安装完成之后并不会立马开始审计内容，需要定义一些参数。</p>\n\n<p>Audit_json_file这个参数要整体控制是否开启审计功能使用命令：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Set variables audit_json_file=on</code></pre>\n\n<p>&nbsp; 开启审计功能：</p>\n\n<p><img alt=\"图片8.png\" src=\"https://image.3001.net/images/20181216/1544951841_5c1618210a29a.png!small\" style=\"width:580px\" /></p>\n\n<p>审计后的记录名可以通过查询变量audit_json_log_file获取：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Show variables like “audit_json_log_file”</code></pre>\n\n<p>默认的审计记录格式如下：</p>\n\n<p><img alt=\"图片9.png\" src=\"https://image.3001.net/images/20181216/1544951858_5c16183262f9c.png!small\" style=\"width:690px\" /></p>\n\n<p>Json格式如下：</p>\n\n<p><img alt=\"图片10.png\" src=\"https://image.3001.net/images/20181216/1544951874_5c1618427bc3e.png!small\" style=\"width:690px\" /></p>\n\n<p>同时插件支持一些自定义的参数与命令，包括白名单与黑名单的功能。</p>\n\n<blockquote>\n<p>Audit_whitelist_users: 不审计user用户的所有命令</p>\n\n<p>Aduit_record_cmds: 需要进行审计的命令种类</p>\n</blockquote>\n\n<p><img alt=\"图片11.png\" src=\"https://image.3001.net/images/20181216/1544951883_5c16184b68f60.png!small\" style=\"width:601px\" /></p>\n\n<p>更多的参数配置项目可以参考官方给的手册：</p>\n\n<blockquote>\n<p><a href=\"https://github.com/mcafee/mysql-audit/wiki/Configuration\">https://github.com/mcafee/mysql-audit/wiki/Configuration</a></p>\n</blockquote>\n\n<p><img alt=\"图片12.png\" src=\"https://image.3001.net/images/20181216/1544951898_5c16185aeaa2e.png!small\" style=\"width:690px\" /></p>\n\n<h2>0&times;2 总结</h2>\n\n<p>1. 通过插件的方式可以实现mysql日志的审计通过ELK的框架实现日志的保存与分析，再通过后期写一些脚本分析可以实现安全检测与业务分析等多个功能，关键是零成本特别适合那些&rdquo;一个人的安全部&rdquo;有此需求的同行们.&nbsp;</p>\n\n<p>2. 根据一些测试数据表示，插件对性能的影响是比较大的约有20%左右的消耗需要结合具体的业务情况进行评估。</p>\n','0b51c75ed5744cdcadefe0ad947be9b6',0,0,'e06331bc9fff4a7186439f2a34c199af',1,'2018-12-29 10:27:30','2018-12-29 10:27:30',NULL,'1','陌溪_','https://www.freebuf.com/articles/es/192062.html','093d8bdd01c84890a928e923d5c235fe',0),('cced737de6d840758ed1349aef774988','CKEditor如何配置能从word中直接粘贴图片','CKEditor如何配置能从word中直接粘贴图片','<p>&nbsp; &nbsp;之前配置通过网上教程，配置好了CKEditor图片上传好，发现效果并不好，因为word中的图片是不能直接复制粘贴上去的，直接复制的话，会出现下面的情况。</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541383489045.png\" style=\"height:405px; width:600px\" /></p>\n\n<p>其实ckeditor是支持复制上传的，只需要在之前的js的filebrowserImageUploadUrl配置的上传路径最后加一个?就可以了，如下：</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;//开启工具栏&ldquo;图像&rdquo;中文件上传功能，后面的url为待会要上传action要指向的的action或servlet</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;config.filebrowserImageUploadUrl = &quot;http://localhost:8602/ckeditor/imgUpload?&quot;;</p>\n\n<p>我们ckeditor的config.js文件中， 找到上传的方法，后方加入问号，就能够成功添加QQ截图和word中图片了</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541384829124.png\" style=\"height:389px; width:785px\" /></p>\n\n<p>&nbsp;</p>\n','a9a747d944c24845815356f72723ef8e',5,0,'fc40260e4fda4e99a4c7a32635f4dc15',1,'2018-11-05 10:27:17','2018-11-05 10:27:17',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('cced8cef5ad8423494573ca2e337cd40','WEB前端知识汇总','WEB前端知识汇总','<p>Web前端技术由<strong>html、css和 javascript</strong>三大部分构成，是一个庞大而复杂的技术体系，其复杂程度不低于任何一门后端语言。而我们在学习它的时候往往是先从某一个点切入，然后不断地接触和学习新的知识点，因此对于初学者很难理清楚整个体系的脉络结构。本文将对Web前端知识体系进行简单的梳理，对应的每个知识点点到为止，不作详细介绍。目的是帮助大家审查自己的知识结构是否完善，如有遗漏或不正确的地方，希望共勉。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051780753.png\" style=\"height:363px; width:648px\" /></p>\n\n<p><strong>一、JAVASCRIPT 篇</strong></p>\n\n<p><strong>0、基础语法</strong></p>\n\n<p>Javascript 基础语法包括：变量声明、数据类型、函数、控制语句、内置对象等。</p>\n\n<p>在ES5 中，变量声明有两种方式，分别是 &nbsp;var 和 function ，var<br />\n用于声明普通的变量，接收任意类型，function用于声明函数。另外，ES6 新增了 let、const、import 和 class<br />\n等四个命令，分别用以声明 普通变量、静态变量、模块 和 类 。</p>\n\n<p>JS数据类型共有六种，分别是 String、Number、Boolean、Null、Undefined 和 Object 等， 另外，ES6新增了<br />\nSymbol 类型。其中，Object 是引用类型，其他的都是原始类型(Primitive Type)。</p>\n\n<p>原始类型也称为基本类型或简单类型，因为其占据空间固定，是简单的数据段，为了便于提升变量查询速度，将其存储在栈(stack)中(按值访问)。为了便于操作这类数据，ECMAScript<br />\n提供了 3 个&nbsp;基本包装类型&nbsp;：Boolean、Number 和 String<br />\n。基本包装类型是一种特殊的引用类型，每当读取一个基本类型值的时候，JS内部就会创建一个对应的包装对象，从而可以调用一些方法来操作这些数据。</p>\n\n<p>引用类型由于其值的大小会改变，所以不能将其存放在栈中，否则会降低变量查询速度，因此其存储在堆(heap)中，存储在变量处的值是一个指针，指向存储对象的内存处(按址访问)，对于引用类型的值，可以为其添加属性和方法，也可以改变和删除其属性和方法；但基本类型不可以添加属性和方法。</p>\n\n<p>Javascript 可以通过 typeof 来判断原始数据类型，但不能判断引用类型，要知道引用类型的具体类型，需要通过 Object 原型上的<br />\ntoString 方法来判断。</p>\n\n<p>JS中的函数存在着三种角色：普通函数、构造函数、对象方法。同一个函数，调用方式不同，函数的作用不一样，所扮演的角色也不一样。直接调用时就是普通函数，通过new创建对象时就是构造函数，通过对象调用时就是方法。</p>\n\n<p>JS常用的内置对象有window、Date、Array、JSON、RegExp<br />\n等，window是浏览器在执行脚本时创建的一个全局对象，主要描述浏览器窗口相关的属性和状态，这个后面会讲到，Date 和 Array<br />\n使用场景最多，JSON主要用于对象的序列化和反序列化，还有一个作用就是实现对象的深拷贝。RegExp 即正则表达式，是处理字符串的利器。</p>\n\n<p><strong>1、函数原型链</strong></p>\n\n<p>JS是一种基于对象的语言，但在ES6 之前是不支持继承的，为了具备继承的能力，Javascript 在&nbsp;<strong>函数对象</strong><br />\n上建立了原型对象prototype，并以函数对象为主线，从上至下，在JS内部构建了一条&nbsp;<strong>原型链</strong>&nbsp;。原型链把一个个独立的对象联系在一起，Object<br />\n则是所有对象的祖宗，&nbsp;任何对象所建立的原型链最终都指向了Object，并以 Object 终结。 ****</p>\n\n<p>简单来说就是建立了变量查找机制，当访问一个对象的属性时，先查找对象本身是否存在，如果不存在就去该对象所在的原型连上去找，直到Object对象为止，如果都没有找到该属性才会返回undefined。因此，我们可以通过原型链来实现JS继承。</p>\n\n<p><strong>2、函数作用域</strong></p>\n\n<p>函数作用域就是变量在声明它们的函数体以及这个函数体嵌套的任意函数体内都是有定义的。因此，&nbsp;<strong>JS中没有块级作用域，只有函数作用域</strong><br />\n，这种设计导致JS中出现了&nbsp;<strong>变量提升</strong>&nbsp;的问题。简单来说就是，将变量声明提升到它所在作用域的最开始的部分，为了解决变量提升带来的副作用，ES6新增了<br />\nlet 命令来声明变量，let 所声明的变量只在 let 命令所在的代码块内有效，所以不存在变量提升问题。</p>\n\n<p><strong>3、this 指针</strong></p>\n\n<p>this 指针存在于函数中，用以标识函数运行时所处的上下文。函数的类型不同，this指向规则也不一样：对于普通函数，this<br />\n始终指向全局对象window；对于构造函数，this则指向新创建的对象；对于方法，this指向调用该方法的对象。另外，Function对象也提供了call、apply<br />\n和 bind 等方法来改变函数的 this 指向，其中，call 和 apply 主动执行函数，bind一般在事件回调中使用，而 call 和 apply<br />\n的区别只是参数的传递方式不同。</p>\n\n<p>如果往深的去理解，无论什么函数，this是否被改变， 本质上，this 均指向触发函数运行时的那个对象。而在函数运行时，this 的值是不能被改变的。</p>\n\n<p><strong>4、new 操作符</strong></p>\n\n<p>函数的创建有三种方式，即 显式声明、匿名定义 和 new Function()<br />\n。前面提到，JS中的函数即可以是函数，也可以是方法，还可以是构造函数。当使用new来创建对象时，该函数就是构造函数，JS将新对象的原型链指向了构造函数的原型对象，于是就在新对象和函数对象之间建立了一条原型链，通过新对象可以访问到函数对象原型prototype中的方法和属性。</p>\n\n<p><strong>5、闭包</strong></p>\n\n<p>通俗来讲，闭包是一个具有独立作用域的静态执行环境。和函数作用域不同的是，闭包的作用域是静态的，可以永久保存局部资源，而函数作用域只存在于运行时，函数执行结束后立即销毁。因此，闭包可以形成一个独立的执行过程，关于闭包更</p>\n\n<p><strong>6、单线程和异步队列</strong></p>\n\n<p>Javascript<br />\n是单线程语言，在浏览器中，当JS代码被加载时，浏览器会为其分配一个主线程来执行任务(函数)，主线程会形成一个全局执行环境，执行环境在栈中采用后进先出(LIFO)的顺序来执行代码块，以保证所有的函数能按照正确的顺序被执行。</p>\n\n<p>但在浏览器中，有一些任务是非常耗时的，比如ajax请求、定时器、事件等，为了保证非耗时任务不受影响，Javascript<br />\n在执行环境中维护了一个异步队列(也叫工作线程)，并将这些耗时任务放入队列中进行等待，这些任务的执行时机并不确定，只有当主线程的任务执行完成以后，主线程才会去检查异步队列中的任务是否需要开始执行。</p>\n\n<p>JS中的 setTimeout 和 setInterval 就是典型的异步操作，它们会被放入异步队列中等待，即使 setTimeout(0)<br />\n也不会被立即执行，需要等到当前同步任务结束后才会被执行。</p>\n\n<p><strong>7、异步通信 Ajax技术</strong></p>\n\n<p>Ajax是浏览器专门用来和服务器进行交互的异步通讯技术，其核心对象是XMLHttpRequest，通过该对象可以创建一个Ajax请求。Ajax请求是一个耗时的异步操作，当请求发出以后，Ajax<br />\n提供了两个状态位来描述请求在不同阶段的状态，这两个状态位分别是&nbsp;<strong>readyState</strong>&nbsp;和&nbsp;<strong>status</strong>&nbsp;，readyState 通过<br />\n5个状态码来描述一个请求的5个阶段：</p>\n\n<p>0 - 请求未发送，初始化阶段</p>\n\n<p>1 - 请求发送中，服务器还未收到请求</p>\n\n<p>2 - 请求发送成功，服务器已收到请求</p>\n\n<p>3 - 服务器处理完成，开始响应请求，传输数据</p>\n\n<p>4 - 客户端收到请求，并完成了数据下载，生成了响应对象</p>\n\n<p>status 用于描述服务端对请求处理的情况，200 表示正确响应了请求，404 表示服务器找不到资源，500 代表服务器内部异常等等。</p>\n\n<p>Ajax对象还可以设置一个timeout 值，代表超时时间，切记：timeout 只会影响<br />\nreadyState，而不会影响status，因为超时只会中断数据传输，但不会影响服务器的处理结果。 如果 timeout 设置的不合理，就会导致响应码<br />\nstatus 是200，但 response里却没有数据，这种情况就是服务器正确响应了请求，但数据的下载被超时中断了。</p>\n\n<p>为了防止XSS攻击，浏览器对Ajax请求做了限制，不允许Ajax 跨域请求服务器，只允许请求和当前地址同域的服务器资源。但不限制脚本和标签发送跨域请求，比如<br />\nscript 和 img 标签，因此可以利用脚本跨域能力来实现跨域请求，即JSONP 的原理。</p>\n\n<p>JSONP虽然可以解决跨域问题，但只能是get请求，并且没有有效的错误捕获机制，为了解决这个问题，XMLHttpRequest Level2 提出了<br />\nCORS 模型，即&nbsp;<strong>跨域资源共享，</strong>&nbsp;它不是一个新的API，而是一个标准规范，当浏览器发现该请求需要跨域时，就会自动在头信息中添加一个 Origin<br />\n字段，用以说明本次请求来自哪个源。服务器根据这个值，决定是否同意这次请求。&nbsp;</p>\n\n<p>随着移动端的快速发展，Web技术的应用场景正在变得越来越复杂，&nbsp;<strong>关注点分离</strong>&nbsp;原则在系统设计层面就显得越来越重要，而XMLHttpRequest 是<br />\nAjax 最古老的一个接口，因而不太符合现代化的系统设计理念。因此，浏览器提供了一个新的 Ajax 接口，即&nbsp;<strong>Fetch API</strong>&nbsp;，Fetch<br />\nAPI 是基于Promise 思想设计的，更符合关注点分离原则。</p>\n\n<p><strong>8、模块化</strong></p>\n\n<p>历史上，Javascript 规范一直没有模块(module)体系，即无法将一个大程序拆分成互相依赖的小文件，再用简单的方法拼装起来。在 ES6<br />\n之前，为了实现JS模块化编程，社区制定了一些模块加载方案，最主要有 CMD 和 AMD 两种，分别以commonjs 和 requirejs为代表。ES6<br />\n在语言标准的层面上，实现了模块化编程，其设计思想是，尽量静态化，使得编译时就能确定模块的依赖关系，即编译时加载，而CMD和AMD是在运行时确定依赖关系，即运行时加载。</p>\n\n<p><strong>9、Node.js</strong></p>\n\n<p>Node.js&nbsp;是一个基于 Chrome V8 引擎的 JavaScript<br />\n运行环境，它的运行不依赖于浏览器作为宿主环境，而是和服务端程序一样可以独立的运行，这使得JS编程第一次从客户端被带到了服务端，Node.js在服务端的优势是，它采用单线程和异步I/O模型，实现了一个高并发、高性能的运行时环境。相比传统的多线程模型，Node.js实现简单，并且可以减少资源开销。</p>\n\n<p><strong>10、ES6</strong></p>\n\n<p>ES6 是&nbsp;ECMAScript 6.0<br />\n的简写，即Javascript语言的下一代标准，已经在2015年6月正式发布了，它的目标是让JS能够方便的开发企业级大型应用程序，因此，ES6的一些规范正在逐渐向Java、C#等后端语言标准靠近。ES6<br />\n规范中，比较重大的变化有以下几个方面：</p>\n\n<p>新增 let、const 命令 来声明变量，和var 相比，let<br />\n声明的变量不存在变量提升问题，但没有改变JS弱类型的特点，依然可以接受任意类型变量的声明；const<br />\n声明的变量不允许在后续逻辑中改变，提高了JS语法的严谨性。</p>\n\n<p>新增解构赋值、rest语法、箭头函数，这些都是为了让代码看起来更简洁，而包装的语法糖。</p>\n\n<p>新增模块化，这是JS走向规范比较重要的一步，让前端更方便的实现工程化。</p>\n\n<p>新增类和继承的概念，配合模块化，JS也可以实现高复用、高扩展的系统架构。</p>\n\n<p>新增模板字符串功能，高效简洁，结束拼接字符串的时代。</p>\n\n<p>新增Promise对象，解决异步回调多层嵌套的问题。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、CSS 篇</strong></p>\n\n<p><strong>1、CSS选择器</strong></p>\n\n<p>CSS选择器即通过某种规则来匹配相应的标签，并为其设置CSS样式，常用的有类选择器、标签选择器、ID选择器、后代选择器、群组选择器、伪类选择器(before/after)、兄弟选择器(+~)、属性选择器等等。</p>\n\n<p><strong>2、CSS Reset</strong></p>\n\n<p>HTML<br />\n标签在不设置任何样式的情况下，也会有一个默认的CSS样式，而不同内核浏览器对于这个默认值的设置则不尽相同，这样可能会导致同一套代码在不同浏览器上的显示效果不一致，而出现兼容性问题。因此，在初始化时，需要对常用标签的样式进行初始化，使其默认样式统一，这就是CSS<br />\nReset ，即CSS样式重置，比如：*{margin:0,padding:0} 就是最简单CSS Reset， 关于CSS重置请参考：<br />\n<em>Neat.css</em></p>\n\n<p><strong>3、盒子布局</strong></p>\n\n<p>盒子模型是CSS比较重要的一个概念，也是CSS 布局的基石。<br />\n常见的盒子模型有块级盒子(block)和行内盒子(inline-block)，与盒子相关的几个属性有：margin、border、padding和content<br />\n等，这些属性的作用是设置盒子与盒子之间的关系以及盒子与内容之间的关系。其中，只有普通文档流中块级盒子的垂直外边距才会发生合并，而行内盒子、浮动盒子或绝对定位之间的外边距不会合并。另外，box-sizing<br />\n属性的设置会影响盒子width和height的计算。</p>\n\n<p><strong>4、浮动布局</strong></p>\n\n<p>设置元素的 float 属性值为 left 或<br />\nright，就能使该元素脱离普通文档流，向左或向右浮动。一般在做宫格布局时会用到，如果子元素全部设置为浮动，则父元素是塌陷的，这时就需要清除浮动，清除浮动的方法也很多，常用的方法是在元素末尾加空元素设置clear:both，<br />\n更高级一点的就给父容器设置before/after来模拟一个空元素，还可以直接设置overflow属性为auto/hidden来清除浮动。除浮动可以实现宫格布局，行内盒子(inline-block)和table也可以实现同样的效果。</p>\n\n<p><strong>5、定位布局</strong></p>\n\n<p>设置元素的position属性值为 relative/absolute/fixed，就可以使该元素脱离文档流，并以某种参照坐标进行偏移。其中，releave<br />\n是相对定位，它以自己原来的位置进行偏移，偏移后，原来的空间不会被其他元素占用；absolute<br />\n是绝对定位，它以离自己最近的定位父容器作为参照进行偏移；为了对某个元素进行定位，常用的方式就是设置父容器的poistion:relative，因为相对定位元素在不设置<br />\ntop 和 left 值时，不会对元素位置产生影响；fixed<br />\n即固定定位，它则以浏览器窗口为参照物，PC网页底部悬停的banner一般都可以通过fixed定位来实现，但fixed属性在移动端有兼容性问题，因此不推荐使用，可替代的方案是：绝对定位+内部滚动。</p>\n\n<p><strong>6、弹性布局</strong></p>\n\n<p>弹性布局即Flex布局，定义了flex的容器一个可伸缩容器，首先容器本身会根据容器中的元素动态设置自身大小；然后当Flex容器被应用一个大小时（width和height），将会自动调整容器中的元素适应新大小。Flex容器也可以设置伸缩比例和固定宽度，还可以设置容器中元素的排列方向（横向和纵向）和是否支持元素的自动换行。有了这个神器，做页面布局的可以方便很多了。注意，设为Flex布局以后，子元素的float、clear和vertical-align<br />\n属性将失效。</p>\n\n<p><strong>7、CSS3 动画</strong></p>\n\n<p>CSS3中规范引入了两种动画，分别是 transition 和 animation，transition<br />\n可以让元素的CSS属性值的变化在一段时间内平滑的过渡，形成动画效果，为了使元素的变换更加丰富多彩，CSS3还引入了transfrom<br />\n属性，它可以通过对元素进行 平移(translate)、旋转(rotate)、放大缩小(scale)、倾斜(skew)<br />\n等操作，来实现2D和3D变换效果。transiton 还有一个结束事件<br />\ntransitionEnd，该事件是在CSS完成过渡后触发，如果过渡在完成之前被移除，则不会触发transitionEnd 。</p>\n\n<p>animation 需要设置一个@keyframes，来定义元素以哪种形式进行变换，<br />\n然后再通过动画函数让这种变换平滑的进行，从而达到动画效果，动画可以被设置为永久循环演示。设置&nbsp;animation-play-state:paused<br />\n可以暂停动画，设置&nbsp;animation-fill-mode:forwards<br />\n可以让动画完成后定格在最后一帧。另外，还可以通过JS监听animation的开始、结束和重复播放时的状态，分别对应三个事件，即<br />\nanimationStart、animationEnd、animationIteration 。注意，当播放次数设置为1时，不会触发<br />\nanimationIteration 。</p>\n\n<p>和 transition相比，animation 设置动画效果更灵活更丰富，还有一个区别是：transition<br />\n只能通过主动改变元素的css值才能触发动画效果，而animation一旦被应用，就开始执行动画。另外，HTML5 还新增了一个动画API，即<br />\nrequestAnimationFrame，它通过JS来调用，并按照屏幕的绘制频率来改变元素的CSS属性，从而达到动画效果。</p>\n\n<p><strong>8、BFC</strong></p>\n\n<p>BFC是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面元素。比如：内部滚动就是一个BFC，当一个父容器的overflow-y设置为auto时，并且子容器的长度大于父容器时，就会出现内部滚动，无论内部的元素怎么滚动，都不会影响父容器以外的布局，这个父容器的渲染区域就叫BFC。满足下列条件之一就可触发BFC：</p>\n\n<p>根元素，即HTML元素</p>\n\n<p>float的值不为none</p>\n\n<p>overflow的值不为visible</p>\n\n<p>display的值为inline-block、table-cell、table-caption</p>\n\n<p>position的值为absolute或fixed</p>\n\n<p><strong>9、Sprite，Iconfont，@font-face</strong></p>\n\n<p>对于大型站点，为了减少http请求的次数，一般会将常用的小图标排到一个大图中，页面加载时只需请求一次网络，<br />\n然后在css中通过设置background-position来控制显示所需要的小图标，这就是Sprite图。</p>\n\n<p>Iconfont，即字体图标，就是将常用的图标转化为字体资源存在文件中，通过在CSS中引用该字体文件，然后可以直接用控制字体的css属性来设置图标的样式，字体图标的好处是节省网络请求、其大小不受屏幕分辨率的影响，并且可以任意修改图标的颜色。</p>\n\n<p>@font-face是CSS3中的一个模块，通过@font-face可以定义一种全新的字体，然后就可以通过css属性font-family来使用这个字体了，即使操作系统没有安装这种字体，网页上也会正常显示出来。</p>\n\n<p><strong>10、CSS Hack</strong></p>\n\n<p>早期，不同内核浏览器对CSS属性的解析存在着差异，导致显示效果不一致，比如 margin<br />\n属性在ie6中显示的距离会比其他浏览器中显示的距离宽2倍，也就是说margin-left:20px;在ie6中距左侧元素的实际显示距离是40px，而在非ie6的浏览器上显示正常。因此，如果要想让所有浏览器中都显示是20px的宽度，就需要在CSS样式中加入一些特殊的符号，让不同的浏览器识别不同的符号，以达到应用不同的CSS样式的目的，这种方式就是css<br />\nhack， 对于ie6中的margin应用hack就会变成这样：.el {margin-left:20px;_margin-left:10px}</p>\n\n<p>兼容各大浏览器的 css hack 如下：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051750949.png\" style=\"height:363px; width:800px\" /></p>\n\n<p><strong>三、HTML 篇</strong></p>\n\n<p><strong>1、BOM</strong></p>\n\n<p>BOM 是&nbsp;Browser Object Model<br />\n的缩写，即浏览器对象模型，当一个浏览器页面初始化时，会在内存创建一个全局的对象，用以描述当前窗口的属性和状态，这个全局对象被称为浏览器对象模型，即BOM。BOM的核心对象就是window，window<br />\n对象也是BOM的顶级对象，其中包含了浏览器的 6个核心模块：</p>\n\n<p><strong>document</strong>&nbsp;-<br />\n即文档对象，渲染引擎在解析HTML代码时，会为每一个元素生成对应的DOM对象，由于元素之间有层级关系，因此整个HTML代码解析完以后，会生成一个由不同节点组成的树形结构，俗称DOM树，document<br />\n用于描述DOM树的状态和属性，并提供了很多操作DOM的API。</p>\n\n<p><strong>frames</strong>&nbsp;- HTML 子框架，即在浏览器里嵌入另一个窗口，父框架和子框架拥有独立的作用域和上下文。</p>\n\n<p><strong>history</strong>&nbsp;- 以栈(FIFO)的形式保存着页面被访问的历史记录，页面前进即入栈，页面返回即出栈。</p>\n\n<p><strong>location</strong>&nbsp;-&nbsp;提供了当前窗口中加载的文档相关信息以及一些导航功能。</p>\n\n<p><strong>navigator</strong>&nbsp;-&nbsp;用来描述浏览器本身，包括浏览器的名称、版本、语言、系统平台、用户特性字符串等信息。</p>\n\n<p><strong>screen</strong>&nbsp;- 提供了浏览器显示屏幕的相关属性，比如显示屏幕的宽度和高度，可用宽度和高度。</p>\n\n<p><strong>2、DOM 系统</strong></p>\n\n<p>DOM 是 Document Object Model 的缩写，即 文档对象模型，是所有浏览器公共遵守的标准，DOM<br />\n将HTML和XML文档映射成一个由不同节点组成的树型结构，俗称DOM树。其核心对象是document，用于描述DOM树的状态和属性，并提供对应的DOM操作API。随着历史的发展，DOM<br />\n被划分为1级、2级、3级，共3个级别：</p>\n\n<p><strong>1级DOM</strong>&nbsp;- 在1998年10月份成为W3C的提议，由DOM核心与DOM<br />\nHTML两个模块组成。DOM核心能映射以XML为基础的文档结构，允许获取和操作文档的任意部分。DOM<br />\nHTML通过添加HTML专用的对象与函数对DOM核心进行了扩展。</p>\n\n<p><strong>2级DOM</strong>&nbsp;- 鉴于1级DOM仅以映射文档结构为目标，DOM<br />\n2级面向更为宽广。通过对原有DOM的扩展，2级DOM通过对象接口增加了对鼠标和用户界面事件（DHTML长期支持鼠标与用户界面事件）、范围、遍历（重复执行DOM文档）和层叠样式表（CSS）的支持。同时也对DOM<br />\n1的核心进行了扩展，从而可支持XML命名空间。</p>\n\n<p><strong>3级DOM</strong>&nbsp;-<br />\n通过引入统一方式载入和保存文档和文档验证方法对DOM进行进一步扩展，DOM3包含一个名为&ldquo;DOM载入与保存&rdquo;的新模块，DOM核心扩展后可支持XML1.0的所有内容，包括XML<br />\nInfoset、 XPath、和XML Base。</p>\n\n<p>浏览器对不同级别DOM的支持情况如下所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051729748.png\" style=\"height:128px; width:800px\" /></p>\n\n<p>从图中可以看出，移动端常用的 webkit 内核浏览器目前只支持DOM2，而不支持DOM3 。</p>\n\n<p><strong>3、事件系统</strong></p>\n\n<p>事件是用户与页面交互的基础，到目前为止，DOM事件从PC端的 鼠标事件(mouse) 发展到了 移动端的 触摸事件(touch) 和<br />\n手势事件(guesture)，touch事件描述了手指在屏幕操作的每一个细节，guesture 则是描述多手指操作时更为复杂的情况，总结如下：</p>\n\n<p>第一根手指放下，触发 touchstart，除此之外什么都不会发生</p>\n\n<p>手指滑动时，触发touchmove</p>\n\n<p>第二根手指放下，触发 gesturestart</p>\n\n<p>触发第二根手指的 touchstart</p>\n\n<p>立即触发&nbsp;gesturechange</p>\n\n<p>任意手指移动，持续触发 gesturechange</p>\n\n<p>第二根手指弹起时，触发 gestureend，以后将不会再触发 gesturechange</p>\n\n<p>触发第二根手指的 touchend</p>\n\n<p>触发touchstart (多根手指在屏幕上，提起一根，会刷新一次全局touch) _ ___</p>\n\n<p>弹起第一根手指，触发 touchend</p>\n\n<p>更多关于手势事件的介绍请参考：<br />\n<em>gesture事件处理复杂手势</em></p>\n\n<p>DOM2.0 模型将事件处理流程分为三个阶段，即&nbsp;<strong>事件捕获阶段</strong>&nbsp;、&nbsp;<strong>事件处理阶段</strong>&nbsp;、&nbsp;<strong>事件冒泡阶段，</strong>&nbsp;如图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051713349.png\" style=\"height:292px; width:656px\" /></p>\n\n<p><strong>事件捕获</strong>&nbsp;：当用户触发点击事件后，顶层对象document 就会发出一个事件流，从最外层的DOM节点向目标元素节点传递，最终到达目标元素。</p>\n\n<p><strong>事件处理</strong>&nbsp;：当到达目标元素之后，执行目标元素绑定的处理函数。如果没有绑定监听函数，则不做任何处理。</p>\n\n<p><strong>事件冒泡</strong>&nbsp;：事件流从目标元素开始，向最外层DOM节点传递，途中如果有节点绑定了事件处理函数，这些函数就会被执行。</p>\n\n<p>利用事件冒泡原理可以实现&nbsp;<strong>事件委托</strong><br />\n，所谓事件委托，就是在父元素上添加事件监听器，用以监听和处理子元素的事件，避免重复为子元素绑定相同的事件。当目标元素的事件被触发以后，这个事件就从目标元素开始，向最外层元素传递，最终冒泡到父元素上，父元素再通过event.target<br />\n获取到这个目标元素，这样做的好处是，父元素只需绑定一个事件监听，就可以对所有子元素的事件进行处理了，从而减少了不必要的事件绑定，对页面性能有一定的提升。</p>\n\n<p><strong>4、HTML解析过程</strong>&nbsp;****</p>\n\n<p>浏览器加载 html 文件以后，渲染引擎会从上往下，一步步来解析HTML标签，大致过程如下：</p>\n\n<p>用户输入网址，浏览器向服务器发出请求，服务器返回html文件；</p>\n\n<p>渲染引擎开始解析 html 标签，并将标签转化为DOM节点，生成 DOM树；</p>\n\n<p>如果head 标签中引用了外部css文件，则发出css文件请求，服务器返回该文件，该过程会阻塞后面的解析；</p>\n\n<p>如果引用了外部 js 文件，则发出 js 文件请求，服务器返回后立即执行该脚本，这个过程也会阻塞html的解析；</p>\n\n<p>引擎开始解析 body 里面的内容，如果标签里引用了css 样式，就需要解析刚才下载好的css文件，然后用css来设置标签的样式属性，并生成渲染树；</p>\n\n<p>如果 body 中的 img 标签引用了图片资源，则立即向服务器发出请求，此时引擎不会等待图片下载完毕，而是继续解析后面的标签；</p>\n\n<p>服务器返回图片文件，由于图片需要占用一定的空间，会影响到后面元素的排版，因此引擎需要重新渲染这部分内容；</p>\n\n<p>如果此时 js 脚本中运行了 style.display=&quot;none&quot;，布局被改变，引擎也需要重新渲染这部分代码；</p>\n\n<p>直到 html 结束标签为止，页面解析完毕。</p>\n\n<p><strong>5、重绘 和 回流</strong></p>\n\n<p>当渲染树中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建。这就称为回流。比如上面的img文件加载完成后就会引起回流，每个页面至少需要一次回流，就是在页面第一次加载的时候。</p>\n\n<p>当渲染树中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如 background-color。则就叫称为重绘。</p>\n\n<p>从上面可以看出，回流必将引起重绘，而重绘不一定会引起回流。会引起重绘和回流的操作如下：</p>\n\n<p>添加、删除元素(回流+重绘)</p>\n\n<p>隐藏元素，display:none(回流+重绘)，visibility:hidden(只重绘，不回流)</p>\n\n<p>移动元素，比如改变top,left的值，或者移动元素到另外一个父元素中。(重绘+回流)</p>\n\n<p>对style的操作(对不同的属性操作，影响不一样)</p>\n\n<p>还有一种是用户的操作，比如改变浏览器大小，改变浏览器的字体大小等(回流+重绘)</p>\n\n<p>另外，transform<br />\n操作不会引起重绘和回流，是一种高效率的渲染。这是因为transform属于合成属性，对合成属性进行transition/animation<br />\n动画时将会创建一个合成层，这使得动画元素在一个独立的层中进行渲染，当元素的内容没有发生改变，就没必要进行重绘，浏览器会通过重新复合来创建动画帧。</p>\n\n<p><strong>6、本地存储</strong></p>\n\n<p>本地存储最原始的方式就是 cookie,cookie 是存放在本地浏览器的一段文本，数据以键值对的形式保存，可以设置过期时间。 但是 cookie<br />\n不适合大量数据的存储，因为每请求一次页面，cookie 都会发送给服务器，这使得 cookie<br />\n速度很慢而且效率也不高。因此cookie的大小被限制为4k左右(不同浏览器可能不同,分HOST)，如下所示：</p>\n\n<p>Firefox和Safari允许cookie多达4097个字节，包括名(name)、值(value) 和 等号。</p>\n\n<p>Opera允许cookie多达4096个字节，包括：名(name)、值(value)&nbsp;和 等号。</p>\n\n<p>Internet Explorer允许cookie多达4095个字节，包括：名(name)、值(value)&nbsp;和 等号。</p>\n\n<p><strong>在所有浏览器中，任何cookie大小超过限制都被忽略，且永远不会被设置。</strong></p>\n\n<p>html5 提供了两种在客户端存储数据的新方法：localStorage 和 sessionStorage, 它们都是以key/value<br />\n的形式来存储数据，前者是永久存储，后者的存储期限仅限于浏览器会话(session)，即当浏览器窗口关闭后，sessionStorage中的数据被清除。</p>\n\n<p>localStorage的存储空间大约5M左右(不同浏览器可能不同，分<br />\nHOST)，这个相当于一个5M大小的前端数据库，相比于cookie，可以节约带宽，但localStorage在浏览器隐私模式下是不可读取的，当存储数据超过了localStorage<br />\n的存储空间后会抛出异常。</p>\n\n<p>此外，H5还提供了逆天的websql和<br />\nindexedDB，允许前端以关系型数据库的方式来存储本地数据，相对来说，这个功能目前应用的场景比较少，此处不作介绍。</p>\n\n<p><strong>7、浏览器缓存机制</strong></p>\n\n<p>浏览器缓存机制是指通过 HTTP 协议头里的 Cache-Control (或 Expires) 和 Last-Modified (或 Etag)<br />\n等字段来控制文件缓存的机制。</p>\n\n<p>Cache-Control 用于控制文件在本地缓存有效时长。最常见的，比如服务器回包：Cache-Control:max-age=600<br />\n表示文件在本地应该缓存，且有效时长是600秒 (从发出请求算起)。在接下来600秒内，如果有请求这个资源，浏览器不会发出 HTTP<br />\n请求，而是直接使用本地缓存的文件。</p>\n\n<p>Last-Modified 是标识文件在服务器上的最新更新时间。下次请求时，如果文件缓存过期，浏览器通过 If-Modified-Since<br />\n字段带上这个时间，发送给服务器，由服务器比较时间戳来判断文件是否有修改。如果没有修改，服务器返回304告诉浏览器继续使用缓存；如果有修改，则返回200，同时返回最新的文件。</p>\n\n<p>Cache-Control 通常与 Last-Modified 一起使用。一个用于控制缓存有效时间，一个在缓存失效后，向服务查询是否有更新。</p>\n\n<p>Cache-Control 还有一个同功能的字段：Expires。Expires 的值一个绝对的时间点，如：Expires: Thu, 10 Nov<br />\n2015 08:45:11 GMT，表示在这个时间点之前，缓存都是有效的。</p>\n\n<p>Expires 是 HTTP1.0 标准中的字段，Cache-Control 是 HTTP1.1<br />\n标准中新加的字段，功能一样，都是控制缓存的有效时间。当这两个字段同时出现时，Cache-Control 是高优化级的。</p>\n\n<p>Etag 也是和 Last-Modified 一样，对文件进行标识的字段。不同的是，Etag<br />\n的取值是一个对文件进行标识的特征字串。在向服务器查询文件是否有更新时，浏览器通过 If-None-Match<br />\n字段把特征字串发送给服务器，由服务器和文件最新特征字串进行匹配，来判断文件是否有更新。没有更新回包304，有更新回包200。Etag 和<br />\nLast-Modified 可根据需求使用一个或两个同时使用。两个同时使用时，只要满足基中一个条件，就认为文件没有更新。</p>\n\n<p>另外有两种特殊的情况：</p>\n\n<p>手动刷新页面(F5)，浏览器会直接认为缓存已经过期(可能缓存还没有过期)，在请求中加上字段：Cache-Control:max-age=0，发包向服务器查询是否有文件是否有更新。</p>\n\n<p>强制刷新页面(Ctrl+F5)，浏览器会直接忽略本地的缓存(有缓存也会认为本地没有缓存)，在请求中加上字段：Cache-Control:no-cache<br />\n(或 Pragma:no-cache)，发包向服务重新拉取文件。</p>\n\n<p><strong>8、History</strong></p>\n\n<p>用户访问网页的历史记录通常会被保存在一个类似于栈的对象中，即history对象，点击返回就出栈，跳下一页就入栈。 它提供了以下方法来操作页面的前进和后退：</p>\n\n<p>window.history.back( ) &nbsp;返回到上一个页面</p>\n\n<p>window.history.forward( ) &nbsp;进入到下一个页面</p>\n\n<p>window.history.go( [delta] ) &nbsp;跳转到指定页面</p>\n\n<p>HTML5 对History Api 进行了增强，新增了两个Api 和一个事件，分别是pushState、replaceState 和<br />\nonpopstate：</p>\n\n<p>pushState是往history对象里添加一个新的历史记录，即压栈。</p>\n\n<p>replaceState 是替换history对象中的当前历史记录。</p>\n\n<p>当点击浏览器后退按钮或 js调用history.back 都会触发 onpopstate 事件。</p>\n\n<p>与其类似的还有一个事件：onhashchange，onhashchange是老API，浏览器支持度高，本来是用来监听hash变化的，但可以被利用来做客户端前进和后退事件的监听，而onpopstate是专门用来监听浏览器前进后退的，不仅可以支持hash，非hash的同源<br />\nurl 也支持。</p>\n\n<p><strong>9、HTML5离线缓存</strong></p>\n\n<p>HTML5离线缓存又叫Application<br />\nCache，是从浏览器的缓存中分出来的一块缓存区，如果要在这个缓存中保存数据，可以使用一个描述文件（manifest file），列出要下载和缓存的资源。</p>\n\n<p>manifest 文件是简单的文本文件，它告知浏览器被缓存的内容（以及不缓存的内容）。manifest 文件可分为三个部分：</p>\n\n<p>-&nbsp;CACHE MANIFEST&nbsp;- 在此标题下列出的文件将在首次下载后进行缓存</p>\n\n<p>-&nbsp;NETWORK&nbsp;- 在此标题下列出的文件需要与服务器的连接，且不会被缓存</p>\n\n<p>-&nbsp;FALLBACK&nbsp;- 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）</p>\n\n<p>离线缓存为应用带来三个优势：</p>\n\n<p>离线浏览 - 用户可在应用离线时使用它们</p>\n\n<p>速度 - 已缓存资源加载得更快</p>\n\n<p>减少服务器负载 - 浏览器将只从服务器下载更新过或更改过的资源。</p>\n\n<p><strong>10、Web语义化 和 SEO</strong></p>\n\n<p>Web语义化是指使用语义恰当的标签，使页面有良好的结构，页面元素有含义，能够让人和搜索引擎都容易理解。</p>\n\n<p>SEO是指在了解搜索引擎自然排名机制的基础之上，对网站进行内部及外部的调整优化，改进网站在搜索引擎中关键词的自然排名，获得更多的展现量，吸引更多目标客户点击访问网站，从而达到互联网营销及品牌建设的目标。</p>\n\n<p>搜索引擎通过爬虫技术获取的页面就是由一堆 html 标签组成的代码，人可以通过可视化的方式来判断页面上哪些内容是重点，而机器做不到。<br />\n但搜索引擎会根据标签的含义来判断内容的权重，因此，在合适的位置使用恰当的标签，使整个页面的语义明确，结构清晰，搜索引擎才能正确识别页面中的重要内容，并予以较高的权值。比如h1~h6这几个标签在SEO中的权值非常高，用它们作页面的标题就是一个简单的SEO优化。</p>\n','a9a747d944c24845815356f72723ef8e',1,0,'b936cfd2bf694d92a056170f821b5859',1,'2018-12-29 10:49:47','2018-12-29 10:49:47',NULL,'1','陌溪_','蘑菇博客','ca28ffc94ea94fbda5571e0b242021e2',0),('cf43070de33b47999dd1eca5700ffe58','CentOS下如何卸载yum安装的Eralng','CentOS下如何卸载yum安装的Eralng','<p>今天我在正式服务器部署的Rabbit的时候，因为Erlang版本的问题，不能正常的使用RabbitMQ，所有打算删除掉</p>\n\n<p>使用 yum install erlang 安装的 eralng。</p>\n\n<p>但是，在我使用 yum list | grep erlang 的时候，发现有很多的安装列表。</p>\n\n<p><br />\n<img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541155761263.png\" style=\"height:689px; width:600px\" /></p>\n\n<p>我们能看到有这么多的包，如果使用 yum remove&nbsp; erlang.XXX 来删除，很显然是不实际的。</p>\n\n<p>所以这里我们可以通过yum的另外一个命令&nbsp; &nbsp; yum history&nbsp; list&nbsp; erlang&nbsp; 能查看到关于erlang 的一些相关yum操作</p>\n\n<p><!--StartFragment --></p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541155935058.png\" style=\"height:129px; width:606px\" /></p>\n\n<p>这里能看到 Command line，输入的命令 以及整个命令执行的时间。第一个ID，表示整个命令的ID。</p>\n\n<p>我们可以看到最早之前，10月25日的时候，我通过install&nbsp; eralng安装了 erlang，所以我们需要回到这个时间</p>\n\n<p>将这个命令撤销掉。</p>\n\n<p>那么就可以输入&nbsp; &nbsp;yum history&nbsp; undo&nbsp; &nbsp;3&nbsp;&nbsp;</p>\n\n<p>其中 3 表示的是ID号。</p>\n\n<p>输入完后，我们能看到他重新回到了我们执行 install eralng 的阶段，所以只需要输入N，即完成了操作，所以到了</p>\n\n<p>这里，我们系统就没有安装Eralng了。</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541156191902.png\" style=\"height:642px; width:914px\" /></p>\n','1d1fd6d26c8e40a38637ef6126c45cd0',4,0,'5a9ea2261ed2466a884db30df54d704e',1,'2018-11-02 18:57:12','2018-11-02 18:57:12',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('d5968d02f570411184cdfcc082d28dac','从Java小白到收获BAT等offer，分享我这两年的经验和感悟','从Java小白到收获BAT等offer，分享我这两年的经验和感悟','<p>本文来自&nbsp; 微信公众号： 程序员江湖&nbsp; &nbsp;作者：陆小凤</p>\n\n<h1>写在最前</h1>\n\n<p>我写过很多篇秋招总结，这篇文章应该是最后一篇总结，当然也是最完整，最详细的一篇总结。秋招是我人生中一段宝贵的经历，不仅是我研究生生涯交出的一份答卷，也是未来职业生涯的开端。仅以此文，献给自己，以及各位在求职路上的，或者是已经经历过校招的朋友们。不忘初心，方得始终。</p>\n\n<h1>前言</h1>\n\n<p>在下本是跨专业渣考研的985渣硕一枚，经历研究生两年的学习积累，有幸于2019秋季招聘中拿到几个公司的研发岗offer，包括百度，阿里，腾讯，今日头条，网易，华为等。</p>\n\n<p>（在秋招末期，有幸又拿到了滴滴和亚马逊的offer，那时已经11月份了，所以之前的文章里都没有提到过）</p>\n\n<p>一路走来也遇到很多困难，也踩了很多坑，同时我自己也探索了很多的学习方法，总结了很多心得体会，并且，我对校园招聘也做了一些研究和相应的准备。在今年的秋季招聘结束以后，我也决定把这些东西全部都写成文字，做成专题，以便分享给更多未来将要参加校招的同学。</p>\n\n<p>&nbsp;</p>\n\n<p>大学时期的迷茫与坚定</p>\n\n<p>我的本科专业是电子信息工程，基本没有接触过计算机专业的课程，只学过c语言，然后在大三的时候接触过java，Android，以及前端开发。这时候我只是一个刚刚入门的菜鸟，还不知道软件开发的水有多深，抱着试一试的态度去应聘了很多公司。结果可想而知，连简历筛选都没有通过。</p>\n\n<p>当年我对游戏开发很有兴趣，特别是对网易游戏情有独钟，但是当我看到网易游戏研发工程师的招聘要求时，我只能望而却步，因为它要求学历至少是985的硕士。</p>\n\n<p><strong>也因为这个契机，我在大三的暑假开始准备考研，花了一个月的时间深思熟虑之后，选择了华科作为我的目标院校。</strong></p>\n\n<p>于是，2016年的下半年，我成为了&ldquo;两耳不闻窗外事，一心只读圣贤书&rdquo;的考研党，回想起来那确实是玩命学习的半年时间，每天稳定泡在图书馆8个小时以上，有时候学到宿舍都能学到晚上12点，那时候感觉自己完全变了一个人似的，可能当一个人为了某个目标而努力时，真的会变得不一样。最终我顺利地考上了，令我意外的是，成绩还挺不错。</p>\n\n<h1>研究生时期的方向选择</h1>\n\n<p>对于即将读研的同学来说，一般有两件事很重要，一件事是选择导师，一件事是选择方向。我在刚读研的时候最头疼的也是这两件事情。首先说明一下，我读的是专硕，所以实验室一般不搞科研，有部分导师会带项目，由于我不打算在实验室做项目（因为我更希望去大公司里锻炼几年），所以我当时本着想要找实习的想法选择了导师，事实证明我的选择还是很正确的，我在研二有大段时间去参加实习，让我在大厂里有足够的时间去锻炼和学习。而选择方向这件事，我倒是折腾了好久。研一期间我做的最多的事情就是看书了，当时自己的方向还不明确，所以找了很多书来看。当别人都在专研数据挖掘和机器学习时，我还在各种方向之间摇摆不定。我在读研之前想做游戏开发和Android开发，但我以前也学过Java Web开发。于是我在网上了解对应方向的资讯，发现游戏研发的就业面比较窄。最后，我综合公司的岗位情况，个人兴趣，以及我之前的学习经历等因素，选定了Java开发方向。于是，我在学校的实训项目中选择了Java Web项目，从此也真正意义上地踏上了Java的学习之路。</p>\n\n<h1>笨鸟先飞，勤能补拙</h1>\n\n<p>尽管我的入学成绩是全学院的top3，但是，我发现，作为非科班出身的我，和很多科班同学相比，还是有一定差距的。大部分同学本科都上过计算机专业的相关课程，比如计算机网络，操作系统，数据结构等等，而我以前连听都没听过，除此之外，他们一般都会几段比较完整的项目经验，至少在Java Web方面已经算是比较熟悉了。而我在当时，只学了数据结构，另外接触过一些Java基础，有一部分项目经验，基本上就是入门水平。于是我痛定思痛，决定好好弥补我的不足，平时一有空就去图书馆找些书来看，不论是操作系统，计算机网络，还是数据库等本科课程，我都会找一些对应的书籍来看，当时不太清楚其实有些课程其实不需要特地去补，以至于我连计算机组成原理，编译原理，软件测试等方面的书都特地找来看，现在想想也是挺逗比的。由于我们上的课比较水，所以上课时间反而变成了我自学基础课程的大好时光了。所以我平时上课的时候都会带两三本书，一到两周内看完一本，虽然可能吸收的不是特别好，但是对当时的我来说还是有很大帮助的。</p>\n\n<p><strong>除</strong><strong>此之外，有时候我还会偷偷去旁听有一些本科生的课程，这也是因为我在自学一些课程的时候遇到了困难，比如《操作系统》，《数据库原理》等等。于是我花时间研究了一下本科生的课表，趁着自己没课的时候赶紧去旁听课程。有时候感觉自己在课堂中显得非常突兀，尴尬地想要逃跑，但总算是坚持地听完了一门数据库的课程。</strong></p>\n\n<p>此外，我还在各种视频网站上看网课，比亦或是看中国MOOC的计算机基础课程，里面的操作系统，数据库等课程也让我印象深刻。就这样，每天我都把自己的时间填满，愣是在研一上学期看了好几本书，当时书的版本现在有的记不清了，主要是计算机网络，操作系统，计算机组成原理，另外还有软件工程，软件测试，设计模式，等书籍。就这样，我靠着这段时间的坚持把计算机基础课程补上来了一些。</p>\n\n<h1>历尽艰辛，终得实习</h1>\n\n<p>时间来到研一下半页，这时候我刚刚结束了学校的Java Web的项目实训课程，在做这个项目期间，我发现自己暴露出了很多问题，技术实践能力不足，Java基础不扎实。这件事情也给我自己敲响了警钟，因为我计划在春招期间找一份大厂的实习，但是目前看来我的水平还远远不够。压力之下，只有努力一条出路。于是，从那时候起，我开始了&ldquo;留守&ldquo;实验室的学习生活。为什么要在实验室学习，一是因为学习气氛好，二是因为平时大家也可以互相交流问题。</p>\n\n<p><strong>每天早上9点到实验室打开电脑，晚上9点背电脑回寝室。大部分时间我会花在看书上，这段时间主要看的都是Java相关的书籍，借鉴的是江南白衣大佬的&ldquo;Java后端书架&rdquo;，比如《深入理解JVM虚拟机》，《Java并发编程艺术》，《深入分析Java Web技术内幕》，《深入剖析Spring源码》等等。</strong></p>\n\n<p><strong>另外一部分时间我会用来看一些技术博客，我主要是根据面经上的知识点按图索骥，找到对应讲解该知识点的文章，那时候主要还是通过搜索引擎来找文章，当然有时候看到一些重点难点也会自己写一些博客。不过这个时期并不是我大量写博客的阶段，主要还是看一些讲解面试知识点的技术博客为主。</strong></p>\n\n<p><strong>除此之外在面试前几天我会花时间去看这家公司的面经，搞懂每一个面经上的知识点，并且记录在我的笔记上，光是面经相关的笔记我就记了100多篇，这样的学习习惯我一直坚持到了秋招，确保每个面试知识点都能被我记住，消化，直至完全理解。</strong></p>\n\n<p>慢慢的，笔记越来越多，我参加面试的公司也越来越多，于是我开始不断完善自己的简历，总结自己的面试技巧，选择合适的网申时机。<strong>从头到尾</strong><strong>我大概花了3个月的时间在找实习上，期间大大小小参加了20多次面试，我也从一开始面试一问三不知的菜鸟，逐渐变成了面霸，到复习末期，我对Java常见面试知识点已经了然于胸，同时也越来越自信，不管面什么大厂都不慌不忙。</strong></p>\n\n<p>这样的日子持续了好几个月，所谓世上无难事，只怕有心人。到最后，实验室里每个人都拿到了心仪的实习offer。</p>\n\n<h1>实习路上，我明白了很多</h1>\n\n<p>踏出学校大门，我的实习之路才刚刚开始。8个月左右的实习时间，说长也长，说短也短。但经历过这段实习之后，我才明白了很多事情。</p>\n\n<p>在猪场实习的日子里，我第一次了解大公司的开发流程，亲自参与项目代码的开发，我的导师会和我提需求，会指导我怎么做得更好。在这里的成长无疑是非常快速的，但我很快意识到我的问题所在，不熟悉部门技术栈，对很多Java Web的技术原理都不太熟悉，这段时间我意识到了自己的知识深度和广度都可能都有待提高。</p>\n\n<p>不过由于家里的一些事情。我提前离职了，所以在猪场呆的时间很短，以致于我没来得及搞懂部门项目的技术架构就走了，这也让我在离开以后感觉很遗憾，所以我下定决心在下个实习单位要好好做。</p>\n\n<p>离开猪场后我来到了熊厂。部门给我提的需求不算太难，大部分都是一些CURD的工作，但是这次很快就意识到了问题所在，就是我不太熟悉部门的整体技术栈，所以在需要借鉴别人代码时偶尔会看不懂。后来部门又给了新的重构需求，此时的我开始焦虑起来，是不是应该做出一些改变呢。</p>\n\n<p><strong>终于，我找到了新的目标，我要搞懂部门的项目架构，了解相关技术栈（我们部门做的是私有云），一开始，我会请教我的导师，尽量去了解项目的架构设计，除此之外，我还会利用一些时间去看其他同事负责的代码，并且通过一些文档和PPT去了解这些代码的功能和意义。结合代码和文档，再加上和同时的交流，我对部门项目的架构逐渐熟悉起来，为了更好地理解每一块代码的作用，我还为一些模块的代码写了注释。</strong></p>\n\n<p>当然，光看代码和文档还不能解决所有问题，因为这个项目的重点难点不在Web应用，而是在底层技术，这个项目中包含了两套架构，分别是一套OpenStack集群和一套docker集群。为了学习这两块内容，我先是看了很多博客，然后在平台上跑虚拟机和容器来做实践，最后又看了这方面的一些书籍，主要是《OpenStack设计与实现》，《docker技术入门实战》。</p>\n\n<p><strong>但是这还不够，虚拟化技术与Linux内核息息相关，又需要学习者对操作系统和计算网络非常熟悉，我自知这些内容我学得还不够深入，于是我花大量时间看这方面的书，当时也遇到了几本确实不错的书，分别是《深入理解计算机系统》，《计算机网络：自顶向下方法》，还有一本没来得及看完的《Linux内核设计与实现》。虽然以后不一定会作云计算方向的开发，但是学完这些东西我还是非常开心的。</strong></p>\n\n<p>到后来，我工位上的书越来越多，我对部门的技术栈也越来越熟悉，有时候我还会去听公司内各个团队组织的技术分享，有空的时候看看内网的技术课程，真正地实现了自己在技术广度上的拓展。</p>\n\n<p><strong>有时候我觉得，实习生活是会骗人的，你佩戴着和正式员工一样的工牌，和他们做着类似的事情，会让你觉得你的水平已经和他们差不多了，但事实上是，在转正之前，你和他们还差得远，所以不要停下自己前进的脚步，抓紧时间学习吧，把握好你在公司里的机会，合理利用公司给你提供的资源。</strong></p>\n\n<h1>秋招前的积累与沉淀</h1>\n\n<p>研究生期间我有一件事情一直在坚持，那就是做笔记和写博客。</p>\n\n<p>做笔记，就是记录学习中大大小小的事情，可能是面试问题，可能是一周的学习计划，也可能知识一个知识点，总归都是值得记录的东西，对我来说，就是一种积累。而对于博客，我从一开始只用于记录项目，到后来做转载，再到后来写原创，整理系列文章，则更像是一种沉淀。</p>\n\n<p><strong>但是在春招刚刚结束的这段时间，我发现一个问题，之前学过的东西忘记了很多，特别是那些理解的不够深的知识点，总是特别容易忘记。另外我发现，虽然我在笔记中记录了很多的知识点和面试题，但是往往我只看过一次，不会再去看第二次。</strong></p>\n\n<p><strong>这也意味着，虽然记录的内容很多，但是真正消化吸收的内容很少，脑子里充斥着总是那些零碎的知识点和面试问题，对于完整的知识体系知之甚少。这些问题在春招期间也不断地暴露出来，让我思考了很久。</strong></p>\n\n<p>面对如此窘境，我想做出改变，趁着现在时间充裕，我想要为这些内容做一次减法，并且借此机会，推翻自己原有的知识体系，重建新的知识框架。简单说来，就是重新开始学习Java后端，这次我要用一种更高效的方式，避免走之前走的弯路，要用最高效，最合理的方式去复习。由于我之前已经有基础，所以我对完成这一目标有信心，相应地我也为此做出了明确且详细的学习计划。</p>\n\n<p><strong>我打算用几个关键词来形容这三个月的秋招复习。</strong></p>\n\n<p><strong>&ldquo;具体可靠的学习计划&rdquo;</strong></p>\n\n<p>在三个月的时间里，我首先按照Java后端路线图安排好复习计划，每个知识点都会对应安排一段时间，比如我可能花一天时间复习&ldquo;Java反射&rdquo;，两天时间复习&ldquo;设计模式&rdquo;，一周的时间用于复习&quot;JVM虚拟机&rdquo;。我一般会在月初做好整个月的计划，然后根据进度做一些微调，但是基本上我都可以跟上进度，并且是在复习到位的前提下。</p>\n\n<p><strong>所以我觉得，对于秋招这一场苦战，指定计划尤为重要，一旦计划定下来，战略目标清晰，对应的战术制定也会变得清晰，执行力也会随之变强。</strong></p>\n\n<p><strong>&ldquo;写博客整合知识点&rdquo;</strong></p>\n\n<p><strong>至于复习方法，我主要通过看高质量博客，并且结合代码实践的方式巩固这部分知识点，比如今天学习&ldquo;concurrenthashmap&rdquo;，我会去找两三篇比较好的博客先看看，主要是源码解读方面的，然后我会把它们进行整合，如果有遗漏的知识点我会再进行补充，有时候我还会自己去看看JDK源码，以便更好地理解博客内容，完成知识整合之后，我就会对应地整理出一篇博客出来，发在我的个人博客上。</strong></p>\n\n<p>除此之外，当我完成了一整个专题的复习之后，我会把这些文章整理成一个专题，比如上面说的&ldquo;concurrenthashmap&rdquo;，实际上属于Java并发包，所以我会专门做一个博客专栏，用来完成Java并发系列的文章专题。<strong>对于每一个文章专题，我都会先理清这个专题一共有哪些内容，然后再开始整理。比如对于Java并发包，我会先写Java多线程基础的文章，再写JMM内存模型的文章，接着一步步着手写Java线程池，阻塞队列，工具类，原子类等等。这样一来这部分内容就复习完毕了，写系列文章的好处就在于，我可以从头到尾理清脉络，并且对于每一部分的知识点都做了比较好的总结。</strong></p>\n\n<p>对于博客的选择，我吸取了之前的教训，宁愿花半小时看一篇高质量文章，也不花10分钟看5篇烂文章。深度阅读的好处，就是可以让这部分内容更好地融入你脑内的知识体系，而不是像其他快餐文章一样转瞬即逝。</p>\n\n<p><strong>&ldquo;做项目巩固实践能力&rdquo;</strong></p>\n\n<p>由于之前在实习期间参加的项目都比较大，我接触的模块也比较单一，没有对整体项目有一个很好的把握，所以我决定趁这段时间再巩固一下我的项目实践能力，这里的能力主要是指的是对项目架构的把握能力，以及对业务开发的熟练度，当然也包括对各种常用后端技术的熟悉程度。</p>\n\n<p><strong>我花了大概一个月的时间完成了两个项目的开发，当然主要也是模仿两个开源项目做了，这两个项目都使用SpringBoot快速开发，并且用到一些常用的后端技术比如redis，云存储，以及一些常见Web框架，除此之外还涉及到了solr，爬虫等技术。虽然项目不算很难，但是我在这段时间里很快地熟悉了完整项目开发的流程，并且每天做迭代，通过Git来跟进版本，每个版本都会写清所做的内容，这也让我对项目的架构非常熟悉。</strong></p>\n\n<p>在项目之余，我也找一些常用的后端组件来跑一跑demo，以便让我对这些技术有一个直观的了解，比如面试常问的dubbo，zookeeper，消息队列等组件。这些尝试也让我在理解它们的原理时更加得心应手了。</p>\n\n<p><strong>&ldquo;坚持刷题，注重方法&rdquo;</strong></p>\n\n<p><strong>算法题是秋招笔试面试中的重头戏，每个研发同学都免不了经历算法题的摧残，对我这么一个非科班同学来说，更是让人头大。正因为如此，我放弃了刷大量LeetCode题目的方法，选择了更加行之有效的刷题方式。</strong></p>\n\n<p><strong>首先我重新刷了一遍剑指offer，并且对每道题目进行总结，尽量保证每一道题都可以记在脑子里，众所周知剑指offer中的题是面试时非常喜欢考的，所以先搞定这部分题目是最为关键的。</strong></p>\n\n<p>搞定剑指offer之后，当然还要刷LeetCode了，LeetCode题目这么多，怎么选择呢，我没有按照tag刷，也没有按照顺序刷，而是参考当时一个大佬的LeetCode刷题指南来进行刷题的，他把每个类型的题目都做了归纳，每部分只放一些比较经典的题目。所以我前后大概刷了100多道LeetCode的题目，并且在第二遍刷题复习的时候，我也对这些题目做了一份总结。</p>\n\n<p><strong>除了上面两个经典题库，我还着重刷了大厂的历年真题，这部分我主要是通过牛客网的历年真题题库来完成刷题的。说实话，真题是非常重要的，因为公司出的题目不像平时的那些算法题，可能会出得非常奇葩，所以你如果不提前适应的话会比较吃亏。完成这部分题目之后，我对算法题的复习也基本告一段落了。</strong></p>\n\n<p>当我完成所有内容的复习时，提前批已经开始了。终于要上战场了，因为战前准备比较充分，所以我对秋招还是比较乐观的，但事实上，秋招不仅是攻坚战，而且是持久战，要笑到最后，确实也不是那么容易的事情。</p>\n\n<h1>重建知识体系，对学过的东西做减法</h1>\n\n<p>前面提到我在秋招前完成了知识体系重建，那在这里我也想跟大家分享一下我当时大致的知识体系构成。就跟我前面说的一样，我选择重新再学一遍Java后端相关的技术内容，因为我知道大致的学习方向，并且有一定的基础，所以看很多文章变得更加得心应手，写文章和做总结也更加有底气了。</p>\n\n<p>首先在Java基础方面，我写了20多篇原创博客，主要是对Java核心技术的解析，比如&ldquo;Java反射&rdquo;，&ldquo;Java序列化和反序列化&rdquo;，&ldquo;Java异常体系&rdquo;等等。</p>\n\n<p>在Java集合类方面，我原创了部分文章，另外整合了一些比较好的技术文章，其中最主要的就是关于hashmap的文章，当时我整合的文章几乎没有遗漏任何一个知识点。</p>\n\n<p><strong>在Java并发编程方面，我主要参考了并发编程网以及一些优质博客的文章，先搞懂了Java并发原理，再一步步学习JUC并发包的组件，其中重点看了chm，并发工具类以及阻塞队列等JDK源码的解析文章，除此之外，我还会在IDE中跑JUC相关的emo，毕竟这方面的内容非常需要实践。</strong></p>\n\n<p>在Java网络编程方面，我先从最基础的socket入手，再讲到NIO,AIO，并且加入了几篇对Linux IO模型解析的文章，让整个知识体系更加完整（因为NIO是基于Linux Epoll实现的），接着我又加入了对Netty的探讨，以及Tomcat中对NIO的应用，可以说是把Java网络编程一些比较重要的部分都囊括进来了。<strong>为了更好理解这部分内容，我也在网上参考了很多客户端和服务端通信的demo，最后我分别用Socket，NIO,AIO以及Netty把C/S 通信的demo都写了一遍。</strong></p>\n\n<p>在JVM虚拟机方面，我则按照《深入理解JVM虚拟机》这本书的行文脉络进行文章的整理。<strong>在搞定JVM基本原理以后，我着重了解了JVM调优和实践中常遇到的问题，并且整理了常用的JVM调优工具，场景问题以及调优实践的案例，这也是因为面试中对JVM调优实践越来越重视了。</strong></p>\n\n<p>在JavaWeb方面，我从Java Web相关技术的发展入手，一步步了解了每种技术存在的意义，比如JSP，Servlet，JDBC，Spring等等，然后对每种技术进行了比较全面的了解，并且着重地看了Spring和SpringMVC的源码分析文章，另外一方面，我花了很多时间去研究Tomcat的工作原理。除此之外，JavaWeb项目中常用的maven，日志组件，甚至是单测试组件，也纳入了我的系列文章里。</p>\n\n<p><strong>在数据库和缓存方面，我主要学习了MySQL和Redis这两种最常用的数据库。对于Mysql，我从简单的sql开始了解，然后开始了解sql优化，MySQL的存储引擎和索引，事务及锁，还有更复杂的主从复制，分库分表等内容。对于Redis，我也是从简单的api入手，然后去了解每一种数据结构的底层实现原理，接着尝试去学习Redis的持久化方式，以及作为缓存常需要考虑的技术点，当然，也包括Redis的分布式锁实现，以及它的分布式集群方案。</strong></p>\n\n<p>最后一部分就是分布式相关的理论和技术了，这个也是困扰我很久的一块内容，我主要把这块内容分为两个部分，分别是分布式理论和分布式技术，理论方面，我先了解CAP,BASE等基本知识，然后开始学习一致性协议和算法，接着探讨分布式事务。<strong>对于分布式技术，涉及的东西就更多了，例如分布式session，负载均衡，分布式锁等内容，这些知识点我都会用一到两篇文章去总结，对于分布式缓存，消息队列，以及分布式服务等内容，我会花比较多的时间去全面学习，然后总结出一个系列的文章出来。</strong>当然，对于这些技术的学习主要还是停留在理论方面，在自己的项目中能用到的比较少。</p>\n\n<p>至此，我的知识体系基本构建完成，这也是我在秋招中能够成功闯过那么多面试的原因。</p>\n\n<h1>秋招之路，砥砺前行</h1>\n\n<p>不管前期做了多少准备，到秋招的时候也不能掉以轻心，从七月底第一次面试到9月基本佛系，中间经历了大大小小的面试。</p>\n\n<p><strong>在完成知识体系重建以后，我把重点转向了另外几件事，一是完善和熟悉我的简历，以便在面试中能够比较好地发挥，二是持续刷题，保持对算法题和笔试真题的手感和熟练度，三则是看面经查缺补漏，我一直认为看面经是很重要的一项复习内容。</strong></p>\n\n<p><strong>就这样，我一边继续复习，以便开始了一场接一场的面试接力。</strong></p>\n\n<p>起初，我面了几家小公司练手，接着阿里的提前批接踵而至，我战战兢兢地参加了阿里中间件部门的面试，面难难度还算适中，一共四轮面试，当时我的表现也还不错，问题基本都答上来了。面完不到一周以后我就收到了通过的消息，当时还有点懵。没想到第一个offer这么快就来了。</p>\n\n<p>这段时间内，蚂蚁金服的两个部门也给了我面试机会，我都参加了它们的面试，并且顺利地拿到了其中一个部门的offer。由于我对蚂蚁这边的业务比较感兴趣，最终选择了蚂蚁金服的offer。</p>\n\n<p><strong>阿里提前批的胜利确实是意外之喜，但也大大地鼓舞了我，于是我又参加了百度和腾讯的提前批面试，由于百度的提前批不走流程，一共有四个部门面试了我，每个部门都有2到3轮面试，总计约为12次面试，到后来我已经快晕了，看到百度的电话就害怕，由于面试次数太多，有时候发挥确实也不是很好，我也没有特别在意，只当是在锻炼自己了。</strong></p>\n\n<p>百度的面试难度每个部门不一样，但是每次面试必写算法题，一写算法题，时间至少就是一个小时以上，每次面试完都有一种身体被掏空的感觉。</p>\n\n<p>经历了百度面试的摧残以后，我手写算法的速度也变快了，很多坑也被我填上了。接下来面对腾讯的面试，我也是既激动又担心，腾讯的面试难度比较大，对于操作系统和网络的知识喜欢深挖，问的东西也很有深度，面完前三面以后，第四面拖了3周才进行。当时三面面试官对我的评价比较好，也让我信心爆棚了好久。</p>\n\n<p>在等待腾讯终面的期间，我参加了今日头条的面试，当时有幸拿到了一个白金码，免去笔试，事实证明白金码作用真的很大。头条的面试难度和腾讯差不多，三轮面试，同样需要写各种算法，由于是视频面试，我可以清楚地看到，头条的面试官真的非常高冷啊。面完头条我的第一感觉就是应该挂了吧。没想到最后还是给了offer。</p>\n\n<p><strong>结束这几家大厂的面试之后，我觉得我的秋招已经接近尾声了，不过由于之前投的比较多，所以我又面了几家大公司，如网易，华为，快手等。到9月上旬的时候，我接连收到了bat和头条，网易的意向书，阿里最早，腾讯最晚，每收到一封意向书我都很开心，没想到最后我真的可以集齐bat等大厂的offer。</strong></p>\n\n<p>9月以后，除了偶尔和同学做几场大厂的笔试，我基本就佛系了。直到后来一些外企例如亚马逊，大摩开始笔试面试，我才又重新回到了状态。</p>\n\n<p>截止目前，我基本上把该拒绝的offer都拒绝了，综合各方面因素的考虑，最后应该会签阿里，原因是部门是我自己喜欢的，同时给的评级也比较高。虽然腾讯也给了sp，但是最后还是忍痛割爱啦。至于百度和头条，给的offer并不是很令人满意，所以就没有考虑了。</p>\n\n<p>至此，我的秋招之旅总算圆满结束。</p>\n\n<h1>面经分享</h1>\n\n<p>具体的面经都比较长，这里大概介绍一下面试的情况，具体的面经请大家关注我的公众号并回复&ldquo;面经&rdquo;即可查看。</p>\n\n<p>1 阿里面经&nbsp;&nbsp;</p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzUyMDc5MTYxNA==&amp;mid=2247483852&amp;idx=1&amp;sn=9ec90620478b35d63a4a971a2222095d&amp;chksm=f9e5b29dce923b8b2b080151e4b6b78373ee3f3e6f75b69252fc00b1a009d85c6f96944ed6e6&amp;scene=21#wechat_redirect\">阿里中间件研发面经</a></p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzUyMDc5MTYxNA==&amp;mid=2247483861&amp;idx=1&amp;sn=34317917908fdb778f16fa9dd557908b&amp;chksm=f9e5b284ce923b922446fb5431b84094dec03ee4688da9c8de1f025d80eac715cbd9740e8464&amp;scene=21#wechat_redirect\">蚂蚁金服研发面经</a></p>\n\n<p>岗位是研发工程师，直接找蚂蚁金服的大佬进行内推。</p>\n\n<p>我参与了阿里巴巴中间件部门的提前批面试，一共经历了四次面试，拿到了口头offer。</p>\n\n<p>然后我也参加了蚂蚁金服中间件部门的面试，经历了三次面试，但是没有走流程，所以面试中止了。</p>\n\n<p>最后我走的是蚂蚁金服财富事业群的流程，经历了四次面试，包括一次交叉面，最终拿到了蚂蚁金服的意向书，评级为A。</p>\n\n<p>阿里的面试体验还是比较好的，至少不要求手写算法，但是非常注重Java基础，中间件部门还会特别安排Java基础笔试。</p>\n\n<p>&nbsp;</p>\n\n<p>2 腾讯面经&nbsp;&nbsp;</p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzUyMDc5MTYxNA==&amp;mid=2247483849&amp;idx=1&amp;sn=f81fd42954589fb2deaf128026ddd856&amp;chksm=f9e5b298ce923b8ef02ae36f7e9029fef0ddb7d5ae456dfa9d64c0073bebaacfb78fac4c8035&amp;scene=21#wechat_redirect\">腾讯研发面经</a></p>\n\n<p>岗位是后台开发工程师，我没有选择意向事业群。</p>\n\n<p>SNG的部门捞了我的简历，开始了面试，他们的技术栈主要是Java，所以比较有的聊。</p>\n\n<p>一共经历了四次技术面试和一次HR面试，目前正在等待结果。</p>\n\n<p>腾讯的面试一如既往地注重考查网络和操作系统，并且喜欢问Linux底层的一些知识，在这方面我还是有很多不足的。</p>\n\n<p>&nbsp;</p>\n\n<p>3 百度面经&nbsp;&nbsp;</p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzUyMDc5MTYxNA==&amp;mid=2247483857&amp;idx=1&amp;sn=214b0f93db93407a7ac5a5149778cbad&amp;chksm=f9e5b280ce923b96fcd535b2ef639fee2de78f12aa961d525b21760b11a3b95c0879113c2944&amp;scene=21#wechat_redirect\">百度研发面经</a></p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzUyMDc5MTYxNA==&amp;mid=2247483866&amp;idx=1&amp;sn=88dc80fef6ad6aa3a4221862f3630a90&amp;chksm=f9e5b28bce923b9d4defc91ed30d8bbe650d7215966f9fb776fe5b244eae527bcd24b1941204&amp;scene=21#wechat_redirect\">百度研发面经整合版</a></p>\n\n<p>岗位是研发工程师岗位，部门包括百度智能云的三个分部门以及大搜索部门。</p>\n\n<p>百度的提前批面试不走流程，所以可以同时面试好多个部门，所以我参加百度面试的次数大概有12次左右，最终应该是拿了两个部门的offer。</p>\n\n<p>百度的面试风格非常统一，每次面试基本都要到电脑上写算法，所以那段时间写算法写的头皮发麻。</p>\n\n<p>&nbsp;</p>\n\n<p>4 网易面经&nbsp;&nbsp;</p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzUyMDc5MTYxNA==&amp;mid=2247483875&amp;idx=1&amp;sn=fa9eaedd9cc3da172ad71d360c46a054&amp;chksm=f9e5b2b2ce923ba443b91d56b24486d22b15bea16a4788e5ed3421906e84f8edd9ee10b2b306&amp;scene=21#wechat_redirect\">网易研发面经</a></p>\n\n<p>面试部门是网易云音乐，岗位是Java开发工程师。</p>\n\n<p>网易是唯一一家我去外地面试的公司，也是我最早去实习的老东家。</p>\n\n<p>一共三轮面试，耗时一个下午。</p>\n\n<p>网易的面试比我想象中的要难，面试官会问的问题都比较深，并且会让你写一些结合实践的代码。</p>\n\n<p>&nbsp;</p>\n\n<p>5 头条面经&nbsp;&nbsp;</p>\n\n<p><a href=\"http://mp.weixin.qq.com/s?__biz=MzUyMDc5MTYxNA==&amp;mid=2247483869&amp;idx=1&amp;sn=eedb7aebcb90cf3d4fe2450ef2d99947&amp;chksm=f9e5b28cce923b9a9b0852a1c998ec014eb1aeb0442916c9028da276be8db0b2934c92292961&amp;scene=21#wechat_redirect\">今日头条研发面经</a></p>\n\n<p>岗位是后台研发工程师，地点选择了上海。</p>\n\n<p>我参加的是字节跳动的内推面试，当时找了一个牛友要到了白金码，再次感谢这位头条大佬。</p>\n\n<p>然后就开始了一下午的视频面试，一共三轮技术面试，每一轮都要写代码，问问题的风格有点像腾讯，也喜欢问一些底层知识，让我有点懵逼。</p>\n\n<p>&nbsp;</p>\n\n<h1>笔试经验</h1>\n\n<p>提前批的笔试其实不是很多，我参加了网易，网易游戏，拼多多等公司的笔试，应该都是低分飘过。</p>\n\n<p>我的算法基础比较一般，读研之前0基础，所以这方面学的比较艰辛，分享一些我的笔试准备经验。</p>\n\n<p>1 打好数据结构和算法基础</p>\n\n<p>2 先易后难，看一些基础的算法书籍，比如《图结算法》，《啊哈算法》等等。</p>\n\n<p>3 剑指offer刷起来，两到三遍，做到胸有成竹</p>\n\n<p>4 LeetCode刷个200题左右，记得二刷，做好总结。</p>\n\n<p>5 到牛客网做公司的历年真题，熟悉题型，保持手感。</p>\n\n<p>剑指offer指南和LeetCode刷题指南可以在我的博客里找到。&nbsp;</p>\n\n<p>其中LeetCode指南是参考@CyC2018大佬的文章。</p>\n\n<h1>面试经验</h1>\n\n<p>面试主要考的还是你的基础知识，需要你对Java后端技术栈有一个全局上的把握，具体说起来就太多了，具体复习方案可以参考文章后面的内容。</p>\n\n<p>&nbsp;</p>\n\n<p>我个人也总结了一些面试方面的经验，主要是一些技巧。</p>\n\n<p>&nbsp;</p>\n\n<p>1 做好自我介绍和项目总结，把握你发言的主动权</p>\n\n<p>2 搞清楚简历上的技术点，兵来将挡水来土掩</p>\n\n<p>3 注意分点答题，思路清晰，也更容易讲清楚原理。</p>\n\n<p>4 压力面下保持冷静，不要回怼面试官</p>\n\n<p>5 HR面试注意常用技巧，可以提前准备。</p>\n\n<p>&nbsp;</p>\n\n<p>Java后端技术专栏</p>\n\n<p>对于校园招聘来说，最重要的还是基础知识。下面的博客专栏出自我的技术博客&nbsp;https://blog.csdn.net/a724888&nbsp;&nbsp; &nbsp;</p>\n\n<p>这些专栏中有一些文章是我自己原创的，也有一些文章是转载自技术大牛的，基本都是是我在学习Java后端的两年时间内陆续完成的。</p>\n\n<p>总的来说算是比较全面了，做后端方向的同学可以参考一下。</p>\n\n<p>深入浅出Java核心技术 &nbsp; &nbsp;</p>\n\n<p>本专栏主要介绍Java基础，并且会结合实现原理以及具体实例来讲解。同时还介绍了Java集合类，设计模式以及Java8的相关知识。</p>\n\n<p><br />\n&nbsp; &nbsp;</p>\n\n<p>深入理解JVM虚拟机 &nbsp; &nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>带你走进JVM的世界，整合高质量文章以阐述虚拟机的原理及相关技术，让开发者更好地了解Java的底层运行原理以及相应的调优方法。</p>\n\n<p><br />\n&nbsp; &nbsp;</p>\n\n<p>Java并发指南 &nbsp; &nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>本专栏主要介绍Java并发编程相关的基本原理以及进阶知识。主要包括Java多线程基础，Java并发编程基本原理以及JUC并发包的使用和源码解析。</p>\n\n<p>Java网络编程与NIO &nbsp; &nbsp;</p>\n\n<p>Java网络编程一直是很重要的一部分内容，其中涉及了socket的使用，以及Java网络编程的IO模型，譬如BIO,NIO,AIO，当然也包括Linux的网络编程模型。</p>\n\n<p>了解这部分知识对于理解网络编程有很多帮助。另外还补充了两个涉及NIO的重要技术：Tomcat和Netty。<br />\n&nbsp; &nbsp;</p>\n\n<p>JavaWeb技术世界 &nbsp; &nbsp;</p>\n\n<p>从这里开始打开去往JavaWeb世界的大门。什么是J2EE，什么是JavaWeb，以及这个生态中常用的一些技术：Maven，Spring，Tomcat，Junit，log4j等等。</p>\n\n<p>我们不仅要了解怎么使用它们，更要去了解它们为什么出现，其中一些技术的实现原理是什么。</p>\n\n<p>Spring与SpringMVC源码解析 &nbsp; &nbsp;</p>\n\n<p>本专栏主要讲解Spring和SpringMVC的实现原理。</p>\n\n<p>Spring是最流行的Java框架之一。</p>\n\n<p>本专栏文章主要包括IOC的实现原理分析，AOP的实现原理分析，事务的实现源码分析等，当然也有SpringMVC的源码解析文章。</p>\n\n<p>重新学习MySQL与Redis &nbsp; &nbsp;</p>\n\n<p>本专栏介绍MySQL的基本知识，比如基本架构，存储引擎，索引原理，主从复制，事务等内容。当然也会讲解一些和sql语句优化有关的知识。</p>\n\n<p>同时本专栏里也介绍了Redis的基本实现原理，包括数据结构，主从复制，集群方案，分布式锁等实现。</p>\n\n<p>分布式系统理论与实践 &nbsp; &nbsp;</p>\n\n<p>本专栏介绍分布式的基本理论和相关技术，比如CAP和BASE理论，一致性算法，以及ZooKeeper这类的分布式协调服务。</p>\n\n<p>在分布式实践方面，我们会讲到负载均衡，缓存，分布式事务，分布式锁，以及Dubbo这样的微服务，也包括消息队列，数据库中间件等等。&nbsp; &nbsp;</p>\n\n<p>后端开技术杂谈 &nbsp; &nbsp;</p>\n\n<p>本专栏涵盖了大后端的众多技术文章，当你在Java后端方面有一定基础以后，再多了解一些相关技术总是有好处的。</p>\n\n<p>除了Java后端的文章以外，还会涉及Hadoop生态，云计算技术，搜索引擎，甚至包括一些数据挖掘和AI的文章。</p>\n\n<p>总的来说选取了一些不错的基础类文章，能让你对大后端有一个更直观的认识。</p>\n\n<p>Java工程师必备书单</p>\n\n<p>我之前专门写了一篇文章介绍了Java工程师的书单，可以这里重点列举一些好书，推荐给大家。</p>\n\n<p>完整内容可以参考这篇文章：</p>\n\n<p>《计算机网络：自顶向下》这本从应用层讲到物理层，感觉这种方式学起来更轻松。</p>\n\n<p>《图解算法》《啊哈算法》</p>\n\n<p>这两部书籍非常适合学习算法的入门，前者主要用图解的形式覆盖了大部分常用算法，包括dp，贪心等等，可以作为入门书，后者则把很多常用算法都进行了实现，包括搜索，图，树等一些比较高级的常用算法。</p>\n\n<p>《剑指offer》这本书还是要强烈推荐的，毕竟是面试题经常参考的书籍，当然最好有前面基本的铺垫再看，可能收获更大，这本书在面试之前一般都要嚼烂。如果想看Java版本的代码，可以到我的Github仓库中查看。</p>\n\n<p>《Java编程思想》这本书也是被誉为Java神书的存在了，但是对新手不友好，适合有些基础再看，当然要选择性地看。我当时大概只看了1/3</p>\n\n<p>《Java核心技术卷一》</p>\n\n<p>这本书还是比较适合入门的，当然，这种厚皮书要看完还是很有难度的，不过比起上面那本要简单一些</p>\n\n<p>《深入理解JVM虚拟机》&nbsp;&nbsp; &nbsp;</p>\n\n<p>这本书是Java开发者必须看的书，很多jvm的文章都是提取这本书的内容。JVM是Java虚拟机，赋予了Java程序生命，所以好好看看把，我自己就已经看了三遍了。&nbsp;&nbsp; &nbsp;</p>\n\n<p>《Java并发编程艺术》</p>\n\n<p>这本书是国内作者写的Java并发书籍，比上面那一本更简单易懂，适合作为并发编程的入门书籍，当然，学习并发原理之前，还是先把Java的多线程搞懂吧。</p>\n\n<p>《深入JavaWeb技术内幕》&nbsp;&nbsp; &nbsp;</p>\n\n<p>这本书是Java Web的集大成之作，涵盖了大部分Java Web开发的知识点，不过一本书显然无法把所有细节都讲完，但是作为Java Web的入门或者进阶书籍来看的话还是很不错的。&nbsp;&nbsp;&nbsp;</p>\n\n<p>《Redis设计与实现》</p>\n\n<p>该书全面而完整地讲解了 Redis 的内部运行机制,对 Redis 的大多数单机功能以及所有多机功能的实现原理进行了介绍。这本书把Redis的基本原理讲的一清二楚，包括数据结构，持久化，集群等内容，有空应该看看。</p>\n\n<p>《大型网站技术架构》&nbsp;&nbsp; &nbsp;</p>\n\n<p>这本淘宝系技术指南还是非常值得推崇的，可以说是把大型网站的现代架构进行了一次简单的总结，内容涵盖了各方面，主要讲的是概念，很适合没接触过架构的同学入门。看完以后你会觉得后端技术原来这么博大精深。&nbsp;&nbsp; &nbsp;</p>\n\n<p>《分布式服务框架原理与实践》</p>\n\n<p>上面那本书讲的是分布式架构的实践，而这本书更专注于分布式服务的原理讲解和对应实践，很好地讲述了分布式服务的基本概念，相关技术，以及解决方案等，对于想要学习分布式服务框架的同学来说是本好书。</p>\n\n<p>《从Paxos到Zookeeper分布式一致性原理与实践》</p>\n\n<p>说起分布式系统，我们需要了解它的原理，相关理论及技术，这本书也是从这个角度出发，讲解了分布式系统的一些常用概念，并且带出了分布式一哥zookeeper，可以说是想学分布式技术的同学必看的书籍。</p>\n\n<p>《大数据技术原理与应用》</p>\n\n<p>作为大数据方面的一本教材，厦大教授写的这本书还是非常赞的，从最基础的原理方面讲解了Hadoop的生态系统，并且把每个组件的原理都讲得比较清楚，另外也加入了spark，storm等内容，可以说是大数据入门非常好的一本书了。</p>\n\n<p>&nbsp; &nbsp; &nbsp;</p>\n\n<h1>技术大牛推荐</h1>\n\n<p>1 江南白衣</p>\n\n<p>这位大大绝对是我的Java启蒙导师，他推荐的Java后端书架让我受益匪浅。&nbsp;&nbsp; &nbsp;</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p>2 码农翻身&nbsp;&nbsp; &nbsp;</p>\n\n<p>刘欣，一位工作15年的IBM架构师，用最浅显易懂的文章讲解技术的那些事，力荐，他的文章帮我解决了很多困惑。&nbsp;&nbsp; &nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>3 CoolShell</p>\n\n<p>陈皓老师的博客相信大家都看过，干货很多，酷壳应该算是国内最有影响力的个人博客了。</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p>4 廖雪峰</p>\n\n<p>学习Git和Python，看它的博客就够了。</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p><strong>5 HollisChuang</strong></p>\n\n<p>阿里一位研发大佬的博客，主要分享Java技术文章，内容还不错。</p>\n\n<p>&nbsp;</p>\n\n<p>6 梁桂钊</p>\n\n<p>阿里另一位研发大佬，博客里的后端技术文章非常丰富。</p>\n\n<p><br />\n&nbsp; &nbsp;</p>\n\n<p><strong>7 chenssy</strong></p>\n\n<p>这位大佬分享的Java技术文章也很多，并且有很多基础方面的文章，新手可以多看看。</p>\n\n<p><br />\n&nbsp; &nbsp;</p>\n\n<p>8 Java Doop</p>\n\n<p>一位魔都Java开发者的技术博客，里面有一些不错的讲解源码的文章，数量不是很多，但是质量都挺不错的。</p>\n\n<p><br />\n&nbsp; &nbsp;</p>\n\n<p>9 学习资源分享</p>\n\n<p>学习Java后端两年的时间里，接触过很多的资料，网站和课程，也走了不少弯路，所以这里也总结一些比较好的资源推荐给大家。</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p>10 CSDN和博客园，</p>\n\n<p>主流的技术交流平台，虽然广告越打越多了，但是还是有很多不错的博文的。</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p>11&nbsp; importnew 专注Java学习资源分享，适合Java初学者。</p>\n\n<p><br />\n&nbsp; &nbsp;</p>\n\n<p>12 并发编程网，主要分享Java相关进阶内容，适合Java提高。</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p>13 推酷 一个不错的技术分享社区。</p>\n\n<p>&nbsp;</p>\n\n<p>14 segmentfault，有点像国内的Stack Overflow，适合交流代码问题的地方。</p>\n\n<p>&nbsp;</p>\n\n<p>15 掘金，一个很有极客范的技术社区，强推，有很多技术大牛分享优质文章。</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p>16 开发者头条</p>\n\n<p>一个整合优质技术博客的社区，里面基本上都是精选的高质量博文，适合技术学习提升。</p>\n\n<p>&nbsp;</p>\n\n<p>17 v2ex，一个极客社区，除了交流技术以外还会有很多和程序员生活相关的话题分享。</p>\n\n<p>&nbsp; &nbsp;</p>\n\n<p>18 知乎</p>\n\n<p>这个就不必多说了。</p>\n\n<p>&nbsp;</p>\n\n<p>19 简书</p>\n\n<p>简书上有些技术文章也很不错，有空大家也可以去看看。</p>\n\n<p>&nbsp;</p>\n\n<p>20 Github</p>\n\n<p>有一些GitHub的项目还是非常不错的，其中也有仓库会分享技术文章。</p>\n\n<h1>后记</h1>\n\n<p>秋招结束以后，我就把主要精力花在做这个公众号上了。当然，剩下要处理的事情还有很多，毕业论文，毕业旅行，还有工作前的知识储备等等。果然，人的一生需要不断的修行，刚刚闯过了一关又马上要迎接下一轮挑战，你不能停下脚步，毕竟大家都在往前走。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>希望还在求职路上的各位少侠好好加油，在未来也能够顺利地拿到自己想要的offer！</strong></p>\n\n<p>&nbsp;</p>\n\n<p><strong>本文中涉及到的几个链接我汇总在这里，方便大家查看。</strong></p>\n\n<p><strong>1、CSDN技术博客：blog.csdn.net/a724888（Java后端技术站点，整理很多Java后端技术文章，推荐Java方向的同学看看）</strong></p>\n\n<p><strong>2、知乎：www.zhihu.com/people/h2pl（知乎活跃用户，希望未来能成为大V）</strong></p>\n\n<p><strong>3、牛客网：www.nowcoder.com/profile/3539721（牛客网活跃粉，分享过一些面经和心得）</strong></p>\n\n<p><strong>4、GitHub：https://github.com/h2pl（用于自己做项目，以及刷剑指offer、LeetCode、历年笔试题）</strong></p>\n','e2c7913050cf4ab9aa92902316aaf075',2,0,'ae59212e7bdc41e08ffb65788ba066cb',1,'2018-12-11 10:38:03','2018-12-11 10:38:03',NULL,'0','陌溪_','程序员江湖','2c93dfab0e754006866f8ed486923a41',2),('e6b65558d5f14840b02f28efcde53779','Vue深度嵌套时，无法被监听到的问题','Vue深度嵌套时，无法被监听到的问题','<p><!--StartFragment --></p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540802382548.png\" style=\"height:174px; width:328px\" /></p>\n\n<p>首先在data中，有上面这样一个form对象，后面我使用代码改变bortherRalation中的值后，发现数据并没有更新。</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540804934582.png\" style=\"height:430px; width:500px\" /></p>\n\n<p>因为这个是属于form中的 bortherRelation的变化，并不能使vue监听到变化，所以就不能改变。所以需要添加监听，deep = true</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540805312167.png\" style=\"height:165px; width:503px\" /></p>\n\n<p>由于 JavaScript 的限制，Vue 不能检测以下变动的数组：</p>\n\n<ol>\n	<li>当你利用索引直接设置一个项时，例如：<code>vm.items[indexOfItem] = newValue</code></li>\n	<li>当你修改数组的长度时，例如：<code>vm.items.length = newLength</code></li>\n</ol>\n\n<p>举个例子：</p>\n\n<table>\n	<tbody>\n		<tr>\n			<td>\n			<pre>\nvar vm = new Vue({\n  data: {\n    items: [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]\n  }\n})\nvm.items[1] = &#39;x&#39; // 不是响应性的\nvm.items.length = 2 // 不是响应性的\n</pre>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p>为了解决第一类问题，以下两种方式都可以实现和&nbsp;<code>vm.items[indexOfItem] = newValue</code>&nbsp;相同的效果，同时也将触发状态更新：</p>\n\n<table>\n	<tbody>\n		<tr>\n			<td>\n			<pre>\n// Vue.set\nVue.set(vm.items, indexOfItem, newValue)\n</pre>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<table>\n	<tbody>\n		<tr>\n			<td>\n			<pre>\n// Array.prototype.splice\nvm.items.splice(indexOfItem, 1, newValue)\n</pre>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p>你也可以使用&nbsp;<a href=\"https://vuejs.org/v2/api/#vm-set\" target=\"_blank\"><code>vm.$set</code></a>&nbsp;实例方法，该方法是全局方法&nbsp;<code>Vue.set</code>&nbsp;的一个别名：</p>\n\n<table>\n	<tbody>\n		<tr>\n			<td>\n			<pre>\nvm.$set(vm.items, indexOfItem, newValue)\n</pre>\n			</td>\n		</tr>\n	</tbody>\n</table>\n\n<p>为了解决第二类问题，你可以使用&nbsp;<code>splice</code>：</p>\n\n<table>\n	<tbody>\n		<tr>\n			<td>\n			<pre>\nvm.items.splice(newLength)</pre>\n			</td>\n		</tr>\n	</tbody>\n</table>\n','f90d3c2fd9434302951130e897a89164',4,0,'989e2c76be4446d1862adcb1364fdc9b',1,'2018-10-29 17:28:39','2018-10-29 17:28:39',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('f21bcafa7cd14feca15f8ce7eb5c33a5','搞清楚Java值传递与引用传递','java的值传递和引用传递在面试中一般都会都被涉及到，今天我们就来聊聊这个问题，首先我们必须认识到这个问题一般是相对函数而言的，也就是java中的方法参数，那么我们先来回顾一下在程序设计语言中有关参数传递给方法（或函数）的两个专业术语','<p>java的值传递和引用传递在面试中一般都会都被涉及到，今天我们就来聊聊这个问题，首先我们必须认识到这个问题一般是相对函数而言的，也就是java中的方法参数，那么我们先来回顾一下在程序设计语言中有关参数传递给方法（或函数）的两个专业术语：</p>\n\n<ul>\n	<li>\n	<p>按值调用（call by value）</p>\n	</li>\n	<li>\n	<p>按引用调用（call by reference）</p>\n	</li>\n</ul>\n\n<p>所谓的按值调用表示方法接收的是调用着提供的值，而按引用调用则表示方法接收的是调用者提供的变量地址(如果是C语言的话来说就是指针啦，当然java并没有指针的概念)。</p>\n\n<p>这里我们需要注意的是一个方法可以修改传递引用所对应的变量值，而不能修改传递值调用所对应的变量值，这句话相当重要，这是按值调用与引用调用的根本区别，当然如果还不理解，没关系，下面就要图文并茂的彻底分析啦。</p>\n\n<p>前面我们说过java中并不存在引用调用，这点是没错的，因为java程序设计语言确实是采用了按值调用，即call by value。也就是说方法得到的是所有参数值的一个拷贝，方法并不能修改传递给它的任何参数变量的内容。下面我们来看一个例子：</p>\n\n<pre>\n<code class=\"language-java\">package com.zejian.test;\n/**\n * java中的按值调用\n * @author zejian\n */\npublic class CallByValue {\n\n    private static int x=10;\n\n    public static void updateValue(int value){\n        value = 3 * value;\n    }\n\n    public static void main(String[] args) {\n        System.out.println(\"调用前x的值：\"+x);\n        updateValue(x);\n        System.out.println(\"调用后x的值：\"+x);\n    }\n\n}</code></pre>\n\n<h3>.&nbsp;运行程序，结果如下：</h3>\n\n<pre>\n<code>调用前x的值：10\n调用后x的值：10</code></pre>\n\n<p><strong>可以看到x的值并没有变化</strong>，接下来我们一起来看一下具体的执行过程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542531405023.png\" style=\"height:513px; width:580px\" /></p>\n\n<p><strong>分析：</strong></p>\n\n<p>1）value被初始化为x值的一个拷贝（也就是10）</p>\n\n<p>2）value被乘以3后等于30，但注意此时x的值仍为10！</p>\n\n<p>3）这个方法结束后，参数变量value不再使用，被回收。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>结论：</strong></p>\n\n<p>当传递方法参数类型为基本数据类型（数字以及布尔值）时，一个方法是不可能修改一个基本数据类型的参数。</p>\n\n<p>当然java中除了基本数据类型还有引用数据类型，也就是对象引用，那么对于这种数据类型又是怎么样的情况呢？</p>\n\n<p>我们还是一样先来看一个例子：</p>\n\n<p>声明一个User对象类型：</p>\n\n<pre>\n<code class=\"language-java\">package com.zejian.test;\npublic class User {\n    private String name;\n    private int age;\n    public User(String name, int age) {\n        this.name=name;\n        this.age=age;\n    }\n    public String getName() {\n        return name;\n    }\n    public void setName(String name) {\n        this.name = name;\n    }\n    public int getAge() {\n        return age;\n    }\n    public void setAge(int age) {\n        this.age = age;\n    }\n}</code></pre>\n\n<p>执行类如下：</p>\n\n<pre>\n<code class=\"language-java\">package com.zejian.test;\n/**\n * java中的按值调用\n * @author zejian\n */\npublic class CallByValue {\n    private static User user=null;\n    public static void updateUser(User student){\n        student.setName(\"Lishen\");\n        student.setAge(18);\n    }\n\n\n    public static void main(String[] args) {\n        user = new User(\"zhangsan\",26);\n        System.out.println(\"调用前user的值：\"+user.toString());\n        updateUser(user);\n        System.out.println(\"调用后user的值：\"+user.toString());\n    }\n}</code></pre>\n\n<h3>.&nbsp;运行结果如下：</h3>\n\n<pre>\n<code class=\"language-java\">调用前user的值：User [name=zhangsan, age=26]\n调用后user的值：User [name=Lishen, age=18]</code></pre>\n\n<p>很显然，User的值被改变了，也就是说方法参数类型如果是引用类型的话，引用类型对应的值将会被修改，下面我们来分析一下这个过程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542531481034.png\" style=\"height:390px; width:675px\" /></p>\n\n<p><strong>过程分析：</strong></p>\n\n<p>1）student变量被初始化为user值的拷贝，这里是一个对象的引用。</p>\n\n<p>2）调用student变量的set方法作用在这个引用对象上，user和student同时引用的User对象内部值被修改。</p>\n\n<p>3）方法结束后，student变量不再使用，被释放，而user还是没有变，依然指向User对象。</p>\n\n<p><strong>结论：</strong></p>\n\n<p>当传递方法参数类型为引用数据类型时，一个方法将修改一个引用数据类型的参数所指向对象的值。</p>\n\n<p>虽然到这里两个数据类型的传递都分析完了，也明白的基本数据类型的传递和引用数据类型的传递区别，前者将不会修改原数据的值，而后者将会修改引用所指向对象的值。</p>\n\n<p>可通过上面的实例我们可能就会觉得java同时拥有按值调用和按引用调用啊，可惜的是这样的理解是有误导性的，虽然上面引用传递表面上体现了按引用调用现象，但是java中确实只有按值调用而没有按引用调用。</p>\n\n<p>到这里估计不少人都蒙逼了，下面我们通过一个反例来说明（回忆一下开头我们所说明的按值调用与按引用调用的根本区别）。</p>\n\n<pre>\n<code class=\"language-java\">package com.zejian.test;\n/**\n * java中的按值调用\n * @author zejian\n */\npublic class CallByValue {\n    private static User user=null;\n    private static User stu=null;\n\n    /**\n     * 交换两个对象\n     * @param x\n     * @param y\n     */\n    public static void swap(User x,User y){\n        User temp =x;\n        x=y;\n        y=temp;\n    }\n\n\n    public static void main(String[] args) {\n        user = new User(\"user\",26);\n        stu = new User(\"stu\",18);\n        System.out.println(\"调用前user的值：\"+user.toString());\n        System.out.println(\"调用前stu的值：\"+stu.toString());\n        swap(user,stu);\n        System.out.println(\"调用后user的值：\"+user.toString());\n        System.out.println(\"调用后stu的值：\"+stu.toString());\n    }\n}</code></pre>\n\n<p>我们通过一个swap函数来交换两个变量user和stu的值，在前面我们说过，如果是按引用调用那么一个方法可以修改传递引用所对应的变量值，也就是说如果java是按引用调用的话，那么swap方法将能够实现数据的交换，而实际运行结果是：</p>\n\n<pre>\n<code class=\"language-java\">调用前user的值：User [name=user, age=26]\n\n调用前stu的值：User [name=stu, age=18]\n\n调用后user的值：User [name=user, age=26]\n\n调用后stu的值：User [name=stu, age=18]</code></pre>\n\n<p>我们发现user和stu的值并没有发生变化，也就是方法并没有改变存储在变量user和stu中的对象引用。swap方法的参数x和y被初始化为两个对象引用的拷贝，这个方法交换的是这两个拷贝的值而已，最终，所做的事都是白费力气罢了。在方法结束后x，y将被丢弃，而原来的变量user和stu仍然引用这个方法调用之前所引用的对象。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542531532567.png\" style=\"height:317px; width:663px\" /></p>\n\n<p>这个过程也充分说明了java程序设计语言对对象采用的不是引用调用，实际上是对象引用进行的是值传递，当然在这里我们可以简单理解为这就是按值调用和引用调用的区别，而且必须明白即使java函数在传递引用数据类型时，也只是拷贝了引用的值罢了，之所以能修改引用数据是因为它们同时指向了一个对象，但这仍然是按值调用而不是引用调用。</p>\n\n<p>总结：</p>\n\n<ol>\n	<li>\n	<p>一个方法不能修改一个基本数据类型的参数（数值型和布尔型）。</p>\n	</li>\n	<li>\n	<p>一个方法可以修改一个引用所指向的对象状态，但这仍然是按值调用而非引用调用。</p>\n	</li>\n	<li>\n	<p>上面两种传递都进行了值拷贝的过程。</p>\n	</li>\n</ol>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',0,0,'ebb8f56a177f4ed89c9020b43610fd6e',1,'2018-11-18 16:59:11','2018-11-18 16:59:11',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('f346267364024e78844d459be2f6f528','CentOS7下RabbitMQ的安装步骤','CentOS7下RabbitMQ的安装步骤','<p>RabbitMQ是使用Erlang语言开发的开源消息队列系统，基于AMQP协议来实现的，AMQP的主要特征是面向消息，队列，路由（包括点对点和发布/订阅），可靠性，安全，AMQP协议更 多用在企业级系统内，对数据一致性，稳定性和可靠性要求很高的场景，对性能和吞吐量的要求还在其次。</p>\n\n<p>按照教程：</p>\n\n<p>1）首先需要安装Erlang</p>\n\n<pre>\n<code># 添加erlang solutions源\n\n$ wget https://packages.erlang-solutions.com/erlang-solutions-1.0-1.noarch.rpm\n\n$ sudo rpm -Uvh erlang-solutions-1.0-1.noarch.rpm</code></pre>\n\n<p>在执行第二步的时候，可能会报错</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540431242134.png\" style=\"height:63px; width:733px\" /></p>\n\n<p>这是因为从EPEL源安装(这种方式安装的Erlang版本可能不是最新的，有时候不能满足RabbitMQ需要的最低版本)</p>\n\n<p>那么什么是EPEL呢？</p>\n\n<p><strong>EPEL的全称叫 Extra Packages for Enterprise Linux</strong>&nbsp;。EPEL是由 Fedora 社区打造，为 RHEL 及衍生发行版如 CentOS、Scientific Linux 等提供高质量软件包的项目。装上了 EPEL之后，就相当于添加了一个第三方源。</p>\n\n<p>所以我们需要安装epel-release</p>\n\n<pre>\n<code>$ sudo yum install epel-release</code></pre>\n\n<p>安装成功后，在执行</p>\n\n<pre>\n<code>$ sudo yum install erlang</code></pre>\n\n<p>这样，就成功把erlang安装上去了。</p>\n\n<p>2）RabbitMQ安装</p>\n\n<p># 安装之前，首先需要把秘钥包安装好</p>\n\n<pre>\n<code>$ sudo rpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc\n\n# 下载RabbitMQ安装包\n\n$ wget https://www.rabbitmq.com/releases/rabbitmq-server/v3.6.6/rabbitmq-server-3.6.6-1.el7.noarch.rpm\n\n$ sudo yum install rabbitmq-server-3.6.6-1.el7.noarch.rpm</code></pre>\n\n<p>到此为止，RabbitMQ已经安装成功了。</p>\n\n<p>3）如果需要正常使用RabbitMQ，首先需要修改一些默认的配置</p>\n\n<p>#RPM安装方式会默认建立下面文件下，我们打开下方配置文件</p>\n\n<p>$ vim&nbsp;&nbsp;/usr/lib/rabbitmq/lib/rabbitmq_server-3.6.6/ebin/rabbit.app<img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540431994644.png\" style=\"height:830px; width:676px\" />打开我们会发现这是一个非常熟悉的界面，没错，就这就一个JSON的格式。</p>\n\n<p>我们继续往下走，能看这个 tcp_listeners, [5672] 这个属性</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540432158983.png\" style=\"height:179px; width:526px\" /></p>\n\n<p>这表示Rabbit默认的端口号是5672，如果我们需要更改默认端口号，那么就需要在这里进行更改了。</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1540432302795.png\" style=\"height:128px; width:426px\" /></p>\n\n<p>紧接着我们看到 loopback_users: [&quot;guest&quot;], 我们把左右的尖括号去掉，这样就能启动guest默认账号了。</p>\n\n<p>完成之后，我们使用快捷键 shift+zz&nbsp; 保存退出编辑器</p>\n\n<p>好了，RabbitMQ在这里就已经安装成功了，关于rabbitMQ的操作，看我另外一篇博客</p>\n','1c76b9848f5f4d71a5e88b20dbaf38f4',3,0,'1d067e9a0ff74faf9519995e64ecfdef',1,'2018-10-25 09:53:51','2018-10-25 09:53:51',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('f4530db500bf457a9ee60aa763a52e1e','文件上传后，使用Nginx配置静态资源映射出现 403 Forbidden','文件上传后，使用Nginx配置静态资源映射出现 403 Forbidden','<p>今天使用nginx做静态资源映射的时候，图片能够正常上传到linux服务器中。</p>\n\n<p>但是我输入通过Nginx配置的URL路径的时候，出现了 403 Forbidden 的错误，经过排查我发现了</p>\n\n<p>在我后面上传的图片中，他只拥有 root 的 读写权限，其他用户没有权限</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541156768806.png\" style=\"height:468px; width:791px\" /></p>\n\n<p>我猜想，可能是通过URL访问的不是root用户，所以我们没有权限访问到这个目录，那么文件就无法访问了。</p>\n\n<p>然后我将那些文件通过&nbsp; chmod 777&nbsp; 命令将他们改成最高权限，目录能够正常访问了。</p>\n\n<p>后面我通过修改Nginx的配置文件</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541156951009.png\" style=\"height:151px; width:301px\" /></p>\n\n<p>增加&nbsp; user&nbsp; root，后就能够正常访问了。</p>\n','7e0e93ea6cdb44ae92e58f48e6496ed7',0,0,'7cec4c83de9e42869d80bdc767b3e61f',1,'2018-11-02 19:09:33','2018-11-02 19:09:33',NULL,'1','陌溪_','蘑菇博客','2c93dfab0e754006866f8ed486923a41',0),('ffd8c8bfe7234bc6aed88d813e3b67ed','扎心！线上服务宕机时，如何保证数据100%不丢失？','扎心！线上服务宕机时，如何保证数据100%不丢失？','<p><strong><strong>一、写在前面</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>上篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=208692b2a7a242f4942993abb8eebf8b\" target=\"_blank\">同学，消息中间件在你们生产项目里如何落地使用的？</a>》，我们用一个简单易懂的电商场景给大家引入说明了一个消息中间件的使用场景。</p>\n\n<p>&nbsp;</p>\n\n<p>同时，我们还基于RabbitMQ的HelloWorld级别的代码，给出了订单服务和仓储服务如何基于MQ中间件收发消息的示例。</p>\n\n<p><strong><strong>二、业务场景回顾</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>这篇文章，我们来稍微深入探讨一些MQ中间件使用中的基础技术问题。</p>\n\n<p>&nbsp;</p>\n\n<p>首先回顾一下上篇文章做出来的一个架构图，看看订单服务和消息服务是如何基于MQ来收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>我们稍微把这个图细化一点，简单来说就是多个订单服务实例给queue推送消息，多个仓储服务每个消费一部分消息。如下图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145179451.png\" style=\"height:265px; width:820px\" /></p>\n\n<p><strong><strong>三、意外宕机，问题凸现</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>假如你线上对MQ技术的使用就到此为止了，那么基本可以跟offer说拜拜了。。。</p>\n\n<p>&nbsp;</p>\n\n<p>因为如果是我的话，作为一个面试官就没法继续往下问了。你这个MQ的使用以及理解的深度仅此而已的话，那基本就是刚刚对MQ技术入门的程度。</p>\n\n<p>&nbsp;</p>\n\n<p>如果面试官要继续问，完全可以问下面的问题：</p>\n\n<ul>\n	<li>\n	<p>那你说说如果仓储服务作为消费者服务，刚收到了一个订单消息，但是在完成消息的处理之前，也就是还没对订单完成仓储调度发货，结果这个仓储服务突然就宕机了，这个时候会发生什么事情？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>所以说，大家还是要对这个技术了解的稍微深入一点点，否则随便被问几个问题就完蛋了。</p>\n\n<p>&nbsp;</p>\n\n<p>大伙儿先来看看下面的图，感受一下车祸现场。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145205074.png\" style=\"height:326px; width:1227px\" /></p>\n\n<p>RabbitMQ这个中间件默认的一个行为，就是只要仓储服务收到一个订单消息，RabbitMQ就会立马把这条订单消息给标记为删除，<strong>这个行为叫做自动ack，</strong>也就是投递完成一条消息就自动确认这个消息处理完毕了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是接着如果此时仓储服务收到了一个订单消息，但是还没来得及对仓库系统完成商品的调度发货，结果直接就宕机了。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，明显这个订单消息就丢失了啊，因为RabbitMQ那里已经没有了。。。</p>\n\n<p>&nbsp;</p>\n\n<p>这会导致什么样的尴尬体验呢？就是一个用户支付了8999元，对一个iphone8下了订单，结果呢，死等活等了好几天，就是不见网站上显示他的iphone8在发货。</p>\n\n<p>&nbsp;</p>\n\n<p>搞了半天，原因就是他的那个iphone8的订单在仓储服务那里，还没来得及调度发货直接就宕机了，导致这个订单消息就一直丢失了，始终没有给这个用户通知仓库系统进行发货。</p>\n\n<p>&nbsp;</p>\n\n<p>这个问题，是不是很尴尬？所以说，技术问题是会严重影响企业的核心业务流程的！</p>\n\n<p>&nbsp;</p>\n\n<p>各位小伙伴，还记得上一讲咱们的仓储服务消费消息的代码中，有一行关键的代码：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145226184.png\" style=\"height:81px; width:500px\" /></p>\n\n<p>这行代码对<strong>channel.basicConsume()</strong>方法，传入的第二个参数：<strong>true</strong>，其实就是一个关键的参数。</p>\n\n<p>&nbsp;</p>\n\n<p>这个true就代表了一个核心的含义，<strong>他的意思是，RabbitMQ只要把一个消息投递到仓储服务手上，立马就标记这个消息删除了。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>但是在这个默认的配置之下，要是仓储服务收到一个订单消息，结果还没来得及完成耗时几十秒的仓储调度发货的业务逻辑，结果突然宕机了，那么这个订单消息就永久性丢失了！</p>\n\n<p>&nbsp;</p>\n\n<p>找了半天，原来问题的症结在这里啊！大家是不是明白了，上一篇文章最后为什么我会说，这个代码目前为止还有很多的问题。</p>\n\n<p>&nbsp;</p>\n\n<p>所以这个时候，我们如果希望不要因为仓储服务的突然宕机导致一条订单消息丢失，就需要改造一下仓储服务消费消息的代码了。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>首先，我们需要把那个参数从true改为false</strong>，如下代码所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145251780.png\" style=\"height:79px; width:500px\" /></p>\n\n<p>只要修改为false之后，RabbitMQ就不会盲目的投递消息到仓储服务，立马就删除消息了，说白了就是关闭autoAck的行为，不要自作主张的认为消息处理成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>接着，我们需要改造一下处理订单消息的代码，如下代码所示。</p>\n\n<p>&nbsp;</p>\n\n<p>这段代码，说白了，就是在对订单完成了调度发货之后，<strong>在finally代码块中手动执行了ack操作</strong>，说我自己已经完成了耗时几十秒的业务逻辑的处理，现在可以手动ack通知RabbitMQ，这个消息处理完毕了。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145274245.png\" style=\"height:156px; width:500px\" /></p>\n\n<p>此时整个架构运行流程大致看起来跟下面的图那样子。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145297769.png\" style=\"height:125px; width:500px\" /></p>\n\n<p>架构流程改成上面那样后，就意味着只有完成了仓储调度发货的代码业务逻辑，确保仓库系统收到通知之后，仓储服务才会在代码中手动发送ack消息给RabbitMQ。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，RabbitMQ收到了这个ack消息，才会标记对应的订单消息被删除了。</p>\n\n<p>&nbsp;</p>\n\n<p>如果说在仓储服务收到了订单消息，但是还没来得及完成仓储调度发货的业务逻辑，那也就绝对不会执行这条订单消息的ack操作，然后RabbitMQ也就不会收到这条订单消息的ack通知。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦RabbitMQ发现代表消费者的某个仓储服务实例突然宕机了，而这个仓储服务收到的一些订单消息还没来得及处理，没给自己发送那些消息的ack通知。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，RabbitMQ会自动对这条订单消息重发推送给其他在运行中的仓储服务实例，让其他的仓储服务实例去处理这条订单消息。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以保证这条订单消息不会因为某个仓储服务实例的宕机而丢失，他会确保必须由某个仓储服务实例完成这条订单消息的调度发货处理，然后才会删除那条订单消息。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>四、总结 &nbsp;tips</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>最后再来一张图，大家直观的感受一下：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145320120.png\" style=\"height:246px; width:800px\" /></p>\n\n<p>好了，各位同学，这篇文章是不是相对稍微深入一点点，让大家了解到了一些使用MQ技术时候要考虑的一些问题？</p>\n\n<p>&nbsp;</p>\n\n<p>实际上无论是RocketMQ、Kafka还是RabbitMQ，都有类似的autoAck或者是手动ack的机制。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>线上生产环境中运行时，你必须要考虑到消费者服务可能宕机的问题。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>如果消费者服务没处理完消息就自己宕机了，那么一定会导致部分消息的丢失，进而影响核心业务流程的运转。</p>\n\n<p>&nbsp;</p>\n\n<p>因此大家在线上使用MQ时，一定要充分考虑这些潜在问题，同时结合具体的MQ提供的一些API、参数来进行合理设置，确保消息不要随意丢失。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>END</strong></p>\n','1c76b9848f5f4d71a5e88b20dbaf38f4,ca928e8718654aa5a802e2f69277b137',1,0,'e79e4375ce5b4aa6ad48027de6cb8af2',1,'2018-12-30 12:49:04','2018-12-30 12:49:04',NULL,'1','陌溪_','蘑菇博客','e60df954efcd47c48463a504bb70bbe9',1);

/*Table structure for table `t_blog_sort` */

DROP TABLE IF EXISTS `t_blog_sort`;

CREATE TABLE `t_blog_sort` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `sort_name` varchar(255) DEFAULT NULL COMMENT '分类内容',
  `content` varchar(255) DEFAULT NULL COMMENT '分类简介',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `sort` int(11) DEFAULT '0' COMMENT '排序字段，越大越靠前',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='博客分类表';

/*Data for the table `t_blog_sort` */

insert  into `t_blog_sort`(`uid`,`sort_name`,`content`,`create_time`,`update_time`,`status`,`sort`) values ('093d8bdd01c84890a928e923d5c235fe','时光轴','时光飞逝，机会就在我们眼前，何时找到了灵感，就要把握机遇，我们需要智慧和勇气去把握机会','2018-09-24 17:14:59','2018-09-24 17:14:59',1,0),('2c93dfab0e754006866f8ed486923a41','慢生活','慢生活，不是懒惰，放慢速度不是拖延时间，而是让我们在生活中寻找到平衡','2018-09-24 16:29:33','2018-09-24 16:29:33',1,0),('337806254f9c42999043de5c5ee09e77','技术新闻','发现世界的每一天','2018-12-29 10:42:11','2018-12-29 10:42:11',1,0),('9d2019983d91490aaa758eddd7c07caf','机器学习','机器学习','2018-11-21 20:56:02','2018-11-21 20:56:02',1,0),('a03d7290b1c04b6eaf46659661b47032','后端开发','后端开发专题','2018-12-29 10:35:43','2018-12-29 10:35:43',1,0),('ca28ffc94ea94fbda5571e0b242021e2','前端开发','前端开发专题','2018-12-29 10:35:58','2018-12-29 10:35:58',1,0),('e60df954efcd47c48463a504bb70bbe9','面试','面试专题','2018-12-19 21:16:30','2018-12-19 21:16:30',1,0);

/*Table structure for table `t_category_menu` */

DROP TABLE IF EXISTS `t_category_menu`;

CREATE TABLE `t_category_menu` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `name` varchar(255) NOT NULL COMMENT '菜单名称',
  `menu_level` tinyint(1) DEFAULT NULL COMMENT '菜单级别',
  `summary` varchar(200) DEFAULT NULL COMMENT '简介',
  `parent_uid` varchar(32) DEFAULT NULL COMMENT '父uid',
  `url` varchar(255) DEFAULT NULL COMMENT 'url地址',
  `icon` varchar(50) DEFAULT NULL COMMENT '图标',
  `sort` int(11) DEFAULT '0' COMMENT '排序字段，越大越靠前',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='管理员表';

/*Data for the table `t_category_menu` */

insert  into `t_category_menu`(`uid`,`name`,`menu_level`,`summary`,`parent_uid`,`url`,`icon`,`sort`,`status`,`create_time`,`update_time`) values ('02ea2f9ef5d44f559fb66189b05f6769','索引管理',2,'索引管理','badf0010422b432ba6ec9c83a25012ed','/system/solrIndex','index',0,1,'2018-11-28 19:55:39','2018-11-28 19:55:39'),('0a035547bbec404eb3ee0ef43312148d','分类管理',2,'管理博客分类','49b42250abcb47ff876bad699cf34f03','/blog/blogSort','sort',10,1,'2018-11-26 03:07:14','2018-11-26 03:07:14'),('1f01cd1d2f474743b241d74008b12333','博客管理',2,'对博客进行增删改查','49b42250abcb47ff876bad699cf34f03','/blog/blog','edit',11,1,'2018-11-27 03:47:07','2018-11-27 03:47:07'),('25b772444f7548f8a3957e00e5eb4246','权限管理',2,'对权限进行管理','d3a19221259d439b916f475e43edb13d','/authority/authority','adminRole',0,1,'2018-11-25 19:11:22','2018-11-25 19:11:22'),('2de247af3b0a459095e937d7ab9f5864','管理员管理',2,'管理员增删改查','d3a19221259d439b916f475e43edb13d','/authority/admin','user',0,1,'2018-11-25 19:09:21','2018-11-25 19:09:21'),('2fb47d3b6dbd44279c8206740a263543','网站配置',2,'网站配置','badf0010422b432ba6ec9c83a25012ed','/system/webConfig','web',0,1,'2018-11-28 19:59:04','2018-11-28 19:59:04'),('4337f63d13d84b9aba64b9d7a69fd066','异常日志',2,'异常日志','98b82be8785e41dc939b6a5517fdfa53','/log/exceptionLog','exception',0,1,'2018-11-28 20:01:36','2018-11-28 20:01:36'),('49b42250abcb47ff876bad699cf34f03','博客管理',1,'用于博客的一些相关操作',NULL,'/blog','edit',14,1,'2018-11-25 05:15:07','2018-11-25 05:15:07'),('4dea9c4f39d2480983e8c4333d35e036','图片类别管理',2,'图片类别管理','65e22f3d36d94bcea47478aba02895a1','/picture/pictureSort','picture',0,1,'2018-11-28 19:50:31','2018-11-28 19:50:31'),('5010ae46511e4c0b9f30d1c63ad3f0c1','角色管理',2,'管理用户角色信息','d3a19221259d439b916f475e43edb13d','/authority/role','peoples',0,1,'2018-11-25 19:10:34','2018-11-25 19:10:34'),('510483ce569b4fc88299f346147b1314','资源管理',1,'资源管理','','/resource','resource',2,1,'2018-11-28 19:42:13','2018-11-28 19:42:13'),('6228ff4e9ebd42c89599b322201a0345','反馈管理',2,'反馈管理','bcf4a9bc21c14b559bcb015fb7912266','/message/feedback','table',0,1,'2018-11-28 19:48:30','2018-11-28 19:48:30'),('65e22f3d36d94bcea47478aba02895a1','图片管理',1,'图片管理','','/picture','example',3,1,'2018-11-28 19:48:53','2018-11-28 19:48:53'),('6606b7e646d545e5a25c70b5e5fade9f','标签管理',2,'对博客标签进行管理','49b42250abcb47ff876bad699cf34f03','/blog/blogTag','tag',4,1,'2018-11-26 02:57:38','2018-11-26 02:57:38'),('78ab104b123f4950af14d65798afb756','收藏管理',2,'管理用户收藏','49b42250abcb47ff876bad699cf34f03','/blog/collect','example',8,1,'2018-11-25 19:07:48','2018-11-25 19:07:48'),('9002d1ae905c4cb79c2a485333dad2f7','友情链接',2,'友情链接','badf0010422b432ba6ec9c83a25012ed','/system/blogLink','blogLink',0,1,'2018-11-29 03:56:35','2018-11-29 03:56:35'),('9449ce5dd5e24b21a9d15f806cb36e87','分类管理',2,'分类管理','510483ce569b4fc88299f346147b1314','/resource/resourceSort','sort',0,1,'2018-11-29 03:43:27','2018-11-29 03:43:27'),('98b82be8785e41dc939b6a5517fdfa53','操作日志',1,'操作日志','','/log','log',9,1,'2018-11-28 20:00:19','2018-11-28 20:00:19'),('9beb7caa2c844b36a02789262dc76fbe','评论管理',2,'评论管理','bcf4a9bc21c14b559bcb015fb7912266','/message/comment','table',1,1,'2018-11-28 19:47:23','2018-11-28 19:47:23'),('a5902692a3ed4fd794895bf634f97b8e','操作日志',2,'操作日志','98b82be8785e41dc939b6a5517fdfa53','/log/log','log',0,1,'2018-11-28 20:01:02','2018-11-28 20:01:02'),('aa225cdae6464bc0acebd732192f8362','菜单管理',2,'对页面菜单进行管理','d3a19221259d439b916f475e43edb13d','/authority/categoryMenu','example',0,1,'2018-11-25 11:12:01','2018-11-25 11:12:01'),('b511cae571834971a392ae4779270034','游客管理',2,'游客管理','c519725da92b42f3acf0cc9fad58c664','/user/visitor','table',0,1,'2018-11-28 19:54:28','2018-11-28 19:54:28'),('baace3dc03d34c54b81761dce8243814','接口管理',1,'接口管理','','/restapi','restapi',4,1,'2018-11-28 20:01:57','2018-11-28 20:01:57'),('badf0010422b432ba6ec9c83a25012ed','系统管理',1,'系统管理','','/system','system',11,1,'2018-11-28 19:54:47','2018-11-28 19:54:47'),('bcf4a9bc21c14b559bcb015fb7912266','消息管理',1,'消息管理','','/message','message1',6,1,'2018-11-28 19:45:29','2018-11-28 19:45:29'),('c519725da92b42f3acf0cc9fad58c664','用户管理',1,'用户管理','','/user','user1',13,1,'2018-11-28 19:51:47','2018-11-28 19:51:47'),('d3a19221259d439b916f475e43edb13d','权限管理',1,'对管理员权限分配进行管理','','/authority','authority',5,1,'2018-11-25 19:08:42','2018-11-25 19:08:42'),('d4d92c53d3614d00865e9219b8292a90','Picture接口',2,'Picture接口','baace3dc03d34c54b81761dce8243814','/restapi/pictureRestApi','table',0,1,'2018-11-28 20:04:33','2018-11-28 20:04:33'),('e4a482c089d04a30b6ecbaadb81b70f8','Admin接口',2,'Admin接口','baace3dc03d34c54b81761dce8243814','/restapi/adminRestApi','table',0,1,'2018-11-28 20:03:32','2018-11-28 20:03:32'),('f9276eb8e3274c8aa05577c86e4dc8c1','Web接口',2,'Web接口','baace3dc03d34c54b81761dce8243814','/restapi/webRestApi','table',0,1,'2018-11-28 20:04:52','2018-11-28 20:04:52'),('faccfe476b89483791c05019ad5b4906','关于我',2,'关于我','badf0010422b432ba6ec9c83a25012ed','/system/aboutMe','aboutMe',0,1,'2018-11-29 03:55:17','2018-11-29 03:55:17'),('fb4237a353d0418ab42c748b7c1d64c6','用户管理',2,'用户管理','c519725da92b42f3acf0cc9fad58c664','/user/user','table',1,1,'2018-11-28 19:52:20','2018-11-28 19:52:20'),('ffc6e9ca2cc243febf6d2f476b849163','视频管理',2,'视频管理','510483ce569b4fc88299f346147b1314','/resource/studyVideo','table',0,1,'2018-11-28 19:43:50','2018-11-28 19:43:50');

/*Table structure for table `t_collect` */

DROP TABLE IF EXISTS `t_collect`;

CREATE TABLE `t_collect` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `user_uid` varchar(32) NOT NULL COMMENT '用户的uid',
  `blog_uid` varchar(32) NOT NULL COMMENT '博客的uid',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='收藏表';

/*Data for the table `t_collect` */

/*Table structure for table `t_comment` */

DROP TABLE IF EXISTS `t_comment`;

CREATE TABLE `t_comment` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `user_uid` varchar(32) DEFAULT NULL COMMENT '用户uid',
  `to_uid` varchar(32) DEFAULT NULL COMMENT '回复某条评论的uid',
  `to_user_uid` varchar(32) DEFAULT NULL COMMENT '回复某个人的uid',
  `user_name` varchar(255) DEFAULT NULL COMMENT '用户名',
  `content` varchar(1000) DEFAULT NULL COMMENT '评论内容',
  `blog_uid` varchar(32) DEFAULT NULL COMMENT '博客uid',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='评论表';

/*Data for the table `t_comment` */

insert  into `t_comment`(`uid`,`user_uid`,`to_uid`,`to_user_uid`,`user_name`,`content`,`blog_uid`,`status`,`create_time`,`update_time`) values ('0500ba8e97b34528ae18c18616cf93e7','093d8bdd01c84890a928e923d5c235fe',NULL,NULL,'你好','编辑测试博客','093d8bdd01c84890a928e923d5c235fe',1,'2018-10-13 16:35:30','2018-10-13 16:35:30');

/*Table structure for table `t_exception_log` */

DROP TABLE IF EXISTS `t_exception_log`;

CREATE TABLE `t_exception_log` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `exception_json` mediumtext COMMENT '异常对象json格式',
  `exception_message` mediumtext COMMENT '异常信息',
  `status` tinyint(1) DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*Data for the table `t_exception_log` */

insert  into `t_exception_log`(`uid`,`exception_json`,`exception_message`,`status`,`create_time`,`update_time`) values ('021e067cec0641b2bdf773f8d131b065','{\"@type\":\"java.lang.NullPointerException\",\"cause\":null,\"localizedMessage\":null,\"message\":null,\"stackTrace\":[{\"className\":\"com.moxi.mogublog.xo.service.impl.BlogSearchServiceImpl\",\"fileName\":\"BlogSearchServiceImpl.java\",\"lineNumber\":125,\"methodName\":\"updateIndex\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi\",\"fileName\":\"BlogRestApi.java\",\"lineNumber\":373,\"methodName\":\"edit\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$FastClassBySpringCGLIB$$24b5f54f\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.cglib.proxy.MethodProxy\",\"fileName\":\"MethodProxy.java\",\"lineNumber\":204,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":720,\"methodName\":\"invokeJoinpoint\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":157,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor\",\"fileName\":\"MethodBeforeAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor\",\"fileName\":\"AfterReturningAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.aspectj.AspectJAfterThrowingAdvice\",\"fileName\":\"AspectJAfterThrowingAdvice.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.interceptor.ExposeInvocationInterceptor\",\"fileName\":\"ExposeInvocationInterceptor.java\",\"lineNumber\":92,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":179,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":655,\"methodName\":\"intercept\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$EnhancerBySpringCGLIB$$14c4cfd4\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"edit\",\"nativeMethod\":false},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2,\"methodName\":\"invoke0\",\"nativeMethod\":true},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"java.lang.reflect.Method\",\"fileName\":\"Method.java\",\"lineNumber\":497,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":221,\"methodName\":\"doInvoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":136,\"methodName\":\"invokeForRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod\",\"fileName\":\"ServletInvocableHandlerMethod.java\",\"lineNumber\":114,\"methodName\":\"invokeAndHandle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":827,\"methodName\":\"invokeHandlerMethod\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":738,\"methodName\":\"handleInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter\",\"fileName\":\"AbstractHandlerMethodAdapter.java\",\"lineNumber\":85,\"methodName\":\"handle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":963,\"methodName\":\"doDispatch\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":897,\"methodName\":\"doService\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":970,\"methodName\":\"processRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":872,\"methodName\":\"doPost\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":661,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":846,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":742,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":231,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.websocket.server.WsFilter\",\"fileName\":\"WsFilter.java\",\"lineNumber\":52,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.filter.ApplicationContextHeaderFilter\",\"fileName\":\"ApplicationContextHeaderFilter.java\",\"lineNumber\":55,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.alibaba.druid.support.http.WebStatFilter\",\"fileName\":\"WebStatFilter.java\",\"lineNumber\":123,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.trace.WebRequestTraceFilter\",\"fileName\":\"WebRequestTraceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":317,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":127,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":91,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.ExceptionTranslationFilter\",\"fileName\":\"ExceptionTranslationFilter.java\",\"lineNumber\":115,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.session.SessionManagementFilter\",\"fileName\":\"SessionManagementFilter.java\",\"lineNumber\":137,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.AnonymousAuthenticationFilter\",\"fileName\":\"AnonymousAuthenticationFilter.java\",\"lineNumber\":111,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter\",\"fileName\":\"SecurityContextHolderAwareRequestFilter.java\",\"lineNumber\":169,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.savedrequest.RequestCacheAwareFilter\",\"fileName\":\"RequestCacheAwareFilter.java\",\"lineNumber\":63,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.logout.LogoutFilter\",\"fileName\":\"LogoutFilter.java\",\"lineNumber\":121,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CorsFilter\",\"fileName\":\"CorsFilter.java\",\"lineNumber\":96,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.header.HeaderWriterFilter\",\"fileName\":\"HeaderWriterFilter.java\",\"lineNumber\":66,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.SecurityContextPersistenceFilter\",\"fileName\":\"SecurityContextPersistenceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter\",\"fileName\":\"WebAsyncManagerIntegrationFilter.java\",\"lineNumber\":56,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":214,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":177,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":346,\"methodName\":\"invokeDelegate\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":262,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.RequestContextFilter\",\"fileName\":\"RequestContextFilter.java\",\"lineNumber\":99,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HttpPutFormContentFilter\",\"fileName\":\"HttpPutFormContentFilter.java\",\"lineNumber\":87,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HiddenHttpMethodFilter\",\"fileName\":\"HiddenHttpMethodFilter.java\",\"lineNumber\":77,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CharacterEncodingFilter\",\"fileName\":\"CharacterEncodingFilter.java\",\"lineNumber\":197,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.autoconfigure.MetricsFilter\",\"fileName\":\"MetricsFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":119,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":61,\"methodName\":\"access$000\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter$1\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":94,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":112,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardWrapperValve\",\"fileName\":\"StandardWrapperValve.java\",\"lineNumber\":198,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardContextValve\",\"fileName\":\"StandardContextValve.java\",\"lineNumber\":96,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.authenticator.AuthenticatorBase\",\"fileName\":\"AuthenticatorBase.java\",\"lineNumber\":493,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardHostValve\",\"fileName\":\"StandardHostValve.java\",\"lineNumber\":140,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.ErrorReportValve\",\"fileName\":\"ErrorReportValve.java\",\"lineNumber\":81,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.AbstractAccessLogValve\",\"fileName\":\"AbstractAccessLogValve.java\",\"lineNumber\":650,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardEngineValve\",\"fileName\":\"StandardEngineValve.java\",\"lineNumber\":87,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.connector.CoyoteAdapter\",\"fileName\":\"CoyoteAdapter.java\",\"lineNumber\":342,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.http11.Http11Processor\",\"fileName\":\"Http11Processor.java\",\"lineNumber\":800,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProcessorLight\",\"fileName\":\"AbstractProcessorLight.java\",\"lineNumber\":66,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProtocol$ConnectionHandler\",\"fileName\":\"AbstractProtocol.java\",\"lineNumber\":806,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.NioEndpoint$SocketProcessor\",\"fileName\":\"NioEndpoint.java\",\"lineNumber\":1498,\"methodName\":\"doRun\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.SocketProcessorBase\",\"fileName\":\"SocketProcessorBase.java\",\"lineNumber\":49,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":1142,\"methodName\":\"runWorker\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor$Worker\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":617,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.threads.TaskThread$WrappingRunnable\",\"fileName\":\"TaskThread.java\",\"lineNumber\":61,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.lang.Thread\",\"fileName\":\"Thread.java\",\"lineNumber\":745,\"methodName\":\"run\",\"nativeMethod\":false}],\"suppressed\":[]}',NULL,1,'2018-12-29 10:34:51','2018-12-29 10:34:51'),('5551888fcb054eb3b81e080d5d48d03f','{\"@type\":\"org.springframework.amqp.AmqpConnectException\",\"cause\":{\"@type\":\"java.net.ConnectException\",\"cause\":null,\"localizedMessage\":\"Connection refused\",\"message\":\"Connection refused\",\"stackTrace\":[{\"className\":\"java.net.PlainSocketImpl\",\"fileName\":\"PlainSocketImpl.java\",\"lineNumber\":-2,\"methodName\":\"socketConnect\",\"nativeMethod\":true},{\"className\":\"java.net.AbstractPlainSocketImpl\",\"fileName\":\"AbstractPlainSocketImpl.java\",\"lineNumber\":350,\"methodName\":\"doConnect\",\"nativeMethod\":false},{\"className\":\"java.net.AbstractPlainSocketImpl\",\"fileName\":\"AbstractPlainSocketImpl.java\",\"lineNumber\":206,\"methodName\":\"connectToAddress\",\"nativeMethod\":false},{\"className\":\"java.net.AbstractPlainSocketImpl\",\"fileName\":\"AbstractPlainSocketImpl.java\",\"lineNumber\":188,\"methodName\":\"connect\",\"nativeMethod\":false},{\"className\":\"java.net.SocksSocketImpl\",\"fileName\":\"SocksSocketImpl.java\",\"lineNumber\":392,\"methodName\":\"connect\",\"nativeMethod\":false},{\"className\":\"java.net.Socket\",\"fileName\":\"Socket.java\",\"lineNumber\":589,\"methodName\":\"connect\",\"nativeMethod\":false},{\"className\":\"com.rabbitmq.client.impl.FrameHandlerFactory\",\"fileName\":\"FrameHandlerFactory.java\",\"lineNumber\":32,\"methodName\":\"create\",\"nativeMethod\":false},{\"className\":\"com.rabbitmq.client.ConnectionFactory\",\"fileName\":\"ConnectionFactory.java\",\"lineNumber\":811,\"methodName\":\"newConnection\",\"nativeMethod\":false},{\"className\":\"com.rabbitmq.client.ConnectionFactory\",\"fileName\":\"ConnectionFactory.java\",\"lineNumber\":725,\"methodName\":\"newConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.AbstractConnectionFactory\",\"fileName\":\"AbstractConnectionFactory.java\",\"lineNumber\":296,\"methodName\":\"createBareConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.CachingConnectionFactory\",\"fileName\":\"CachingConnectionFactory.java\",\"lineNumber\":547,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils$1\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":90,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":140,\"methodName\":\"doGetTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":76,\"methodName\":\"getTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1374,\"methodName\":\"doExecute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1367,\"methodName\":\"execute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":699,\"methodName\":\"send\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":767,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":763,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi\",\"fileName\":\"BlogRestApi.java\",\"lineNumber\":281,\"methodName\":\"add\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$FastClassBySpringCGLIB$$24b5f54f\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.cglib.proxy.MethodProxy\",\"fileName\":\"MethodProxy.java\",\"lineNumber\":204,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":720,\"methodName\":\"invokeJoinpoint\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":157,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor\",\"fileName\":\"MethodBeforeAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor\",\"fileName\":\"AfterReturningAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.aspectj.AspectJAfterThrowingAdvice\",\"fileName\":\"AspectJAfterThrowingAdvice.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.interceptor.ExposeInvocationInterceptor\",\"fileName\":\"ExposeInvocationInterceptor.java\",\"lineNumber\":92,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":179,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":655,\"methodName\":\"intercept\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$EnhancerBySpringCGLIB$$f84fb287\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"add\",\"nativeMethod\":false},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2,\"methodName\":\"invoke0\",\"nativeMethod\":true},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"java.lang.reflect.Method\",\"fileName\":\"Method.java\",\"lineNumber\":497,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":221,\"methodName\":\"doInvoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":136,\"methodName\":\"invokeForRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod\",\"fileName\":\"ServletInvocableHandlerMethod.java\",\"lineNumber\":114,\"methodName\":\"invokeAndHandle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":827,\"methodName\":\"invokeHandlerMethod\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":738,\"methodName\":\"handleInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter\",\"fileName\":\"AbstractHandlerMethodAdapter.java\",\"lineNumber\":85,\"methodName\":\"handle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":963,\"methodName\":\"doDispatch\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":897,\"methodName\":\"doService\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":970,\"methodName\":\"processRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":872,\"methodName\":\"doPost\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":661,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":846,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":742,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":231,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.websocket.server.WsFilter\",\"fileName\":\"WsFilter.java\",\"lineNumber\":52,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.filter.ApplicationContextHeaderFilter\",\"fileName\":\"ApplicationContextHeaderFilter.java\",\"lineNumber\":55,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.alibaba.druid.support.http.WebStatFilter\",\"fileName\":\"WebStatFilter.java\",\"lineNumber\":123,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.trace.WebRequestTraceFilter\",\"fileName\":\"WebRequestTraceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":317,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":127,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":91,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.ExceptionTranslationFilter\",\"fileName\":\"ExceptionTranslationFilter.java\",\"lineNumber\":115,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.session.SessionManagementFilter\",\"fileName\":\"SessionManagementFilter.java\",\"lineNumber\":137,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.AnonymousAuthenticationFilter\",\"fileName\":\"AnonymousAuthenticationFilter.java\",\"lineNumber\":111,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter\",\"fileName\":\"SecurityContextHolderAwareRequestFilter.java\",\"lineNumber\":169,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.savedrequest.RequestCacheAwareFilter\",\"fileName\":\"RequestCacheAwareFilter.java\",\"lineNumber\":63,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.logout.LogoutFilter\",\"fileName\":\"LogoutFilter.java\",\"lineNumber\":121,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CorsFilter\",\"fileName\":\"CorsFilter.java\",\"lineNumber\":96,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.header.HeaderWriterFilter\",\"fileName\":\"HeaderWriterFilter.java\",\"lineNumber\":66,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.SecurityContextPersistenceFilter\",\"fileName\":\"SecurityContextPersistenceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter\",\"fileName\":\"WebAsyncManagerIntegrationFilter.java\",\"lineNumber\":56,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":214,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":177,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":346,\"methodName\":\"invokeDelegate\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":262,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.RequestContextFilter\",\"fileName\":\"RequestContextFilter.java\",\"lineNumber\":99,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HttpPutFormContentFilter\",\"fileName\":\"HttpPutFormContentFilter.java\",\"lineNumber\":87,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HiddenHttpMethodFilter\",\"fileName\":\"HiddenHttpMethodFilter.java\",\"lineNumber\":77,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CharacterEncodingFilter\",\"fileName\":\"CharacterEncodingFilter.java\",\"lineNumber\":197,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.autoconfigure.MetricsFilter\",\"fileName\":\"MetricsFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":119,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":61,\"methodName\":\"access$000\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter$1\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":94,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":112,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardWrapperValve\",\"fileName\":\"StandardWrapperValve.java\",\"lineNumber\":198,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardContextValve\",\"fileName\":\"StandardContextValve.java\",\"lineNumber\":96,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.authenticator.AuthenticatorBase\",\"fileName\":\"AuthenticatorBase.java\",\"lineNumber\":493,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardHostValve\",\"fileName\":\"StandardHostValve.java\",\"lineNumber\":140,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.ErrorReportValve\",\"fileName\":\"ErrorReportValve.java\",\"lineNumber\":81,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.AbstractAccessLogValve\",\"fileName\":\"AbstractAccessLogValve.java\",\"lineNumber\":650,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardEngineValve\",\"fileName\":\"StandardEngineValve.java\",\"lineNumber\":87,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.connector.CoyoteAdapter\",\"fileName\":\"CoyoteAdapter.java\",\"lineNumber\":342,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.http11.Http11Processor\",\"fileName\":\"Http11Processor.java\",\"lineNumber\":800,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProcessorLight\",\"fileName\":\"AbstractProcessorLight.java\",\"lineNumber\":66,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProtocol$ConnectionHandler\",\"fileName\":\"AbstractProtocol.java\",\"lineNumber\":806,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.NioEndpoint$SocketProcessor\",\"fileName\":\"NioEndpoint.java\",\"lineNumber\":1498,\"methodName\":\"doRun\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.SocketProcessorBase\",\"fileName\":\"SocketProcessorBase.java\",\"lineNumber\":49,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":1142,\"methodName\":\"runWorker\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor$Worker\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":617,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.threads.TaskThread$WrappingRunnable\",\"fileName\":\"TaskThread.java\",\"lineNumber\":61,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.lang.Thread\",\"fileName\":\"Thread.java\",\"lineNumber\":745,\"methodName\":\"run\",\"nativeMethod\":false}],\"suppressed\":[]},\"localizedMessage\":\"java.net.ConnectException: Connection refused\",\"message\":\"java.net.ConnectException: Connection refused\",\"stackTrace\":[{\"className\":\"org.springframework.amqp.rabbit.support.RabbitExceptionTranslator\",\"fileName\":\"RabbitExceptionTranslator.java\",\"lineNumber\":62,\"methodName\":\"convertRabbitAccessException\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.AbstractConnectionFactory\",\"fileName\":\"AbstractConnectionFactory.java\",\"lineNumber\":309,\"methodName\":\"createBareConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.CachingConnectionFactory\",\"fileName\":\"CachingConnectionFactory.java\",\"lineNumber\":547,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils$1\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":90,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":140,\"methodName\":\"doGetTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":76,\"methodName\":\"getTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1374,\"methodName\":\"doExecute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1367,\"methodName\":\"execute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":699,\"methodName\":\"send\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":767,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":763,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi\",\"fileName\":\"BlogRestApi.java\",\"lineNumber\":281,\"methodName\":\"add\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$FastClassBySpringCGLIB$$24b5f54f\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.cglib.proxy.MethodProxy\",\"fileName\":\"MethodProxy.java\",\"lineNumber\":204,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":720,\"methodName\":\"invokeJoinpoint\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":157,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor\",\"fileName\":\"MethodBeforeAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor\",\"fileName\":\"AfterReturningAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.aspectj.AspectJAfterThrowingAdvice\",\"fileName\":\"AspectJAfterThrowingAdvice.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.interceptor.ExposeInvocationInterceptor\",\"fileName\":\"ExposeInvocationInterceptor.java\",\"lineNumber\":92,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":179,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":655,\"methodName\":\"intercept\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$EnhancerBySpringCGLIB$$f84fb287\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"add\",\"nativeMethod\":false},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2,\"methodName\":\"invoke0\",\"nativeMethod\":true},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"java.lang.reflect.Method\",\"fileName\":\"Method.java\",\"lineNumber\":497,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":221,\"methodName\":\"doInvoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":136,\"methodName\":\"invokeForRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod\",\"fileName\":\"ServletInvocableHandlerMethod.java\",\"lineNumber\":114,\"methodName\":\"invokeAndHandle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":827,\"methodName\":\"invokeHandlerMethod\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":738,\"methodName\":\"handleInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter\",\"fileName\":\"AbstractHandlerMethodAdapter.java\",\"lineNumber\":85,\"methodName\":\"handle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":963,\"methodName\":\"doDispatch\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":897,\"methodName\":\"doService\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":970,\"methodName\":\"processRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":872,\"methodName\":\"doPost\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":661,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":846,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":742,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":231,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.websocket.server.WsFilter\",\"fileName\":\"WsFilter.java\",\"lineNumber\":52,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.filter.ApplicationContextHeaderFilter\",\"fileName\":\"ApplicationContextHeaderFilter.java\",\"lineNumber\":55,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.alibaba.druid.support.http.WebStatFilter\",\"fileName\":\"WebStatFilter.java\",\"lineNumber\":123,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.trace.WebRequestTraceFilter\",\"fileName\":\"WebRequestTraceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":317,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":127,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":91,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.ExceptionTranslationFilter\",\"fileName\":\"ExceptionTranslationFilter.java\",\"lineNumber\":115,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.session.SessionManagementFilter\",\"fileName\":\"SessionManagementFilter.java\",\"lineNumber\":137,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.AnonymousAuthenticationFilter\",\"fileName\":\"AnonymousAuthenticationFilter.java\",\"lineNumber\":111,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter\",\"fileName\":\"SecurityContextHolderAwareRequestFilter.java\",\"lineNumber\":169,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.savedrequest.RequestCacheAwareFilter\",\"fileName\":\"RequestCacheAwareFilter.java\",\"lineNumber\":63,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.logout.LogoutFilter\",\"fileName\":\"LogoutFilter.java\",\"lineNumber\":121,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CorsFilter\",\"fileName\":\"CorsFilter.java\",\"lineNumber\":96,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.header.HeaderWriterFilter\",\"fileName\":\"HeaderWriterFilter.java\",\"lineNumber\":66,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.SecurityContextPersistenceFilter\",\"fileName\":\"SecurityContextPersistenceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter\",\"fileName\":\"WebAsyncManagerIntegrationFilter.java\",\"lineNumber\":56,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":214,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":177,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":346,\"methodName\":\"invokeDelegate\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":262,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.RequestContextFilter\",\"fileName\":\"RequestContextFilter.java\",\"lineNumber\":99,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HttpPutFormContentFilter\",\"fileName\":\"HttpPutFormContentFilter.java\",\"lineNumber\":87,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HiddenHttpMethodFilter\",\"fileName\":\"HiddenHttpMethodFilter.java\",\"lineNumber\":77,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CharacterEncodingFilter\",\"fileName\":\"CharacterEncodingFilter.java\",\"lineNumber\":197,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.autoconfigure.MetricsFilter\",\"fileName\":\"MetricsFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":119,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":61,\"methodName\":\"access$000\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter$1\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":94,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":112,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardWrapperValve\",\"fileName\":\"StandardWrapperValve.java\",\"lineNumber\":198,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardContextValve\",\"fileName\":\"StandardContextValve.java\",\"lineNumber\":96,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.authenticator.AuthenticatorBase\",\"fileName\":\"AuthenticatorBase.java\",\"lineNumber\":493,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardHostValve\",\"fileName\":\"StandardHostValve.java\",\"lineNumber\":140,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.ErrorReportValve\",\"fileName\":\"ErrorReportValve.java\",\"lineNumber\":81,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.AbstractAccessLogValve\",\"fileName\":\"AbstractAccessLogValve.java\",\"lineNumber\":650,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardEngineValve\",\"fileName\":\"StandardEngineValve.java\",\"lineNumber\":87,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.connector.CoyoteAdapter\",\"fileName\":\"CoyoteAdapter.java\",\"lineNumber\":342,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.http11.Http11Processor\",\"fileName\":\"Http11Processor.java\",\"lineNumber\":800,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProcessorLight\",\"fileName\":\"AbstractProcessorLight.java\",\"lineNumber\":66,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProtocol$ConnectionHandler\",\"fileName\":\"AbstractProtocol.java\",\"lineNumber\":806,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.NioEndpoint$SocketProcessor\",\"fileName\":\"NioEndpoint.java\",\"lineNumber\":1498,\"methodName\":\"doRun\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.SocketProcessorBase\",\"fileName\":\"SocketProcessorBase.java\",\"lineNumber\":49,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":1142,\"methodName\":\"runWorker\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor$Worker\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":617,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.threads.TaskThread$WrappingRunnable\",\"fileName\":\"TaskThread.java\",\"lineNumber\":61,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.lang.Thread\",\"fileName\":\"Thread.java\",\"lineNumber\":745,\"methodName\":\"run\",\"nativeMethod\":false}],\"suppressed\":[]}','java.net.ConnectException: Connection refused',1,'2018-12-27 09:28:42','2018-12-27 09:28:42'),('8a57e91b2d714c8a9d2a046878da5754',NULL,'\n### Error updating database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry \'c83a489cd0c7492c9c2cf9a5c5743e56\' for key \'PRIMARY\'\n### The error may involve com.moxi.mogublog.xo.mapper.SysLogMapper.insert-Inline\n### The error occurred while setting parameters\n### SQL: INSERT INTO t_sys_log   ( uid,user_name,admin_uid,ip,url,type,class_path,method,params,operation,status,create_time,update_time )  VALUES   ( ?,?,?,?,?,?,?,?,?,?,?,?,? )\n### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry \'c83a489cd0c7492c9c2cf9a5c5743e56\' for key \'PRIMARY\'\n; SQL []; Duplicate entry \'c83a489cd0c7492c9c2cf9a5c5743e56\' for key \'PRIMARY\'; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry \'c83a489cd0c7492c9c2cf9a5c5743e56\' for key \'PRIMARY\'',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('f1815869199a4bd9abdbb2f0d25adcd6','{\"@type\":\"org.springframework.amqp.AmqpConnectException\",\"cause\":{\"@type\":\"java.net.ConnectException\",\"cause\":null,\"localizedMessage\":\"Connection refused\",\"message\":\"Connection refused\",\"stackTrace\":[{\"className\":\"java.net.PlainSocketImpl\",\"fileName\":\"PlainSocketImpl.java\",\"lineNumber\":-2,\"methodName\":\"socketConnect\",\"nativeMethod\":true},{\"className\":\"java.net.AbstractPlainSocketImpl\",\"fileName\":\"AbstractPlainSocketImpl.java\",\"lineNumber\":350,\"methodName\":\"doConnect\",\"nativeMethod\":false},{\"className\":\"java.net.AbstractPlainSocketImpl\",\"fileName\":\"AbstractPlainSocketImpl.java\",\"lineNumber\":206,\"methodName\":\"connectToAddress\",\"nativeMethod\":false},{\"className\":\"java.net.AbstractPlainSocketImpl\",\"fileName\":\"AbstractPlainSocketImpl.java\",\"lineNumber\":188,\"methodName\":\"connect\",\"nativeMethod\":false},{\"className\":\"java.net.SocksSocketImpl\",\"fileName\":\"SocksSocketImpl.java\",\"lineNumber\":392,\"methodName\":\"connect\",\"nativeMethod\":false},{\"className\":\"java.net.Socket\",\"fileName\":\"Socket.java\",\"lineNumber\":589,\"methodName\":\"connect\",\"nativeMethod\":false},{\"className\":\"com.rabbitmq.client.impl.FrameHandlerFactory\",\"fileName\":\"FrameHandlerFactory.java\",\"lineNumber\":32,\"methodName\":\"create\",\"nativeMethod\":false},{\"className\":\"com.rabbitmq.client.ConnectionFactory\",\"fileName\":\"ConnectionFactory.java\",\"lineNumber\":811,\"methodName\":\"newConnection\",\"nativeMethod\":false},{\"className\":\"com.rabbitmq.client.ConnectionFactory\",\"fileName\":\"ConnectionFactory.java\",\"lineNumber\":725,\"methodName\":\"newConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.AbstractConnectionFactory\",\"fileName\":\"AbstractConnectionFactory.java\",\"lineNumber\":296,\"methodName\":\"createBareConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.CachingConnectionFactory\",\"fileName\":\"CachingConnectionFactory.java\",\"lineNumber\":547,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils$1\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":90,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":140,\"methodName\":\"doGetTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":76,\"methodName\":\"getTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1374,\"methodName\":\"doExecute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1367,\"methodName\":\"execute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":699,\"methodName\":\"send\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":767,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":763,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi\",\"fileName\":\"BlogRestApi.java\",\"lineNumber\":370,\"methodName\":\"edit\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$FastClassBySpringCGLIB$$24b5f54f\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.cglib.proxy.MethodProxy\",\"fileName\":\"MethodProxy.java\",\"lineNumber\":204,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":720,\"methodName\":\"invokeJoinpoint\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":157,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor\",\"fileName\":\"MethodBeforeAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor\",\"fileName\":\"AfterReturningAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.aspectj.AspectJAfterThrowingAdvice\",\"fileName\":\"AspectJAfterThrowingAdvice.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.interceptor.ExposeInvocationInterceptor\",\"fileName\":\"ExposeInvocationInterceptor.java\",\"lineNumber\":92,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":179,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":655,\"methodName\":\"intercept\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$EnhancerBySpringCGLIB$$f84fb287\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"edit\",\"nativeMethod\":false},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2,\"methodName\":\"invoke0\",\"nativeMethod\":true},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"java.lang.reflect.Method\",\"fileName\":\"Method.java\",\"lineNumber\":497,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":221,\"methodName\":\"doInvoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":136,\"methodName\":\"invokeForRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod\",\"fileName\":\"ServletInvocableHandlerMethod.java\",\"lineNumber\":114,\"methodName\":\"invokeAndHandle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":827,\"methodName\":\"invokeHandlerMethod\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":738,\"methodName\":\"handleInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter\",\"fileName\":\"AbstractHandlerMethodAdapter.java\",\"lineNumber\":85,\"methodName\":\"handle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":963,\"methodName\":\"doDispatch\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":897,\"methodName\":\"doService\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":970,\"methodName\":\"processRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":872,\"methodName\":\"doPost\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":661,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":846,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":742,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":231,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.websocket.server.WsFilter\",\"fileName\":\"WsFilter.java\",\"lineNumber\":52,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.filter.ApplicationContextHeaderFilter\",\"fileName\":\"ApplicationContextHeaderFilter.java\",\"lineNumber\":55,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.alibaba.druid.support.http.WebStatFilter\",\"fileName\":\"WebStatFilter.java\",\"lineNumber\":123,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.trace.WebRequestTraceFilter\",\"fileName\":\"WebRequestTraceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":317,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":127,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":91,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.ExceptionTranslationFilter\",\"fileName\":\"ExceptionTranslationFilter.java\",\"lineNumber\":115,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.session.SessionManagementFilter\",\"fileName\":\"SessionManagementFilter.java\",\"lineNumber\":137,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.AnonymousAuthenticationFilter\",\"fileName\":\"AnonymousAuthenticationFilter.java\",\"lineNumber\":111,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter\",\"fileName\":\"SecurityContextHolderAwareRequestFilter.java\",\"lineNumber\":169,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.savedrequest.RequestCacheAwareFilter\",\"fileName\":\"RequestCacheAwareFilter.java\",\"lineNumber\":63,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.logout.LogoutFilter\",\"fileName\":\"LogoutFilter.java\",\"lineNumber\":121,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CorsFilter\",\"fileName\":\"CorsFilter.java\",\"lineNumber\":96,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.header.HeaderWriterFilter\",\"fileName\":\"HeaderWriterFilter.java\",\"lineNumber\":66,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.SecurityContextPersistenceFilter\",\"fileName\":\"SecurityContextPersistenceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter\",\"fileName\":\"WebAsyncManagerIntegrationFilter.java\",\"lineNumber\":56,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":214,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":177,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":346,\"methodName\":\"invokeDelegate\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":262,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.RequestContextFilter\",\"fileName\":\"RequestContextFilter.java\",\"lineNumber\":99,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HttpPutFormContentFilter\",\"fileName\":\"HttpPutFormContentFilter.java\",\"lineNumber\":87,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HiddenHttpMethodFilter\",\"fileName\":\"HiddenHttpMethodFilter.java\",\"lineNumber\":77,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CharacterEncodingFilter\",\"fileName\":\"CharacterEncodingFilter.java\",\"lineNumber\":197,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.autoconfigure.MetricsFilter\",\"fileName\":\"MetricsFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":119,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":61,\"methodName\":\"access$000\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter$1\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":94,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":112,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardWrapperValve\",\"fileName\":\"StandardWrapperValve.java\",\"lineNumber\":198,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardContextValve\",\"fileName\":\"StandardContextValve.java\",\"lineNumber\":96,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.authenticator.AuthenticatorBase\",\"fileName\":\"AuthenticatorBase.java\",\"lineNumber\":493,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardHostValve\",\"fileName\":\"StandardHostValve.java\",\"lineNumber\":140,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.ErrorReportValve\",\"fileName\":\"ErrorReportValve.java\",\"lineNumber\":81,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.AbstractAccessLogValve\",\"fileName\":\"AbstractAccessLogValve.java\",\"lineNumber\":650,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardEngineValve\",\"fileName\":\"StandardEngineValve.java\",\"lineNumber\":87,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.connector.CoyoteAdapter\",\"fileName\":\"CoyoteAdapter.java\",\"lineNumber\":342,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.http11.Http11Processor\",\"fileName\":\"Http11Processor.java\",\"lineNumber\":800,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProcessorLight\",\"fileName\":\"AbstractProcessorLight.java\",\"lineNumber\":66,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProtocol$ConnectionHandler\",\"fileName\":\"AbstractProtocol.java\",\"lineNumber\":806,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.NioEndpoint$SocketProcessor\",\"fileName\":\"NioEndpoint.java\",\"lineNumber\":1498,\"methodName\":\"doRun\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.SocketProcessorBase\",\"fileName\":\"SocketProcessorBase.java\",\"lineNumber\":49,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":1142,\"methodName\":\"runWorker\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor$Worker\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":617,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.threads.TaskThread$WrappingRunnable\",\"fileName\":\"TaskThread.java\",\"lineNumber\":61,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.lang.Thread\",\"fileName\":\"Thread.java\",\"lineNumber\":745,\"methodName\":\"run\",\"nativeMethod\":false}],\"suppressed\":[]},\"localizedMessage\":\"java.net.ConnectException: Connection refused\",\"message\":\"java.net.ConnectException: Connection refused\",\"stackTrace\":[{\"className\":\"org.springframework.amqp.rabbit.support.RabbitExceptionTranslator\",\"fileName\":\"RabbitExceptionTranslator.java\",\"lineNumber\":62,\"methodName\":\"convertRabbitAccessException\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.AbstractConnectionFactory\",\"fileName\":\"AbstractConnectionFactory.java\",\"lineNumber\":309,\"methodName\":\"createBareConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.CachingConnectionFactory\",\"fileName\":\"CachingConnectionFactory.java\",\"lineNumber\":547,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils$1\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":90,\"methodName\":\"createConnection\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":140,\"methodName\":\"doGetTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils\",\"fileName\":\"ConnectionFactoryUtils.java\",\"lineNumber\":76,\"methodName\":\"getTransactionalResourceHolder\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1374,\"methodName\":\"doExecute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":1367,\"methodName\":\"execute\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":699,\"methodName\":\"send\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":767,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"org.springframework.amqp.rabbit.core.RabbitTemplate\",\"fileName\":\"RabbitTemplate.java\",\"lineNumber\":763,\"methodName\":\"convertAndSend\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi\",\"fileName\":\"BlogRestApi.java\",\"lineNumber\":370,\"methodName\":\"edit\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$FastClassBySpringCGLIB$$24b5f54f\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.cglib.proxy.MethodProxy\",\"fileName\":\"MethodProxy.java\",\"lineNumber\":204,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":720,\"methodName\":\"invokeJoinpoint\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":157,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor\",\"fileName\":\"MethodBeforeAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor\",\"fileName\":\"AfterReturningAdviceInterceptor.java\",\"lineNumber\":52,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.aspectj.AspectJAfterThrowingAdvice\",\"fileName\":\"AspectJAfterThrowingAdvice.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":168,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.interceptor.ExposeInvocationInterceptor\",\"fileName\":\"ExposeInvocationInterceptor.java\",\"lineNumber\":92,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.ReflectiveMethodInvocation\",\"fileName\":\"ReflectiveMethodInvocation.java\",\"lineNumber\":179,\"methodName\":\"proceed\",\"nativeMethod\":false},{\"className\":\"org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor\",\"fileName\":\"CglibAopProxy.java\",\"lineNumber\":655,\"methodName\":\"intercept\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.restapi.BlogRestApi$$EnhancerBySpringCGLIB$$f84fb287\",\"fileName\":\"<generated>\",\"lineNumber\":-1,\"methodName\":\"edit\",\"nativeMethod\":false},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2,\"methodName\":\"invoke0\",\"nativeMethod\":true},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"java.lang.reflect.Method\",\"fileName\":\"Method.java\",\"lineNumber\":497,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":221,\"methodName\":\"doInvoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.method.support.InvocableHandlerMethod\",\"fileName\":\"InvocableHandlerMethod.java\",\"lineNumber\":136,\"methodName\":\"invokeForRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod\",\"fileName\":\"ServletInvocableHandlerMethod.java\",\"lineNumber\":114,\"methodName\":\"invokeAndHandle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":827,\"methodName\":\"invokeHandlerMethod\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter\",\"fileName\":\"RequestMappingHandlerAdapter.java\",\"lineNumber\":738,\"methodName\":\"handleInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter\",\"fileName\":\"AbstractHandlerMethodAdapter.java\",\"lineNumber\":85,\"methodName\":\"handle\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":963,\"methodName\":\"doDispatch\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.DispatcherServlet\",\"fileName\":\"DispatcherServlet.java\",\"lineNumber\":897,\"methodName\":\"doService\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":970,\"methodName\":\"processRequest\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":872,\"methodName\":\"doPost\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":661,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.servlet.FrameworkServlet\",\"fileName\":\"FrameworkServlet.java\",\"lineNumber\":846,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"javax.servlet.http.HttpServlet\",\"fileName\":\"HttpServlet.java\",\"lineNumber\":742,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":231,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.websocket.server.WsFilter\",\"fileName\":\"WsFilter.java\",\"lineNumber\":52,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.filter.ApplicationContextHeaderFilter\",\"fileName\":\"ApplicationContextHeaderFilter.java\",\"lineNumber\":55,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":101,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.alibaba.druid.support.http.WebStatFilter\",\"fileName\":\"WebStatFilter.java\",\"lineNumber\":123,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.trace.WebRequestTraceFilter\",\"fileName\":\"WebRequestTraceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":317,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":127,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.intercept.FilterSecurityInterceptor\",\"fileName\":\"FilterSecurityInterceptor.java\",\"lineNumber\":91,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.access.ExceptionTranslationFilter\",\"fileName\":\"ExceptionTranslationFilter.java\",\"lineNumber\":115,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.session.SessionManagementFilter\",\"fileName\":\"SessionManagementFilter.java\",\"lineNumber\":137,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.AnonymousAuthenticationFilter\",\"fileName\":\"AnonymousAuthenticationFilter.java\",\"lineNumber\":111,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter\",\"fileName\":\"SecurityContextHolderAwareRequestFilter.java\",\"lineNumber\":169,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.savedrequest.RequestCacheAwareFilter\",\"fileName\":\"RequestCacheAwareFilter.java\",\"lineNumber\":63,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"com.moxi.mogublog.admin.security.JwtAuthenticationTokenFilter\",\"fileName\":\"JwtAuthenticationTokenFilter.java\",\"lineNumber\":162,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.authentication.logout.LogoutFilter\",\"fileName\":\"LogoutFilter.java\",\"lineNumber\":121,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CorsFilter\",\"fileName\":\"CorsFilter.java\",\"lineNumber\":96,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.header.HeaderWriterFilter\",\"fileName\":\"HeaderWriterFilter.java\",\"lineNumber\":66,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.SecurityContextPersistenceFilter\",\"fileName\":\"SecurityContextPersistenceFilter.java\",\"lineNumber\":105,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter\",\"fileName\":\"WebAsyncManagerIntegrationFilter.java\",\"lineNumber\":56,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy$VirtualFilterChain\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":331,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":214,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.security.web.FilterChainProxy\",\"fileName\":\"FilterChainProxy.java\",\"lineNumber\":177,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":346,\"methodName\":\"invokeDelegate\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.DelegatingFilterProxy\",\"fileName\":\"DelegatingFilterProxy.java\",\"lineNumber\":262,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.RequestContextFilter\",\"fileName\":\"RequestContextFilter.java\",\"lineNumber\":99,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HttpPutFormContentFilter\",\"fileName\":\"HttpPutFormContentFilter.java\",\"lineNumber\":87,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.HiddenHttpMethodFilter\",\"fileName\":\"HiddenHttpMethodFilter.java\",\"lineNumber\":77,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.CharacterEncodingFilter\",\"fileName\":\"CharacterEncodingFilter.java\",\"lineNumber\":197,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.actuate.autoconfigure.MetricsFilter\",\"fileName\":\"MetricsFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":119,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":61,\"methodName\":\"access$000\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter$1\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":94,\"methodName\":\"doFilterInternal\",\"nativeMethod\":false},{\"className\":\"org.springframework.web.filter.OncePerRequestFilter\",\"fileName\":\"OncePerRequestFilter.java\",\"lineNumber\":107,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.springframework.boot.web.support.ErrorPageFilter\",\"fileName\":\"ErrorPageFilter.java\",\"lineNumber\":112,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":193,\"methodName\":\"internalDoFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.ApplicationFilterChain\",\"fileName\":\"ApplicationFilterChain.java\",\"lineNumber\":166,\"methodName\":\"doFilter\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardWrapperValve\",\"fileName\":\"StandardWrapperValve.java\",\"lineNumber\":198,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardContextValve\",\"fileName\":\"StandardContextValve.java\",\"lineNumber\":96,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.authenticator.AuthenticatorBase\",\"fileName\":\"AuthenticatorBase.java\",\"lineNumber\":493,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardHostValve\",\"fileName\":\"StandardHostValve.java\",\"lineNumber\":140,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.ErrorReportValve\",\"fileName\":\"ErrorReportValve.java\",\"lineNumber\":81,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.valves.AbstractAccessLogValve\",\"fileName\":\"AbstractAccessLogValve.java\",\"lineNumber\":650,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.core.StandardEngineValve\",\"fileName\":\"StandardEngineValve.java\",\"lineNumber\":87,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.apache.catalina.connector.CoyoteAdapter\",\"fileName\":\"CoyoteAdapter.java\",\"lineNumber\":342,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.http11.Http11Processor\",\"fileName\":\"Http11Processor.java\",\"lineNumber\":800,\"methodName\":\"service\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProcessorLight\",\"fileName\":\"AbstractProcessorLight.java\",\"lineNumber\":66,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.coyote.AbstractProtocol$ConnectionHandler\",\"fileName\":\"AbstractProtocol.java\",\"lineNumber\":806,\"methodName\":\"process\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.NioEndpoint$SocketProcessor\",\"fileName\":\"NioEndpoint.java\",\"lineNumber\":1498,\"methodName\":\"doRun\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.net.SocketProcessorBase\",\"fileName\":\"SocketProcessorBase.java\",\"lineNumber\":49,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":1142,\"methodName\":\"runWorker\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.ThreadPoolExecutor$Worker\",\"fileName\":\"ThreadPoolExecutor.java\",\"lineNumber\":617,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"org.apache.tomcat.util.threads.TaskThread$WrappingRunnable\",\"fileName\":\"TaskThread.java\",\"lineNumber\":61,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.lang.Thread\",\"fileName\":\"Thread.java\",\"lineNumber\":745,\"methodName\":\"run\",\"nativeMethod\":false}],\"suppressed\":[]}','java.net.ConnectException: Connection refused',1,'2018-12-27 09:36:33','2018-12-27 09:36:33');

/*Table structure for table `t_feedback` */

DROP TABLE IF EXISTS `t_feedback`;

CREATE TABLE `t_feedback` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `user_uid` varchar(32) NOT NULL COMMENT '用户uid',
  `content` varchar(1000) DEFAULT NULL COMMENT '反馈的内容',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='反馈表';

/*Data for the table `t_feedback` */

/*Table structure for table `t_link` */

DROP TABLE IF EXISTS `t_link`;

CREATE TABLE `t_link` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `title` varchar(255) DEFAULT NULL COMMENT '友情链接标题',
  `summary` varchar(255) DEFAULT NULL COMMENT '友情链接介绍',
  `url` varchar(255) DEFAULT NULL COMMENT '友情链接URL',
  `click_count` int(11) DEFAULT '0' COMMENT '点击数',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `sort` int(11) DEFAULT '0' COMMENT '排序字段，越大越靠前',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='友情链接表';

/*Data for the table `t_link` */

insert  into `t_link`(`uid`,`title`,`summary`,`url`,`click_count`,`create_time`,`update_time`,`status`,`sort`) values ('5217d7212f9d487eab13deadca961402','蘑菇博客Git','蘑菇博客Git','https://gitee.com/moxi159753/mogu_blog_v2',0,'2018-12-16 18:25:11','2018-12-16 18:25:11',1,0),('bb418e0a9d27490bb71972bd8da5afa6','IT大本营','IT大本营 - 专注于技术分享的开发者社区','http://www.itarea.cn/',1,'2018-09-26 13:55:33','2018-09-26 13:55:33',1,0),('dcc01149be71492dabd55821c22f6061','Mybatis-plus','MyBatis-Plus 为简化开发而生','http://mp.baomidou.com/',1,'2018-09-26 18:52:58','2018-09-26 18:52:58',1,0);

/*Table structure for table `t_picture` */

DROP TABLE IF EXISTS `t_picture`;

CREATE TABLE `t_picture` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `file_uid` varchar(32) DEFAULT NULL COMMENT '图片uid',
  `pic_name` varchar(255) DEFAULT NULL COMMENT '图片名',
  `picture_sort_uid` varchar(32) DEFAULT NULL COMMENT '分类uid',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='图片表';

/*Data for the table `t_picture` */

insert  into `t_picture`(`uid`,`file_uid`,`pic_name`,`picture_sort_uid`,`status`,`create_time`,`update_time`) values ('00a18fcb98ef43ab86b3f527a1146f07','647d9656f86444dea6eeec18457f3866',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-14 08:53:17','2018-12-14 08:53:17'),('00e828df0a2046b59e303754770912e3','e70306aa4b2f47918a3d20643a242de5',NULL,'8585745c71a34a3688d5cf722e005cea',1,'2018-10-21 10:07:34','2018-10-21 10:07:34'),('05a35691c38f4879a910912e6c248562','d87dd2f6ab4f4091b9da4778b8563a13',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:19','2018-09-23 15:01:19'),('062a3754db6a49f6984be4c566a56bb7','2508670a57b54a5b8f66dd7547d52cd1',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('071f79e3e0fb45f5b6dda4a7f411f936','32db3087802d43948950b7d1e6474036',NULL,'4a6a314e1ebb415d89ff611fc17ca3db',1,'2018-11-02 17:23:03','2018-11-02 17:23:03'),('073752b5ccae435b97732a2417f29221','de7d864ef19c4f56b8e7d7ecb59c2145',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-10-21 10:06:23','2018-10-21 10:06:23'),('0c062009b6a540819af91c69454e7ec6','7b9bae295683483887b86f8a00981992',NULL,'8585745c71a34a3688d5cf722e005cea',1,'2018-10-21 10:07:34','2018-10-21 10:07:34'),('0c4873816cd24b9ebbd43fe621ba8d71','dfe6c28d97784bc5bc751f8d8786c9e8',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-14 08:51:30','2018-12-14 08:51:30'),('0c66a59bcf684b03a9966b7e7dc98404','3fba09a1eb90422db15a88d0b87f561d',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('10174522814c45e7b254d1da404d483d','371c9ed84b5f42bfa329dbbf4bcff917',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-10-21 09:49:33','2018-10-21 09:49:33'),('105fffa550e1428f81f7a09d78f8be66','f7836e491cec428ab5f6b7486b64eea3',NULL,'0927c1e18a8c4677b1cce28c17bf0382',0,'2018-12-14 08:51:30','2018-12-14 08:51:30'),('1082e7bd014b4c39b63b59eeff69a02e','b5cc2311f7004037ab33fdc16d50f4a0',NULL,'4a6a314e1ebb415d89ff611fc17ca3db',1,'2018-11-02 17:23:03','2018-11-02 17:23:03'),('10bd233f79e84b028eae47f1e75520a3','44704768e62f48bb9a04ae1cac453dd8',NULL,'8585745c71a34a3688d5cf722e005cea',1,'2018-10-21 10:07:34','2018-10-21 10:07:34'),('135f9158eaa744ddbd90efe4c4b2f73e','2cc77c9d08ee41f5a0339af5638d64f7',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('1763e8d548334cf88b2c2e5485f83f1c','febaf99552684143a4300fd395fe7c2e',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-11-15 13:04:34','2018-11-15 13:04:34'),('17b9d1d3e42b4c92ac0a1f92230c3c4e','82f9380f765044edadbe7ab3e441b51b',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('195830ef90c14d4ebd7cff6cea49f632','6c1d188385324101beb231806002d4f2',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('1b1ef03a754940d4a12b8200744173b3','1a3dcc42f0064935b00c02cf5f41c50f',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:46','2018-10-21 10:05:46'),('1c137ad738794375a914261173b44e60','290a1ee600ce40908604b3a5f7dfe57a',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('1cd2057fc532452bbe915e6330c7eae9','989e2c76be4446d1862adcb1364fdc9b',NULL,'8585745c71a34a3688d5cf722e005cea',1,'2018-10-21 10:07:34','2018-10-21 10:07:34'),('1d63d9c62b044b2f9b941a61ac62bf89','aacd190a902042cbb99c6fbd4b6ce1ed',NULL,'b897c85eda734b528cbe3e0e15a32d75',1,'2018-11-02 19:00:55','2018-11-02 19:00:55'),('22f5431860ad4fcba7ddb0a5657babbb','1c64848f38ca4dc39ae3e140d3925f4e',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('26d781600d6248b9945898c1dc57f054','0bf5fb94626843fba5519599b10fcb1f',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('29d9567f9ad24c598b40f3e4d1560280','829ad31089404f0eb52baa1a8e19705c',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('2acdb5609acc4a5e928f058ef11017d6','fc40260e4fda4e99a4c7a32635f4dc15',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-10-21 10:06:23','2018-10-21 10:06:23'),('318270a1f4ed49faa297d3ab1290b90e','ebdf95a75bd54e6ab356b69829b44518',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('322b3bee3cad4768b7afd8a2b5febffb','753c685dae1b470d989eb804ad0f6176',NULL,'499ce9cee1aa4f148e9bff9a72c8db01',1,'2018-10-21 10:07:00','2018-10-21 10:07:00'),('331f6d14ed064b328eabafd6a3169fe9','71a054b8153449848666fd23a34226e9',NULL,'9d7308129cc24fed9fc81fe80bfd7107',1,'2018-11-15 15:52:15','2018-11-15 15:52:15'),('346d9c13544c432c8cf464fbb78de5b6','16018de3271d4c5fbafb03c1b342fb82',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('34c16987d5e9476fa08c0001596cd75e','bf4f61f6599f48dda9ecf4a5149410e5',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('34c1f81a8151493eb3d4705bbfa12533','9593eb7803bd4fb49354582ee13061fa',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:19','2018-09-23 15:01:19'),('353aee6465bf452bbffdb06b625c7b98','95ebbd393dc9432a9d65ac0d7b35cd5c',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('3adc46413b394ab7a8715dd068176457','282f7a1ae2594c09b296daaa961313e3',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('3bc6bfca363445a99555650832c89e83','18bf33157595485fb2773e666da0f5d1',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-12-10 09:14:48','2018-12-10 09:14:48'),('3c0761052780448bbcdbff05514cca9b','1d067e9a0ff74faf9519995e64ecfdef',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-10-25 09:29:06','2018-10-25 09:29:06'),('3c33ddc2111b4e0b9de2dd846c42ba8e','b8a7b24a3de8401597548e71c6b5d399',NULL,'0e28f72727c34f9ca1606789a95c9d93',1,'2018-11-13 22:41:29','2018-11-13 22:41:29'),('3fd6ddf78d1b4106a07616224c95f8b3','e94e738ed04f4471b673de155e393a0b',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-11-15 13:04:34','2018-11-15 13:04:34'),('3fda6f00e03e4bfda236e059edbd0e1d','287184b3636048fe94204c02a92280b0',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:18','2018-09-23 15:01:18'),('419969ae945347128a37c44c7f57510b','018f9739272944dbb32c251373b0744a',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:46','2018-10-21 10:05:46'),('4666ec6a7d7747938c837ab2bedde063','f61fd7cce1c944199c6b93d36282fcb1',NULL,'9d7308129cc24fed9fc81fe80bfd7107',1,'2018-11-21 20:55:36','2018-11-21 20:55:36'),('4667aaa4a9ab44859f92e5a9e72a4997','c24f64850d024d24974b3b9cfe2e3a93',NULL,'499ce9cee1aa4f148e9bff9a72c8db01',1,'2018-10-21 10:07:00','2018-10-21 10:07:00'),('4724e232b9ab46c18066bdfa69d49bef','3c996aed16e2420aa9958711c3cc1060',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('4ad6299e44da46379334b0340c1c68de','f53193072c5e493090f4b09358ce8e55',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:38','2018-09-23 15:01:38'),('4c50fce4241e4ce3a9e7dc10fdf374a1','8c2a3690e2b346829468eda0b646c08e',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('4e54c819256b4fe2b6f329e815e2f31d','a784b4b5178c468f995fab0405260bd4',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:46','2018-10-21 10:05:46'),('4f875b076b9c4037ad4af707d91b61c7','7cec4c83de9e42869d80bdc767b3e61f',NULL,'b897c85eda734b528cbe3e0e15a32d75',1,'2018-11-02 19:00:55','2018-11-02 19:00:55'),('4fde58bce6d14f1da81f00305d0fe742','d0808356e0cc4ea29ce56f261e1956e6',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('4fe0204b144143279fd1d413d28c6163','8f48f07f30314960a38a0b85c4f1f34a',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-10-27 16:53:16','2018-10-27 16:53:16'),('50cf276f1f6444f790faae8efb9c1814','a0ac7e9232f248259f4feb1a120f6b39',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 09:31:17','2018-09-23 09:31:17'),('538d3a9c8bc441edb99577c51fc601ea','bd56ecbcf182401995400376d33f2354',NULL,'dd6728afaec34b64a12f560ca9931a7b',0,'2018-09-28 21:40:00','2018-09-28 21:40:00'),('5548a49daade4885b4c1128ec148ed80','ffa3f48765d24d29a7600999639ed607',NULL,'b18b2c15648342b78715d33fd956bb95',1,'2018-10-21 10:08:11','2018-10-21 10:08:11'),('5e2aa3c543624c6382a81eda4b8f0fee','b35193a9e8224ddb9e5cc4c8f804fda1',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-11-21 15:51:00','2018-11-21 15:51:00'),('5fbd4b7eef264583a86de8fdd7db77c6','b9a667d581a84f1ea17f80450f92be4b',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:38','2018-09-23 15:01:38'),('629e2919e7dc4d5dad481f1286d01699','d44135761c504fe1bf3663a056656595',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:19','2018-09-23 15:01:19'),('663edc505d2e47c48d6dde32f8f6abbe','50ffa793ddf3475d9e2fff29f258f6a3',NULL,'499ce9cee1aa4f148e9bff9a72c8db01',1,'2018-10-21 10:07:00','2018-10-21 10:07:00'),('66c3a2df20c7433194ec8382f7034bec','eea2f4a2e73548a5af1b9380d858333c',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-10-21 09:49:33','2018-10-21 09:49:33'),('6cbf25e03a0c421aa06c4fd30c8ac2fc','9e071786d3a74b919563a40c215c87eb',NULL,'dd6728afaec34b64a12f560ca9931a7b',0,'2018-09-28 20:33:26','2018-09-28 20:33:26'),('6fcef4568c9745559520c1194936be27','02a90e16c9bb4dd8a46190699f64af66',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:18','2018-09-23 15:01:18'),('705b5f8f6f8a4ab782bad5553bada2d8','992f8c34af46443984a05f1a10b36709',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:19','2018-09-23 15:01:19'),('708b43bbf8504121911ffc768799584a','edbc7e3c0f9d443da15d650c2ef2f96f',NULL,'dd6728afaec34b64a12f560ca9931a7b',0,'2018-09-23 16:39:13','2018-09-23 16:39:13'),('70981745e08c44498f1a4b3034e93c5c','e79e4375ce5b4aa6ad48027de6cb8af2',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 12:37:05','2018-12-30 12:37:05'),('729d7de164954d32aa10d8c2f32ffc2d','4addade94eab49d9b3b13e120d593c82',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-10-21 10:06:23','2018-10-21 10:06:23'),('73f234bc8e8c4ccf8f689cc83638ec6b','ee98646f1d684fa4b74f4bff1e1c6f2d',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('73fed777a77f47f8b7ab1a28893badc2','760f5d83f561440c8ec0691c66ca0338',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-11-15 13:04:34','2018-11-15 13:04:34'),('74feb30f3a19496392aa074f76c179dd','5531611e57134eef906bdf393f7e6503',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-11-21 15:51:00','2018-11-21 15:51:00'),('7cd1111643c24999b39698f532c476f5','52b6106a19524aa8ab5543342e5152b9',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 12:37:05','2018-12-30 12:37:05'),('7e0d397d14974be0afc52def430cc453','12b7a1a3645a495995fe0b792f9a6fa5',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:46','2018-10-21 10:05:46'),('81921a9f29994a0ca2c8f1b7ed6e49cd','00d0f924c8ba4f69b088e18e260c9bae',NULL,'499ce9cee1aa4f148e9bff9a72c8db01',1,'2018-10-21 10:07:00','2018-10-21 10:07:00'),('81a4621453f9427698c12a14740fb627','a76a5367198c4be48b508559ac934af5',NULL,'499ce9cee1aa4f148e9bff9a72c8db01',1,'2018-10-21 10:07:00','2018-10-21 10:07:00'),('82e9e38d8e2b4a038a23ce5ee09055c3','7dde5a06b272440ca0948d1f0fddd0d9',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 11:10:35','2018-09-23 11:10:35'),('8692e979c5e84a2787f92079b651dff2','ede7dc39d3ae45f387784bb0f3b0a85d',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',0,'2018-12-10 09:14:48','2018-12-10 09:14:48'),('8a2e4ce1440f42dc9349986010c813e4','53afd10389564f75afa4cf6bde141037',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('8c2c1c450b35471385d26aab9283228f','76a78fa08e4f450ea212731057a7ccac',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:38','2018-09-23 15:01:38'),('905492d4e2dd451c8530d0302d76b79d','166280b6769e43b6ae8a2cd461609d8b',NULL,'b18b2c15648342b78715d33fd956bb95',1,'2018-10-21 10:08:11','2018-10-21 10:08:11'),('a370d8862a8741b4a413a394e93d081d','ec3c91ada4994d1fb6a5181a716ab0dd',NULL,'9d7308129cc24fed9fc81fe80bfd7107',1,'2018-11-15 15:52:15','2018-11-15 15:52:15'),('aa1e2c3c8b704cabb910b65526880cfc','b40b436f58ef437b993aca6aa37077f4',NULL,'4a6a314e1ebb415d89ff611fc17ca3db',1,'2018-11-02 17:23:03','2018-11-02 17:23:03'),('aa82496ce1594a6a95503a1915a0c4ea','35e191c4bfcd45bca64d3b21533ca6b6',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('b2b946f2502e4a00a6442a0b4f26e9e2','ae59212e7bdc41e08ffb65788ba066cb',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-10-27 16:53:17','2018-10-27 16:53:17'),('b6f231545b154b32b1dcea4e300f2d74','832b4c6545fa40e183154b459ff254fa',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-10-21 10:06:23','2018-10-21 10:06:23'),('b78a82460ad549f2907e8fe868652b6a','a8f63f64c55d4b8a8e7eb7a6fd7d1892',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-10-27 16:53:16','2018-10-27 16:53:16'),('b82a1d43b36c40b9bd9a83559a87dc9d','088c7dc30f8b4f8bb4be5bee0a041cf2',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-12-10 09:14:48','2018-12-10 09:14:48'),('bc1b8310c300417a876abde93fcdcbad','de4191efd16248ec878e5a1f027e45b9',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:46','2018-10-21 10:05:46'),('bc2766f77fe9405fb277ffbe8941b023','53ef0429cf344599b10bba893f005785',NULL,'8585745c71a34a3688d5cf722e005cea',1,'2018-10-21 10:07:35','2018-10-21 10:07:35'),('be27e3d8f7c34bdba6c89b8f501d6d05','eda860927b6c41b99cd9b052757b5f33',NULL,'b897c85eda734b528cbe3e0e15a32d75',1,'2018-11-02 19:00:55','2018-11-02 19:00:55'),('be4d94fb88d94cef9a553432966b7d9c','1c91acdaa1cf4fe2a7f5b8e5ace01397',NULL,'5a281aa35fa9408bb07c2fc9a990701f',1,'2018-09-23 15:01:18','2018-09-23 15:01:18'),('bf3618a2eba5459097c00fb97b4c853b','af867bf71f0a4e1e802c5cd5ce7e2d2b',NULL,'b897c85eda734b528cbe3e0e15a32d75',1,'2018-11-02 19:00:55','2018-11-02 19:00:55'),('c3f407895e544843a62bfa4d827fdda0','ddb4ac9e62fd455a8afd2b769f2643cb',NULL,'4a6a314e1ebb415d89ff611fc17ca3db',1,'2018-11-02 17:23:03','2018-11-02 17:23:03'),('c47acead50364e91a24dfbd6777baa6a','5a9ea2261ed2466a884db30df54d704e',NULL,'4a6a314e1ebb415d89ff611fc17ca3db',1,'2018-11-02 17:23:03','2018-11-02 17:23:03'),('c6bc3b4668944618b3ed468b7689346f','b936cfd2bf694d92a056170f821b5859',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-12-29 10:50:20','2018-12-29 10:50:20'),('ccac3437e63845a79960f0e82ba2ee67','dde8800dd17c4b8c9de9169fbb0a49f9',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53'),('ccd21410f6c54c2ea6af4d8346dece12','8f1b96ca6c844882858efca25923a62c',NULL,'b18b2c15648342b78715d33fd956bb95',1,'2018-10-21 10:08:11','2018-10-21 10:08:11'),('ce39bc4088e441f789e54282c2a5bd3e','4f016786d65a4abe83cb12b14a576948',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:45','2018-10-21 10:05:45'),('cf2c3a2e63624916a96f1d85a6232612','f86040ccdddf4bdc9eafe4fdc5a3e823',NULL,'9d7308129cc24fed9fc81fe80bfd7107',1,'2018-11-21 20:55:36','2018-11-21 20:55:36'),('d153baab2cef415ba265dcc7ae911923','775d249fe05c4383aa16694a27f6d4d5',NULL,'9d7308129cc24fed9fc81fe80bfd7107',1,'2018-11-15 15:52:15','2018-11-15 15:52:15'),('d25f54d726fa4d1f86c61cd7ef1d6b3b','ebb8f56a177f4ed89c9020b43610fd6e',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-10-21 09:49:33','2018-10-21 09:49:33'),('d57f93ec2c4d45b1b5750d9a1eb7281b','ea6943fef5154910add617c96c4cf740',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-14 08:51:30','2018-12-14 08:51:30'),('d745f3a531414826a1efd8173962b938','244a1dfd59a7417e8ca2bf9116416036',NULL,'499ce9cee1aa4f148e9bff9a72c8db01',1,'2018-10-21 10:07:00','2018-10-21 10:07:00'),('d8cb50b5aaf1440c8a7f3c637d169821','4f1939b3ce064363b14ca1577f188753',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-09 10:15:15','2018-12-09 10:15:15'),('d8d7101d96694b84813e6330b3434f70','8b58a57f7e8e4cc7809e3cd89d1c1baa',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-10-21 10:06:23','2018-10-21 10:06:23'),('d97ff68d254c4c2bbca29519c08559ca','c5700c4cd927476caf7e5dcfaf1252a4',NULL,'0927c1e18a8c4677b1cce28c17bf0382',0,'2018-12-21 12:17:39','2018-12-21 12:17:39'),('dda0b79baa804fa88892d2f0f39eff47','c8c2f27b849c43c8885ac54be365ee39',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('de46f5c599e14b9f99b7ad8cedfa6476','11696ee83574446b8c87c0533b4dcd53',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-14 08:51:30','2018-12-14 08:51:30'),('e158ed59fe7c4853b375a2543e2475c6','9fc5970c50644c67bc78cae11e3081b2',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('e51e57df929a48edb7c9ddd1208f28d5','d903784805844f72a78348b0777fbb81',NULL,'9d7308129cc24fed9fc81fe80bfd7107',1,'2018-11-23 21:21:03','2018-11-23 21:21:03'),('ec87a2feaae34a30b66ac4bf6a24907b','e3f36d881aea4c998623cf9f7df63e80',NULL,'0927c1e18a8c4677b1cce28c17bf0382',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('ecbbdf4b96e140c7adbcb0f2a9bbf978','3ad9e76da93643ca835652fb56f2338b',NULL,'b897c85eda734b528cbe3e0e15a32d75',1,'2018-11-02 19:00:55','2018-11-02 19:00:55'),('efb13d17c0684f2c96194694d36e375b','0984affc6e27417b92e783c70cf8d5d4',NULL,'48233835d29846e488442b58b5dfb2f2',1,'2018-10-21 10:04:37','2018-10-21 10:04:37'),('f2b8a1a8680b4c969e30ad94834091bb','2ca46ddff5cd48c296b4f81dab924065',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:45','2018-10-21 10:05:45'),('f2ca2412198140d8abe58111bb1b724c','43219d4f19244fc099a543d20e0d1b99',NULL,'f321114dc2014bb68ac4091fd90f64c1',1,'2018-10-21 10:05:46','2018-10-21 10:05:46'),('f4deed5fb39e482889edb0a6acc918f6','25f9c548239348ecb9bdf49656ff59f3',NULL,'4a6a314e1ebb415d89ff611fc17ca3db',1,'2018-11-02 17:23:03','2018-11-02 17:23:03'),('f6f232430b9f49c29b2f9c58b75b33fb','20b89e41ae80455cb245234f7b1649ce',NULL,'dd6728afaec34b64a12f560ca9931a7b',0,'2018-09-23 15:49:27','2018-09-23 15:49:27'),('fa1da71187d1424da12c597e1a6dd304','e06331bc9fff4a7186439f2a34c199af',NULL,'b18b2c15648342b78715d33fd956bb95',1,'2018-10-21 10:08:11','2018-10-21 10:08:11'),('fce5181823fa4839adfad3829da41fea','6b61d3c6c9c24888bc6c787b8488a378',NULL,'fd160e2525284d378a52fa8b6b7bdbb3',1,'2018-10-21 10:06:23','2018-10-21 10:06:23'),('fd0e4b07046d4ded955f87e0b29ee250','720cc8699ccb484caf1c20a477c66382',NULL,'dd6728afaec34b64a12f560ca9931a7b',1,'2018-09-25 09:26:53','2018-09-25 09:26:53');

/*Table structure for table `t_picture_sort` */

DROP TABLE IF EXISTS `t_picture_sort`;

CREATE TABLE `t_picture_sort` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `file_uid` varchar(32) DEFAULT NULL COMMENT '分类图片uid',
  `name` varchar(255) DEFAULT NULL COMMENT '分类名',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `parent_uid` varchar(32) DEFAULT NULL,
  `sort` int(11) DEFAULT '0' COMMENT '排序字段，越大越靠前',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='图片分类表';

/*Data for the table `t_picture_sort` */

insert  into `t_picture_sort`(`uid`,`file_uid`,`name`,`status`,`create_time`,`update_time`,`parent_uid`,`sort`) values ('0927c1e18a8c4677b1cce28c17bf0382','371c9ed84b5f42bfa329dbbf4bcff917','Java图标',1,'2018-10-21 09:49:20','2018-10-21 09:49:20',NULL,0),('0e28f72727c34f9ca1606789a95c9d93','b8a7b24a3de8401597548e71c6b5d399','头像',0,'2018-11-13 22:41:17','2018-11-13 22:41:17',NULL,0),('48233835d29846e488442b58b5dfb2f2','6c1d188385324101beb231806002d4f2','Spring',1,'2018-10-21 10:04:26','2018-10-21 10:04:26',NULL,0),('499ce9cee1aa4f148e9bff9a72c8db01','244a1dfd59a7417e8ca2bf9116416036','JQuery',1,'2018-10-21 10:06:49','2018-10-21 10:06:49',NULL,0),('4a6a314e1ebb415d89ff611fc17ca3db','5a9ea2261ed2466a884db30df54d704e','Linux',1,'2018-11-02 17:22:45','2018-11-02 17:22:45',NULL,0),('5a281aa35fa9408bb07c2fc9a990701f','290a1ee600ce40908604b3a5f7dfe57a','用户头像',0,'2018-09-20 20:04:47','2018-09-20 20:04:47',NULL,0),('8585745c71a34a3688d5cf722e005cea','989e2c76be4446d1862adcb1364fdc9b','VUE',1,'2018-10-21 10:07:24','2018-10-21 10:07:24',NULL,0),('9d7308129cc24fed9fc81fe80bfd7107','775d249fe05c4383aa16694a27f6d4d5','百度',1,'2018-11-15 15:51:34','2018-11-15 15:51:34',NULL,0),('b18b2c15648342b78715d33fd956bb95','e06331bc9fff4a7186439f2a34c199af','Mysql',1,'2018-10-21 10:07:59','2018-10-21 10:07:59',NULL,0),('b897c85eda734b528cbe3e0e15a32d75','aacd190a902042cbb99c6fbd4b6ce1ed','Nginx',1,'2018-11-02 19:00:36','2018-11-02 19:00:36',NULL,0),('dd6728afaec34b64a12f560ca9931a7b','35e191c4bfcd45bca64d3b21533ca6b6','博客封面图',0,'2018-09-20 19:34:40','2018-09-20 19:34:40',NULL,0),('f321114dc2014bb68ac4091fd90f64c1','2ca46ddff5cd48c296b4f81dab924065','HTML+CSS',1,'2018-10-21 10:05:24','2018-10-21 10:05:24',NULL,0),('fd160e2525284d378a52fa8b6b7bdbb3','832b4c6545fa40e183154b459ff254fa','JavaScript',1,'2018-10-21 10:06:13','2018-10-21 10:06:13',NULL,0);

/*Table structure for table `t_resource_sort` */

DROP TABLE IF EXISTS `t_resource_sort`;

CREATE TABLE `t_resource_sort` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `file_uid` varchar(32) DEFAULT NULL COMMENT '分类图片uid',
  `sort_name` varchar(255) DEFAULT NULL COMMENT '分类名',
  `content` varchar(255) DEFAULT NULL COMMENT '分类介绍',
  `click_count` varchar(255) DEFAULT NULL COMMENT '点击数',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `parent_uid` varchar(32) DEFAULT NULL,
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='资源分类表';

/*Data for the table `t_resource_sort` */

insert  into `t_resource_sort`(`uid`,`file_uid`,`sort_name`,`content`,`click_count`,`status`,`create_time`,`update_time`,`parent_uid`) values ('232de7c82bac472aa90a122dd7e62ca0','4addade94eab49d9b3b13e120d593c82','JavaScript','JavaScript',NULL,1,'2018-10-21 10:26:35','2018-10-21 10:26:35',NULL),('2aa2b0f2402643c0a11bdf00b8fda94d','e06331bc9fff4a7186439f2a34c199af','Mysql','Mysql',NULL,1,'2018-10-21 10:18:34','2018-10-21 10:18:34',NULL),('2f05ae3ee71f40efab6fa419a12ca560','282f7a1ae2594c09b296daaa961313e3','Spring','Java学习资源',NULL,1,'2018-10-20 11:42:43','2018-10-20 11:42:43',NULL),('4cd13528dc634f26813548cf3bf0dcea','371c9ed84b5f42bfa329dbbf4bcff917','Java','java干货',NULL,1,'2018-10-20 11:46:22','2018-10-20 11:46:22',NULL),('53739b1ffa74485a93dd26dc4743ed2a','244a1dfd59a7417e8ca2bf9116416036','JQuery','JQuery',NULL,1,'2018-10-21 10:28:20','2018-10-21 10:28:20',NULL),('5d3d3e71ca564cfcb7353af37fa732b9','1a3dcc42f0064935b00c02cf5f41c50f','HTML+CSS','HTML+CSS',NULL,1,'2018-10-21 10:16:51','2018-10-21 10:16:51',NULL),('820ab06295154d4c8acf53a0e5d58e80','e70306aa4b2f47918a3d20643a242de5','VUE','VUE',NULL,1,'2018-10-21 10:27:14','2018-10-21 10:27:14',NULL);

/*Table structure for table `t_role` */

DROP TABLE IF EXISTS `t_role`;

CREATE TABLE `t_role` (
  `uid` varchar(32) NOT NULL COMMENT '角色id',
  `role_name` varchar(255) NOT NULL COMMENT '角色名',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `summary` varchar(255) DEFAULT NULL COMMENT '角色介绍',
  `category_menu_uids` text COMMENT '角色管辖的菜单的UID',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*Data for the table `t_role` */

insert  into `t_role`(`uid`,`role_name`,`create_time`,`update_time`,`status`,`summary`,`category_menu_uids`) values ('434994947c5a4ee3a710cd277357c7c3','超级管理员','2018-10-14 23:56:26','2018-10-14 23:56:35',1,'超级管理员，管理全部菜单和功能','[\"49b42250abcb47ff876bad699cf34f03\",\"1f01cd1d2f474743b241d74008b12333\",\"0a035547bbec404eb3ee0ef43312148d\",\"78ab104b123f4950af14d65798afb756\",\"6606b7e646d545e5a25c70b5e5fade9f\",\"c519725da92b42f3acf0cc9fad58c664\",\"fb4237a353d0418ab42c748b7c1d64c6\",\"b511cae571834971a392ae4779270034\",\"badf0010422b432ba6ec9c83a25012ed\",\"02ea2f9ef5d44f559fb66189b05f6769\",\"2fb47d3b6dbd44279c8206740a263543\",\"9002d1ae905c4cb79c2a485333dad2f7\",\"faccfe476b89483791c05019ad5b4906\",\"98b82be8785e41dc939b6a5517fdfa53\",\"4337f63d13d84b9aba64b9d7a69fd066\",\"a5902692a3ed4fd794895bf634f97b8e\",\"bcf4a9bc21c14b559bcb015fb7912266\",\"9beb7caa2c844b36a02789262dc76fbe\",\"6228ff4e9ebd42c89599b322201a0345\",\"d3a19221259d439b916f475e43edb13d\",\"25b772444f7548f8a3957e00e5eb4246\",\"2de247af3b0a459095e937d7ab9f5864\",\"5010ae46511e4c0b9f30d1c63ad3f0c1\",\"aa225cdae6464bc0acebd732192f8362\",\"baace3dc03d34c54b81761dce8243814\",\"d4d92c53d3614d00865e9219b8292a90\",\"e4a482c089d04a30b6ecbaadb81b70f8\",\"f9276eb8e3274c8aa05577c86e4dc8c1\",\"65e22f3d36d94bcea47478aba02895a1\",\"4dea9c4f39d2480983e8c4333d35e036\",\"510483ce569b4fc88299f346147b1314\",\"9449ce5dd5e24b21a9d15f806cb36e87\",\"ffc6e9ca2cc243febf6d2f476b849163\"]'),('434994947c5a4ee3a710cd277357c7c4','文章管理员','2018-10-14 23:56:21','2018-10-14 23:56:23',1,'管理文章','[\"49b42250abcb47ff876bad699cf34f03\",\"1f01cd1d2f474743b241d74008b12333\",\"0a035547bbec404eb3ee0ef43312148d\",\"78ab104b123f4950af14d65798afb756\",\"6606b7e646d545e5a25c70b5e5fade9f\",\"bcf4a9bc21c14b559bcb015fb7912266\",\"9beb7caa2c844b36a02789262dc76fbe\",\"6228ff4e9ebd42c89599b322201a0345\",\"65e22f3d36d94bcea47478aba02895a1\",\"4dea9c4f39d2480983e8c4333d35e036\"]');

/*Table structure for table `t_study_video` */

DROP TABLE IF EXISTS `t_study_video`;

CREATE TABLE `t_study_video` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `file_uid` varchar(32) DEFAULT NULL COMMENT '视频封面图片uid',
  `resource_sort_uid` varchar(255) DEFAULT NULL COMMENT '资源分类UID',
  `name` varchar(255) DEFAULT NULL COMMENT '视频名称',
  `summary` varchar(255) DEFAULT NULL COMMENT '视频简介',
  `content` varchar(255) DEFAULT NULL COMMENT '分类介绍',
  `baidu_path` varchar(255) DEFAULT NULL COMMENT '百度云完整路径',
  `click_count` varchar(255) DEFAULT NULL COMMENT '点击数',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `parent_uid` varchar(32) DEFAULT NULL,
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='学习视频表';

/*Data for the table `t_study_video` */

insert  into `t_study_video`(`uid`,`file_uid`,`resource_sort_uid`,`name`,`summary`,`content`,`baidu_path`,`click_count`,`status`,`create_time`,`update_time`,`parent_uid`) values ('05a35691c38f4879a910912e6c248562','dde8800dd17c4b8c9de9169fbb0a49f9','2f05ae3ee71f40efab6fa419a12ca560','学习学习','学习学习','<p>黑马全套学习视频</p>\n','黑马全套','1',1,'2018-10-22 01:24:48','2018-10-22 01:24:48',NULL),('133e2a76080047508d026e42f03fce96','ee98646f1d684fa4b74f4bff1e1c6f2d','4cd13528dc634f26813548cf3bf0dcea','测试','测试','黑马全套学习视频','黑马全套','0',1,'2018-10-21 01:31:07','2018-10-21 01:31:07',NULL),('853585d787e0426d9196e0e1ad31a19c','95ebbd393dc9432a9d65ac0d7b35cd5c','4cd13528dc634f26813548cf3bf0dcea','哈哈哈','哈哈哈','黑马全套学习视频','黑马全套','0',1,'2018-10-20 21:43:56','2018-10-20 21:43:56',NULL),('eb9d821be06d435499d09cf114c8b50e','ebb8f56a177f4ed89c9020b43610fd6e','4cd13528dc634f26813548cf3bf0dcea','测试','测试','<p>黑马全套</p>\n','黑马全套','1',1,'2018-10-23 21:42:01','2018-10-23 21:42:01',NULL),('fd6c9f0ce6ca415cb56f62d186123808','44704768e62f48bb9a04ae1cac453dd8','820ab06295154d4c8acf53a0e5d58e80','测试','测试','黑马全套学习视频','黑马全套','0',1,'2018-10-21 21:48:37','2018-10-21 21:48:37',NULL);

/*Table structure for table `t_sys_log` */

DROP TABLE IF EXISTS `t_sys_log`;

CREATE TABLE `t_sys_log` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `user_name` varchar(255) NOT NULL COMMENT '用户名',
  `admin_uid` varchar(32) DEFAULT NULL COMMENT '管理员uid',
  `ip` varchar(50) DEFAULT NULL COMMENT '请求ip地址',
  `url` varchar(255) DEFAULT NULL COMMENT '请求url',
  `type` varchar(32) DEFAULT NULL COMMENT '请求方式',
  `class_path` varchar(255) DEFAULT NULL COMMENT '请求类路径',
  `method` varchar(32) DEFAULT NULL COMMENT '请求方法名',
  `params` text COMMENT '请求参数',
  `operation` varchar(32) DEFAULT NULL COMMENT '描述',
  `status` tinyint(1) DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*Data for the table `t_sys_log` */

insert  into `t_sys_log`(`uid`,`user_name`,`admin_uid`,`ip`,`url`,`type`,`class_path`,`method`,`params`,`operation`,`status`,`create_time`,`update_time`) values ('04db96036fc24da7bb9e632bca206c5a','或许无所谓','1f01cd1d2f474743b241d74008b12335','39.166.106.41','/mogu_admin/picture/add','POST','com.moxi.mogublog.admin.restapi.PictureRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@a57a2a5]], 参数2:c5700c4cd927476caf7e5dcfaf1252a4,, 参数3:0927c1e18a8c4677b1cce28c17bf0382, ','增加图片',1,'2018-12-21 12:17:39','2018-12-21 12:17:39'),('15d89411fe854b6eb79f5bcdc69f8db9','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/picture/add','POST','com.moxi.mogublog.admin.restapi.PictureRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:52b6106a19524aa8ab5543342e5152b9,, 参数3:0927c1e18a8c4677b1cce28c17bf0382, ','增加图片',1,'2018-12-30 12:37:05','2018-12-30 12:37:05'),('1ba7c85114bc4d439163dd59232371c8','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:6c5d0f1850ee4204b3669d9cd4a3b080, 参数3:微服务注册中心如何承载大型系统的千万级访问？, 参数4:Spring Cloud架构体系中，Eureka是一个至关重要的组件，它扮演着微服务注册中心的角色，所有的服务注册与服务发现，都是依赖Eureka的。, 参数5:<p><strong>一、问题起源</strong></p>\n\n<p>Spring Cloud架构体系中，Eureka是一个至关重要的组件，它扮演着微服务注册中心的角色，所有的服务注册与服务发现，都是依赖Eureka的。</p>\n\n<p><br />\n不少初学Spring Cloud的朋友在落地公司生产环境部署时，经常会问：</p>\n\n<ul>\n	<li>\n	<p>Eureka Server到底要部署几台机器？</p>\n	</li>\n	<li>\n	<p>我们的系统那么多服务，到底会对Eureka Server产生多大的访问压力？</p>\n	</li>\n	<li>\n	<p>Eureka Server能不能抗住一个大型系统的访问压力？</p>\n	</li>\n</ul>\n\n<p><br />\n如果你也有这些疑问，别着急！咱们这就一起去看看，Eureka作为微服务注册中心的核心原理</p>\n\n<p>&nbsp;</p>\n\n<p>下面这些问题，大家先看看，有个大概印象。带着这些问题，来看后面的内容，效果更佳</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>Eureka注册中心使用什么样的方式来储存各个服务注册时发送过来的机器地址和端口号？</p>\n	</li>\n	<li>\n	<p>各个服务找Eureka Server拉取注册表的时候，是什么样的频率？</p>\n	</li>\n	<li>\n	<p>各个服务是如何拉取注册表的？</p>\n	</li>\n	<li>\n	<p>一个几百服务，部署上千台机器的大型分布式系统，会对Eureka Server造成多大的访问压力？</p>\n	</li>\n	<li>\n	<p>Eureka Server从技术层面是如何抗住日千万级访问量的？</p>\n	</li>\n</ol>\n\n<p>先给大家说一个基本的知识点，各个服务内的Eureka Client组件，默认情况下，每隔30秒会发送一个请求到Eureka Server，来拉取最近有变化的服务信息</p>\n\n<p>&nbsp;</p>\n\n<p><strong>举个例子</strong>：</p>\n\n<ul>\n	<li>\n	<p>库存服务原本部署在1台机器上，现在扩容了，部署到了3台机器，并且均注册到了Eureka Server上。</p>\n	</li>\n	<li>\n	<p>然后订单服务的Eureka Client会每隔30秒去找Eureka Server拉取最近注册表的变化，看看其他服务的地址有没有变化。</p>\n	</li>\n</ul>\n\n<p>除此之外，Eureka还有一个心跳机制，各个Eureka Client每隔30秒会发送一次心跳到Eureka Server，通知人家说，哥们，我这个服务实例还活着！</p>\n\n<p>如果某个Eureka Client很长时间没有发送心跳给Eureka Server，那么就说明这个服务实例已经挂了。</p>\n\n<p>光看上面的文字，大家可能没什么印象。老规矩！咱们还是来一张图，一起来直观的感受一下这个过程。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462396419.png\" style=\"height:359px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、Eureka Server设计精妙的注册表存储结构</strong></p>\n\n<p>现在咱们假设手头有一套大型的分布式系统，一共100个服务，每个服务部署在20台机器上，机器是4核8G的标准配置。</p>\n\n<p>也就是说，相当于你一共部署了100 * 20 = 2000个服务实例，有2000台机器。</p>\n\n<p>每台机器上的服务实例内部都有一个Eureka Client组件，它会每隔30秒请求一次Eureka Server，拉取变化的注册表。</p>\n\n<p>此外，每个服务实例上的Eureka Client都会每隔30秒发送一次心跳请求给Eureka Server。</p>\n\n<p>&nbsp;</p>\n\n<p>那么大家算算，Eureka Server作为一个微服务注册中心，<strong>每秒钟要被请求多少次？一天要被请求多少次？</strong></p>\n\n<ul>\n	<li>\n	<p>按标准的算法，每个服务实例每分钟请求2次拉取注册表，每分钟请求2次发送心跳</p>\n	</li>\n	<li>\n	<p>这样一个服务实例每分钟会请求4次，2000个服务实例每分钟请求8000次</p>\n	</li>\n	<li>\n	<p>换算到每秒，则是8000 / 60 = 133次左右，我们就大概估算为Eureka Server每秒会被请求150次</p>\n	</li>\n	<li>\n	<p>那一天的话，就是8000 * 60 * 24 = 1152万，也就是<strong>每天千万级访问量</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>好！经过这么一个测算，大家是否发现这里的奥秘了？</strong></p>\n\n<ul>\n	<li>\n	<p>首先，对于微服务注册中心这种组件，在一开始设计它的拉取频率以及心跳发送频率时，就已经考虑到了一个大型系统的各个服务请求时的压力，每秒会承载多大的请求量。</p>\n	</li>\n	<li>\n	<p>所以各服务实例<strong>每隔30秒</strong>发起请求拉取变化的注册表，以及<strong>每隔30秒</strong>发送心跳给Eureka Server，其实这个时间安排是有其用意的。</p>\n	</li>\n</ul>\n\n<p>按照我们的测算，一个上百个服务，几千台机器的系统，按照这样的频率请求Eureka Server，日请求量在千万级，每秒的访问量在150次左右。</p>\n\n<p>即使算上其他一些额外操作，我们姑且就算每秒钟请求Eureka Server在200次~300次吧。</p>\n\n<p>所以通过设置一个适当的拉取注册表以及发送心跳的频率，可以保证大规模系统里对Eureka Server的请求压力不会太大。</p>\n\n<p><strong>关键问题来了</strong><strong>，Eureka Server是如何保证轻松抗住这每秒数百次请求，每天千万级请求的呢？</strong></p>\n\n<p>要搞清楚这个，首先得清楚Eureka&nbsp;Server到底是用什么来存储注册表的？三个字，<strong>看源码</strong></p>\n\n<p>&nbsp;</p>\n\n<p><strong>接下来咱们就一起进入Eureka源码里一探究竟：</strong></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462475383.png\" style=\"height:160px; width:800px\" /></p>\n\n<ul>\n	<li>\n	<p>如上图所示，图中的这个名字叫做<strong>registry</strong>的<strong>CocurrentHashMap</strong>，就是注册表的核心结构。看完之后忍不住先赞叹一下，精妙的设计！</p>\n	</li>\n	<li>\n	<p>从代码中可以看到，Eureka&nbsp;Server的注册表直接基于<strong>纯内存</strong>，即在内存里维护了一个数据结构。</p>\n	</li>\n	<li>\n	<p>各个服务的注册、服务下线、服务故障，全部会在内存里维护和更新这个注册表。</p>\n	</li>\n	<li>\n	<p>各个服务每隔30秒拉取注册表的时候，Eureka&nbsp;Server就是直接提供内存里存储的有变化的注册表数据给他们就可以了。</p>\n	</li>\n	<li>\n	<p>同样，每隔30秒发起心跳时，也是在这个纯内存的Map数据结构里更新心跳时间。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>一句话概括</strong>：维护注册表、拉取注册表、更新心跳时间，全部发生在内存里！这是Eureka Server非常核心的一个点。</p>\n\n<p>搞清楚了这个，咱们再来分析一下registry这个东西的数据结构，大家千万别被它复杂的外表唬住了，沉下心来，一层层的分析！</p>\n\n<ul>\n	<li>\n	<p>首先，这个ConcurrentHashMap的key就是服务名称，比如&ldquo;inventory-service&rdquo;，就是一个服务名称。</p>\n	</li>\n	<li>\n	<p>value则代表了一个服务的多个服务实例。</p>\n	</li>\n	<li>\n	<p>举例：比如&ldquo;inventory-service&rdquo;是可以有3个服务实例的，每个服务实例部署在一台机器上。</p>\n	</li>\n</ul>\n\n<p>再来看看作为value的这个Map：</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Map&lt;String, Lease&lt;InstanceInfo</strong><strong>&gt;</strong>&gt;</p>\n\n<ul>\n	<li>\n	<p>这个Map的key就是<strong>服务实例的id</strong></p>\n	</li>\n	<li>\n	<p>value是一个叫做<strong>Lease</strong>的类，它的泛型是一个叫做<strong>InstanceInfo</strong>的东东，你可能会问，这俩又是什么鬼？</p>\n	</li>\n	<li>\n	<p>首先说下InstanceInfo，其实啊，我们见名知义，这个InstanceInfo就代表了<strong>服务实例的具体信息</strong>，比如机器的ip地址、hostname以及端口号。</p>\n	</li>\n	<li>\n	<p>而这个Lease，里面则会维护每个服务<strong>最近一次发送心跳的时间</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>三、Eureka Server端优秀的多级缓存机制</strong></p>\n\n<p>假设Eureka Server部署在4核8G的普通机器上，那么<strong>基于内存来承载各个服务的请求，每秒钟最多可以处理多少请求呢？</strong></p>\n\n<ul>\n	<li>\n	<p>根据之前的测试，单台4核8G的机器，处理纯内存操作，哪怕加上一些网络的开销，每秒处理几百请求也是轻松加愉快的。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>而且Eureka Server为了避免同时读写内存数据结构造成的并发冲突问题，还采用了<strong>多级缓存机制</strong>来进一步提升服务请求的响应速度。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在拉取注册表的时候：首先从<strong>ReadOnlyCacheMap</strong>里查缓存的注册表。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>若没有，就找<strong>ReadWriteCacheMap</strong>里缓存的注册表。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>如果还没有，就从<strong>内存中获取实际的注册表数据。</strong></li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在注册表发生变更的时候：会在内存中更新变更的注册表数据，同时<strong>过期掉ReadWriteCacheMap</strong>。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>此过程不会影响ReadOnlyCacheMap提供人家查询注册表。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>一段时间内（默认30秒），各服务拉取注册表会直接读ReadOnlyCacheMap</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>30秒过后，Eureka Server的后台线程发现ReadWriteCacheMap已经清空了，也会清空ReadOnlyCacheMap中的缓存</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>下次有服务拉取注册表，又会从内存中获取最新的数据了，同时填充各个缓存。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>多级缓存机制的优点是什么？</strong></p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>尽可能保证了内存注册表数据不会出现频繁的读写冲突问题。</p>\n	</li>\n	<li>\n	<p>并且进一步保证对Eureka Server的大量请求，都是快速从纯内存走，性能极高。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>为方便大家更好的理解，同样来一张图，大家跟着图再来回顾一下这整个过程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462665485.png\" style=\"height:396px; width:800px\" /></p>\n\n<p><strong>四、总结</strong></p>\n\n<ul>\n	<li>\n	<p>通过上面的分析可以看到，Eureka通过设置适当的请求频率<strong>（拉取注册表30秒间隔，发送心跳30秒间隔）</strong>，可以保证一个大规模的系统每秒请求Eureka Server的次数在几百次。</p>\n	</li>\n	<li>\n	<p>同时通过纯内存的注册表，保证了所有的请求都可以在内存处理，确保了极高的性能</p>\n	</li>\n	<li>\n	<p>另外,多级缓存机制，确保了不会针对内存数据结构发生频繁的读写并发冲突操作，进一步提升性能。</p>\n	</li>\n</ul>\n\n<p>上述就是Spring Cloud架构中，Eureka作为微服务注册中心可以承载大规模系统每天千万级访问量的原理。</p>\n, 参数6:e81bc2dca42c4031be7d66fef4a71e16, 参数7:2c93dfab0e754006866f8ed486923a41, 参数8:0, 参数9:2, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:e94e738ed04f4471b673de155e393a0b, ','编辑博客',1,'2018-12-29 10:27:49','2018-12-29 10:27:49'),('27ee1315eb65489cad00744180372646','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/add','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@51af8501]], 参数2:扎心！线上服务宕机时，如何保证数据100%不丢失？, 参数3:扎心！线上服务宕机时，如何保证数据100%不丢失？, 参数4:<p><strong><strong>一、写在前面</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>上篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=208692b2a7a242f4942993abb8eebf8b\" target=\"_blank\">同学，消息中间件在你们生产项目里如何落地使用的？</a>》，我们用一个简单易懂的电商场景给大家引入说明了一个消息中间件的使用场景。</p>\n\n<p>&nbsp;</p>\n\n<p>同时，我们还基于RabbitMQ的HelloWorld级别的代码，给出了订单服务和仓储服务如何基于MQ中间件收发消息的示例。</p>\n\n<p><strong><strong>二、业务场景回顾</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>这篇文章，我们来稍微深入探讨一些MQ中间件使用中的基础技术问题。</p>\n\n<p>&nbsp;</p>\n\n<p>首先回顾一下上篇文章做出来的一个架构图，看看订单服务和消息服务是如何基于MQ来收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>我们稍微把这个图细化一点，简单来说就是多个订单服务实例给queue推送消息，多个仓储服务每个消费一部分消息。如下图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145179451.png\" style=\"height:265px; width:820px\" /></p>\n\n<p><strong><strong>三、意外宕机，问题凸现</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>假如你线上对MQ技术的使用就到此为止了，那么基本可以跟offer说拜拜了。。。</p>\n\n<p>&nbsp;</p>\n\n<p>因为如果是我的话，作为一个面试官就没法继续往下问了。你这个MQ的使用以及理解的深度仅此而已的话，那基本就是刚刚对MQ技术入门的程度。</p>\n\n<p>&nbsp;</p>\n\n<p>如果面试官要继续问，完全可以问下面的问题：</p>\n\n<ul>\n	<li>\n	<p>那你说说如果仓储服务作为消费者服务，刚收到了一个订单消息，但是在完成消息的处理之前，也就是还没对订单完成仓储调度发货，结果这个仓储服务突然就宕机了，这个时候会发生什么事情？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>所以说，大家还是要对这个技术了解的稍微深入一点点，否则随便被问几个问题就完蛋了。</p>\n\n<p>&nbsp;</p>\n\n<p>大伙儿先来看看下面的图，感受一下车祸现场。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145205074.png\" style=\"height:326px; width:1227px\" /></p>\n\n<p>RabbitMQ这个中间件默认的一个行为，就是只要仓储服务收到一个订单消息，RabbitMQ就会立马把这条订单消息给标记为删除，<strong>这个行为叫做自动ack，</strong>也就是投递完成一条消息就自动确认这个消息处理完毕了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是接着如果此时仓储服务收到了一个订单消息，但是还没来得及对仓库系统完成商品的调度发货，结果直接就宕机了。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，明显这个订单消息就丢失了啊，因为RabbitMQ那里已经没有了。。。</p>\n\n<p>&nbsp;</p>\n\n<p>这会导致什么样的尴尬体验呢？就是一个用户支付了8999元，对一个iphone8下了订单，结果呢，死等活等了好几天，就是不见网站上显示他的iphone8在发货。</p>\n\n<p>&nbsp;</p>\n\n<p>搞了半天，原因就是他的那个iphone8的订单在仓储服务那里，还没来得及调度发货直接就宕机了，导致这个订单消息就一直丢失了，始终没有给这个用户通知仓库系统进行发货。</p>\n\n<p>&nbsp;</p>\n\n<p>这个问题，是不是很尴尬？所以说，技术问题是会严重影响企业的核心业务流程的！</p>\n\n<p>&nbsp;</p>\n\n<p>各位小伙伴，还记得上一讲咱们的仓储服务消费消息的代码中，有一行关键的代码：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145226184.png\" style=\"height:81px; width:500px\" /></p>\n\n<p>这行代码对<strong>channel.basicConsume()</strong>方法，传入的第二个参数：<strong>true</strong>，其实就是一个关键的参数。</p>\n\n<p>&nbsp;</p>\n\n<p>这个true就代表了一个核心的含义，<strong>他的意思是，RabbitMQ只要把一个消息投递到仓储服务手上，立马就标记这个消息删除了。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>但是在这个默认的配置之下，要是仓储服务收到一个订单消息，结果还没来得及完成耗时几十秒的仓储调度发货的业务逻辑，结果突然宕机了，那么这个订单消息就永久性丢失了！</p>\n\n<p>&nbsp;</p>\n\n<p>找了半天，原来问题的症结在这里啊！大家是不是明白了，上一篇文章最后为什么我会说，这个代码目前为止还有很多的问题。</p>\n\n<p>&nbsp;</p>\n\n<p>所以这个时候，我们如果希望不要因为仓储服务的突然宕机导致一条订单消息丢失，就需要改造一下仓储服务消费消息的代码了。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>首先，我们需要把那个参数从true改为false</strong>，如下代码所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145251780.png\" style=\"height:79px; width:500px\" /></p>\n\n<p>只要修改为false之后，RabbitMQ就不会盲目的投递消息到仓储服务，立马就删除消息了，说白了就是关闭autoAck的行为，不要自作主张的认为消息处理成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>接着，我们需要改造一下处理订单消息的代码，如下代码所示。</p>\n\n<p>&nbsp;</p>\n\n<p>这段代码，说白了，就是在对订单完成了调度发货之后，<strong>在finally代码块中手动执行了ack操作</strong>，说我自己已经完成了耗时几十秒的业务逻辑的处理，现在可以手动ack通知RabbitMQ，这个消息处理完毕了。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145274245.png\" style=\"height:156px; width:500px\" /></p>\n\n<p>此时整个架构运行流程大致看起来跟下面的图那样子。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145297769.png\" style=\"height:125px; width:500px\" /></p>\n\n<p>架构流程改成上面那样后，就意味着只有完成了仓储调度发货的代码业务逻辑，确保仓库系统收到通知之后，仓储服务才会在代码中手动发送ack消息给RabbitMQ。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，RabbitMQ收到了这个ack消息，才会标记对应的订单消息被删除了。</p>\n\n<p>&nbsp;</p>\n\n<p>如果说在仓储服务收到了订单消息，但是还没来得及完成仓储调度发货的业务逻辑，那也就绝对不会执行这条订单消息的ack操作，然后RabbitMQ也就不会收到这条订单消息的ack通知。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦RabbitMQ发现代表消费者的某个仓储服务实例突然宕机了，而这个仓储服务收到的一些订单消息还没来得及处理，没给自己发送那些消息的ack通知。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，RabbitMQ会自动对这条订单消息重发推送给其他在运行中的仓储服务实例，让其他的仓储服务实例去处理这条订单消息。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以保证这条订单消息不会因为某个仓储服务实例的宕机而丢失，他会确保必须由某个仓储服务实例完成这条订单消息的调度发货处理，然后才会删除那条订单消息。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>四、总结 &nbsp;tips</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>最后再来一张图，大家直观的感受一下：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145320120.png\" style=\"height:246px; width:800px\" /></p>\n\n<p>好了，各位同学，这篇文章是不是相对稍微深入一点点，让大家了解到了一些使用MQ技术时候要考虑的一些问题？</p>\n\n<p>&nbsp;</p>\n\n<p>实际上无论是RocketMQ、Kafka还是RabbitMQ，都有类似的autoAck或者是手动ack的机制。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>线上生产环境中运行时，你必须要考虑到消费者服务可能宕机的问题。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>如果消费者服务没处理完消息就自己宕机了，那么一定会导致部分消息的丢失，进而影响核心业务流程的运转。</p>\n\n<p>&nbsp;</p>\n\n<p>因此大家在线上使用MQ时，一定要充分考虑这些潜在问题，同时结合具体的MQ提供的一些API、参数来进行合理设置，确保消息不要随意丢失。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>END</strong></p>\n, 参数5:1c76b9848f5f4d71a5e88b20dbaf38f4,ca928e8718654aa5a802e2f69277b137, 参数6:0, 参数7:0, 参数8:0, 参数9:1, 参数10:陌溪_, 参数11:蘑菇博客, 参数12:e60df954efcd47c48463a504bb70bbe9, 参数13:e79e4375ce5b4aa6ad48027de6cb8af2, ','增加博客',1,'2018-12-30 12:49:04','2018-12-30 12:49:04'),('28d7f0350fae4f68a988c9ddd6119042','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/search/initIndex','POST','com.moxi.mogublog.admin.restapi.SolrIndexRestApi','initIndex','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@51af8501]], ','初始化solr索引',1,'2018-12-29 10:50:53','2018-12-29 10:50:53'),('2f8ea67756c6434a895bdb18e9ff1764','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@19557f7f]], 参数2:7936b17678e84ddb81ac0af74f22c355, 参数3:Java工程师学习指南（入门篇）, 参数4:Java工程师学习指南（入门篇）, 参数5:<h1><strong>前期准备工作</strong></h1>\n\n<p>&nbsp;</p>\n\n<h2><strong>开发环境搭建</strong></h2>\n\n<p>这一步我们往往会直接跳过，但既然是面向小白的教程，这里就提一下吧。首先你需要一台电脑，然后安装好JDK和JRE，JDK提供的是Java开发工具，也就是一些必备的jar包，JRE则是Java的运行环境组件，我们熟悉的JVM就在这里面。</p>\n\n<p>安装好这两个东东之后，一般还要配置一下环境变量，否则有一些目录可能无法被正确找到。</p>\n\n<h2><strong>IDE选择和安装</strong></h2>\n\n<p>IDE指的就是本地开发编辑器，没有了它，你就只能直接在记事本这类工具里敲代码了。IDE最大的好处就是整合了大量的工具和功能模块，让你非常轻松地完成开发。</p>\n\n<p>以前大家都用eclipse，不过eclipse已经不流行了，现在我推荐你直接用intellij idea 或者 STS作为你的第一个代码编辑器。如果是用过eclipse的同学，基本上也可以无痛切换STS。</p>\n\n<p>intellij idea可以直接在官网上下载，试用版30天，如果想要永久使用，网上也有一些办法滴。</p>\n\n<p>STS是spring boot官方推荐的IDE，可以直接在官网上下载。</p>\n\n<h2><strong>关于jar包</strong></h2>\n\n<p>jar包是什么，其实就是将一堆class格式文件打包，Java中把它称为jar包，这些jar包在编译器中能被直接识别，让开发者使用。</p>\n\n<p>对于新手来说，可能只需要用到JDK自带的一些API，但是如果你要引用外部jar包，可能就会遇到一些困难了。对于idea来说，导入外部jar包有两种办法，一种是手动导入jar包，一种是使用maven。后者会在Java Web相关的文章中讲起。</p>\n\n<p>手动导入jar包其实也不难，你需要先下载好jar包，然后在对应的项目下选择导入jar包即可，具体的方法这里就不展开说了，因为在网上都找得到。</p>\n\n<h1><strong>学习Java基础的几种方法</strong></h1>\n\n<h2><strong>了解基础语法</strong></h2>\n\n<p>学习一门语言，最开始要做的事情就是学习它的语法。我最早学习Java语法是在Runoob（菜鸟教程），这个网站可以让你对任意一门语言完成最快速的语法入门，当然，这只是相当于你浏览了一遍基础语法。</p>\n\n<p>想要真正掌握Java语言基础，光看基础语法还远远不够，我在大三第一次接触Java课程，听老师讲面向对象三大特征听得一头雾水，连数组的初始化方式都理不清楚，但这些内容都是我们需要掌握的。所以，为了学好Java基础，我们还需要看视频或者看书进行学习。</p>\n\n<h2><strong>看视频</strong></h2>\n\n<p>视频的话，可以到极客学院或者慕课网听Java基础课程，当然也可以看我分享的Java视频课程。大家也都知道，现在Java的培训班非常多，基本上学的东西也都大同小异，不过它们的有些课程还不错，大家有渠道的话也可以去看一看。</p>\n\n<p>看视频的好处是你可以更好地接收知识，同时也会耗费你更多时间，所以，有时候你也可以选择看书。</p>\n\n<h2><strong>看书</strong></h2>\n\n<p>看书的话，对于小白来说不推荐太复杂的书，比如《Java编程思想》这种书，新手千万不要看。我个人建议，你只需要先看看《Java入门到精通》这种类型的书就足够了，因为这个部分的学习只是为你后面的学习开个头，你以后可能还要回过头来重新研究这些内容。</p>\n\n<p>现在市面上介绍Java基础的书籍实在太多了，质量参差不齐，内容同质化严重，笔者看过的其实也不多。给大家一个建议，你只需要挑一两本书来看即可，这里推荐两本最简单的吧，《head first java》和《Java从入门到精通》。</p>\n\n<h2><strong>看博客</strong></h2>\n\n<p>这里再推荐另一种学习方式，就是看博客，博客比起书籍来说，更适合对于某个技术点的学习，你可以很容易地在网上找到这个知识点相关的原理，实现方法，以及代码范例。</p>\n\n<p>我的博客里没有讲解特别基础的东西，如果你看一些比较基础的文章，可以到Runoob等网站上查看。如果你有一个很明确的知识点想要学习，相信搜搜引擎会给你更好的答案。</p>\n\n<h2><strong>代码实践</strong></h2>\n\n<p>除此之外，一般的Java书籍或者视频课程都会要求你相应完成一些练习题，这部分内容你需要自己在电脑里使用IDE完成。</p>\n\n<p>在IDE里，你可以很好地熟悉Java语言的使用，基本代码的实现，同时可以尝试各种各样的API,并且测试一些语言特性，比如继承，封装，多态等等。</p>\n\n<p>另外，这也是你熟悉IDE的一个好机会，因为在公司里做开发可能要用到IDE各种各样的功能，提前熟悉好IDE绝对是有益无害的。</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>Java入门必备知识点梳理</strong></h1>\n\n<p>在Java入门阶段，你可能需要接触到以下这部分知识，不管你是从通过哪种方式学习，这些内容都是你学习Java基础时绕不过的重点。</p>\n\n<h2>Java基础知识</h2>\n\n<p>这部分内容是你必须要掌握的内容，在入门阶段你需要把这些基础打扎实，以便于在学习后面的内容时可以更上一层楼。</p>\n\n<p>如何把基础打扎实呢，最好的办法就是在IDE上把书上或者视频上的每个例子都实现一遍，当然有的时候你也可以自己写一些有意思的例子。</p>\n\n<h3><strong>1 基本数据类型</strong></h3>\n\n<p>比如int，double，char，以及其包装类。</p>\n\n<p>熟悉基本数据类型的使用，了解每种类型所占的字节数，以及它们和包装类之间的相互转换。</p>\n\n<h3><strong>2 流程控制</strong></h3>\n\n<p>比如for循环，if else，while循环等等</p>\n\n<p>如果是学过c语言的同学，这部分可以跳过了。</p>\n\n<h3><strong>3 字符串类型String的使用</strong></h3>\n\n<p>字符串类型是Java中很重要的类型，它不是基本数据类型，但却很常用，熟悉和实践String相关的api，开始你对字符串的学习吧。</p>\n\n<h3><strong>4 数组</strong></h3>\n\n<p>数组的初始化方式有哪些，二维数组应该怎么写，把数组当成方法参数又该怎么处理？</p>\n\n<h3><strong>5 类和对象</strong></h3>\n\n<p>Java中最重要的两个概念：类和对象，它们有什么用呢，有什么区别和联系呢，请在代码中实践它们吧。</p>\n\n<p>&nbsp;</p>\n\n<h2><strong>Java核心技术</strong></h2>\n\n<p>对于这部分内容，我相信很多小白只能了解它们的基本使用方法，但是并不明白其背后的一些原理：比如为什么接口和抽象类有这些区别，多态的意义是什么，为什么要有反射。</p>\n\n<p>新手在学习这部分内容时，只需要知道怎么用就可以了。当然，你最好把这些特性都实现一遍，以加深印象。</p>\n\n<p>至于为什么有这些特性，这些特性背后的原理是什么，不是我们现在讨论的内容，这些内容我们将在初级和中级篇中讲述。因为，要了解这些原理，你得了解JVM，了解并发技术的基础，了解网络基础，甚至更多。显然，这不是你现在能做到的。</p>\n\n<h3><strong>1 接口和抽象类</strong></h3>\n\n<p>写一些接口，同时写一些实现类去实现这些接口，并且了解一下为什么我们需要接口，为什么子类需要实现接口里的方法。</p>\n\n<p>同理，去实现一些抽象类吧。然后，看看它和接口有什么不同。</p>\n\n<h3><strong>2 继承，封装和多态</strong></h3>\n\n<p>如何理解继承，子类和父类之间有什么联系呢。</p>\n\n<p>封装是一种保护代码的方式，有哪些方式可以实现封装呢。</p>\n\n<p>多态一般分为重载和重写，它们分别怎么使用？</p>\n\n<h3><strong>3 异常处理</strong></h3>\n\n<p>Java中的异常处理主要用于捕获和处理错误，请你写一些try catch代码块去捕获错误吧。</p>\n\n<h3><strong>4 集合类</strong></h3>\n\n<p>集合类是我们经常需要打交道的东西，List，Map，Set等等，赶快去熟悉API，然后写一些测试例子吧。</p>\n\n<h3><strong>5 IO输入流和输出流</strong></h3>\n\n<p>IO输入流和输出流可以操作文件，网络数据等内容，如何在Java代码中完成这么复杂的操作呢，其实只需要简单的几个api就可以了。</p>\n\n<h3><strong>6 多线程</strong></h3>\n\n<p>为了让系统资源最合理地分配和调度，我们需要多线程，多线程会让程序变得有趣，也会带来很多问题，使用Thread和相关API，去尝试这些有趣的事情吧。</p>\n\n<p><strong>可选内容：</strong></p>\n\n<p>1 反射（了解即可，不是入门必须）</p>\n\n<p>2 枚举类型和泛型（了解即可，不是入门必须）</p>\n\n<p>3 网络通信（了解基本的socket使用即可，需要网络基础）</p>\n\n<p>4 数据库操作（了解基本的JDBC即可，需要数据库基础）</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>总结</strong></h1>\n\n<p>总而言之，对于一个Java小白来说，入门Java可以分为这几步：</p>\n\n<blockquote>\n<p>1 首先搭建好Java开发环境</p>\n\n<p>2 通过Runoob等一些网站熟悉Java的基本语法</p>\n\n<p>3 通过看书看视频等方式熟悉Java基础知识，通过代码实践加深理解</p>\n\n<p>4 通过看书看视频等方式初步了解Java核心技术，通过代码实践加深理解。</p>\n</blockquote>\n\n<p>&nbsp;</p>\n\n<p>本文主要是为大家提供一个学习的思路，以及推荐一些学习方法，如果你能够按照这样的步骤去学习，并且配合上一些适合你自己的学习方法来完成学习计划，相信你可以很好地完成对Java的入门。</p>\n, 参数6:7e0e93ea6cdb44ae92e58f48e6496ed7, 参数7:093d8bdd01c84890a928e923d5c235fe, 参数8:0, 参数9:0, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:8f48f07f30314960a38a0b85c4f1f34a, ','编辑博客',1,'2018-12-20 16:32:01','2018-12-20 16:32:01'),('41fbcaa4ab6a458f9c8fae60acb6d2bb','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:5358c7c8696d4f4facc5d6e1a7f9e031, 参数3:如何让网页“看起来”展现地更快？骨架屏二三事, 参数4:如何让网页“看起来”展现地更快？骨架屏二三事, 参数5:<p>让网页展现的更快，官方说法叫做首屏绘制，First Paint 或者简称 FP，直白的说法叫做白屏时间，就是从输入 URL 到真的看到内容（不必可交互，那个叫 TTI, Time to Interactive）之间经历的时间。当然这个时间越短越好。</p>\n\n<p>&nbsp;</p>\n\n<p>但这里要注意，和首屏相关的除了 FP 还有两个指标，分别称为 FCP (First Contentful Paint，页面有效内容的绘制) 和 FMP (First Meaningful Paint，页面有意义的内容绘制)。虽然这几个概念可能会让我们绕晕，但我们只需要了解一点：<strong>首屏时间 FP 并不要求内容是真实的，有效的，有意义的，可交互的。</strong>换言之，随便&nbsp;给用户看点啥都行。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058813640.png\" style=\"height:278px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>这就是本文标题的玄机了：&ldquo;看起来&rdquo;。是的，只是看起来更快，实际上还是那样。所以本文并不讨论性能优化，讨论的是一个投机取巧的小伎俩，但的确能够实实在在的提升体验。打个比方，性能优化是修炼内功，提升你本身的各项机能；而本文接下来要讨论的是一些招式，能让你在第一时间就唬住对手。</p>\n\n<p>&nbsp;</p>\n\n<p>这所谓的招式就是我接下来要谈的内容，学名骨架屏，也叫 Skeleton。你可能没听过这个名字，但你不可能没见过它。</p>\n\n<h3>骨架屏长什么样</h3>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058854701.png\" style=\"height:662px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>这种应该是最常见的形式，使用各种形状的灰色矩形来模拟图片和文字。有些 APP 也会使用圆形，但重点都是和实际内容结构近似，不能差距太大。</p>\n\n<p>&nbsp;</p>\n\n<p>如果追求效果，还可以在色块表面添加动画（如波纹），显示出一种动态的效果，算是致敬 Loading 了。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058879692.png\" style=\"height:453px; width:659px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>在图片居多的站点，这将会是一个很好的体验，因为图片通常加载较慢。如上图演示中的占位图片采用了低像素的图片，即大体配色和变化是和实际内容一致的。</p>\n\n<p>&nbsp;</p>\n\n<p>如果无法生成这样的低像素图片，稍微降级的方案是通过算法获取图片的主体颜色，使用纯色块占位。</p>\n\n<p>&nbsp;</p>\n\n<p>再退一级，还可以使用全站相同的站位图片，或者直接一个统一颜色的色块。虽说效果肯定不如上面两种，但也聊胜于无。</p>\n\n<p>&nbsp;</p>\n\n<p>骨架屏完全是自定义的，想做成什么样全凭你的想象。你想做圆形的，三角形的，立体的都可以，但&ldquo;占位&rdquo;决定了它的特性：它不能太复杂，必须第一时间，最快展现出来。</p>\n\n<h3>骨架屏有哪些优势</h3>\n\n<p><strong>大</strong><strong>体来说，骨架屏的优势在于：</strong></p>\n\n<p>&nbsp;</p>\n\n<p>1、在页面加载初期预先渲染内容，提升感官上的体验。</p>\n\n<p>2、一般情况骨架屏和实际内容的结构是类似的，因此之后的切换不会过于突兀。这点和传统的 Loading 动图不同，可以认为是其升级版。</p>\n\n<p>3、只需要简单的 CSS 支持 (涉及图片懒加载可能还需要 JS )，不要求 HTTPS 协议，没有额外的学习和维护成本。</p>\n\n<p>4、如果页面采用组件化开发，每个组件可以根据自身状态定义自身的骨架屏及其切换时机，同时维持了组件之间的独立性。</p>\n\n<h3>骨架屏能用在哪里</h3>\n\n<p>现在的 WEB 站点，大致有两种渲染模式：</p>\n\n<h3>前端渲染</h3>\n\n<p>由于最近几年 Angular/React/Vue 的相继推出和流行，前端渲染开始占据主导。这种模式的应用也叫单页应用（SPA, Single Page Application）。</p>\n\n<p>&nbsp;</p>\n\n<p>前端渲染的模式是服务器（多为静态服务器）返回一个固定的 HTML。通常这个 HTML 包含一个空的容器节点，没有其他内容。之后内部包含的 JS 包含路由管理，页面渲染，页面切换，绑定事件等等逻辑，所以称之为前端渲染。</p>\n\n<p>&nbsp;</p>\n\n<p>因为前端要管理的事情很多，所以 JS 通常很大很复杂，执行起来也要花较多的时间。<strong>在 JS 渲染出实际内容之前，骨架屏就是一个很好的替补队员</strong>。</p>\n\n<h3>后端渲染</h3>\n\n<p>在这波前端渲染流行之前，早期的传统网站采用的模式叫做后端渲染，即服务器直接返回网站的 HTML 页面，已经包含首页的全部（或绝大部分） DOM 元素。其中包含的 JS 的作用大多是绑定事件，定义用户交互后的行为等。少量会额外添加/修改一些 DOM，但无碍大局。</p>\n\n<p>&nbsp;</p>\n\n<p>此外，前端渲染的模式存在 SEO 不友好的问题，因为它返回的 HTML 是一个空的容器。如果搜索引擎没有执行 JS 的能力（称为 Deep Render），那它就不知道你的站点究竟是什么内容，自然也就无法把站点排到搜索结果中去。这对于绝大部分站点来说是不可接受的，于是前端框架又相继推出了服务端渲染（简称 SSR, Server Side Rendering）模式。这个模式和传统网站很接近，在于返回的 HTML 也是包含所有的 DOM，而非前端渲染。而前端 JS 除了绑定事件之外，还会多做一个事情叫做&ldquo;激活&rdquo;（hydration），这里就不再赘述了。</p>\n\n<p>&nbsp;</p>\n\n<p>不论是传统模式还是 SSR，只要是后端渲染，就不需要骨架屏。<strong>因为页面的内容直接存在于 HTML，所以并没有骨架屏出场的余地。</strong></p>\n\n<h3>骨架屏怎么用</h3>\n\n<p>讨论了一波背景，我们来看如何使用。首先先无视具体的实现细节，先看思路。</p>\n\n<h3>实现思路</h3>\n\n<p>大体分为几个步骤：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>往本应为空的容器节点内部注入骨架屏的 HTML。<br />\n	骨架屏为了尽快展现，要求快速和简单，所以骨架屏多数使用静态的图片。而且把图片编译成 base64 编码格式可以节省网络请求，使得骨架屏更快展现，更加有效。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre>\n<code class=\"language-html\">&lt;html&gt;\n    &lt;head&gt;\n        &lt;style&gt;\n            .skeleton-wrapper {\n                // styles\n            }\n        &lt;/style&gt;\n        &lt;!-- 声明 meta 或者引入其他 CSS --&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"app\"&gt;\n            &lt;div class=\"skeleton-wrapper\"&gt;\n                &lt;img src=\"data:image/svg+xml;base64,XXXXXX\"&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;!-- 引用 JS --&gt;\n    &lt;/body&gt;\n&lt;/html&gt;</code></pre>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在执行 JS 开始真正内容的渲染之前，清空骨架屏 HTML<br />\n	以 Vue 为例，即在&nbsp;mount&nbsp;之前清空内容即可。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre>\n<code class=\"language-javascript\">let app = new Vue({...})\nlet container = document.querySelector(\'#app\')\nif (container) {\n    container.innerHTML = \'\'\n}\napp.$mount(container)</code></pre>\n\n<p>&nbsp;</p>\n\n<p>仅此两步，并不牵涉多么复杂的机制和高端的 API，因此非常容易应用，赶快用起来！</p>\n\n<h3>示例</h3>\n\n<p>我编写了一个示例，用于快速展现骨架屏的效果，代码在此。</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p><strong>index.html</strong><br />\n	默认包含了骨架屏，并且内联了样式（以&nbsp;&lt;style&gt;&nbsp;标签添加在头部）。</p>\n	</li>\n	<li>\n	<p><strong>render.js</strong><br />\n	它负责创建 DOM 元素并添加到&nbsp;&lt;body&gt;&nbsp;上，渲染页面实际的内容，用来模拟常见的前端渲染模式。</p>\n	</li>\n	<li>\n	<p><strong>index.css</strong><br />\n	页面实际内容的样式表，不包含骨架屏的样式。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>代码的三个文件各司其职，配合上面的实现思路，应该还是很好理解的。可以在&nbsp;这里&nbsp;查看效果。</p>\n\n<p>&nbsp;</p>\n\n<p>因为这个示例的逻辑太过简单，而实际的前端渲染框架复杂得多，包含的功能也不单纯是渲染，还有状态管理，路由管理，虚拟 DOM 等等，所以文件大小和执行时间都更大更长。<strong>我们在查看例子的时候，把网络调成 &quot;Fast 3G&quot; 或者 &quot;Slow 3G&quot; 能够稍微真实一些。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>但匪夷所思的是，对着这个地址刷新试几次，我也基本看不到骨架屏（骨架屏的内容是一个居中的蓝色方形图片，外加一条白色横线反复侧滑的高亮动画）。是我们的实现思路有问题吗？</p>\n\n<h3>浏览器的奥秘：减少重排</h3>\n\n<p>为了排除肉眼的遗漏和干扰，我们用 Chrome Dev Tools 的 Performance 工具来记录刚才发生了什么，截图如下：（截图时的网络设置为 &quot;Fast 3G&quot;）</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543058991079.png\" style=\"height:519px; width:951px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>我们可以很明显地看到 3 个时间点：</strong></p>\n\n<p>&nbsp;</p>\n\n<p>1、HTML 加载完成了。浏览器在解析 HTML 的同时，发现了它需要引用的 2 个外部资源&nbsp;index.js&nbsp;和&nbsp;index.css，于是发送网络请求去获取。</p>\n\n<p>2、获取成功后，执行 JS 并注册 CSS 的规则。</p>\n\n<p>3、JS 一执行，很自然的渲染出了实际的内容，并应用了样式规则（随机颜色的横条）。</p>\n\n<p>&nbsp;</p>\n\n<p>我们的骨架屏呢？按照预想，骨架屏应该出现在 1 和 2 之间，也就是在获取 JS 和 CSS 的同时，就应该渲染骨架屏了。这也是我们当时把骨架屏的 HTML 注入到&nbsp;index.html， 还把 CSS 从&nbsp;index.css&nbsp;中分离出来的良苦用心，然而浏览器并不买账。</p>\n\n<p>&nbsp;</p>\n\n<p>这其实和浏览器的渲染顺序有关。</p>\n\n<p>&nbsp;</p>\n\n<p>相信大家都整理过行李箱。我们在整理行李箱时，会根据每个行李的大小合理安排，大的和小的配合，填满一层再放上面一层。现在突然有人跑来跟你说，你的电脑不用带了，你要多带两件衣服，你不能带那么多瓶矿泉水。除了想打他之外，为了重新整理行李箱，必然需要把整理好的行李拿出来再重新放。在浏览器中这个过程叫做重排 (reflow)，而那个馊主意就是新加载的 CSS。显而易见，重排的开销是很大的。</p>\n\n<p>&nbsp;</p>\n\n<p>熟能生巧，箱子理多了，就能想出解决办法。既然每个 CSS 文件加载都可能触发重绘，那我能不能等所有 CSS 加载完了一起渲染呢？正是基于这一点，浏览器会等 HTML 中所有的 CSS 都加载完，注册完，一起应用样式，力求一次排列完成工作，不要反复重排。看起来浏览器的设计者经常出差，因为这是一个很正确的优化思路，但应用在骨架屏上就出了问题。</p>\n\n<p>&nbsp;</p>\n\n<p>我们为了尽早展现骨架屏，把骨架屏的样式从&nbsp;index.css&nbsp;分离出来。但浏览器不知道，它以为骨架屏的 HTML 还依赖&nbsp;index.css，所以必须等它加载完。而它加载完之后，render.js&nbsp;也差不多加载完开始执行了，于是骨架屏的 HTML 又被替换了，自然就看不到了。而且在等待 JS, CSS 加载的时候依然是个白屏，骨架屏的效果大打折扣。</p>\n\n<p>&nbsp;</p>\n\n<p>所以我们要做的是告诉浏览器，你放心大胆的先画骨架屏，它和后面的&nbsp;index.css&nbsp;是无关的。那怎么告诉它呢？</p>\n\n<h3>告诉浏览器先渲染骨架屏</h3>\n\n<p>我们在引用 CSS 时，会使用&nbsp;&lt;link rel=&quot;stylesheet&quot; href=&quot;xxxx&gt;&nbsp;这样的语法。但实际上，浏览器还提供了其他一些机制确保（后续）页面的性能，我们称之为 preload，中文叫预加载。具体来说，使用&nbsp;&lt;link rel=&quot;preload&quot; href=&quot;xxxx&quot;&gt;，提前把后续要使用的资源先声明一下。在浏览器空闲的时候会提前加载并放入缓存。之后再使用就可以节省一个网络请求。</p>\n\n<p>&nbsp;</p>\n\n<p>这看似无关的技术，在这里将起到很大的作用，因为&nbsp;预加载的资源是不会影响当前页面的。</p>\n\n<p>&nbsp;</p>\n\n<p>我们可以通过这种方式，告诉浏览器：先不要管&nbsp;index.css，直接画骨架屏。之后&nbsp;index.css加载回来之后，再应用这个样式。具体来说代码如下：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;link rel=\"preload\" href=\"index.css\" as=\"style\" onload=\"this.rel=\'stylesheet\'\"&gt;\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>方法的核心是通过改变&nbsp;rel&nbsp;可以让浏览器重新界定&nbsp;&lt;link&gt;&nbsp;标签的角色，从预加载变成当页样式。（另外也有文章采用修改&nbsp;media&nbsp;的方法，但浏览器支持度较低，这里不作展开了。我把文章列在最后了）这样的话，浏览器在 CSS 尚未获取完成时，会先渲染骨架屏（因为此时的 CSS 还是&nbsp;preload，也就是后续使用的，并不妨碍当前页面）。而当 CSS 加载完成并修改了自己的&nbsp;rel之后，浏览器重新应用样式，目的达成。</p>\n\n<h3>不得不考虑的注意点</h3>\n\n<p>事实上，并不是把&nbsp;rel=&quot;stylesheet&quot;&nbsp;改成&nbsp;rel=&quot;preload&quot;&nbsp;就完事儿了。在真正应用到生产环境之前，我们还有很多事情要考虑。</p>\n\n<h3>兼容性考虑</h3>\n\n<p>首先，在&nbsp;&lt;link&gt;&nbsp;内部我们使用了&nbsp;onload，也就是使用了 JS。为了应对用户的浏览器没有开启脚本功能的情况，我们需要添加一个 fallback。（不过这点对于单页应用来说可能也无所谓，因为如果没有脚本，那页面实际内容也渲染不出来的）</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;noscript&gt;&lt;link rel=\"stylesheet\" href=\"index.css\"&gt;&lt;/noscript&gt;</code></pre>\n\n<p>&nbsp;</p>\n\n<p>其次，rel=&quot;preload&quot;&nbsp;并不是没有兼容性问题。对于不支持 preload 的浏览器，我们可以添加一些&nbsp;polyfill 代码（来使所有浏览器获得一致的效果。</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;script&gt;\n/*! loadCSS rel=preload polyfill. [c]2017 Filament Group, Inc. MIT License */\n(function(){ ... }());\n&lt;/script&gt;</code></pre>\n\n<p>&nbsp;</p>\n\n<p>polyfill 的压缩代码可以参见 Lavas 的 SPA 模板第 29 行。</p>\n\n<h3>加载顺序</h3>\n\n<p>不同于传统页面，我们的实际 DOM 是通过&nbsp;render.js&nbsp;生成的。所以如果 JS 先于 CSS 执行，那将会发生跳动。（因为先渲染了实际内容却没有样式，而后样式加载，页面出现很明显的变化）所以这里我们需要严格控制 CSS 早于渲染。</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>&lt;link rel=\"preload\" href=\"index.css\" as=\"style\" onload=\"this.rel=\'stylesheet\';window.STYLE_READY=true;window.mountApp &amp;&amp; window.mountApp()\"&gt;\n</code></pre>\n\n<p>&nbsp;</p>\n\n<p>JS 对外暴露一个&nbsp;mountApp&nbsp;方法用于渲染页面（其实是模拟 Vue 的&nbsp;mount）</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>// render.js\n\nfunction mountApp() {\n    // 方法内部就是把实际内容添加到 &lt;body&gt; 上面\n}\n\n// 本来直接调用方法完成渲染\n// mountApp()\n\n// 改成挂到 window 由 CSS 来调用\nwindow.mountApp = mountApp()\n// 如果 JS 晚于 CSS 加载完成，那直接执行渲染。\nif (window.STYLE_READY) {\n    mountApp()\n}</code></pre>\n\n<p>&nbsp;</p>\n\n<p>如果 CSS 更快加载完成，那么通过设置&nbsp;window.STYLE_READY&nbsp;允许 JS 加载完成后直接执行；而如果 JS 更快，则先不自己执行，而是把机会留给 CSS 的&nbsp;onload。</p>\n\n<h3>清空 onload</h3>\n\n<p>loadCSS&nbsp;的开发者提出，某些浏览器会在&nbsp;rel&nbsp;改变时重新出发&nbsp;onload，导致后面的逻辑走了两次。为了消除这个影响，我们再在&nbsp;onload&nbsp;里面添加一句&nbsp;this.onload=null。</p>\n\n<h3>最终的 CSS 引用方式</h3>\n\n<pre>\n<code>&lt;link rel=\"preload\" href=\"index.css\" as=\"style\" onload=\"this.onload=null;this.rel=\'stylesheet\';window.STYLE_READY=true;window.mountApp &amp;&amp; window.mountApp()\"&gt;\n\n&lt;!-- 为了方便阅读，折行重复一遍 --&gt;\n&lt;!-- this.onload=null --&gt;\n&lt;!-- this.rel=\'stylesheet\' --&gt;\n&lt;!-- window.STYLE_READY=true --&gt;\n&lt;!-- window.mountApp &amp;&amp; window.mountApp() --&gt;</code></pre>\n\n<h3>修改后的效果</h3>\n\n<p>修改后的代码在&nbsp;这里，访问地址在&nbsp;这里。（为了简便，我省去了处理兼容性的代码，即&nbsp;&lt;noscript&gt;&nbsp;和 preload polyfill）</p>\n\n<p>&nbsp;</p>\n\n<p>Performance 截图如下：（依然采用了 &quot;Fast 3G&quot; 的网络设置）</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1543059015113.png\" style=\"height:517px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>这次在&nbsp;render.js&nbsp;和&nbsp;index.css&nbsp;还在加载的时候页面已经呈现出骨架屏的内容，实际肉眼也可以观测到。在截图的情况下，骨架屏的展现大约持续了 300ms，占据整个网络请求的大约一半时间。</p>\n\n<p>&nbsp;</p>\n\n<p>至于说为什么不是 HTML 加载完成立马展现骨架屏，而是还要等大约 300ms 才展现，从图上看是浏览器 ParseHTML 所花费的时间，可能在 Dev Tools 打开的情况下计算资源有限，不过可优化空间已经不大。（可能简化骨架屏的结构能起一些作用吧）</p>\n\n<h3>多骨架屏的支持</h3>\n\n<p>一般来说一个站点的所有页面不太可能是同一种展示类型。例如说首页和内部页面就展示风格而言会很有区别，另外例如列表页和搜索页比较接近（可能都有列表展示），但和详情页（可能是商品，服务，个人信息，博客文章等等）就会很不相同。但单页应用的&nbsp;index.html&nbsp;只有一个，所有的变化都源自前端渲染框架在容器节点内部进行改变。所以直接将骨架屏注入到&nbsp;index.html中会导致所有的页面都用同一个骨架屏，那就很难达成&ldquo;和实际内容结构类似&rdquo;的目标了，骨架屏就退化为 Loading 了。</p>\n\n<p>&nbsp;</p>\n\n<p>为了要支持多种骨架屏，我们需要在&nbsp;index.html&nbsp;里面进行判断逻辑（独立于主体 JS 之外），具体来说：</p>\n\n<p>&nbsp;</p>\n\n<p>1、把所有种类的骨架屏的 HTML 和样式全部写入&nbsp;index.html</p>\n\n<p>2、在&nbsp;index.html&nbsp;底下新增内联的脚本&nbsp;&lt;script&gt;，根据当前路由判断应该展示哪一个骨架屏</p>\n\n<p>&nbsp;</p>\n\n<p>这样会导致&nbsp;index.html&nbsp;体积变大一点，但整体感觉依然是收益大于付出，我认为是值得的。</p>\n\n<h3>后记</h3>\n\n<p>这个优化点最早由我的前同事&nbsp;xiaop 同学&nbsp;在开发 Lavas 的 SPA 模板中发现并完成的，Issue 记录在此。我在他的基础上，做了一个分离 Lavas 和 Vue 环境并且更直白的例子，让截图也尽可能易于理解，方便阅读。在此非常感谢他的工作！</p>\n\n<p>&nbsp;</p>\n\n<p>另外骨架屏的编写我全部采用的是纯粹的手写 HTML 和 CSS，不止展现逻辑，包括开发流程也是独立于单页应用其他常规页面的。当然这可能给开发者带来一点不便，所以这时候需要推出 xiaop 同学的利器：vue-skeleton-webpack-plugin&nbsp;https://github.com/lavas-project/vue-skeleton-webpack-plugin。它的作用是把骨架屏本身也当成一个 Vue 组件，配上单独的路由规则来统一在 Vue 项目中的开发体验，最后使用 webpack 在打包构建的时候加以区分并注入，对于使用 Vue + webpack 开发的同学来说可以一试。</p>\n\n<h3>参考文章</h3>\n\n<ul>\n	<li>\n	<p><strong>让骨架屏更快渲染</strong>&nbsp;https://zhuanlan.zhihu.com/p/34550387- xiaop 同学原作</p>\n	</li>\n	<li>\n	<p><strong>Loading CSS without blocking render</strong>&nbsp;https://keithclark.co.uk/articles/loading-css-without-blocking-render/- 使用修改&nbsp;media&nbsp;的方式达成目的。</p>\n	</li>\n	<li>\n	<p><strong>filamentgroup/loadCSS&nbsp;</strong>https://github.com/filamentgroup/loadCSS&nbsp;- 同样使用修改&nbsp;rel&nbsp;的方式，并提供了 preload polyfill</p>\n	</li>\n</ul>\n, 参数6:ca928e8718654aa5a802e2f69277b137, 参数7:2c93dfab0e754006866f8ed486923a41, 参数8:0, 参数9:4, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:44704768e62f48bb9a04ae1cac453dd8, ','编辑博客',1,'2018-12-29 10:31:19','2018-12-29 10:31:19'),('4251fa1bbc9e4ca2bacb5ce6523513a0','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@4cee3ce6]], 参数2:cced8cef5ad8423494573ca2e337cd40, 参数3:WEB前端知识汇总, 参数4:WEB前端知识汇总, 参数5:<p>Web前端技术由<strong>html、css和 javascript</strong>三大部分构成，是一个庞大而复杂的技术体系，其复杂程度不低于任何一门后端语言。而我们在学习它的时候往往是先从某一个点切入，然后不断地接触和学习新的知识点，因此对于初学者很难理清楚整个体系的脉络结构。本文将对Web前端知识体系进行简单的梳理，对应的每个知识点点到为止，不作详细介绍。目的是帮助大家审查自己的知识结构是否完善，如有遗漏或不正确的地方，希望共勉。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051780753.png\" style=\"height:363px; width:648px\" /></p>\n\n<p><strong>一、JAVASCRIPT 篇</strong></p>\n\n<p><strong>0、基础语法</strong></p>\n\n<p>Javascript 基础语法包括：变量声明、数据类型、函数、控制语句、内置对象等。</p>\n\n<p>在ES5 中，变量声明有两种方式，分别是 &nbsp;var 和 function ，var<br />\n用于声明普通的变量，接收任意类型，function用于声明函数。另外，ES6 新增了 let、const、import 和 class<br />\n等四个命令，分别用以声明 普通变量、静态变量、模块 和 类 。</p>\n\n<p>JS数据类型共有六种，分别是 String、Number、Boolean、Null、Undefined 和 Object 等， 另外，ES6新增了<br />\nSymbol 类型。其中，Object 是引用类型，其他的都是原始类型(Primitive Type)。</p>\n\n<p>原始类型也称为基本类型或简单类型，因为其占据空间固定，是简单的数据段，为了便于提升变量查询速度，将其存储在栈(stack)中(按值访问)。为了便于操作这类数据，ECMAScript<br />\n提供了 3 个&nbsp;基本包装类型&nbsp;：Boolean、Number 和 String<br />\n。基本包装类型是一种特殊的引用类型，每当读取一个基本类型值的时候，JS内部就会创建一个对应的包装对象，从而可以调用一些方法来操作这些数据。</p>\n\n<p>引用类型由于其值的大小会改变，所以不能将其存放在栈中，否则会降低变量查询速度，因此其存储在堆(heap)中，存储在变量处的值是一个指针，指向存储对象的内存处(按址访问)，对于引用类型的值，可以为其添加属性和方法，也可以改变和删除其属性和方法；但基本类型不可以添加属性和方法。</p>\n\n<p>Javascript 可以通过 typeof 来判断原始数据类型，但不能判断引用类型，要知道引用类型的具体类型，需要通过 Object 原型上的<br />\ntoString 方法来判断。</p>\n\n<p>JS中的函数存在着三种角色：普通函数、构造函数、对象方法。同一个函数，调用方式不同，函数的作用不一样，所扮演的角色也不一样。直接调用时就是普通函数，通过new创建对象时就是构造函数，通过对象调用时就是方法。</p>\n\n<p>JS常用的内置对象有window、Date、Array、JSON、RegExp<br />\n等，window是浏览器在执行脚本时创建的一个全局对象，主要描述浏览器窗口相关的属性和状态，这个后面会讲到，Date 和 Array<br />\n使用场景最多，JSON主要用于对象的序列化和反序列化，还有一个作用就是实现对象的深拷贝。RegExp 即正则表达式，是处理字符串的利器。</p>\n\n<p><strong>1、函数原型链</strong></p>\n\n<p>JS是一种基于对象的语言，但在ES6 之前是不支持继承的，为了具备继承的能力，Javascript 在&nbsp;<strong>函数对象</strong><br />\n上建立了原型对象prototype，并以函数对象为主线，从上至下，在JS内部构建了一条&nbsp;<strong>原型链</strong>&nbsp;。原型链把一个个独立的对象联系在一起，Object<br />\n则是所有对象的祖宗，&nbsp;任何对象所建立的原型链最终都指向了Object，并以 Object 终结。 ****</p>\n\n<p>简单来说就是建立了变量查找机制，当访问一个对象的属性时，先查找对象本身是否存在，如果不存在就去该对象所在的原型连上去找，直到Object对象为止，如果都没有找到该属性才会返回undefined。因此，我们可以通过原型链来实现JS继承。</p>\n\n<p><strong>2、函数作用域</strong></p>\n\n<p>函数作用域就是变量在声明它们的函数体以及这个函数体嵌套的任意函数体内都是有定义的。因此，&nbsp;<strong>JS中没有块级作用域，只有函数作用域</strong><br />\n，这种设计导致JS中出现了&nbsp;<strong>变量提升</strong>&nbsp;的问题。简单来说就是，将变量声明提升到它所在作用域的最开始的部分，为了解决变量提升带来的副作用，ES6新增了<br />\nlet 命令来声明变量，let 所声明的变量只在 let 命令所在的代码块内有效，所以不存在变量提升问题。</p>\n\n<p><strong>3、this 指针</strong></p>\n\n<p>this 指针存在于函数中，用以标识函数运行时所处的上下文。函数的类型不同，this指向规则也不一样：对于普通函数，this<br />\n始终指向全局对象window；对于构造函数，this则指向新创建的对象；对于方法，this指向调用该方法的对象。另外，Function对象也提供了call、apply<br />\n和 bind 等方法来改变函数的 this 指向，其中，call 和 apply 主动执行函数，bind一般在事件回调中使用，而 call 和 apply<br />\n的区别只是参数的传递方式不同。</p>\n\n<p>如果往深的去理解，无论什么函数，this是否被改变， 本质上，this 均指向触发函数运行时的那个对象。而在函数运行时，this 的值是不能被改变的。</p>\n\n<p><strong>4、new 操作符</strong></p>\n\n<p>函数的创建有三种方式，即 显式声明、匿名定义 和 new Function()<br />\n。前面提到，JS中的函数即可以是函数，也可以是方法，还可以是构造函数。当使用new来创建对象时，该函数就是构造函数，JS将新对象的原型链指向了构造函数的原型对象，于是就在新对象和函数对象之间建立了一条原型链，通过新对象可以访问到函数对象原型prototype中的方法和属性。</p>\n\n<p><strong>5、闭包</strong></p>\n\n<p>通俗来讲，闭包是一个具有独立作用域的静态执行环境。和函数作用域不同的是，闭包的作用域是静态的，可以永久保存局部资源，而函数作用域只存在于运行时，函数执行结束后立即销毁。因此，闭包可以形成一个独立的执行过程，关于闭包更</p>\n\n<p><strong>6、单线程和异步队列</strong></p>\n\n<p>Javascript<br />\n是单线程语言，在浏览器中，当JS代码被加载时，浏览器会为其分配一个主线程来执行任务(函数)，主线程会形成一个全局执行环境，执行环境在栈中采用后进先出(LIFO)的顺序来执行代码块，以保证所有的函数能按照正确的顺序被执行。</p>\n\n<p>但在浏览器中，有一些任务是非常耗时的，比如ajax请求、定时器、事件等，为了保证非耗时任务不受影响，Javascript<br />\n在执行环境中维护了一个异步队列(也叫工作线程)，并将这些耗时任务放入队列中进行等待，这些任务的执行时机并不确定，只有当主线程的任务执行完成以后，主线程才会去检查异步队列中的任务是否需要开始执行。</p>\n\n<p>JS中的 setTimeout 和 setInterval 就是典型的异步操作，它们会被放入异步队列中等待，即使 setTimeout(0)<br />\n也不会被立即执行，需要等到当前同步任务结束后才会被执行。</p>\n\n<p><strong>7、异步通信 Ajax技术</strong></p>\n\n<p>Ajax是浏览器专门用来和服务器进行交互的异步通讯技术，其核心对象是XMLHttpRequest，通过该对象可以创建一个Ajax请求。Ajax请求是一个耗时的异步操作，当请求发出以后，Ajax<br />\n提供了两个状态位来描述请求在不同阶段的状态，这两个状态位分别是&nbsp;<strong>readyState</strong>&nbsp;和&nbsp;<strong>status</strong>&nbsp;，readyState 通过<br />\n5个状态码来描述一个请求的5个阶段：</p>\n\n<p>0 - 请求未发送，初始化阶段</p>\n\n<p>1 - 请求发送中，服务器还未收到请求</p>\n\n<p>2 - 请求发送成功，服务器已收到请求</p>\n\n<p>3 - 服务器处理完成，开始响应请求，传输数据</p>\n\n<p>4 - 客户端收到请求，并完成了数据下载，生成了响应对象</p>\n\n<p>status 用于描述服务端对请求处理的情况，200 表示正确响应了请求，404 表示服务器找不到资源，500 代表服务器内部异常等等。</p>\n\n<p>Ajax对象还可以设置一个timeout 值，代表超时时间，切记：timeout 只会影响<br />\nreadyState，而不会影响status，因为超时只会中断数据传输，但不会影响服务器的处理结果。 如果 timeout 设置的不合理，就会导致响应码<br />\nstatus 是200，但 response里却没有数据，这种情况就是服务器正确响应了请求，但数据的下载被超时中断了。</p>\n\n<p>为了防止XSS攻击，浏览器对Ajax请求做了限制，不允许Ajax 跨域请求服务器，只允许请求和当前地址同域的服务器资源。但不限制脚本和标签发送跨域请求，比如<br />\nscript 和 img 标签，因此可以利用脚本跨域能力来实现跨域请求，即JSONP 的原理。</p>\n\n<p>JSONP虽然可以解决跨域问题，但只能是get请求，并且没有有效的错误捕获机制，为了解决这个问题，XMLHttpRequest Level2 提出了<br />\nCORS 模型，即&nbsp;<strong>跨域资源共享，</strong>&nbsp;它不是一个新的API，而是一个标准规范，当浏览器发现该请求需要跨域时，就会自动在头信息中添加一个 Origin<br />\n字段，用以说明本次请求来自哪个源。服务器根据这个值，决定是否同意这次请求。&nbsp;</p>\n\n<p>随着移动端的快速发展，Web技术的应用场景正在变得越来越复杂，&nbsp;<strong>关注点分离</strong>&nbsp;原则在系统设计层面就显得越来越重要，而XMLHttpRequest 是<br />\nAjax 最古老的一个接口，因而不太符合现代化的系统设计理念。因此，浏览器提供了一个新的 Ajax 接口，即&nbsp;<strong>Fetch API</strong>&nbsp;，Fetch<br />\nAPI 是基于Promise 思想设计的，更符合关注点分离原则。</p>\n\n<p><strong>8、模块化</strong></p>\n\n<p>历史上，Javascript 规范一直没有模块(module)体系，即无法将一个大程序拆分成互相依赖的小文件，再用简单的方法拼装起来。在 ES6<br />\n之前，为了实现JS模块化编程，社区制定了一些模块加载方案，最主要有 CMD 和 AMD 两种，分别以commonjs 和 requirejs为代表。ES6<br />\n在语言标准的层面上，实现了模块化编程，其设计思想是，尽量静态化，使得编译时就能确定模块的依赖关系，即编译时加载，而CMD和AMD是在运行时确定依赖关系，即运行时加载。</p>\n\n<p><strong>9、Node.js</strong></p>\n\n<p>Node.js&nbsp;是一个基于 Chrome V8 引擎的 JavaScript<br />\n运行环境，它的运行不依赖于浏览器作为宿主环境，而是和服务端程序一样可以独立的运行，这使得JS编程第一次从客户端被带到了服务端，Node.js在服务端的优势是，它采用单线程和异步I/O模型，实现了一个高并发、高性能的运行时环境。相比传统的多线程模型，Node.js实现简单，并且可以减少资源开销。</p>\n\n<p><strong>10、ES6</strong></p>\n\n<p>ES6 是&nbsp;ECMAScript 6.0<br />\n的简写，即Javascript语言的下一代标准，已经在2015年6月正式发布了，它的目标是让JS能够方便的开发企业级大型应用程序，因此，ES6的一些规范正在逐渐向Java、C#等后端语言标准靠近。ES6<br />\n规范中，比较重大的变化有以下几个方面：</p>\n\n<p>新增 let、const 命令 来声明变量，和var 相比，let<br />\n声明的变量不存在变量提升问题，但没有改变JS弱类型的特点，依然可以接受任意类型变量的声明；const<br />\n声明的变量不允许在后续逻辑中改变，提高了JS语法的严谨性。</p>\n\n<p>新增解构赋值、rest语法、箭头函数，这些都是为了让代码看起来更简洁，而包装的语法糖。</p>\n\n<p>新增模块化，这是JS走向规范比较重要的一步，让前端更方便的实现工程化。</p>\n\n<p>新增类和继承的概念，配合模块化，JS也可以实现高复用、高扩展的系统架构。</p>\n\n<p>新增模板字符串功能，高效简洁，结束拼接字符串的时代。</p>\n\n<p>新增Promise对象，解决异步回调多层嵌套的问题。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、CSS 篇</strong></p>\n\n<p><strong>1、CSS选择器</strong></p>\n\n<p>CSS选择器即通过某种规则来匹配相应的标签，并为其设置CSS样式，常用的有类选择器、标签选择器、ID选择器、后代选择器、群组选择器、伪类选择器(before/after)、兄弟选择器(+~)、属性选择器等等。</p>\n\n<p><strong>2、CSS Reset</strong></p>\n\n<p>HTML<br />\n标签在不设置任何样式的情况下，也会有一个默认的CSS样式，而不同内核浏览器对于这个默认值的设置则不尽相同，这样可能会导致同一套代码在不同浏览器上的显示效果不一致，而出现兼容性问题。因此，在初始化时，需要对常用标签的样式进行初始化，使其默认样式统一，这就是CSS<br />\nReset ，即CSS样式重置，比如：*{margin:0,padding:0} 就是最简单CSS Reset， 关于CSS重置请参考：<br />\n<em>Neat.css</em></p>\n\n<p><strong>3、盒子布局</strong></p>\n\n<p>盒子模型是CSS比较重要的一个概念，也是CSS 布局的基石。<br />\n常见的盒子模型有块级盒子(block)和行内盒子(inline-block)，与盒子相关的几个属性有：margin、border、padding和content<br />\n等，这些属性的作用是设置盒子与盒子之间的关系以及盒子与内容之间的关系。其中，只有普通文档流中块级盒子的垂直外边距才会发生合并，而行内盒子、浮动盒子或绝对定位之间的外边距不会合并。另外，box-sizing<br />\n属性的设置会影响盒子width和height的计算。</p>\n\n<p><strong>4、浮动布局</strong></p>\n\n<p>设置元素的 float 属性值为 left 或<br />\nright，就能使该元素脱离普通文档流，向左或向右浮动。一般在做宫格布局时会用到，如果子元素全部设置为浮动，则父元素是塌陷的，这时就需要清除浮动，清除浮动的方法也很多，常用的方法是在元素末尾加空元素设置clear:both，<br />\n更高级一点的就给父容器设置before/after来模拟一个空元素，还可以直接设置overflow属性为auto/hidden来清除浮动。除浮动可以实现宫格布局，行内盒子(inline-block)和table也可以实现同样的效果。</p>\n\n<p><strong>5、定位布局</strong></p>\n\n<p>设置元素的position属性值为 relative/absolute/fixed，就可以使该元素脱离文档流，并以某种参照坐标进行偏移。其中，releave<br />\n是相对定位，它以自己原来的位置进行偏移，偏移后，原来的空间不会被其他元素占用；absolute<br />\n是绝对定位，它以离自己最近的定位父容器作为参照进行偏移；为了对某个元素进行定位，常用的方式就是设置父容器的poistion:relative，因为相对定位元素在不设置<br />\ntop 和 left 值时，不会对元素位置产生影响；fixed<br />\n即固定定位，它则以浏览器窗口为参照物，PC网页底部悬停的banner一般都可以通过fixed定位来实现，但fixed属性在移动端有兼容性问题，因此不推荐使用，可替代的方案是：绝对定位+内部滚动。</p>\n\n<p><strong>6、弹性布局</strong></p>\n\n<p>弹性布局即Flex布局，定义了flex的容器一个可伸缩容器，首先容器本身会根据容器中的元素动态设置自身大小；然后当Flex容器被应用一个大小时（width和height），将会自动调整容器中的元素适应新大小。Flex容器也可以设置伸缩比例和固定宽度，还可以设置容器中元素的排列方向（横向和纵向）和是否支持元素的自动换行。有了这个神器，做页面布局的可以方便很多了。注意，设为Flex布局以后，子元素的float、clear和vertical-align<br />\n属性将失效。</p>\n\n<p><strong>7、CSS3 动画</strong></p>\n\n<p>CSS3中规范引入了两种动画，分别是 transition 和 animation，transition<br />\n可以让元素的CSS属性值的变化在一段时间内平滑的过渡，形成动画效果，为了使元素的变换更加丰富多彩，CSS3还引入了transfrom<br />\n属性，它可以通过对元素进行 平移(translate)、旋转(rotate)、放大缩小(scale)、倾斜(skew)<br />\n等操作，来实现2D和3D变换效果。transiton 还有一个结束事件<br />\ntransitionEnd，该事件是在CSS完成过渡后触发，如果过渡在完成之前被移除，则不会触发transitionEnd 。</p>\n\n<p>animation 需要设置一个@keyframes，来定义元素以哪种形式进行变换，<br />\n然后再通过动画函数让这种变换平滑的进行，从而达到动画效果，动画可以被设置为永久循环演示。设置&nbsp;animation-play-state:paused<br />\n可以暂停动画，设置&nbsp;animation-fill-mode:forwards<br />\n可以让动画完成后定格在最后一帧。另外，还可以通过JS监听animation的开始、结束和重复播放时的状态，分别对应三个事件，即<br />\nanimationStart、animationEnd、animationIteration 。注意，当播放次数设置为1时，不会触发<br />\nanimationIteration 。</p>\n\n<p>和 transition相比，animation 设置动画效果更灵活更丰富，还有一个区别是：transition<br />\n只能通过主动改变元素的css值才能触发动画效果，而animation一旦被应用，就开始执行动画。另外，HTML5 还新增了一个动画API，即<br />\nrequestAnimationFrame，它通过JS来调用，并按照屏幕的绘制频率来改变元素的CSS属性，从而达到动画效果。</p>\n\n<p><strong>8、BFC</strong></p>\n\n<p>BFC是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面元素。比如：内部滚动就是一个BFC，当一个父容器的overflow-y设置为auto时，并且子容器的长度大于父容器时，就会出现内部滚动，无论内部的元素怎么滚动，都不会影响父容器以外的布局，这个父容器的渲染区域就叫BFC。满足下列条件之一就可触发BFC：</p>\n\n<p>根元素，即HTML元素</p>\n\n<p>float的值不为none</p>\n\n<p>overflow的值不为visible</p>\n\n<p>display的值为inline-block、table-cell、table-caption</p>\n\n<p>position的值为absolute或fixed</p>\n\n<p><strong>9、Sprite，Iconfont，@font-face</strong></p>\n\n<p>对于大型站点，为了减少http请求的次数，一般会将常用的小图标排到一个大图中，页面加载时只需请求一次网络，<br />\n然后在css中通过设置background-position来控制显示所需要的小图标，这就是Sprite图。</p>\n\n<p>Iconfont，即字体图标，就是将常用的图标转化为字体资源存在文件中，通过在CSS中引用该字体文件，然后可以直接用控制字体的css属性来设置图标的样式，字体图标的好处是节省网络请求、其大小不受屏幕分辨率的影响，并且可以任意修改图标的颜色。</p>\n\n<p>@font-face是CSS3中的一个模块，通过@font-face可以定义一种全新的字体，然后就可以通过css属性font-family来使用这个字体了，即使操作系统没有安装这种字体，网页上也会正常显示出来。</p>\n\n<p><strong>10、CSS Hack</strong></p>\n\n<p>早期，不同内核浏览器对CSS属性的解析存在着差异，导致显示效果不一致，比如 margin<br />\n属性在ie6中显示的距离会比其他浏览器中显示的距离宽2倍，也就是说margin-left:20px;在ie6中距左侧元素的实际显示距离是40px，而在非ie6的浏览器上显示正常。因此，如果要想让所有浏览器中都显示是20px的宽度，就需要在CSS样式中加入一些特殊的符号，让不同的浏览器识别不同的符号，以达到应用不同的CSS样式的目的，这种方式就是css<br />\nhack， 对于ie6中的margin应用hack就会变成这样：.el {margin-left:20px;_margin-left:10px}</p>\n\n<p>兼容各大浏览器的 css hack 如下：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051750949.png\" style=\"height:363px; width:800px\" /></p>\n\n<p><strong>三、HTML 篇</strong></p>\n\n<p><strong>1、BOM</strong></p>\n\n<p>BOM 是&nbsp;Browser Object Model<br />\n的缩写，即浏览器对象模型，当一个浏览器页面初始化时，会在内存创建一个全局的对象，用以描述当前窗口的属性和状态，这个全局对象被称为浏览器对象模型，即BOM。BOM的核心对象就是window，window<br />\n对象也是BOM的顶级对象，其中包含了浏览器的 6个核心模块：</p>\n\n<p><strong>document</strong>&nbsp;-<br />\n即文档对象，渲染引擎在解析HTML代码时，会为每一个元素生成对应的DOM对象，由于元素之间有层级关系，因此整个HTML代码解析完以后，会生成一个由不同节点组成的树形结构，俗称DOM树，document<br />\n用于描述DOM树的状态和属性，并提供了很多操作DOM的API。</p>\n\n<p><strong>frames</strong>&nbsp;- HTML 子框架，即在浏览器里嵌入另一个窗口，父框架和子框架拥有独立的作用域和上下文。</p>\n\n<p><strong>history</strong>&nbsp;- 以栈(FIFO)的形式保存着页面被访问的历史记录，页面前进即入栈，页面返回即出栈。</p>\n\n<p><strong>location</strong>&nbsp;-&nbsp;提供了当前窗口中加载的文档相关信息以及一些导航功能。</p>\n\n<p><strong>navigator</strong>&nbsp;-&nbsp;用来描述浏览器本身，包括浏览器的名称、版本、语言、系统平台、用户特性字符串等信息。</p>\n\n<p><strong>screen</strong>&nbsp;- 提供了浏览器显示屏幕的相关属性，比如显示屏幕的宽度和高度，可用宽度和高度。</p>\n\n<p><strong>2、DOM 系统</strong></p>\n\n<p>DOM 是 Document Object Model 的缩写，即 文档对象模型，是所有浏览器公共遵守的标准，DOM<br />\n将HTML和XML文档映射成一个由不同节点组成的树型结构，俗称DOM树。其核心对象是document，用于描述DOM树的状态和属性，并提供对应的DOM操作API。随着历史的发展，DOM<br />\n被划分为1级、2级、3级，共3个级别：</p>\n\n<p><strong>1级DOM</strong>&nbsp;- 在1998年10月份成为W3C的提议，由DOM核心与DOM<br />\nHTML两个模块组成。DOM核心能映射以XML为基础的文档结构，允许获取和操作文档的任意部分。DOM<br />\nHTML通过添加HTML专用的对象与函数对DOM核心进行了扩展。</p>\n\n<p><strong>2级DOM</strong>&nbsp;- 鉴于1级DOM仅以映射文档结构为目标，DOM<br />\n2级面向更为宽广。通过对原有DOM的扩展，2级DOM通过对象接口增加了对鼠标和用户界面事件（DHTML长期支持鼠标与用户界面事件）、范围、遍历（重复执行DOM文档）和层叠样式表（CSS）的支持。同时也对DOM<br />\n1的核心进行了扩展，从而可支持XML命名空间。</p>\n\n<p><strong>3级DOM</strong>&nbsp;-<br />\n通过引入统一方式载入和保存文档和文档验证方法对DOM进行进一步扩展，DOM3包含一个名为&ldquo;DOM载入与保存&rdquo;的新模块，DOM核心扩展后可支持XML1.0的所有内容，包括XML<br />\nInfoset、 XPath、和XML Base。</p>\n\n<p>浏览器对不同级别DOM的支持情况如下所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051729748.png\" style=\"height:128px; width:800px\" /></p>\n\n<p>从图中可以看出，移动端常用的 webkit 内核浏览器目前只支持DOM2，而不支持DOM3 。</p>\n\n<p><strong>3、事件系统</strong></p>\n\n<p>事件是用户与页面交互的基础，到目前为止，DOM事件从PC端的 鼠标事件(mouse) 发展到了 移动端的 触摸事件(touch) 和<br />\n手势事件(guesture)，touch事件描述了手指在屏幕操作的每一个细节，guesture 则是描述多手指操作时更为复杂的情况，总结如下：</p>\n\n<p>第一根手指放下，触发 touchstart，除此之外什么都不会发生</p>\n\n<p>手指滑动时，触发touchmove</p>\n\n<p>第二根手指放下，触发 gesturestart</p>\n\n<p>触发第二根手指的 touchstart</p>\n\n<p>立即触发&nbsp;gesturechange</p>\n\n<p>任意手指移动，持续触发 gesturechange</p>\n\n<p>第二根手指弹起时，触发 gestureend，以后将不会再触发 gesturechange</p>\n\n<p>触发第二根手指的 touchend</p>\n\n<p>触发touchstart (多根手指在屏幕上，提起一根，会刷新一次全局touch) _ ___</p>\n\n<p>弹起第一根手指，触发 touchend</p>\n\n<p>更多关于手势事件的介绍请参考：<br />\n<em>gesture事件处理复杂手势</em></p>\n\n<p>DOM2.0 模型将事件处理流程分为三个阶段，即&nbsp;<strong>事件捕获阶段</strong>&nbsp;、&nbsp;<strong>事件处理阶段</strong>&nbsp;、&nbsp;<strong>事件冒泡阶段，</strong>&nbsp;如图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051713349.png\" style=\"height:292px; width:656px\" /></p>\n\n<p><strong>事件捕获</strong>&nbsp;：当用户触发点击事件后，顶层对象document 就会发出一个事件流，从最外层的DOM节点向目标元素节点传递，最终到达目标元素。</p>\n\n<p><strong>事件处理</strong>&nbsp;：当到达目标元素之后，执行目标元素绑定的处理函数。如果没有绑定监听函数，则不做任何处理。</p>\n\n<p><strong>事件冒泡</strong>&nbsp;：事件流从目标元素开始，向最外层DOM节点传递，途中如果有节点绑定了事件处理函数，这些函数就会被执行。</p>\n\n<p>利用事件冒泡原理可以实现&nbsp;<strong>事件委托</strong><br />\n，所谓事件委托，就是在父元素上添加事件监听器，用以监听和处理子元素的事件，避免重复为子元素绑定相同的事件。当目标元素的事件被触发以后，这个事件就从目标元素开始，向最外层元素传递，最终冒泡到父元素上，父元素再通过event.target<br />\n获取到这个目标元素，这样做的好处是，父元素只需绑定一个事件监听，就可以对所有子元素的事件进行处理了，从而减少了不必要的事件绑定，对页面性能有一定的提升。</p>\n\n<p><strong>4、HTML解析过程</strong>&nbsp;****</p>\n\n<p>浏览器加载 html 文件以后，渲染引擎会从上往下，一步步来解析HTML标签，大致过程如下：</p>\n\n<p>用户输入网址，浏览器向服务器发出请求，服务器返回html文件；</p>\n\n<p>渲染引擎开始解析 html 标签，并将标签转化为DOM节点，生成 DOM树；</p>\n\n<p>如果head 标签中引用了外部css文件，则发出css文件请求，服务器返回该文件，该过程会阻塞后面的解析；</p>\n\n<p>如果引用了外部 js 文件，则发出 js 文件请求，服务器返回后立即执行该脚本，这个过程也会阻塞html的解析；</p>\n\n<p>引擎开始解析 body 里面的内容，如果标签里引用了css 样式，就需要解析刚才下载好的css文件，然后用css来设置标签的样式属性，并生成渲染树；</p>\n\n<p>如果 body 中的 img 标签引用了图片资源，则立即向服务器发出请求，此时引擎不会等待图片下载完毕，而是继续解析后面的标签；</p>\n\n<p>服务器返回图片文件，由于图片需要占用一定的空间，会影响到后面元素的排版，因此引擎需要重新渲染这部分内容；</p>\n\n<p>如果此时 js 脚本中运行了 style.display=&quot;none&quot;，布局被改变，引擎也需要重新渲染这部分代码；</p>\n\n<p>直到 html 结束标签为止，页面解析完毕。</p>\n\n<p><strong>5、重绘 和 回流</strong></p>\n\n<p>当渲染树中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建。这就称为回流。比如上面的img文件加载完成后就会引起回流，每个页面至少需要一次回流，就是在页面第一次加载的时候。</p>\n\n<p>当渲染树中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如 background-color。则就叫称为重绘。</p>\n\n<p>从上面可以看出，回流必将引起重绘，而重绘不一定会引起回流。会引起重绘和回流的操作如下：</p>\n\n<p>添加、删除元素(回流+重绘)</p>\n\n<p>隐藏元素，display:none(回流+重绘)，visibility:hidden(只重绘，不回流)</p>\n\n<p>移动元素，比如改变top,left的值，或者移动元素到另外一个父元素中。(重绘+回流)</p>\n\n<p>对style的操作(对不同的属性操作，影响不一样)</p>\n\n<p>还有一种是用户的操作，比如改变浏览器大小，改变浏览器的字体大小等(回流+重绘)</p>\n\n<p>另外，transform<br />\n操作不会引起重绘和回流，是一种高效率的渲染。这是因为transform属于合成属性，对合成属性进行transition/animation<br />\n动画时将会创建一个合成层，这使得动画元素在一个独立的层中进行渲染，当元素的内容没有发生改变，就没必要进行重绘，浏览器会通过重新复合来创建动画帧。</p>\n\n<p><strong>6、本地存储</strong></p>\n\n<p>本地存储最原始的方式就是 cookie,cookie 是存放在本地浏览器的一段文本，数据以键值对的形式保存，可以设置过期时间。 但是 cookie<br />\n不适合大量数据的存储，因为每请求一次页面，cookie 都会发送给服务器，这使得 cookie<br />\n速度很慢而且效率也不高。因此cookie的大小被限制为4k左右(不同浏览器可能不同,分HOST)，如下所示：</p>\n\n<p>Firefox和Safari允许cookie多达4097个字节，包括名(name)、值(value) 和 等号。</p>\n\n<p>Opera允许cookie多达4096个字节，包括：名(name)、值(value)&nbsp;和 等号。</p>\n\n<p>Internet Explorer允许cookie多达4095个字节，包括：名(name)、值(value)&nbsp;和 等号。</p>\n\n<p><strong>在所有浏览器中，任何cookie大小超过限制都被忽略，且永远不会被设置。</strong></p>\n\n<p>html5 提供了两种在客户端存储数据的新方法：localStorage 和 sessionStorage, 它们都是以key/value<br />\n的形式来存储数据，前者是永久存储，后者的存储期限仅限于浏览器会话(session)，即当浏览器窗口关闭后，sessionStorage中的数据被清除。</p>\n\n<p>localStorage的存储空间大约5M左右(不同浏览器可能不同，分<br />\nHOST)，这个相当于一个5M大小的前端数据库，相比于cookie，可以节约带宽，但localStorage在浏览器隐私模式下是不可读取的，当存储数据超过了localStorage<br />\n的存储空间后会抛出异常。</p>\n\n<p>此外，H5还提供了逆天的websql和<br />\nindexedDB，允许前端以关系型数据库的方式来存储本地数据，相对来说，这个功能目前应用的场景比较少，此处不作介绍。</p>\n\n<p><strong>7、浏览器缓存机制</strong></p>\n\n<p>浏览器缓存机制是指通过 HTTP 协议头里的 Cache-Control (或 Expires) 和 Last-Modified (或 Etag)<br />\n等字段来控制文件缓存的机制。</p>\n\n<p>Cache-Control 用于控制文件在本地缓存有效时长。最常见的，比如服务器回包：Cache-Control:max-age=600<br />\n表示文件在本地应该缓存，且有效时长是600秒 (从发出请求算起)。在接下来600秒内，如果有请求这个资源，浏览器不会发出 HTTP<br />\n请求，而是直接使用本地缓存的文件。</p>\n\n<p>Last-Modified 是标识文件在服务器上的最新更新时间。下次请求时，如果文件缓存过期，浏览器通过 If-Modified-Since<br />\n字段带上这个时间，发送给服务器，由服务器比较时间戳来判断文件是否有修改。如果没有修改，服务器返回304告诉浏览器继续使用缓存；如果有修改，则返回200，同时返回最新的文件。</p>\n\n<p>Cache-Control 通常与 Last-Modified 一起使用。一个用于控制缓存有效时间，一个在缓存失效后，向服务查询是否有更新。</p>\n\n<p>Cache-Control 还有一个同功能的字段：Expires。Expires 的值一个绝对的时间点，如：Expires: Thu, 10 Nov<br />\n2015 08:45:11 GMT，表示在这个时间点之前，缓存都是有效的。</p>\n\n<p>Expires 是 HTTP1.0 标准中的字段，Cache-Control 是 HTTP1.1<br />\n标准中新加的字段，功能一样，都是控制缓存的有效时间。当这两个字段同时出现时，Cache-Control 是高优化级的。</p>\n\n<p>Etag 也是和 Last-Modified 一样，对文件进行标识的字段。不同的是，Etag<br />\n的取值是一个对文件进行标识的特征字串。在向服务器查询文件是否有更新时，浏览器通过 If-None-Match<br />\n字段把特征字串发送给服务器，由服务器和文件最新特征字串进行匹配，来判断文件是否有更新。没有更新回包304，有更新回包200。Etag 和<br />\nLast-Modified 可根据需求使用一个或两个同时使用。两个同时使用时，只要满足基中一个条件，就认为文件没有更新。</p>\n\n<p>另外有两种特殊的情况：</p>\n\n<p>手动刷新页面(F5)，浏览器会直接认为缓存已经过期(可能缓存还没有过期)，在请求中加上字段：Cache-Control:max-age=0，发包向服务器查询是否有文件是否有更新。</p>\n\n<p>强制刷新页面(Ctrl+F5)，浏览器会直接忽略本地的缓存(有缓存也会认为本地没有缓存)，在请求中加上字段：Cache-Control:no-cache<br />\n(或 Pragma:no-cache)，发包向服务重新拉取文件。</p>\n\n<p><strong>8、History</strong></p>\n\n<p>用户访问网页的历史记录通常会被保存在一个类似于栈的对象中，即history对象，点击返回就出栈，跳下一页就入栈。 它提供了以下方法来操作页面的前进和后退：</p>\n\n<p>window.history.back( ) &nbsp;返回到上一个页面</p>\n\n<p>window.history.forward( ) &nbsp;进入到下一个页面</p>\n\n<p>window.history.go( [delta] ) &nbsp;跳转到指定页面</p>\n\n<p>HTML5 对History Api 进行了增强，新增了两个Api 和一个事件，分别是pushState、replaceState 和<br />\nonpopstate：</p>\n\n<p>pushState是往history对象里添加一个新的历史记录，即压栈。</p>\n\n<p>replaceState 是替换history对象中的当前历史记录。</p>\n\n<p>当点击浏览器后退按钮或 js调用history.back 都会触发 onpopstate 事件。</p>\n\n<p>与其类似的还有一个事件：onhashchange，onhashchange是老API，浏览器支持度高，本来是用来监听hash变化的，但可以被利用来做客户端前进和后退事件的监听，而onpopstate是专门用来监听浏览器前进后退的，不仅可以支持hash，非hash的同源<br />\nurl 也支持。</p>\n\n<p><strong>9、HTML5离线缓存</strong></p>\n\n<p>HTML5离线缓存又叫Application<br />\nCache，是从浏览器的缓存中分出来的一块缓存区，如果要在这个缓存中保存数据，可以使用一个描述文件（manifest file），列出要下载和缓存的资源。</p>\n\n<p>manifest 文件是简单的文本文件，它告知浏览器被缓存的内容（以及不缓存的内容）。manifest 文件可分为三个部分：</p>\n\n<p>-&nbsp;CACHE MANIFEST&nbsp;- 在此标题下列出的文件将在首次下载后进行缓存</p>\n\n<p>-&nbsp;NETWORK&nbsp;- 在此标题下列出的文件需要与服务器的连接，且不会被缓存</p>\n\n<p>-&nbsp;FALLBACK&nbsp;- 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）</p>\n\n<p>离线缓存为应用带来三个优势：</p>\n\n<p>离线浏览 - 用户可在应用离线时使用它们</p>\n\n<p>速度 - 已缓存资源加载得更快</p>\n\n<p>减少服务器负载 - 浏览器将只从服务器下载更新过或更改过的资源。</p>\n\n<p><strong>10、Web语义化 和 SEO</strong></p>\n\n<p>Web语义化是指使用语义恰当的标签，使页面有良好的结构，页面元素有含义，能够让人和搜索引擎都容易理解。</p>\n\n<p>SEO是指在了解搜索引擎自然排名机制的基础之上，对网站进行内部及外部的调整优化，改进网站在搜索引擎中关键词的自然排名，获得更多的展现量，吸引更多目标客户点击访问网站，从而达到互联网营销及品牌建设的目标。</p>\n\n<p>搜索引擎通过爬虫技术获取的页面就是由一堆 html 标签组成的代码，人可以通过可视化的方式来判断页面上哪些内容是重点，而机器做不到。<br />\n但搜索引擎会根据标签的含义来判断内容的权重，因此，在合适的位置使用恰当的标签，使整个页面的语义明确，结构清晰，搜索引擎才能正确识别页面中的重要内容，并予以较高的权值。比如h1~h6这几个标签在SEO中的权值非常高，用它们作页面的标题就是一个简单的SEO优化。</p>\n, 参数6:a9a747d944c24845815356f72723ef8e, 参数7:ca28ffc94ea94fbda5571e0b242021e2, 参数8:0, 参数9:0, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:b936cfd2bf694d92a056170f821b5859, ','编辑博客',1,'2018-12-29 10:50:43','2018-12-29 10:50:43'),('475d978f3ffb4dd09fda813753a73dfa','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blogSort/add','POST','com.moxi.mogublog.admin.restapi.BlogSortRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:技术新闻, 参数3:发现世界的每一天, ','增加博客分类',1,'2018-12-29 10:42:11','2018-12-29 10:42:11'),('5f12e9d2e715457b812c0f72423c96e3','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/system/editMe','POST','com.moxi.mogublog.admin.restapi.SystemRestApi','editMe','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@51af8501]], 参数2:com.moxi.mogublog.xo.entity.Admin@373edec6, ','编辑我的信息',1,'2018-12-29 11:02:16','2018-12-29 11:02:16'),('66c5ec34668c4587a525bb5c22de3395','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blogSort/add','POST','com.moxi.mogublog.admin.restapi.BlogSortRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:前端开发, 参数3:前端开发专题, ','增加博客分类',1,'2018-12-29 10:35:58','2018-12-29 10:35:58'),('6bdfb953864d4ff08584d7d01b1c258b','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/picture/add','POST','com.moxi.mogublog.admin.restapi.PictureRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@2a46efa7]], 参数2:e79e4375ce5b4aa6ad48027de6cb8af2,, 参数3:0927c1e18a8c4677b1cce28c17bf0382, ','增加图片',1,'2018-12-30 12:37:05','2018-12-30 12:37:05'),('7eb94048aba8494abceffe9447eeadf8','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:208692b2a7a242f4942993abb8eebf8b, 参数3:哥们，消息中间件在你们项目里是如何落地的？, 参数4:哥们，消息中间件在你们项目里是如何落地的？, 参数5:<p>来源：石杉的架构笔记</p>\n\n<h1><strong><strong>一、前情回顾</strong></strong></h1>\n\n<p>之前给大家聊了一下，面试时如果遇到消息中间件这个话题，面试官上来可能问的两个问题：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>你们的系统架构中为什么要引入消息中间件？</p>\n	</li>\n	<li>\n	<p>系统架构中引入消息中间件有什么缺点？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>关于这两个问题的回答，可以参见之前的两篇文章：</p>\n\n<ul>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件？</a>》</p>\n	</li>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=bcdb3ee0332a440994216682cf850ed6\" target=\"_blank\">哥们，那你说说系统架构中引入消息中间件有什么缺点？</a>》</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>在问完这两个问题之后，不同风格的面试官可能会展开不同的发问。</p>\n\n<p>&nbsp;</p>\n\n<p>针对那种工作年限比较长的资深的同学，可能会开始就候选人所在公司使用的消息中间件，深入里面的技术细节，比如让你聊聊RocketMQ的架构原理和核心源码？</p>\n\n<p>&nbsp;</p>\n\n<p>但是另外一种面试风格，会先从你们的项目和业务入手进行考察，比如像下面这样：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>消息中间件在你们生产项目里具体是哪个业务场景下落地的？</p>\n	</li>\n	<li>\n	<p>这个业务场景有什么技术挑战？</p>\n	</li>\n	<li>\n	<p>为什么必须要在这个业务场景里用消息中间件技术？</p>\n	</li>\n	<li>\n	<p>具体使用消息中间件的时候是怎么来用的？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>好！这篇文章，咱们从第二种风格来聊聊。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>二、业务场景介绍</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>我们会落地到某个具体业务系统的某个场景下，看看如何使用消息中间件，然后其效果是什么。</p>\n\n<p>&nbsp;</p>\n\n<p>业务场景的话，咱们就用大家都很熟悉的<strong>电商业务</strong>为例，这里为了便于理解，对其做了一定的抽象和简化。</p>\n\n<p>&nbsp;</p>\n\n<p>大家还是来考虑一个下订单的业务流程，比如你下个订单，此时需要干几件事情：</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>更新订单状态为&ldquo;待发货&rdquo;（耗时20ms）</p>\n	</li>\n	<li>\n	<p>扣减商品库存（耗时100ms）</p>\n	</li>\n	<li>\n	<p>增加会员积分（耗时80ms）</p>\n	</li>\n	<li>\n	<p>附赠优惠券（耗时50ms）</p>\n	</li>\n	<li>\n	<p>仓储调度发货（耗时几十秒）。</p>\n	</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>说明一下：上述环节，为了便于大家理解，做了简化。实际真正复杂的电商系统里，整体环节和业务流程会比这个复杂很多倍，而且耗时也绝对不是上面那么简单的。</p>\n\n<p>&nbsp;</p>\n\n<p>老规矩！我们还是通过一张手绘图，来看看这整个的业务流程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144696893.png\" style=\"height:400px; width:675px\" /></p>\n\n<p>如上图，这个下订单的业务流程中：</p>\n\n<p>更新订单状态（20ms） + &nbsp;扣减商品库存（100ms） + &nbsp;增加会员积分（80ms） + &nbsp;附赠优惠券（50ms） = &nbsp;250ms。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，仅仅是这4个流程的话，也就200多毫秒的耗时。</p>\n\n<p>&nbsp;</p>\n\n<p>200多毫秒的耗时，对用户下单体验来说是非常快速的，几乎就是一瞬间就完成了，不会感到过多的停顿，也就是一下子就可以看到自己下单成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是，如果加上那个调度仓储发货呢？</p>\n\n<p>&nbsp;</p>\n\n<p>那个环节需要读取大量的数据、使用多仓库/多货位的调度算法、还要跟C/S架构的仓储系统进行网络通信，因此我们这里假设这个环节可能会耗时数十秒。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦加上那个调度仓储发货的环节到这个下单流程里，就可能导致用户要等页面卡顿几十秒后才会看到下单成功的提示，这个用户体验就相当的差了。</p>\n\n<p>&nbsp;</p>\n\n<p>按照之前一篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件呢？</a>》的说法。对于这种场景，完全适合使用消息中间件来进行异步化调用。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，订单服务对仓储调度发货，仅仅是发送一个消息到MQ里，然后仓储服务消费消息之后再慢慢的执行调度算法，然后分配商品发货任务给对应的仓库即可。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以把耗时几十秒的仓储调度发货的环节，从下单流程里摘除出去了。进而保证下单流程就仅仅是耗时200多毫秒而已。</p>\n\n<p>&nbsp;</p>\n\n<p>至于那个耗时几十秒的仓储调度发货环节，我们通过异步的方式慢慢执行即可，不会影响用户下单的体验。</p>\n\n<p>&nbsp;</p>\n\n<p>以上过程，我们同样来一张图，大家直观的感受一下：</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144724851.png\" style=\"height:408px; width:690px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>三、初步落地</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>好！接下来我们就假设大家在实际生产中还没用过消息中间件，咱们从0开始，看看如何落地？</p>\n\n<p>&nbsp;</p>\n\n<p>对于已经在生产中使用过消息中间件的小伙伴，不妨也看看，权当复习，温故知新！</p>\n\n<p>&nbsp;</p>\n\n<p>我们以RabbitMQ为例，假如你用的消息中间件是RabbitMQ，那么我们对这个消息中间件应该如何安装和部署呢？</p>\n\n<p>&nbsp;</p>\n\n<p>很简单，RabbitMQ的官方文档里提供了非常详细的安装部署步骤，你可以在自己的笔记本电脑本地安装，也可以在公司的服务器上部署。</p>\n\n<p>&nbsp;</p>\n\n<p>现在假设你已经参考了官方文档并安装完成，那么接下来在代码层面应该怎么来引入RabbitMQ以及在系统里实现收发消息呢？</p>\n\n<p>&nbsp;</p>\n\n<p>下面通过一些HelloWorld级别的代码和一些简单的示例图，给大家演示一下RabbitMQ是如何收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>对于很多在实际生产中使用过MQ的同学，这些代码可能对实际生产中使用过MQ的同学，显得太简单了。</p>\n\n<p>&nbsp;</p>\n\n<p>不过考虑到很多初学者可能连用都没有用过MQ，甚至是才听说消息中间件不久，所以笔者认为这些demo代码以及手工绘图，还是很有必要。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144746252.png\" style=\"height:412px; width:675px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144758533.png\" style=\"height:489px; width:676px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144769467.png\" style=\"height:629px; width:677px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144782745.png\" style=\"height:171px; width:678px\" /></p>\n\n<p>好！看完了代码，这个时候，我们可以通过一张图来想象一下两个服务之间的通信。<br />\n&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>订单服务你可以启动多个，不同的订单服务都可以往一个RabbitMQ的queue里推送消息。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务你也可以启动多个，多个仓储服务会采用<strong>round-robin</strong>的轮询算法，每个服务实例都可以从RabbitMQ queue里消费到一部分的消息。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144796282.png\" style=\"height:349px; width:623px\" /></p>\n\n<p>上面的图里，订单服务在MQ专业术语中叫做<strong>&ldquo;生产者&rdquo;</strong>，英文是&ldquo;Producer&rdquo;，意思就是这个服务是专门负责生产消息投递到MQ的。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务在MQ专业术语中叫做<strong>&ldquo;消费者&rdquo;</strong>，英文是&ldquo;Consumer&rdquo;，意思就是这个服务专门是负责从MQ消费消息然后处理的。</p>\n\n<p>&nbsp;</p>\n\n<p>这个时候，这套异步通信的架构就可以跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>好了，到目前为止，虽然这个代码还存在不少问题，但是没关系，大体上我们已经给一些不太熟悉MQ技术的同学，从一个比较形象易于理解简化后的电商业务场景出发，通过HelloWorld级别的示例代码和手工绘图，将MQ这个技术落地跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>更进一步，各位同学完全可以参照这个文章里的案例，思考一下：自己负责的项目里，有没有类似的业务场景可以使用MQ的？</p>\n\n<p>&nbsp;</p>\n\n<p>然后想办法在自己的项目里落地使用MQ的技术来做一下异步化，提升核心流程的性能。</p>\n\n<p>&nbsp;</p>\n\n<p>这样未来在跳槽面试的时候，才可以做到游刃有余，有自己的一套东西可以说。</p>\n\n<p><strong>END</strong></p>\n, 参数6:1c76b9848f5f4d71a5e88b20dbaf38f4, 参数7:e60df954efcd47c48463a504bb70bbe9, 参数8:0, 参数9:1, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:52b6106a19524aa8ab5543342e5152b9, ','编辑博客',1,'2018-12-30 12:42:04','2018-12-30 12:42:04'),('859b0b0257754abe8a106036304a5f26','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/add','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:简单实现MySQL数据库的日志审计, 参数3:简单实现MySQL数据库的日志审计, 参数4:<h2>来源：https://www.freebuf.com/articles/es/192062.html</h2>\n\n<p>&nbsp;</p>\n\n<h2>0&times;0 背景&nbsp;</h2>\n\n<p><strong>由于MySQL社区版没有自带的审计功能或插件，对于等级保护当中对数据库管理的要求的就存在一定的不满足情况的，抛开条条框框不说数据库的日志是值得研究的，通过收集数据库的日志到企业SOC平台便于安全事件的溯源与故障分析，配合目前的UEBA技术能够轻松发现很多恶意事件。&nbsp;</strong></p>\n\n<p>根据等级保护内容第四章&ldquo;数据库管理系统安全技术要求&rdquo;中&nbsp;第四节&ldquo;数据库安全审计&rdquo;中明确提出数据库管理系统的安全审计应：</p>\n\n<blockquote>\n<p>1. 建立独立的安全审计系统；</p>\n\n<p>2. 定义与数据库安全相关的审计事件；</p>\n\n<p>3. 设置专门的安全审计员；</p>\n\n<p>4. 设置专门用于存储数据库系统审计数据的安全审计库；</p>\n\n<p>5. 提供适用于数据库系统的安全审计设置、分析和查阅的工具。&nbsp;</p>\n</blockquote>\n\n<h2>0&times;1 部署插件</h2>\n\n<p><strong>&nbsp;</strong>为了节省购买一些安全设备的费用，可以尝试使用一些开源的日志审计插件。Mysql-audit是macfee公司基于percona开发的MySQL的SQL审计插件。</p>\n\n<blockquote>\n<p>源码地址如下：<a href=\"https://github.com/mcafee/mysql-audit\">https://github.com/mcafee/mysql-audit</a></p>\n</blockquote>\n\n<p>首先确定当前mysql的版本去官网下载与之相对应的插件：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片1.png\" src=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片2.png\" src=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png!small\" style=\"width:690px\" /></a></p>\n\n<p>&nbsp;解压插件后需要确认mysql插件的安装目录：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片3.png\" src=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片4.png\" src=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png!small\" style=\"width:566px\" /></a></p>\n\n<p>将解压出来的插件libaudit_plugin.so复制到插件的目录下：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片5.png\" src=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png!small\" style=\"width:690px\" /></a></p>\n\n<p>使用mysql的函数install plugin导入此插件后通过show plugin确认是否导入成功。</p>\n\n<p>主要命令如下：</p>\n\n<pre>\n<code>install plugin audit soname ‘libaudit_plugin.so’</code></pre>\n\n<p><img alt=\"图片6.png\" src=\"https://image.3001.net/images/20181216/1544951819_5c16180b1c8a8.png!small\" style=\"width:690px\" /><img alt=\"图片7.png\" src=\"https://image.3001.net/images/20181216/1544951820_5c16180cb659a.png!small\" style=\"width:690px\" /></p>\n\n<p>安装完成之后并不会立马开始审计内容，需要定义一些参数。</p>\n\n<p>Audit_json_file这个参数要整体控制是否开启审计功能使用命令：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Set variables audit_json_file=on</code></pre>\n\n<p>&nbsp; 开启审计功能：</p>\n\n<p><img alt=\"图片8.png\" src=\"https://image.3001.net/images/20181216/1544951841_5c1618210a29a.png!small\" style=\"width:580px\" /></p>\n\n<p>审计后的记录名可以通过查询变量audit_json_log_file获取：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Show variables like “audit_json_log_file”</code></pre>\n\n<p>默认的审计记录格式如下：</p>\n\n<p><img alt=\"图片9.png\" src=\"https://image.3001.net/images/20181216/1544951858_5c16183262f9c.png!small\" style=\"width:690px\" /></p>\n\n<p>Json格式如下：</p>\n\n<p><img alt=\"图片10.png\" src=\"https://image.3001.net/images/20181216/1544951874_5c1618427bc3e.png!small\" style=\"width:690px\" /></p>\n\n<p>同时插件支持一些自定义的参数与命令，包括白名单与黑名单的功能。</p>\n\n<blockquote>\n<p>Audit_whitelist_users: 不审计user用户的所有命令</p>\n\n<p>Aduit_record_cmds: 需要进行审计的命令种类</p>\n</blockquote>\n\n<p><img alt=\"图片11.png\" src=\"https://image.3001.net/images/20181216/1544951883_5c16184b68f60.png!small\" style=\"width:601px\" /></p>\n\n<p>更多的参数配置项目可以参考官方给的手册：</p>\n\n<blockquote>\n<p><a href=\"https://github.com/mcafee/mysql-audit/wiki/Configuration\">https://github.com/mcafee/mysql-audit/wiki/Configuration</a></p>\n</blockquote>\n\n<p><img alt=\"图片12.png\" src=\"https://image.3001.net/images/20181216/1544951898_5c16185aeaa2e.png!small\" style=\"width:690px\" /></p>\n\n<h2>0&times;2 总结</h2>\n\n<p>1. 通过插件的方式可以实现mysql日志的审计通过ELK的框架实现日志的保存与分析，再通过后期写一些脚本分析可以实现安全检测与业务分析等多个功能，关键是零成本特别适合那些&rdquo;一个人的安全部&rdquo;有此需求的同行们.&nbsp;</p>\n\n<p>2. 根据一些测试数据表示，插件对性能的影响是比较大的约有20%左右的消耗需要结合具体的业务情况进行评估。</p>\n, 参数5:8d5ce3e0c0784b95adb7f9e7b76dca93, 参数6:0, 参数7:0, 参数8:0, 参数9:1, 参数10:陌溪_, 参数11:https://www.freebuf.com/articles/es/192062.html, 参数12:093d8bdd01c84890a928e923d5c235fe, 参数13:e06331bc9fff4a7186439f2a34c199af, ','增加博客',1,'2018-12-29 10:27:31','2018-12-29 10:27:31'),('8751d61ff10e4c4bb3af1f1063ab70cd','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/add','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:哥们，消息中间件在你们项目里是如何落地的？, 参数3:哥们，消息中间件在你们项目里是如何落地的？, 参数4:<p>来源：石杉的架构笔记</p>\n\n<h1><strong><strong>一、前情回顾</strong></strong></h1>\n\n<p>之前给大家聊了一下，面试时如果遇到消息中间件这个话题，面试官上来可能问的两个问题：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>你们的系统架构中为什么要引入消息中间件？</p>\n	</li>\n	<li>\n	<p>系统架构中引入消息中间件有什么缺点？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>关于这两个问题的回答，可以参见之前的两篇文章：</p>\n\n<ul>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件？</a>》</p>\n	</li>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=bcdb3ee0332a440994216682cf850ed6\" target=\"_blank\">哥们，那你说说系统架构中引入消息中间件有什么缺点？</a>》</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>在问完这两个问题之后，不同风格的面试官可能会展开不同的发问。</p>\n\n<p>&nbsp;</p>\n\n<p>针对那种工作年限比较长的资深的同学，可能会开始就候选人所在公司使用的消息中间件，深入里面的技术细节，比如让你聊聊RocketMQ的架构原理和核心源码？</p>\n\n<p>&nbsp;</p>\n\n<p>但是另外一种面试风格，会先从你们的项目和业务入手进行考察，比如像下面这样：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>消息中间件在你们生产项目里具体是哪个业务场景下落地的？</p>\n	</li>\n	<li>\n	<p>这个业务场景有什么技术挑战？</p>\n	</li>\n	<li>\n	<p>为什么必须要在这个业务场景里用消息中间件技术？</p>\n	</li>\n	<li>\n	<p>具体使用消息中间件的时候是怎么来用的？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>好！这篇文章，咱们从第二种风格来聊聊。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>二、业务场景介绍</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>我们会落地到某个具体业务系统的某个场景下，看看如何使用消息中间件，然后其效果是什么。</p>\n\n<p>&nbsp;</p>\n\n<p>业务场景的话，咱们就用大家都很熟悉的<strong>电商业务</strong>为例，这里为了便于理解，对其做了一定的抽象和简化。</p>\n\n<p>&nbsp;</p>\n\n<p>大家还是来考虑一个下订单的业务流程，比如你下个订单，此时需要干几件事情：</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>更新订单状态为&ldquo;待发货&rdquo;（耗时20ms）</p>\n	</li>\n	<li>\n	<p>扣减商品库存（耗时100ms）</p>\n	</li>\n	<li>\n	<p>增加会员积分（耗时80ms）</p>\n	</li>\n	<li>\n	<p>附赠优惠券（耗时50ms）</p>\n	</li>\n	<li>\n	<p>仓储调度发货（耗时几十秒）。</p>\n	</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>说明一下：上述环节，为了便于大家理解，做了简化。实际真正复杂的电商系统里，整体环节和业务流程会比这个复杂很多倍，而且耗时也绝对不是上面那么简单的。</p>\n\n<p>&nbsp;</p>\n\n<p>老规矩！我们还是通过一张手绘图，来看看这整个的业务流程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144696893.png\" style=\"height:400px; width:675px\" /></p>\n\n<p>如上图，这个下订单的业务流程中：</p>\n\n<p>更新订单状态（20ms） + &nbsp;扣减商品库存（100ms） + &nbsp;增加会员积分（80ms） + &nbsp;附赠优惠券（50ms） = &nbsp;250ms。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，仅仅是这4个流程的话，也就200多毫秒的耗时。</p>\n\n<p>&nbsp;</p>\n\n<p>200多毫秒的耗时，对用户下单体验来说是非常快速的，几乎就是一瞬间就完成了，不会感到过多的停顿，也就是一下子就可以看到自己下单成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是，如果加上那个调度仓储发货呢？</p>\n\n<p>&nbsp;</p>\n\n<p>那个环节需要读取大量的数据、使用多仓库/多货位的调度算法、还要跟C/S架构的仓储系统进行网络通信，因此我们这里假设这个环节可能会耗时数十秒。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦加上那个调度仓储发货的环节到这个下单流程里，就可能导致用户要等页面卡顿几十秒后才会看到下单成功的提示，这个用户体验就相当的差了。</p>\n\n<p>&nbsp;</p>\n\n<p>按照之前一篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件呢？</a>》的说法。对于这种场景，完全适合使用消息中间件来进行异步化调用。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，订单服务对仓储调度发货，仅仅是发送一个消息到MQ里，然后仓储服务消费消息之后再慢慢的执行调度算法，然后分配商品发货任务给对应的仓库即可。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以把耗时几十秒的仓储调度发货的环节，从下单流程里摘除出去了。进而保证下单流程就仅仅是耗时200多毫秒而已。</p>\n\n<p>&nbsp;</p>\n\n<p>至于那个耗时几十秒的仓储调度发货环节，我们通过异步的方式慢慢执行即可，不会影响用户下单的体验。</p>\n\n<p>&nbsp;</p>\n\n<p>以上过程，我们同样来一张图，大家直观的感受一下：</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144724851.png\" style=\"height:408px; width:690px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>三、初步落地</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>好！接下来我们就假设大家在实际生产中还没用过消息中间件，咱们从0开始，看看如何落地？</p>\n\n<p>&nbsp;</p>\n\n<p>对于已经在生产中使用过消息中间件的小伙伴，不妨也看看，权当复习，温故知新！</p>\n\n<p>&nbsp;</p>\n\n<p>我们以RabbitMQ为例，假如你用的消息中间件是RabbitMQ，那么我们对这个消息中间件应该如何安装和部署呢？</p>\n\n<p>&nbsp;</p>\n\n<p>很简单，RabbitMQ的官方文档里提供了非常详细的安装部署步骤，你可以在自己的笔记本电脑本地安装，也可以在公司的服务器上部署。</p>\n\n<p>&nbsp;</p>\n\n<p>现在假设你已经参考了官方文档并安装完成，那么接下来在代码层面应该怎么来引入RabbitMQ以及在系统里实现收发消息呢？</p>\n\n<p>&nbsp;</p>\n\n<p>下面通过一些HelloWorld级别的代码和一些简单的示例图，给大家演示一下RabbitMQ是如何收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>对于很多在实际生产中使用过MQ的同学，这些代码可能对实际生产中使用过MQ的同学，显得太简单了。</p>\n\n<p>&nbsp;</p>\n\n<p>不过考虑到很多初学者可能连用都没有用过MQ，甚至是才听说消息中间件不久，所以笔者认为这些demo代码以及手工绘图，还是很有必要。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144746252.png\" style=\"height:412px; width:675px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144758533.png\" style=\"height:489px; width:676px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144769467.png\" style=\"height:629px; width:677px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144782745.png\" style=\"height:171px; width:678px\" /></p>\n\n<p>好！看完了代码，这个时候，我们可以通过一张图来想象一下两个服务之间的通信。<br />\n&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>订单服务你可以启动多个，不同的订单服务都可以往一个RabbitMQ的queue里推送消息。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务你也可以启动多个，多个仓储服务会采用<strong>round-robin</strong>的轮询算法，每个服务实例都可以从RabbitMQ queue里消费到一部分的消息。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144796282.png\" style=\"height:349px; width:623px\" /></p>\n\n<p>上面的图里，订单服务在MQ专业术语中叫做<strong>&ldquo;生产者&rdquo;</strong>，英文是&ldquo;Producer&rdquo;，意思就是这个服务是专门负责生产消息投递到MQ的。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务在MQ专业术语中叫做<strong>&ldquo;消费者&rdquo;</strong>，英文是&ldquo;Consumer&rdquo;，意思就是这个服务专门是负责从MQ消费消息然后处理的。</p>\n\n<p>&nbsp;</p>\n\n<p>这个时候，这套异步通信的架构就可以跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>好了，到目前为止，虽然这个代码还存在不少问题，但是没关系，大体上我们已经给一些不太熟悉MQ技术的同学，从一个比较形象易于理解简化后的电商业务场景出发，通过HelloWorld级别的示例代码和手工绘图，将MQ这个技术落地跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>更进一步，各位同学完全可以参照这个文章里的案例，思考一下：自己负责的项目里，有没有类似的业务场景可以使用MQ的？</p>\n\n<p>&nbsp;</p>\n\n<p>然后想办法在自己的项目里落地使用MQ的技术来做一下异步化，提升核心流程的性能。</p>\n\n<p>&nbsp;</p>\n\n<p>这样未来在跳槽面试的时候，才可以做到游刃有余，有自己的一套东西可以说。</p>\n\n<p><strong>END</strong></p>\n, 参数5:1c76b9848f5f4d71a5e88b20dbaf38f4, 参数6:0, 参数7:0, 参数8:0, 参数9:1, 参数10:陌溪_, 参数11:蘑菇博客, 参数12:e60df954efcd47c48463a504bb70bbe9, 参数13:52b6106a19524aa8ab5543342e5152b9, ','增加博客',1,'2018-12-30 12:41:46','2018-12-30 12:41:46'),('8c088efcfc7e4d058a2f93da0c2b9d56','或许无所谓','1f01cd1d2f474743b241d74008b12335','39.166.106.86','/mogu_admin/picture/delete','POST','com.moxi.mogublog.admin.restapi.PictureRestApi','delete','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@19557f7f]], 参数2:d97ff68d254c4c2bbca29519c08559ca, ','删除图片',1,'2018-12-24 21:09:57','2018-12-24 21:09:57'),('8c612f9b8570473cb84a3ace8c323838','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:208692b2a7a242f4942993abb8eebf8b, 参数3:哥们，消息中间件在你们项目里是如何落地的？, 参数4:哥们，消息中间件在你们项目里是如何落地的？, 参数5:<p>来源：石杉的架构笔记</p>\n\n<h1><strong><strong>一、前情回顾</strong></strong></h1>\n\n<p>之前给大家聊了一下，面试时如果遇到消息中间件这个话题，面试官上来可能问的两个问题：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>你们的系统架构中为什么要引入消息中间件？</p>\n	</li>\n	<li>\n	<p>系统架构中引入消息中间件有什么缺点？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>关于这两个问题的回答，可以参见之前的两篇文章：</p>\n\n<ul>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件？</a>》</p>\n	</li>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=bcdb3ee0332a440994216682cf850ed6\" target=\"_blank\">哥们，那你说说系统架构中引入消息中间件有什么缺点？</a>》</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>在问完这两个问题之后，不同风格的面试官可能会展开不同的发问。</p>\n\n<p>&nbsp;</p>\n\n<p>针对那种工作年限比较长的资深的同学，可能会开始就候选人所在公司使用的消息中间件，深入里面的技术细节，比如让你聊聊RocketMQ的架构原理和核心源码？</p>\n\n<p>&nbsp;</p>\n\n<p>但是另外一种面试风格，会先从你们的项目和业务入手进行考察，比如像下面这样：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>消息中间件在你们生产项目里具体是哪个业务场景下落地的？</p>\n	</li>\n	<li>\n	<p>这个业务场景有什么技术挑战？</p>\n	</li>\n	<li>\n	<p>为什么必须要在这个业务场景里用消息中间件技术？</p>\n	</li>\n	<li>\n	<p>具体使用消息中间件的时候是怎么来用的？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>好！这篇文章，咱们从第二种风格来聊聊。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>二、业务场景介绍</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>我们会落地到某个具体业务系统的某个场景下，看看如何使用消息中间件，然后其效果是什么。</p>\n\n<p>&nbsp;</p>\n\n<p>业务场景的话，咱们就用大家都很熟悉的<strong>电商业务</strong>为例，这里为了便于理解，对其做了一定的抽象和简化。</p>\n\n<p>&nbsp;</p>\n\n<p>大家还是来考虑一个下订单的业务流程，比如你下个订单，此时需要干几件事情：</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>更新订单状态为&ldquo;待发货&rdquo;（耗时20ms）</p>\n	</li>\n	<li>\n	<p>扣减商品库存（耗时100ms）</p>\n	</li>\n	<li>\n	<p>增加会员积分（耗时80ms）</p>\n	</li>\n	<li>\n	<p>附赠优惠券（耗时50ms）</p>\n	</li>\n	<li>\n	<p>仓储调度发货（耗时几十秒）。</p>\n	</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>说明一下：上述环节，为了便于大家理解，做了简化。实际真正复杂的电商系统里，整体环节和业务流程会比这个复杂很多倍，而且耗时也绝对不是上面那么简单的。</p>\n\n<p>&nbsp;</p>\n\n<p>老规矩！我们还是通过一张手绘图，来看看这整个的业务流程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144696893.png\" style=\"height:400px; width:675px\" /></p>\n\n<p>如上图，这个下订单的业务流程中：</p>\n\n<p>更新订单状态（20ms） + &nbsp;扣减商品库存（100ms） + &nbsp;增加会员积分（80ms） + &nbsp;附赠优惠券（50ms） = &nbsp;250ms。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，仅仅是这4个流程的话，也就200多毫秒的耗时。</p>\n\n<p>&nbsp;</p>\n\n<p>200多毫秒的耗时，对用户下单体验来说是非常快速的，几乎就是一瞬间就完成了，不会感到过多的停顿，也就是一下子就可以看到自己下单成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是，如果加上那个调度仓储发货呢？</p>\n\n<p>&nbsp;</p>\n\n<p>那个环节需要读取大量的数据、使用多仓库/多货位的调度算法、还要跟C/S架构的仓储系统进行网络通信，因此我们这里假设这个环节可能会耗时数十秒。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦加上那个调度仓储发货的环节到这个下单流程里，就可能导致用户要等页面卡顿几十秒后才会看到下单成功的提示，这个用户体验就相当的差了。</p>\n\n<p>&nbsp;</p>\n\n<p>按照之前一篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件呢？</a>》的说法。对于这种场景，完全适合使用消息中间件来进行异步化调用。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，订单服务对仓储调度发货，仅仅是发送一个消息到MQ里，然后仓储服务消费消息之后再慢慢的执行调度算法，然后分配商品发货任务给对应的仓库即可。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以把耗时几十秒的仓储调度发货的环节，从下单流程里摘除出去了。进而保证下单流程就仅仅是耗时200多毫秒而已。</p>\n\n<p>&nbsp;</p>\n\n<p>至于那个耗时几十秒的仓储调度发货环节，我们通过异步的方式慢慢执行即可，不会影响用户下单的体验。</p>\n\n<p>&nbsp;</p>\n\n<p>以上过程，我们同样来一张图，大家直观的感受一下：</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144724851.png\" style=\"height:408px; width:690px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>三、初步落地</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>好！接下来我们就假设大家在实际生产中还没用过消息中间件，咱们从0开始，看看如何落地？</p>\n\n<p>&nbsp;</p>\n\n<p>对于已经在生产中使用过消息中间件的小伙伴，不妨也看看，权当复习，温故知新！</p>\n\n<p>&nbsp;</p>\n\n<p>我们以RabbitMQ为例，假如你用的消息中间件是RabbitMQ，那么我们对这个消息中间件应该如何安装和部署呢？</p>\n\n<p>&nbsp;</p>\n\n<p>很简单，RabbitMQ的官方文档里提供了非常详细的安装部署步骤，你可以在自己的笔记本电脑本地安装，也可以在公司的服务器上部署。</p>\n\n<p>&nbsp;</p>\n\n<p>现在假设你已经参考了官方文档并安装完成，那么接下来在代码层面应该怎么来引入RabbitMQ以及在系统里实现收发消息呢？</p>\n\n<p>&nbsp;</p>\n\n<p>下面通过一些HelloWorld级别的代码和一些简单的示例图，给大家演示一下RabbitMQ是如何收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>对于很多在实际生产中使用过MQ的同学，这些代码可能对实际生产中使用过MQ的同学，显得太简单了。</p>\n\n<p>&nbsp;</p>\n\n<p>不过考虑到很多初学者可能连用都没有用过MQ，甚至是才听说消息中间件不久，所以笔者认为这些demo代码以及手工绘图，还是很有必要。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144746252.png\" style=\"height:412px; width:675px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144758533.png\" style=\"height:489px; width:676px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144769467.png\" style=\"height:629px; width:677px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144782745.png\" style=\"height:171px; width:678px\" /></p>\n\n<p>好！看完了代码，这个时候，我们可以通过一张图来想象一下两个服务之间的通信。<br />\n&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>订单服务你可以启动多个，不同的订单服务都可以往一个RabbitMQ的queue里推送消息。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务你也可以启动多个，多个仓储服务会采用<strong>round-robin</strong>的轮询算法，每个服务实例都可以从RabbitMQ queue里消费到一部分的消息。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144796282.png\" style=\"height:349px; width:623px\" /></p>\n\n<p>上面的图里，订单服务在MQ专业术语中叫做<strong>&ldquo;生产者&rdquo;</strong>，英文是&ldquo;Producer&rdquo;，意思就是这个服务是专门负责生产消息投递到MQ的。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务在MQ专业术语中叫做<strong>&ldquo;消费者&rdquo;</strong>，英文是&ldquo;Consumer&rdquo;，意思就是这个服务专门是负责从MQ消费消息然后处理的。</p>\n\n<p>&nbsp;</p>\n\n<p>这个时候，这套异步通信的架构就可以跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>好了，到目前为止，虽然这个代码还存在不少问题，但是没关系，大体上我们已经给一些不太熟悉MQ技术的同学，从一个比较形象易于理解简化后的电商业务场景出发，通过HelloWorld级别的示例代码和手工绘图，将MQ这个技术落地跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>更进一步，各位同学完全可以参照这个文章里的案例，思考一下：自己负责的项目里，有没有类似的业务场景可以使用MQ的？</p>\n\n<p>&nbsp;</p>\n\n<p>然后想办法在自己的项目里落地使用MQ的技术来做一下异步化，提升核心流程的性能。</p>\n\n<p>&nbsp;</p>\n\n<p>这样未来在跳槽面试的时候，才可以做到游刃有余，有自己的一套东西可以说。</p>\n\n<p><strong>END</strong></p>\n, 参数6:1c76b9848f5f4d71a5e88b20dbaf38f4, 参数7:e60df954efcd47c48463a504bb70bbe9, 参数8:1, 参数9:0, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:52b6106a19524aa8ab5543342e5152b9, ','编辑博客',1,'2018-12-30 12:50:11','2018-12-30 12:50:11'),('8e7f1d8947e241a993befd4f2ee1d290','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/picture/add','POST','com.moxi.mogublog.admin.restapi.PictureRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@4cee3ce6]], 参数2:b936cfd2bf694d92a056170f821b5859,, 参数3:f321114dc2014bb68ac4091fd90f64c1, ','增加图片',1,'2018-12-29 10:50:20','2018-12-29 10:50:20'),('9251f351a99943c9aada31e444128fc8','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blogSort/add','POST','com.moxi.mogublog.admin.restapi.BlogSortRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:后端开发, 参数3:后端开发专题, ','增加博客分类',1,'2018-12-29 10:35:43','2018-12-29 10:35:43'),('92f72f03edbd4cb0af63b6273d4705ad','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/tag/add','POST','com.moxi.mogublog.admin.restapi.TagRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:数据库, 参数3:0, ','增加标签',1,'2018-12-29 10:34:16','2018-12-29 10:34:16'),('aa1cbe54c1854ea18389175604c03c1e','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:ffd8c8bfe7234bc6aed88d813e3b67ed, 参数3:扎心！线上服务宕机时，如何保证数据100%不丢失？, 参数4:扎心！线上服务宕机时，如何保证数据100%不丢失？, 参数5:<p><strong><strong>一、写在前面</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>上篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=208692b2a7a242f4942993abb8eebf8b\" target=\"_blank\">同学，消息中间件在你们生产项目里如何落地使用的？</a>》，我们用一个简单易懂的电商场景给大家引入说明了一个消息中间件的使用场景。</p>\n\n<p>&nbsp;</p>\n\n<p>同时，我们还基于RabbitMQ的HelloWorld级别的代码，给出了订单服务和仓储服务如何基于MQ中间件收发消息的示例。</p>\n\n<p><strong><strong>二、业务场景回顾</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>这篇文章，我们来稍微深入探讨一些MQ中间件使用中的基础技术问题。</p>\n\n<p>&nbsp;</p>\n\n<p>首先回顾一下上篇文章做出来的一个架构图，看看订单服务和消息服务是如何基于MQ来收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>我们稍微把这个图细化一点，简单来说就是多个订单服务实例给queue推送消息，多个仓储服务每个消费一部分消息。如下图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145179451.png\" style=\"height:265px; width:820px\" /></p>\n\n<p><strong><strong>三、意外宕机，问题凸现</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>假如你线上对MQ技术的使用就到此为止了，那么基本可以跟offer说拜拜了。。。</p>\n\n<p>&nbsp;</p>\n\n<p>因为如果是我的话，作为一个面试官就没法继续往下问了。你这个MQ的使用以及理解的深度仅此而已的话，那基本就是刚刚对MQ技术入门的程度。</p>\n\n<p>&nbsp;</p>\n\n<p>如果面试官要继续问，完全可以问下面的问题：</p>\n\n<ul>\n	<li>\n	<p>那你说说如果仓储服务作为消费者服务，刚收到了一个订单消息，但是在完成消息的处理之前，也就是还没对订单完成仓储调度发货，结果这个仓储服务突然就宕机了，这个时候会发生什么事情？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>所以说，大家还是要对这个技术了解的稍微深入一点点，否则随便被问几个问题就完蛋了。</p>\n\n<p>&nbsp;</p>\n\n<p>大伙儿先来看看下面的图，感受一下车祸现场。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145205074.png\" style=\"height:326px; width:1227px\" /></p>\n\n<p>RabbitMQ这个中间件默认的一个行为，就是只要仓储服务收到一个订单消息，RabbitMQ就会立马把这条订单消息给标记为删除，<strong>这个行为叫做自动ack，</strong>也就是投递完成一条消息就自动确认这个消息处理完毕了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是接着如果此时仓储服务收到了一个订单消息，但是还没来得及对仓库系统完成商品的调度发货，结果直接就宕机了。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，明显这个订单消息就丢失了啊，因为RabbitMQ那里已经没有了。。。</p>\n\n<p>&nbsp;</p>\n\n<p>这会导致什么样的尴尬体验呢？就是一个用户支付了8999元，对一个iphone8下了订单，结果呢，死等活等了好几天，就是不见网站上显示他的iphone8在发货。</p>\n\n<p>&nbsp;</p>\n\n<p>搞了半天，原因就是他的那个iphone8的订单在仓储服务那里，还没来得及调度发货直接就宕机了，导致这个订单消息就一直丢失了，始终没有给这个用户通知仓库系统进行发货。</p>\n\n<p>&nbsp;</p>\n\n<p>这个问题，是不是很尴尬？所以说，技术问题是会严重影响企业的核心业务流程的！</p>\n\n<p>&nbsp;</p>\n\n<p>各位小伙伴，还记得上一讲咱们的仓储服务消费消息的代码中，有一行关键的代码：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145226184.png\" style=\"height:81px; width:500px\" /></p>\n\n<p>这行代码对<strong>channel.basicConsume()</strong>方法，传入的第二个参数：<strong>true</strong>，其实就是一个关键的参数。</p>\n\n<p>&nbsp;</p>\n\n<p>这个true就代表了一个核心的含义，<strong>他的意思是，RabbitMQ只要把一个消息投递到仓储服务手上，立马就标记这个消息删除了。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>但是在这个默认的配置之下，要是仓储服务收到一个订单消息，结果还没来得及完成耗时几十秒的仓储调度发货的业务逻辑，结果突然宕机了，那么这个订单消息就永久性丢失了！</p>\n\n<p>&nbsp;</p>\n\n<p>找了半天，原来问题的症结在这里啊！大家是不是明白了，上一篇文章最后为什么我会说，这个代码目前为止还有很多的问题。</p>\n\n<p>&nbsp;</p>\n\n<p>所以这个时候，我们如果希望不要因为仓储服务的突然宕机导致一条订单消息丢失，就需要改造一下仓储服务消费消息的代码了。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>首先，我们需要把那个参数从true改为false</strong>，如下代码所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145251780.png\" style=\"height:79px; width:500px\" /></p>\n\n<p>只要修改为false之后，RabbitMQ就不会盲目的投递消息到仓储服务，立马就删除消息了，说白了就是关闭autoAck的行为，不要自作主张的认为消息处理成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>接着，我们需要改造一下处理订单消息的代码，如下代码所示。</p>\n\n<p>&nbsp;</p>\n\n<p>这段代码，说白了，就是在对订单完成了调度发货之后，<strong>在finally代码块中手动执行了ack操作</strong>，说我自己已经完成了耗时几十秒的业务逻辑的处理，现在可以手动ack通知RabbitMQ，这个消息处理完毕了。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145274245.png\" style=\"height:156px; width:500px\" /></p>\n\n<p>此时整个架构运行流程大致看起来跟下面的图那样子。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145297769.png\" style=\"height:125px; width:500px\" /></p>\n\n<p>架构流程改成上面那样后，就意味着只有完成了仓储调度发货的代码业务逻辑，确保仓库系统收到通知之后，仓储服务才会在代码中手动发送ack消息给RabbitMQ。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，RabbitMQ收到了这个ack消息，才会标记对应的订单消息被删除了。</p>\n\n<p>&nbsp;</p>\n\n<p>如果说在仓储服务收到了订单消息，但是还没来得及完成仓储调度发货的业务逻辑，那也就绝对不会执行这条订单消息的ack操作，然后RabbitMQ也就不会收到这条订单消息的ack通知。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦RabbitMQ发现代表消费者的某个仓储服务实例突然宕机了，而这个仓储服务收到的一些订单消息还没来得及处理，没给自己发送那些消息的ack通知。</p>\n\n<p>&nbsp;</p>\n\n<p>此时，RabbitMQ会自动对这条订单消息重发推送给其他在运行中的仓储服务实例，让其他的仓储服务实例去处理这条订单消息。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以保证这条订单消息不会因为某个仓储服务实例的宕机而丢失，他会确保必须由某个仓储服务实例完成这条订单消息的调度发货处理，然后才会删除那条订单消息。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>四、总结 &nbsp;tips</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>最后再来一张图，大家直观的感受一下：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546145320120.png\" style=\"height:246px; width:800px\" /></p>\n\n<p>好了，各位同学，这篇文章是不是相对稍微深入一点点，让大家了解到了一些使用MQ技术时候要考虑的一些问题？</p>\n\n<p>&nbsp;</p>\n\n<p>实际上无论是RocketMQ、Kafka还是RabbitMQ，都有类似的autoAck或者是手动ack的机制。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>线上生产环境中运行时，你必须要考虑到消费者服务可能宕机的问题。</strong></p>\n\n<p>&nbsp;</p>\n\n<p>如果消费者服务没处理完消息就自己宕机了，那么一定会导致部分消息的丢失，进而影响核心业务流程的运转。</p>\n\n<p>&nbsp;</p>\n\n<p>因此大家在线上使用MQ时，一定要充分考虑这些潜在问题，同时结合具体的MQ提供的一些API、参数来进行合理设置，确保消息不要随意丢失。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>END</strong></p>\n, 参数6:1c76b9848f5f4d71a5e88b20dbaf38f4,ca928e8718654aa5a802e2f69277b137, 参数7:e60df954efcd47c48463a504bb70bbe9, 参数8:0, 参数9:1, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:e79e4375ce5b4aa6ad48027de6cb8af2, ','编辑博客',1,'2018-12-30 12:49:22','2018-12-30 12:49:22'),('b18f50cad0664193948340c901f921f1','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:c459e7c261884086b5e462fa4f26cc04, 参数3:简单实现MySQL数据库的日志审计, 参数4:简单实现MySQL数据库的日志审计, 参数5:<p>来源：https://www.freebuf.com/articles/es/192062.html</p>\n\n<h2>0&times;0 背景&nbsp;</h2>\n\n<p><strong>由于MySQL社区版没有自带的审计功能或插件，对于等级保护当中对数据库管理的要求的就存在一定的不满足情况的，抛开条条框框不说数据库的日志是值得研究的，通过收集数据库的日志到企业SOC平台便于安全事件的溯源与故障分析，配合目前的UEBA技术能够轻松发现很多恶意事件。&nbsp;</strong></p>\n\n<p>根据等级保护内容第四章&ldquo;数据库管理系统安全技术要求&rdquo;中&nbsp;第四节&ldquo;数据库安全审计&rdquo;中明确提出数据库管理系统的安全审计应：</p>\n\n<blockquote>\n<p>1. 建立独立的安全审计系统；</p>\n\n<p>2. 定义与数据库安全相关的审计事件；</p>\n\n<p>3. 设置专门的安全审计员；</p>\n\n<p>4. 设置专门用于存储数据库系统审计数据的安全审计库；</p>\n\n<p>5. 提供适用于数据库系统的安全审计设置、分析和查阅的工具。&nbsp;</p>\n</blockquote>\n\n<h2>0&times;1 部署插件</h2>\n\n<p><strong>&nbsp;</strong>为了节省购买一些安全设备的费用，可以尝试使用一些开源的日志审计插件。Mysql-audit是macfee公司基于percona开发的MySQL的SQL审计插件。</p>\n\n<blockquote>\n<p>源码地址如下：<a href=\"https://github.com/mcafee/mysql-audit\">https://github.com/mcafee/mysql-audit</a></p>\n</blockquote>\n\n<p>首先确定当前mysql的版本去官网下载与之相对应的插件：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片1.png\" src=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片2.png\" src=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png!small\" style=\"width:690px\" /></a></p>\n\n<p>&nbsp;解压插件后需要确认mysql插件的安装目录：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片3.png\" src=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片4.png\" src=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png!small\" style=\"width:566px\" /></a></p>\n\n<p>将解压出来的插件libaudit_plugin.so复制到插件的目录下：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片5.png\" src=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png!small\" style=\"width:690px\" /></a></p>\n\n<p>使用mysql的函数install plugin导入此插件后通过show plugin确认是否导入成功。</p>\n\n<p>主要命令如下：</p>\n\n<pre>\n<code>install plugin audit soname ‘libaudit_plugin.so’</code></pre>\n\n<p><img alt=\"图片6.png\" src=\"https://image.3001.net/images/20181216/1544951819_5c16180b1c8a8.png!small\" style=\"width:690px\" /><img alt=\"图片7.png\" src=\"https://image.3001.net/images/20181216/1544951820_5c16180cb659a.png!small\" style=\"width:690px\" /></p>\n\n<p>安装完成之后并不会立马开始审计内容，需要定义一些参数。</p>\n\n<p>Audit_json_file这个参数要整体控制是否开启审计功能使用命令：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Set variables audit_json_file=on</code></pre>\n\n<p>&nbsp; 开启审计功能：</p>\n\n<p><img alt=\"图片8.png\" src=\"https://image.3001.net/images/20181216/1544951841_5c1618210a29a.png!small\" style=\"width:580px\" /></p>\n\n<p>审计后的记录名可以通过查询变量audit_json_log_file获取：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Show variables like “audit_json_log_file”</code></pre>\n\n<p>默认的审计记录格式如下：</p>\n\n<p><img alt=\"图片9.png\" src=\"https://image.3001.net/images/20181216/1544951858_5c16183262f9c.png!small\" style=\"width:690px\" /></p>\n\n<p>Json格式如下：</p>\n\n<p><img alt=\"图片10.png\" src=\"https://image.3001.net/images/20181216/1544951874_5c1618427bc3e.png!small\" style=\"width:690px\" /></p>\n\n<p>同时插件支持一些自定义的参数与命令，包括白名单与黑名单的功能。</p>\n\n<blockquote>\n<p>Audit_whitelist_users: 不审计user用户的所有命令</p>\n\n<p>Aduit_record_cmds: 需要进行审计的命令种类</p>\n</blockquote>\n\n<p><img alt=\"图片11.png\" src=\"https://image.3001.net/images/20181216/1544951883_5c16184b68f60.png!small\" style=\"width:601px\" /></p>\n\n<p>更多的参数配置项目可以参考官方给的手册：</p>\n\n<blockquote>\n<p><a href=\"https://github.com/mcafee/mysql-audit/wiki/Configuration\">https://github.com/mcafee/mysql-audit/wiki/Configuration</a></p>\n</blockquote>\n\n<p><img alt=\"图片12.png\" src=\"https://image.3001.net/images/20181216/1544951898_5c16185aeaa2e.png!small\" style=\"width:690px\" /></p>\n\n<h2>0&times;2 总结</h2>\n\n<p>1. 通过插件的方式可以实现mysql日志的审计通过ELK的框架实现日志的保存与分析，再通过后期写一些脚本分析可以实现安全检测与业务分析等多个功能，关键是零成本特别适合那些&rdquo;一个人的安全部&rdquo;有此需求的同行们.&nbsp;</p>\n\n<p>2. 根据一些测试数据表示，插件对性能的影响是比较大的约有20%左右的消耗需要结合具体的业务情况进行评估。</p>\n, 参数6:0b51c75ed5744cdcadefe0ad947be9b6, 参数7:093d8bdd01c84890a928e923d5c235fe, 参数8:0, 参数9:0, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:https://www.freebuf.com/articles/es/192062.html, 参数14:e06331bc9fff4a7186439f2a34c199af, ','编辑博客',1,'2018-12-29 10:34:41','2018-12-29 10:34:41'),('b7f43c6f62534e9098c145bebb0d28c5','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/add','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@4cee3ce6]], 参数2:WEB前端知识汇总, 参数3:WEB前端知识汇总, 参数4:<p>Web前端技术由<strong>html、css和 javascript</strong>三大部分构成，是一个庞大而复杂的技术体系，其复杂程度不低于任何一门后端语言。而我们在学习它的时候往往是先从某一个点切入，然后不断地接触和学习新的知识点，因此对于初学者很难理清楚整个体系的脉络结构。本文将对Web前端知识体系进行简单的梳理，对应的每个知识点点到为止，不作详细介绍。目的是帮助大家审查自己的知识结构是否完善，如有遗漏或不正确的地方，希望共勉。</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051780753.png\" style=\"height:363px; width:648px\" /></p>\n\n<p><strong>一、JAVASCRIPT 篇</strong></p>\n\n<p><strong>0、基础语法</strong></p>\n\n<p>Javascript 基础语法包括：变量声明、数据类型、函数、控制语句、内置对象等。</p>\n\n<p>在ES5 中，变量声明有两种方式，分别是 &nbsp;var 和 function ，var<br />\n用于声明普通的变量，接收任意类型，function用于声明函数。另外，ES6 新增了 let、const、import 和 class<br />\n等四个命令，分别用以声明 普通变量、静态变量、模块 和 类 。</p>\n\n<p>JS数据类型共有六种，分别是 String、Number、Boolean、Null、Undefined 和 Object 等， 另外，ES6新增了<br />\nSymbol 类型。其中，Object 是引用类型，其他的都是原始类型(Primitive Type)。</p>\n\n<p>原始类型也称为基本类型或简单类型，因为其占据空间固定，是简单的数据段，为了便于提升变量查询速度，将其存储在栈(stack)中(按值访问)。为了便于操作这类数据，ECMAScript<br />\n提供了 3 个&nbsp;基本包装类型&nbsp;：Boolean、Number 和 String<br />\n。基本包装类型是一种特殊的引用类型，每当读取一个基本类型值的时候，JS内部就会创建一个对应的包装对象，从而可以调用一些方法来操作这些数据。</p>\n\n<p>引用类型由于其值的大小会改变，所以不能将其存放在栈中，否则会降低变量查询速度，因此其存储在堆(heap)中，存储在变量处的值是一个指针，指向存储对象的内存处(按址访问)，对于引用类型的值，可以为其添加属性和方法，也可以改变和删除其属性和方法；但基本类型不可以添加属性和方法。</p>\n\n<p>Javascript 可以通过 typeof 来判断原始数据类型，但不能判断引用类型，要知道引用类型的具体类型，需要通过 Object 原型上的<br />\ntoString 方法来判断。</p>\n\n<p>JS中的函数存在着三种角色：普通函数、构造函数、对象方法。同一个函数，调用方式不同，函数的作用不一样，所扮演的角色也不一样。直接调用时就是普通函数，通过new创建对象时就是构造函数，通过对象调用时就是方法。</p>\n\n<p>JS常用的内置对象有window、Date、Array、JSON、RegExp<br />\n等，window是浏览器在执行脚本时创建的一个全局对象，主要描述浏览器窗口相关的属性和状态，这个后面会讲到，Date 和 Array<br />\n使用场景最多，JSON主要用于对象的序列化和反序列化，还有一个作用就是实现对象的深拷贝。RegExp 即正则表达式，是处理字符串的利器。</p>\n\n<p><strong>1、函数原型链</strong></p>\n\n<p>JS是一种基于对象的语言，但在ES6 之前是不支持继承的，为了具备继承的能力，Javascript 在&nbsp;<strong>函数对象</strong><br />\n上建立了原型对象prototype，并以函数对象为主线，从上至下，在JS内部构建了一条&nbsp;<strong>原型链</strong>&nbsp;。原型链把一个个独立的对象联系在一起，Object<br />\n则是所有对象的祖宗，&nbsp;任何对象所建立的原型链最终都指向了Object，并以 Object 终结。 ****</p>\n\n<p>简单来说就是建立了变量查找机制，当访问一个对象的属性时，先查找对象本身是否存在，如果不存在就去该对象所在的原型连上去找，直到Object对象为止，如果都没有找到该属性才会返回undefined。因此，我们可以通过原型链来实现JS继承。</p>\n\n<p><strong>2、函数作用域</strong></p>\n\n<p>函数作用域就是变量在声明它们的函数体以及这个函数体嵌套的任意函数体内都是有定义的。因此，&nbsp;<strong>JS中没有块级作用域，只有函数作用域</strong><br />\n，这种设计导致JS中出现了&nbsp;<strong>变量提升</strong>&nbsp;的问题。简单来说就是，将变量声明提升到它所在作用域的最开始的部分，为了解决变量提升带来的副作用，ES6新增了<br />\nlet 命令来声明变量，let 所声明的变量只在 let 命令所在的代码块内有效，所以不存在变量提升问题。</p>\n\n<p><strong>3、this 指针</strong></p>\n\n<p>this 指针存在于函数中，用以标识函数运行时所处的上下文。函数的类型不同，this指向规则也不一样：对于普通函数，this<br />\n始终指向全局对象window；对于构造函数，this则指向新创建的对象；对于方法，this指向调用该方法的对象。另外，Function对象也提供了call、apply<br />\n和 bind 等方法来改变函数的 this 指向，其中，call 和 apply 主动执行函数，bind一般在事件回调中使用，而 call 和 apply<br />\n的区别只是参数的传递方式不同。</p>\n\n<p>如果往深的去理解，无论什么函数，this是否被改变， 本质上，this 均指向触发函数运行时的那个对象。而在函数运行时，this 的值是不能被改变的。</p>\n\n<p><strong>4、new 操作符</strong></p>\n\n<p>函数的创建有三种方式，即 显式声明、匿名定义 和 new Function()<br />\n。前面提到，JS中的函数即可以是函数，也可以是方法，还可以是构造函数。当使用new来创建对象时，该函数就是构造函数，JS将新对象的原型链指向了构造函数的原型对象，于是就在新对象和函数对象之间建立了一条原型链，通过新对象可以访问到函数对象原型prototype中的方法和属性。</p>\n\n<p><strong>5、闭包</strong></p>\n\n<p>通俗来讲，闭包是一个具有独立作用域的静态执行环境。和函数作用域不同的是，闭包的作用域是静态的，可以永久保存局部资源，而函数作用域只存在于运行时，函数执行结束后立即销毁。因此，闭包可以形成一个独立的执行过程，关于闭包更</p>\n\n<p><strong>6、单线程和异步队列</strong></p>\n\n<p>Javascript<br />\n是单线程语言，在浏览器中，当JS代码被加载时，浏览器会为其分配一个主线程来执行任务(函数)，主线程会形成一个全局执行环境，执行环境在栈中采用后进先出(LIFO)的顺序来执行代码块，以保证所有的函数能按照正确的顺序被执行。</p>\n\n<p>但在浏览器中，有一些任务是非常耗时的，比如ajax请求、定时器、事件等，为了保证非耗时任务不受影响，Javascript<br />\n在执行环境中维护了一个异步队列(也叫工作线程)，并将这些耗时任务放入队列中进行等待，这些任务的执行时机并不确定，只有当主线程的任务执行完成以后，主线程才会去检查异步队列中的任务是否需要开始执行。</p>\n\n<p>JS中的 setTimeout 和 setInterval 就是典型的异步操作，它们会被放入异步队列中等待，即使 setTimeout(0)<br />\n也不会被立即执行，需要等到当前同步任务结束后才会被执行。</p>\n\n<p><strong>7、异步通信 Ajax技术</strong></p>\n\n<p>Ajax是浏览器专门用来和服务器进行交互的异步通讯技术，其核心对象是XMLHttpRequest，通过该对象可以创建一个Ajax请求。Ajax请求是一个耗时的异步操作，当请求发出以后，Ajax<br />\n提供了两个状态位来描述请求在不同阶段的状态，这两个状态位分别是&nbsp;<strong>readyState</strong>&nbsp;和&nbsp;<strong>status</strong>&nbsp;，readyState 通过<br />\n5个状态码来描述一个请求的5个阶段：</p>\n\n<p>0 - 请求未发送，初始化阶段</p>\n\n<p>1 - 请求发送中，服务器还未收到请求</p>\n\n<p>2 - 请求发送成功，服务器已收到请求</p>\n\n<p>3 - 服务器处理完成，开始响应请求，传输数据</p>\n\n<p>4 - 客户端收到请求，并完成了数据下载，生成了响应对象</p>\n\n<p>status 用于描述服务端对请求处理的情况，200 表示正确响应了请求，404 表示服务器找不到资源，500 代表服务器内部异常等等。</p>\n\n<p>Ajax对象还可以设置一个timeout 值，代表超时时间，切记：timeout 只会影响<br />\nreadyState，而不会影响status，因为超时只会中断数据传输，但不会影响服务器的处理结果。 如果 timeout 设置的不合理，就会导致响应码<br />\nstatus 是200，但 response里却没有数据，这种情况就是服务器正确响应了请求，但数据的下载被超时中断了。</p>\n\n<p>为了防止XSS攻击，浏览器对Ajax请求做了限制，不允许Ajax 跨域请求服务器，只允许请求和当前地址同域的服务器资源。但不限制脚本和标签发送跨域请求，比如<br />\nscript 和 img 标签，因此可以利用脚本跨域能力来实现跨域请求，即JSONP 的原理。</p>\n\n<p>JSONP虽然可以解决跨域问题，但只能是get请求，并且没有有效的错误捕获机制，为了解决这个问题，XMLHttpRequest Level2 提出了<br />\nCORS 模型，即&nbsp;<strong>跨域资源共享，</strong>&nbsp;它不是一个新的API，而是一个标准规范，当浏览器发现该请求需要跨域时，就会自动在头信息中添加一个 Origin<br />\n字段，用以说明本次请求来自哪个源。服务器根据这个值，决定是否同意这次请求。&nbsp;</p>\n\n<p>随着移动端的快速发展，Web技术的应用场景正在变得越来越复杂，&nbsp;<strong>关注点分离</strong>&nbsp;原则在系统设计层面就显得越来越重要，而XMLHttpRequest 是<br />\nAjax 最古老的一个接口，因而不太符合现代化的系统设计理念。因此，浏览器提供了一个新的 Ajax 接口，即&nbsp;<strong>Fetch API</strong>&nbsp;，Fetch<br />\nAPI 是基于Promise 思想设计的，更符合关注点分离原则。</p>\n\n<p><strong>8、模块化</strong></p>\n\n<p>历史上，Javascript 规范一直没有模块(module)体系，即无法将一个大程序拆分成互相依赖的小文件，再用简单的方法拼装起来。在 ES6<br />\n之前，为了实现JS模块化编程，社区制定了一些模块加载方案，最主要有 CMD 和 AMD 两种，分别以commonjs 和 requirejs为代表。ES6<br />\n在语言标准的层面上，实现了模块化编程，其设计思想是，尽量静态化，使得编译时就能确定模块的依赖关系，即编译时加载，而CMD和AMD是在运行时确定依赖关系，即运行时加载。</p>\n\n<p><strong>9、Node.js</strong></p>\n\n<p>Node.js&nbsp;是一个基于 Chrome V8 引擎的 JavaScript<br />\n运行环境，它的运行不依赖于浏览器作为宿主环境，而是和服务端程序一样可以独立的运行，这使得JS编程第一次从客户端被带到了服务端，Node.js在服务端的优势是，它采用单线程和异步I/O模型，实现了一个高并发、高性能的运行时环境。相比传统的多线程模型，Node.js实现简单，并且可以减少资源开销。</p>\n\n<p><strong>10、ES6</strong></p>\n\n<p>ES6 是&nbsp;ECMAScript 6.0<br />\n的简写，即Javascript语言的下一代标准，已经在2015年6月正式发布了，它的目标是让JS能够方便的开发企业级大型应用程序，因此，ES6的一些规范正在逐渐向Java、C#等后端语言标准靠近。ES6<br />\n规范中，比较重大的变化有以下几个方面：</p>\n\n<p>新增 let、const 命令 来声明变量，和var 相比，let<br />\n声明的变量不存在变量提升问题，但没有改变JS弱类型的特点，依然可以接受任意类型变量的声明；const<br />\n声明的变量不允许在后续逻辑中改变，提高了JS语法的严谨性。</p>\n\n<p>新增解构赋值、rest语法、箭头函数，这些都是为了让代码看起来更简洁，而包装的语法糖。</p>\n\n<p>新增模块化，这是JS走向规范比较重要的一步，让前端更方便的实现工程化。</p>\n\n<p>新增类和继承的概念，配合模块化，JS也可以实现高复用、高扩展的系统架构。</p>\n\n<p>新增模板字符串功能，高效简洁，结束拼接字符串的时代。</p>\n\n<p>新增Promise对象，解决异步回调多层嵌套的问题。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、CSS 篇</strong></p>\n\n<p><strong>1、CSS选择器</strong></p>\n\n<p>CSS选择器即通过某种规则来匹配相应的标签，并为其设置CSS样式，常用的有类选择器、标签选择器、ID选择器、后代选择器、群组选择器、伪类选择器(before/after)、兄弟选择器(+~)、属性选择器等等。</p>\n\n<p><strong>2、CSS Reset</strong></p>\n\n<p>HTML<br />\n标签在不设置任何样式的情况下，也会有一个默认的CSS样式，而不同内核浏览器对于这个默认值的设置则不尽相同，这样可能会导致同一套代码在不同浏览器上的显示效果不一致，而出现兼容性问题。因此，在初始化时，需要对常用标签的样式进行初始化，使其默认样式统一，这就是CSS<br />\nReset ，即CSS样式重置，比如：*{margin:0,padding:0} 就是最简单CSS Reset， 关于CSS重置请参考：<br />\n<em>Neat.css</em></p>\n\n<p><strong>3、盒子布局</strong></p>\n\n<p>盒子模型是CSS比较重要的一个概念，也是CSS 布局的基石。<br />\n常见的盒子模型有块级盒子(block)和行内盒子(inline-block)，与盒子相关的几个属性有：margin、border、padding和content<br />\n等，这些属性的作用是设置盒子与盒子之间的关系以及盒子与内容之间的关系。其中，只有普通文档流中块级盒子的垂直外边距才会发生合并，而行内盒子、浮动盒子或绝对定位之间的外边距不会合并。另外，box-sizing<br />\n属性的设置会影响盒子width和height的计算。</p>\n\n<p><strong>4、浮动布局</strong></p>\n\n<p>设置元素的 float 属性值为 left 或<br />\nright，就能使该元素脱离普通文档流，向左或向右浮动。一般在做宫格布局时会用到，如果子元素全部设置为浮动，则父元素是塌陷的，这时就需要清除浮动，清除浮动的方法也很多，常用的方法是在元素末尾加空元素设置clear:both，<br />\n更高级一点的就给父容器设置before/after来模拟一个空元素，还可以直接设置overflow属性为auto/hidden来清除浮动。除浮动可以实现宫格布局，行内盒子(inline-block)和table也可以实现同样的效果。</p>\n\n<p><strong>5、定位布局</strong></p>\n\n<p>设置元素的position属性值为 relative/absolute/fixed，就可以使该元素脱离文档流，并以某种参照坐标进行偏移。其中，releave<br />\n是相对定位，它以自己原来的位置进行偏移，偏移后，原来的空间不会被其他元素占用；absolute<br />\n是绝对定位，它以离自己最近的定位父容器作为参照进行偏移；为了对某个元素进行定位，常用的方式就是设置父容器的poistion:relative，因为相对定位元素在不设置<br />\ntop 和 left 值时，不会对元素位置产生影响；fixed<br />\n即固定定位，它则以浏览器窗口为参照物，PC网页底部悬停的banner一般都可以通过fixed定位来实现，但fixed属性在移动端有兼容性问题，因此不推荐使用，可替代的方案是：绝对定位+内部滚动。</p>\n\n<p><strong>6、弹性布局</strong></p>\n\n<p>弹性布局即Flex布局，定义了flex的容器一个可伸缩容器，首先容器本身会根据容器中的元素动态设置自身大小；然后当Flex容器被应用一个大小时（width和height），将会自动调整容器中的元素适应新大小。Flex容器也可以设置伸缩比例和固定宽度，还可以设置容器中元素的排列方向（横向和纵向）和是否支持元素的自动换行。有了这个神器，做页面布局的可以方便很多了。注意，设为Flex布局以后，子元素的float、clear和vertical-align<br />\n属性将失效。</p>\n\n<p><strong>7、CSS3 动画</strong></p>\n\n<p>CSS3中规范引入了两种动画，分别是 transition 和 animation，transition<br />\n可以让元素的CSS属性值的变化在一段时间内平滑的过渡，形成动画效果，为了使元素的变换更加丰富多彩，CSS3还引入了transfrom<br />\n属性，它可以通过对元素进行 平移(translate)、旋转(rotate)、放大缩小(scale)、倾斜(skew)<br />\n等操作，来实现2D和3D变换效果。transiton 还有一个结束事件<br />\ntransitionEnd，该事件是在CSS完成过渡后触发，如果过渡在完成之前被移除，则不会触发transitionEnd 。</p>\n\n<p>animation 需要设置一个@keyframes，来定义元素以哪种形式进行变换，<br />\n然后再通过动画函数让这种变换平滑的进行，从而达到动画效果，动画可以被设置为永久循环演示。设置&nbsp;animation-play-state:paused<br />\n可以暂停动画，设置&nbsp;animation-fill-mode:forwards<br />\n可以让动画完成后定格在最后一帧。另外，还可以通过JS监听animation的开始、结束和重复播放时的状态，分别对应三个事件，即<br />\nanimationStart、animationEnd、animationIteration 。注意，当播放次数设置为1时，不会触发<br />\nanimationIteration 。</p>\n\n<p>和 transition相比，animation 设置动画效果更灵活更丰富，还有一个区别是：transition<br />\n只能通过主动改变元素的css值才能触发动画效果，而animation一旦被应用，就开始执行动画。另外，HTML5 还新增了一个动画API，即<br />\nrequestAnimationFrame，它通过JS来调用，并按照屏幕的绘制频率来改变元素的CSS属性，从而达到动画效果。</p>\n\n<p><strong>8、BFC</strong></p>\n\n<p>BFC是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面元素。比如：内部滚动就是一个BFC，当一个父容器的overflow-y设置为auto时，并且子容器的长度大于父容器时，就会出现内部滚动，无论内部的元素怎么滚动，都不会影响父容器以外的布局，这个父容器的渲染区域就叫BFC。满足下列条件之一就可触发BFC：</p>\n\n<p>根元素，即HTML元素</p>\n\n<p>float的值不为none</p>\n\n<p>overflow的值不为visible</p>\n\n<p>display的值为inline-block、table-cell、table-caption</p>\n\n<p>position的值为absolute或fixed</p>\n\n<p><strong>9、Sprite，Iconfont，@font-face</strong></p>\n\n<p>对于大型站点，为了减少http请求的次数，一般会将常用的小图标排到一个大图中，页面加载时只需请求一次网络，<br />\n然后在css中通过设置background-position来控制显示所需要的小图标，这就是Sprite图。</p>\n\n<p>Iconfont，即字体图标，就是将常用的图标转化为字体资源存在文件中，通过在CSS中引用该字体文件，然后可以直接用控制字体的css属性来设置图标的样式，字体图标的好处是节省网络请求、其大小不受屏幕分辨率的影响，并且可以任意修改图标的颜色。</p>\n\n<p>@font-face是CSS3中的一个模块，通过@font-face可以定义一种全新的字体，然后就可以通过css属性font-family来使用这个字体了，即使操作系统没有安装这种字体，网页上也会正常显示出来。</p>\n\n<p><strong>10、CSS Hack</strong></p>\n\n<p>早期，不同内核浏览器对CSS属性的解析存在着差异，导致显示效果不一致，比如 margin<br />\n属性在ie6中显示的距离会比其他浏览器中显示的距离宽2倍，也就是说margin-left:20px;在ie6中距左侧元素的实际显示距离是40px，而在非ie6的浏览器上显示正常。因此，如果要想让所有浏览器中都显示是20px的宽度，就需要在CSS样式中加入一些特殊的符号，让不同的浏览器识别不同的符号，以达到应用不同的CSS样式的目的，这种方式就是css<br />\nhack， 对于ie6中的margin应用hack就会变成这样：.el {margin-left:20px;_margin-left:10px}</p>\n\n<p>兼容各大浏览器的 css hack 如下：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051750949.png\" style=\"height:363px; width:800px\" /></p>\n\n<p><strong>三、HTML 篇</strong></p>\n\n<p><strong>1、BOM</strong></p>\n\n<p>BOM 是&nbsp;Browser Object Model<br />\n的缩写，即浏览器对象模型，当一个浏览器页面初始化时，会在内存创建一个全局的对象，用以描述当前窗口的属性和状态，这个全局对象被称为浏览器对象模型，即BOM。BOM的核心对象就是window，window<br />\n对象也是BOM的顶级对象，其中包含了浏览器的 6个核心模块：</p>\n\n<p><strong>document</strong>&nbsp;-<br />\n即文档对象，渲染引擎在解析HTML代码时，会为每一个元素生成对应的DOM对象，由于元素之间有层级关系，因此整个HTML代码解析完以后，会生成一个由不同节点组成的树形结构，俗称DOM树，document<br />\n用于描述DOM树的状态和属性，并提供了很多操作DOM的API。</p>\n\n<p><strong>frames</strong>&nbsp;- HTML 子框架，即在浏览器里嵌入另一个窗口，父框架和子框架拥有独立的作用域和上下文。</p>\n\n<p><strong>history</strong>&nbsp;- 以栈(FIFO)的形式保存着页面被访问的历史记录，页面前进即入栈，页面返回即出栈。</p>\n\n<p><strong>location</strong>&nbsp;-&nbsp;提供了当前窗口中加载的文档相关信息以及一些导航功能。</p>\n\n<p><strong>navigator</strong>&nbsp;-&nbsp;用来描述浏览器本身，包括浏览器的名称、版本、语言、系统平台、用户特性字符串等信息。</p>\n\n<p><strong>screen</strong>&nbsp;- 提供了浏览器显示屏幕的相关属性，比如显示屏幕的宽度和高度，可用宽度和高度。</p>\n\n<p><strong>2、DOM 系统</strong></p>\n\n<p>DOM 是 Document Object Model 的缩写，即 文档对象模型，是所有浏览器公共遵守的标准，DOM<br />\n将HTML和XML文档映射成一个由不同节点组成的树型结构，俗称DOM树。其核心对象是document，用于描述DOM树的状态和属性，并提供对应的DOM操作API。随着历史的发展，DOM<br />\n被划分为1级、2级、3级，共3个级别：</p>\n\n<p><strong>1级DOM</strong>&nbsp;- 在1998年10月份成为W3C的提议，由DOM核心与DOM<br />\nHTML两个模块组成。DOM核心能映射以XML为基础的文档结构，允许获取和操作文档的任意部分。DOM<br />\nHTML通过添加HTML专用的对象与函数对DOM核心进行了扩展。</p>\n\n<p><strong>2级DOM</strong>&nbsp;- 鉴于1级DOM仅以映射文档结构为目标，DOM<br />\n2级面向更为宽广。通过对原有DOM的扩展，2级DOM通过对象接口增加了对鼠标和用户界面事件（DHTML长期支持鼠标与用户界面事件）、范围、遍历（重复执行DOM文档）和层叠样式表（CSS）的支持。同时也对DOM<br />\n1的核心进行了扩展，从而可支持XML命名空间。</p>\n\n<p><strong>3级DOM</strong>&nbsp;-<br />\n通过引入统一方式载入和保存文档和文档验证方法对DOM进行进一步扩展，DOM3包含一个名为&ldquo;DOM载入与保存&rdquo;的新模块，DOM核心扩展后可支持XML1.0的所有内容，包括XML<br />\nInfoset、 XPath、和XML Base。</p>\n\n<p>浏览器对不同级别DOM的支持情况如下所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051729748.png\" style=\"height:128px; width:800px\" /></p>\n\n<p>从图中可以看出，移动端常用的 webkit 内核浏览器目前只支持DOM2，而不支持DOM3 。</p>\n\n<p><strong>3、事件系统</strong></p>\n\n<p>事件是用户与页面交互的基础，到目前为止，DOM事件从PC端的 鼠标事件(mouse) 发展到了 移动端的 触摸事件(touch) 和<br />\n手势事件(guesture)，touch事件描述了手指在屏幕操作的每一个细节，guesture 则是描述多手指操作时更为复杂的情况，总结如下：</p>\n\n<p>第一根手指放下，触发 touchstart，除此之外什么都不会发生</p>\n\n<p>手指滑动时，触发touchmove</p>\n\n<p>第二根手指放下，触发 gesturestart</p>\n\n<p>触发第二根手指的 touchstart</p>\n\n<p>立即触发&nbsp;gesturechange</p>\n\n<p>任意手指移动，持续触发 gesturechange</p>\n\n<p>第二根手指弹起时，触发 gestureend，以后将不会再触发 gesturechange</p>\n\n<p>触发第二根手指的 touchend</p>\n\n<p>触发touchstart (多根手指在屏幕上，提起一根，会刷新一次全局touch) _ ___</p>\n\n<p>弹起第一根手指，触发 touchend</p>\n\n<p>更多关于手势事件的介绍请参考：<br />\n<em>gesture事件处理复杂手势</em></p>\n\n<p>DOM2.0 模型将事件处理流程分为三个阶段，即&nbsp;<strong>事件捕获阶段</strong>&nbsp;、&nbsp;<strong>事件处理阶段</strong>&nbsp;、&nbsp;<strong>事件冒泡阶段，</strong>&nbsp;如图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546051713349.png\" style=\"height:292px; width:656px\" /></p>\n\n<p><strong>事件捕获</strong>&nbsp;：当用户触发点击事件后，顶层对象document 就会发出一个事件流，从最外层的DOM节点向目标元素节点传递，最终到达目标元素。</p>\n\n<p><strong>事件处理</strong>&nbsp;：当到达目标元素之后，执行目标元素绑定的处理函数。如果没有绑定监听函数，则不做任何处理。</p>\n\n<p><strong>事件冒泡</strong>&nbsp;：事件流从目标元素开始，向最外层DOM节点传递，途中如果有节点绑定了事件处理函数，这些函数就会被执行。</p>\n\n<p>利用事件冒泡原理可以实现&nbsp;<strong>事件委托</strong><br />\n，所谓事件委托，就是在父元素上添加事件监听器，用以监听和处理子元素的事件，避免重复为子元素绑定相同的事件。当目标元素的事件被触发以后，这个事件就从目标元素开始，向最外层元素传递，最终冒泡到父元素上，父元素再通过event.target<br />\n获取到这个目标元素，这样做的好处是，父元素只需绑定一个事件监听，就可以对所有子元素的事件进行处理了，从而减少了不必要的事件绑定，对页面性能有一定的提升。</p>\n\n<p><strong>4、HTML解析过程</strong>&nbsp;****</p>\n\n<p>浏览器加载 html 文件以后，渲染引擎会从上往下，一步步来解析HTML标签，大致过程如下：</p>\n\n<p>用户输入网址，浏览器向服务器发出请求，服务器返回html文件；</p>\n\n<p>渲染引擎开始解析 html 标签，并将标签转化为DOM节点，生成 DOM树；</p>\n\n<p>如果head 标签中引用了外部css文件，则发出css文件请求，服务器返回该文件，该过程会阻塞后面的解析；</p>\n\n<p>如果引用了外部 js 文件，则发出 js 文件请求，服务器返回后立即执行该脚本，这个过程也会阻塞html的解析；</p>\n\n<p>引擎开始解析 body 里面的内容，如果标签里引用了css 样式，就需要解析刚才下载好的css文件，然后用css来设置标签的样式属性，并生成渲染树；</p>\n\n<p>如果 body 中的 img 标签引用了图片资源，则立即向服务器发出请求，此时引擎不会等待图片下载完毕，而是继续解析后面的标签；</p>\n\n<p>服务器返回图片文件，由于图片需要占用一定的空间，会影响到后面元素的排版，因此引擎需要重新渲染这部分内容；</p>\n\n<p>如果此时 js 脚本中运行了 style.display=&quot;none&quot;，布局被改变，引擎也需要重新渲染这部分代码；</p>\n\n<p>直到 html 结束标签为止，页面解析完毕。</p>\n\n<p><strong>5、重绘 和 回流</strong></p>\n\n<p>当渲染树中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建。这就称为回流。比如上面的img文件加载完成后就会引起回流，每个页面至少需要一次回流，就是在页面第一次加载的时候。</p>\n\n<p>当渲染树中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如 background-color。则就叫称为重绘。</p>\n\n<p>从上面可以看出，回流必将引起重绘，而重绘不一定会引起回流。会引起重绘和回流的操作如下：</p>\n\n<p>添加、删除元素(回流+重绘)</p>\n\n<p>隐藏元素，display:none(回流+重绘)，visibility:hidden(只重绘，不回流)</p>\n\n<p>移动元素，比如改变top,left的值，或者移动元素到另外一个父元素中。(重绘+回流)</p>\n\n<p>对style的操作(对不同的属性操作，影响不一样)</p>\n\n<p>还有一种是用户的操作，比如改变浏览器大小，改变浏览器的字体大小等(回流+重绘)</p>\n\n<p>另外，transform<br />\n操作不会引起重绘和回流，是一种高效率的渲染。这是因为transform属于合成属性，对合成属性进行transition/animation<br />\n动画时将会创建一个合成层，这使得动画元素在一个独立的层中进行渲染，当元素的内容没有发生改变，就没必要进行重绘，浏览器会通过重新复合来创建动画帧。</p>\n\n<p><strong>6、本地存储</strong></p>\n\n<p>本地存储最原始的方式就是 cookie,cookie 是存放在本地浏览器的一段文本，数据以键值对的形式保存，可以设置过期时间。 但是 cookie<br />\n不适合大量数据的存储，因为每请求一次页面，cookie 都会发送给服务器，这使得 cookie<br />\n速度很慢而且效率也不高。因此cookie的大小被限制为4k左右(不同浏览器可能不同,分HOST)，如下所示：</p>\n\n<p>Firefox和Safari允许cookie多达4097个字节，包括名(name)、值(value) 和 等号。</p>\n\n<p>Opera允许cookie多达4096个字节，包括：名(name)、值(value)&nbsp;和 等号。</p>\n\n<p>Internet Explorer允许cookie多达4095个字节，包括：名(name)、值(value)&nbsp;和 等号。</p>\n\n<p><strong>在所有浏览器中，任何cookie大小超过限制都被忽略，且永远不会被设置。</strong></p>\n\n<p>html5 提供了两种在客户端存储数据的新方法：localStorage 和 sessionStorage, 它们都是以key/value<br />\n的形式来存储数据，前者是永久存储，后者的存储期限仅限于浏览器会话(session)，即当浏览器窗口关闭后，sessionStorage中的数据被清除。</p>\n\n<p>localStorage的存储空间大约5M左右(不同浏览器可能不同，分<br />\nHOST)，这个相当于一个5M大小的前端数据库，相比于cookie，可以节约带宽，但localStorage在浏览器隐私模式下是不可读取的，当存储数据超过了localStorage<br />\n的存储空间后会抛出异常。</p>\n\n<p>此外，H5还提供了逆天的websql和<br />\nindexedDB，允许前端以关系型数据库的方式来存储本地数据，相对来说，这个功能目前应用的场景比较少，此处不作介绍。</p>\n\n<p><strong>7、浏览器缓存机制</strong></p>\n\n<p>浏览器缓存机制是指通过 HTTP 协议头里的 Cache-Control (或 Expires) 和 Last-Modified (或 Etag)<br />\n等字段来控制文件缓存的机制。</p>\n\n<p>Cache-Control 用于控制文件在本地缓存有效时长。最常见的，比如服务器回包：Cache-Control:max-age=600<br />\n表示文件在本地应该缓存，且有效时长是600秒 (从发出请求算起)。在接下来600秒内，如果有请求这个资源，浏览器不会发出 HTTP<br />\n请求，而是直接使用本地缓存的文件。</p>\n\n<p>Last-Modified 是标识文件在服务器上的最新更新时间。下次请求时，如果文件缓存过期，浏览器通过 If-Modified-Since<br />\n字段带上这个时间，发送给服务器，由服务器比较时间戳来判断文件是否有修改。如果没有修改，服务器返回304告诉浏览器继续使用缓存；如果有修改，则返回200，同时返回最新的文件。</p>\n\n<p>Cache-Control 通常与 Last-Modified 一起使用。一个用于控制缓存有效时间，一个在缓存失效后，向服务查询是否有更新。</p>\n\n<p>Cache-Control 还有一个同功能的字段：Expires。Expires 的值一个绝对的时间点，如：Expires: Thu, 10 Nov<br />\n2015 08:45:11 GMT，表示在这个时间点之前，缓存都是有效的。</p>\n\n<p>Expires 是 HTTP1.0 标准中的字段，Cache-Control 是 HTTP1.1<br />\n标准中新加的字段，功能一样，都是控制缓存的有效时间。当这两个字段同时出现时，Cache-Control 是高优化级的。</p>\n\n<p>Etag 也是和 Last-Modified 一样，对文件进行标识的字段。不同的是，Etag<br />\n的取值是一个对文件进行标识的特征字串。在向服务器查询文件是否有更新时，浏览器通过 If-None-Match<br />\n字段把特征字串发送给服务器，由服务器和文件最新特征字串进行匹配，来判断文件是否有更新。没有更新回包304，有更新回包200。Etag 和<br />\nLast-Modified 可根据需求使用一个或两个同时使用。两个同时使用时，只要满足基中一个条件，就认为文件没有更新。</p>\n\n<p>另外有两种特殊的情况：</p>\n\n<p>手动刷新页面(F5)，浏览器会直接认为缓存已经过期(可能缓存还没有过期)，在请求中加上字段：Cache-Control:max-age=0，发包向服务器查询是否有文件是否有更新。</p>\n\n<p>强制刷新页面(Ctrl+F5)，浏览器会直接忽略本地的缓存(有缓存也会认为本地没有缓存)，在请求中加上字段：Cache-Control:no-cache<br />\n(或 Pragma:no-cache)，发包向服务重新拉取文件。</p>\n\n<p><strong>8、History</strong></p>\n\n<p>用户访问网页的历史记录通常会被保存在一个类似于栈的对象中，即history对象，点击返回就出栈，跳下一页就入栈。 它提供了以下方法来操作页面的前进和后退：</p>\n\n<p>window.history.back( ) &nbsp;返回到上一个页面</p>\n\n<p>window.history.forward( ) &nbsp;进入到下一个页面</p>\n\n<p>window.history.go( [delta] ) &nbsp;跳转到指定页面</p>\n\n<p>HTML5 对History Api 进行了增强，新增了两个Api 和一个事件，分别是pushState、replaceState 和<br />\nonpopstate：</p>\n\n<p>pushState是往history对象里添加一个新的历史记录，即压栈。</p>\n\n<p>replaceState 是替换history对象中的当前历史记录。</p>\n\n<p>当点击浏览器后退按钮或 js调用history.back 都会触发 onpopstate 事件。</p>\n\n<p>与其类似的还有一个事件：onhashchange，onhashchange是老API，浏览器支持度高，本来是用来监听hash变化的，但可以被利用来做客户端前进和后退事件的监听，而onpopstate是专门用来监听浏览器前进后退的，不仅可以支持hash，非hash的同源<br />\nurl 也支持。</p>\n\n<p><strong>9、HTML5离线缓存</strong></p>\n\n<p>HTML5离线缓存又叫Application<br />\nCache，是从浏览器的缓存中分出来的一块缓存区，如果要在这个缓存中保存数据，可以使用一个描述文件（manifest file），列出要下载和缓存的资源。</p>\n\n<p>manifest 文件是简单的文本文件，它告知浏览器被缓存的内容（以及不缓存的内容）。manifest 文件可分为三个部分：</p>\n\n<p>-&nbsp;CACHE MANIFEST&nbsp;- 在此标题下列出的文件将在首次下载后进行缓存</p>\n\n<p>-&nbsp;NETWORK&nbsp;- 在此标题下列出的文件需要与服务器的连接，且不会被缓存</p>\n\n<p>-&nbsp;FALLBACK&nbsp;- 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）</p>\n\n<p>离线缓存为应用带来三个优势：</p>\n\n<p>离线浏览 - 用户可在应用离线时使用它们</p>\n\n<p>速度 - 已缓存资源加载得更快</p>\n\n<p>减少服务器负载 - 浏览器将只从服务器下载更新过或更改过的资源。</p>\n\n<p><strong>10、Web语义化 和 SEO</strong></p>\n\n<p>Web语义化是指使用语义恰当的标签，使页面有良好的结构，页面元素有含义，能够让人和搜索引擎都容易理解。</p>\n\n<p>SEO是指在了解搜索引擎自然排名机制的基础之上，对网站进行内部及外部的调整优化，改进网站在搜索引擎中关键词的自然排名，获得更多的展现量，吸引更多目标客户点击访问网站，从而达到互联网营销及品牌建设的目标。</p>\n\n<p>搜索引擎通过爬虫技术获取的页面就是由一堆 html 标签组成的代码，人可以通过可视化的方式来判断页面上哪些内容是重点，而机器做不到。<br />\n但搜索引擎会根据标签的含义来判断内容的权重，因此，在合适的位置使用恰当的标签，使整个页面的语义明确，结构清晰，搜索引擎才能正确识别页面中的重要内容，并予以较高的权值。比如h1~h6这几个标签在SEO中的权值非常高，用它们作页面的标题就是一个简单的SEO优化。</p>\n, 参数5:a9a747d944c24845815356f72723ef8e, 参数6:0, 参数7:0, 参数8:0, 参数9:1, 参数10:陌溪_, 参数11:蘑菇博客, 参数12:ca28ffc94ea94fbda5571e0b242021e2, 参数13:018f9739272944dbb32c251373b0744a, ','增加博客',1,'2018-12-29 10:49:47','2018-12-29 10:49:47'),('bc361023ef2b488d94a4533e6451b47b','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:4000982427cb47edb8c626f409d5377d, 参数3:Linux下Mysql定时备份, 参数4:Linux下Mysql定时备份, 参数5:<p>&nbsp; &nbsp; &nbsp; &nbsp;记得原来第一次使用服务器的时候，当初写了一个小网站，想要上传到服务器上去，当初服务器是买的国外的，因为部署的时候，为了方便，就在控制台把防火墙关闭了！（特别提醒，以后千万别干这种傻事），关闭后就开始安装MariaDB，（MariaDB是mysql的社区版），然后端口号和密码都采用的是初始化的，3306，admin admin，所以网站部署完成以后，第二天就被黑客进行端口扫描后，暴力破解了。留下一条索要比特币恢复数据的记录。&nbsp;&nbsp;&nbsp;</p>\n\n<p>&nbsp; &nbsp; &nbsp; 虽然说我们这个网站也没啥人访问，数据丢了也损失不大，但是如果平时写的博客，上传的图片不见了，也会郁闷一阵子。为了防范未然，我们还是采取一点挽救的措施，比如在服务器上面设置定时备份数据库的任务。好啦，下面进入正题！</p>\n\n<p>&nbsp;</p>\n\n<p>1）我们首先创建一个 &nbsp;bak.sh 的脚本文件，然后输入下面的（下面的命令是我给我现在博客设计的，大概意思就是进入 /bak目录下，然后使用 mysqldump 命令对 mogu_picture 和 mogu_blog表进行备份，然后完事后将数据库添加到压缩文件，同时最后就是讲八天前的数据删除，只保留七天的）</p>\n\n<pre>\n<code class=\"language-bash\">#!/bin/sh\n\nbseDir=\"/bak\";\n\ncd \"$baseDir\";\n\necho \"开始备份数据库\";\n\n#开始备份mogu_blog数据库\n\necho `mysqldump  -uroot -p\'admin\' --default-character-set=utf8  mogu_blog &gt; mogu_blog_$(date +%Y%m%d).sql`;\n\n#开始备份mogu_picture数据库\n\necho `mysqldump  -uroot -p\'w1313375\' --default-character-set=utf8  mogu_picture &gt; mogu_picture_$(date +%Y%m%d).sql`;\n\necho \"正在进行备份文件打包\"\n\necho `tar zcvf mogu_blog_$(date +%Y%m%d).tar.gz  mogu_blog_$(date +%Y%m%d).sql mogu_picture_$(date +%Y%m%d).sql `;\n\necho `rm -rf mogu_blog_$(date +%Y%m%d).sql`;\n\necho `rm -rf mogu_picture_$(date +%Y%m%d).sql`;\n\necho \"备份数据完成\";\n\noldDate=`date --date=\'8 day ago\' +%Y%m%d`;\n\n#删除当前日期-8的备份\n\necho `rm -rf mogu_blog_$oldDate*`;\n\necho \"删除$oldDate的备份成功\"</code></pre>\n\n<p>2) 下面就是使用定时任务，每天执行一次 脚本, 这是使用的是crond</p>\n\n<p>&nbsp; &nbsp; crond是linux下用来周期性的执行某种任务或等待处理某些事件的一个守护进程，与windows下的计划任务类似，当安装完成操作系统后，默认会安装此服务工具，并且会自动启动crond进程，crond进程每分钟会定期检查是否有要执行的任务，如果有要执行的任务，则自动执行该任务。</p>\n\n<p>&nbsp; &nbsp; 用户定期要执行的工作，比如用户数据备份、定时邮件提醒等。用户可以使用&nbsp;crontab&nbsp;工具来定制自己的计划任务。所有用户定义的crontab&nbsp;文件都被保存在&nbsp;/var/spool/cron目录中。其文件名与用户名一致。</p>\n\n<p><strong>crontab文件的含义：</strong></p>\n\n<p>用户所建立的crontab文件中，每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：</p>\n\n<p>minute&nbsp;&nbsp;&nbsp;hour&nbsp;&nbsp;&nbsp;day&nbsp;&nbsp;&nbsp;month&nbsp;&nbsp;&nbsp;week&nbsp;&nbsp;&nbsp;command</p>\n\n<p>其中：</p>\n\n<p>minute：&nbsp;表示分钟，可以是从0到59之间的任何整数。</p>\n\n<p>hour：表示小时，可以是从0到23之间的任何整数。</p>\n\n<p>day：表示日期，可以是从1到31之间的任何整数。</p>\n\n<p>month：表示月份，可以是从1到12之间的任何整数。</p>\n\n<p>week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。</p>\n\n<p>command：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。</p>\n\n<p><img alt=\"\" src=\"http://120.79.70.126:8600/ckEditorUploadImg/1541314306339.png\" style=\"height:450px; width:542px\" /></p>\n\n<p><strong>在以上各个字段中，还可以使用以下特殊字符：</strong></p>\n\n<p>星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。</p>\n\n<p>逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，&ldquo;1,2,5,7,8,9&rdquo;</p>\n\n<p>中杠（-）：可以用整数之间的中杠表示一个整数范围，例如&ldquo;2-6&rdquo;表示&ldquo;2,3,4,5,6&rdquo;</p>\n\n<p>正斜线（/）：可以用正斜线指定时间的间隔频率，例如&ldquo;0-23/2&rdquo;表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。</p>\n\n<pre>\n<code>1、首先先按照crond\n\nyum install crontabs\n\n2、crond启动命令\n\nsystemctl start crond\n\n3、关闭\n\nsystemctl stop crond\n\n4、开启自启\n\nsystemctl enable crond</code></pre>\n\n<p>&nbsp;</p>\n\n<p>那么介绍就到这里了，下面我们需要开始创建定时任务了！</p>\n\n<p>首先使用&nbsp; crontab -e 命令 ，会打开一个创建定时任务的vi窗口</p>\n\n<pre>\n<code>0 2 * * * /bak/mogu_blog.sh</code></pre>\n\n<p>然后我们输入上面的命令，就是每天2点，执行&nbsp; /bak文件夹下的定时备份脚本</p>\n\n<p>&nbsp;</p>\n, 参数6:1d1fd6d26c8e40a38637ef6126c45cd0,0b51c75ed5744cdcadefe0ad947be9b6, 参数7:2c93dfab0e754006866f8ed486923a41, 参数8:2, 参数9:4, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:8f1b96ca6c844882858efca25923a62c, ','编辑博客',1,'2018-12-29 10:35:10','2018-12-29 10:35:10'),('be4add382aa24be99694476576199347','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@2ec7acf4]], 参数2:c459e7c261884086b5e462fa4f26cc04, 参数3:简单实现MySQL数据库的日志审计, 参数4:简单实现MySQL数据库的日志审计, 参数5:<p>来源：https://www.freebuf.com/articles/es/192062.html</p>\n\n<h2>0&times;0 背景&nbsp;</h2>\n\n<p><strong>由于MySQL社区版没有自带的审计功能或插件，对于等级保护当中对数据库管理的要求的就存在一定的不满足情况的，抛开条条框框不说数据库的日志是值得研究的，通过收集数据库的日志到企业SOC平台便于安全事件的溯源与故障分析，配合目前的UEBA技术能够轻松发现很多恶意事件。&nbsp;</strong></p>\n\n<p>根据等级保护内容第四章&ldquo;数据库管理系统安全技术要求&rdquo;中&nbsp;第四节&ldquo;数据库安全审计&rdquo;中明确提出数据库管理系统的安全审计应：</p>\n\n<blockquote>\n<p>1. 建立独立的安全审计系统；</p>\n\n<p>2. 定义与数据库安全相关的审计事件；</p>\n\n<p>3. 设置专门的安全审计员；</p>\n\n<p>4. 设置专门用于存储数据库系统审计数据的安全审计库；</p>\n\n<p>5. 提供适用于数据库系统的安全审计设置、分析和查阅的工具。&nbsp;</p>\n</blockquote>\n\n<h2>0&times;1 部署插件</h2>\n\n<p><strong>&nbsp;</strong>为了节省购买一些安全设备的费用，可以尝试使用一些开源的日志审计插件。Mysql-audit是macfee公司基于percona开发的MySQL的SQL审计插件。</p>\n\n<blockquote>\n<p>源码地址如下：<a href=\"https://github.com/mcafee/mysql-audit\">https://github.com/mcafee/mysql-audit</a></p>\n</blockquote>\n\n<p>首先确定当前mysql的版本去官网下载与之相对应的插件：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片1.png\" src=\"https://image.3001.net/images/20181216/1544951755_5c1617cb30a92.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片2.png\" src=\"https://image.3001.net/images/20181216/1544951805_5c1617fd0ada4.png!small\" style=\"width:690px\" /></a></p>\n\n<p>&nbsp;解压插件后需要确认mysql插件的安装目录：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片3.png\" src=\"https://image.3001.net/images/20181216/1544951784_5c1617e8e8576.png!small\" style=\"width:690px\" /></a></p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片4.png\" src=\"https://image.3001.net/images/20181216/1544951791_5c1617efb3289.png!small\" style=\"width:566px\" /></a></p>\n\n<p>将解压出来的插件libaudit_plugin.so复制到插件的目录下：</p>\n\n<p><a href=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png\" onclick=\"return hs.expand(this);\" target=\"_blank\"><img alt=\"图片5.png\" src=\"https://image.3001.net/images/20181216/1544951806_5c1617fe32e94.png!small\" style=\"width:690px\" /></a></p>\n\n<p>使用mysql的函数install plugin导入此插件后通过show plugin确认是否导入成功。</p>\n\n<p>主要命令如下：</p>\n\n<pre>\n<code>install plugin audit soname ‘libaudit_plugin.so’</code></pre>\n\n<p><img alt=\"图片6.png\" src=\"https://image.3001.net/images/20181216/1544951819_5c16180b1c8a8.png!small\" style=\"width:690px\" /><img alt=\"图片7.png\" src=\"https://image.3001.net/images/20181216/1544951820_5c16180cb659a.png!small\" style=\"width:690px\" /></p>\n\n<p>安装完成之后并不会立马开始审计内容，需要定义一些参数。</p>\n\n<p>Audit_json_file这个参数要整体控制是否开启审计功能使用命令：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Set variables audit_json_file=on</code></pre>\n\n<p>&nbsp; 开启审计功能：</p>\n\n<p><img alt=\"图片8.png\" src=\"https://image.3001.net/images/20181216/1544951841_5c1618210a29a.png!small\" style=\"width:580px\" /></p>\n\n<p>审计后的记录名可以通过查询变量audit_json_log_file获取：</p>\n\n<p>&nbsp;</p>\n\n<pre>\n<code>Show variables like “audit_json_log_file”</code></pre>\n\n<p>默认的审计记录格式如下：</p>\n\n<p><img alt=\"图片9.png\" src=\"https://image.3001.net/images/20181216/1544951858_5c16183262f9c.png!small\" style=\"width:690px\" /></p>\n\n<p>Json格式如下：</p>\n\n<p><img alt=\"图片10.png\" src=\"https://image.3001.net/images/20181216/1544951874_5c1618427bc3e.png!small\" style=\"width:690px\" /></p>\n\n<p>同时插件支持一些自定义的参数与命令，包括白名单与黑名单的功能。</p>\n\n<blockquote>\n<p>Audit_whitelist_users: 不审计user用户的所有命令</p>\n\n<p>Aduit_record_cmds: 需要进行审计的命令种类</p>\n</blockquote>\n\n<p><img alt=\"图片11.png\" src=\"https://image.3001.net/images/20181216/1544951883_5c16184b68f60.png!small\" style=\"width:601px\" /></p>\n\n<p>更多的参数配置项目可以参考官方给的手册：</p>\n\n<blockquote>\n<p><a href=\"https://github.com/mcafee/mysql-audit/wiki/Configuration\">https://github.com/mcafee/mysql-audit/wiki/Configuration</a></p>\n</blockquote>\n\n<p><img alt=\"图片12.png\" src=\"https://image.3001.net/images/20181216/1544951898_5c16185aeaa2e.png!small\" style=\"width:690px\" /></p>\n\n<h2>0&times;2 总结</h2>\n\n<p>1. 通过插件的方式可以实现mysql日志的审计通过ELK的框架实现日志的保存与分析，再通过后期写一些脚本分析可以实现安全检测与业务分析等多个功能，关键是零成本特别适合那些&rdquo;一个人的安全部&rdquo;有此需求的同行们.&nbsp;</p>\n\n<p>2. 根据一些测试数据表示，插件对性能的影响是比较大的约有20%左右的消耗需要结合具体的业务情况进行评估。</p>\n, 参数6:8d5ce3e0c0784b95adb7f9e7b76dca93, 参数7:093d8bdd01c84890a928e923d5c235fe, 参数8:0, 参数9:0, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:https://www.freebuf.com/articles/es/192062.html, 参数14:e06331bc9fff4a7186439f2a34c199af, ','编辑博客',1,'2018-12-29 10:29:54','2018-12-29 10:29:54'),('bfea68e790fa49b2b492c7b3801bd9f1','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:6c5d0f1850ee4204b3669d9cd4a3b080, 参数3:微服务注册中心如何承载大型系统的千万级访问？, 参数4:Spring Cloud架构体系中，Eureka是一个至关重要的组件，它扮演着微服务注册中心的角色，所有的服务注册与服务发现，都是依赖Eureka的。, 参数5:<p><strong>一、问题起源</strong></p>\n\n<p>Spring Cloud架构体系中，Eureka是一个至关重要的组件，它扮演着微服务注册中心的角色，所有的服务注册与服务发现，都是依赖Eureka的。</p>\n\n<p><br />\n不少初学Spring Cloud的朋友在落地公司生产环境部署时，经常会问：</p>\n\n<ul>\n	<li>\n	<p>Eureka Server到底要部署几台机器？</p>\n	</li>\n	<li>\n	<p>我们的系统那么多服务，到底会对Eureka Server产生多大的访问压力？</p>\n	</li>\n	<li>\n	<p>Eureka Server能不能抗住一个大型系统的访问压力？</p>\n	</li>\n</ul>\n\n<p><br />\n如果你也有这些疑问，别着急！咱们这就一起去看看，Eureka作为微服务注册中心的核心原理</p>\n\n<p>&nbsp;</p>\n\n<p>下面这些问题，大家先看看，有个大概印象。带着这些问题，来看后面的内容，效果更佳</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>Eureka注册中心使用什么样的方式来储存各个服务注册时发送过来的机器地址和端口号？</p>\n	</li>\n	<li>\n	<p>各个服务找Eureka Server拉取注册表的时候，是什么样的频率？</p>\n	</li>\n	<li>\n	<p>各个服务是如何拉取注册表的？</p>\n	</li>\n	<li>\n	<p>一个几百服务，部署上千台机器的大型分布式系统，会对Eureka Server造成多大的访问压力？</p>\n	</li>\n	<li>\n	<p>Eureka Server从技术层面是如何抗住日千万级访问量的？</p>\n	</li>\n</ol>\n\n<p>先给大家说一个基本的知识点，各个服务内的Eureka Client组件，默认情况下，每隔30秒会发送一个请求到Eureka Server，来拉取最近有变化的服务信息</p>\n\n<p>&nbsp;</p>\n\n<p><strong>举个例子</strong>：</p>\n\n<ul>\n	<li>\n	<p>库存服务原本部署在1台机器上，现在扩容了，部署到了3台机器，并且均注册到了Eureka Server上。</p>\n	</li>\n	<li>\n	<p>然后订单服务的Eureka Client会每隔30秒去找Eureka Server拉取最近注册表的变化，看看其他服务的地址有没有变化。</p>\n	</li>\n</ul>\n\n<p>除此之外，Eureka还有一个心跳机制，各个Eureka Client每隔30秒会发送一次心跳到Eureka Server，通知人家说，哥们，我这个服务实例还活着！</p>\n\n<p>如果某个Eureka Client很长时间没有发送心跳给Eureka Server，那么就说明这个服务实例已经挂了。</p>\n\n<p>光看上面的文字，大家可能没什么印象。老规矩！咱们还是来一张图，一起来直观的感受一下这个过程。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462396419.png\" style=\"height:359px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、Eureka Server设计精妙的注册表存储结构</strong></p>\n\n<p>现在咱们假设手头有一套大型的分布式系统，一共100个服务，每个服务部署在20台机器上，机器是4核8G的标准配置。</p>\n\n<p>也就是说，相当于你一共部署了100 * 20 = 2000个服务实例，有2000台机器。</p>\n\n<p>每台机器上的服务实例内部都有一个Eureka Client组件，它会每隔30秒请求一次Eureka Server，拉取变化的注册表。</p>\n\n<p>此外，每个服务实例上的Eureka Client都会每隔30秒发送一次心跳请求给Eureka Server。</p>\n\n<p>&nbsp;</p>\n\n<p>那么大家算算，Eureka Server作为一个微服务注册中心，<strong>每秒钟要被请求多少次？一天要被请求多少次？</strong></p>\n\n<ul>\n	<li>\n	<p>按标准的算法，每个服务实例每分钟请求2次拉取注册表，每分钟请求2次发送心跳</p>\n	</li>\n	<li>\n	<p>这样一个服务实例每分钟会请求4次，2000个服务实例每分钟请求8000次</p>\n	</li>\n	<li>\n	<p>换算到每秒，则是8000 / 60 = 133次左右，我们就大概估算为Eureka Server每秒会被请求150次</p>\n	</li>\n	<li>\n	<p>那一天的话，就是8000 * 60 * 24 = 1152万，也就是<strong>每天千万级访问量</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>好！经过这么一个测算，大家是否发现这里的奥秘了？</strong></p>\n\n<ul>\n	<li>\n	<p>首先，对于微服务注册中心这种组件，在一开始设计它的拉取频率以及心跳发送频率时，就已经考虑到了一个大型系统的各个服务请求时的压力，每秒会承载多大的请求量。</p>\n	</li>\n	<li>\n	<p>所以各服务实例<strong>每隔30秒</strong>发起请求拉取变化的注册表，以及<strong>每隔30秒</strong>发送心跳给Eureka Server，其实这个时间安排是有其用意的。</p>\n	</li>\n</ul>\n\n<p>按照我们的测算，一个上百个服务，几千台机器的系统，按照这样的频率请求Eureka Server，日请求量在千万级，每秒的访问量在150次左右。</p>\n\n<p>即使算上其他一些额外操作，我们姑且就算每秒钟请求Eureka Server在200次~300次吧。</p>\n\n<p>所以通过设置一个适当的拉取注册表以及发送心跳的频率，可以保证大规模系统里对Eureka Server的请求压力不会太大。</p>\n\n<p><strong>关键问题来了</strong><strong>，Eureka Server是如何保证轻松抗住这每秒数百次请求，每天千万级请求的呢？</strong></p>\n\n<p>要搞清楚这个，首先得清楚Eureka&nbsp;Server到底是用什么来存储注册表的？三个字，<strong>看源码</strong></p>\n\n<p>&nbsp;</p>\n\n<p><strong>接下来咱们就一起进入Eureka源码里一探究竟：</strong></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462475383.png\" style=\"height:160px; width:800px\" /></p>\n\n<ul>\n	<li>\n	<p>如上图所示，图中的这个名字叫做<strong>registry</strong>的<strong>CocurrentHashMap</strong>，就是注册表的核心结构。看完之后忍不住先赞叹一下，精妙的设计！</p>\n	</li>\n	<li>\n	<p>从代码中可以看到，Eureka&nbsp;Server的注册表直接基于<strong>纯内存</strong>，即在内存里维护了一个数据结构。</p>\n	</li>\n	<li>\n	<p>各个服务的注册、服务下线、服务故障，全部会在内存里维护和更新这个注册表。</p>\n	</li>\n	<li>\n	<p>各个服务每隔30秒拉取注册表的时候，Eureka&nbsp;Server就是直接提供内存里存储的有变化的注册表数据给他们就可以了。</p>\n	</li>\n	<li>\n	<p>同样，每隔30秒发起心跳时，也是在这个纯内存的Map数据结构里更新心跳时间。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>一句话概括</strong>：维护注册表、拉取注册表、更新心跳时间，全部发生在内存里！这是Eureka Server非常核心的一个点。</p>\n\n<p>搞清楚了这个，咱们再来分析一下registry这个东西的数据结构，大家千万别被它复杂的外表唬住了，沉下心来，一层层的分析！</p>\n\n<ul>\n	<li>\n	<p>首先，这个ConcurrentHashMap的key就是服务名称，比如&ldquo;inventory-service&rdquo;，就是一个服务名称。</p>\n	</li>\n	<li>\n	<p>value则代表了一个服务的多个服务实例。</p>\n	</li>\n	<li>\n	<p>举例：比如&ldquo;inventory-service&rdquo;是可以有3个服务实例的，每个服务实例部署在一台机器上。</p>\n	</li>\n</ul>\n\n<p>再来看看作为value的这个Map：</p>\n\n<p>&nbsp;&nbsp;&nbsp;&nbsp;<strong>Map&lt;String, Lease&lt;InstanceInfo</strong><strong>&gt;</strong>&gt;</p>\n\n<ul>\n	<li>\n	<p>这个Map的key就是<strong>服务实例的id</strong></p>\n	</li>\n	<li>\n	<p>value是一个叫做<strong>Lease</strong>的类，它的泛型是一个叫做<strong>InstanceInfo</strong>的东东，你可能会问，这俩又是什么鬼？</p>\n	</li>\n	<li>\n	<p>首先说下InstanceInfo，其实啊，我们见名知义，这个InstanceInfo就代表了<strong>服务实例的具体信息</strong>，比如机器的ip地址、hostname以及端口号。</p>\n	</li>\n	<li>\n	<p>而这个Lease，里面则会维护每个服务<strong>最近一次发送心跳的时间</strong></p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>三、Eureka Server端优秀的多级缓存机制</strong></p>\n\n<p>假设Eureka Server部署在4核8G的普通机器上，那么<strong>基于内存来承载各个服务的请求，每秒钟最多可以处理多少请求呢？</strong></p>\n\n<ul>\n	<li>\n	<p>根据之前的测试，单台4核8G的机器，处理纯内存操作，哪怕加上一些网络的开销，每秒处理几百请求也是轻松加愉快的。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>而且Eureka Server为了避免同时读写内存数据结构造成的并发冲突问题，还采用了<strong>多级缓存机制</strong>来进一步提升服务请求的响应速度。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在拉取注册表的时候：首先从<strong>ReadOnlyCacheMap</strong>里查缓存的注册表。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>若没有，就找<strong>ReadWriteCacheMap</strong>里缓存的注册表。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>如果还没有，就从<strong>内存中获取实际的注册表数据。</strong></li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>在注册表发生变更的时候：会在内存中更新变更的注册表数据，同时<strong>过期掉ReadWriteCacheMap</strong>。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>此过程不会影响ReadOnlyCacheMap提供人家查询注册表。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>一段时间内（默认30秒），各服务拉取注册表会直接读ReadOnlyCacheMap</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>30秒过后，Eureka Server的后台线程发现ReadWriteCacheMap已经清空了，也会清空ReadOnlyCacheMap中的缓存</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>下次有服务拉取注册表，又会从内存中获取最新的数据了，同时填充各个缓存。</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>多级缓存机制的优点是什么？</strong></p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>尽可能保证了内存注册表数据不会出现频繁的读写冲突问题。</p>\n	</li>\n	<li>\n	<p>并且进一步保证对Eureka Server的大量请求，都是快速从纯内存走，性能极高。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>为方便大家更好的理解，同样来一张图，大家跟着图再来回顾一下这整个过程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542462665485.png\" style=\"height:396px; width:800px\" /></p>\n\n<p><strong>四、总结</strong></p>\n\n<ul>\n	<li>\n	<p>通过上面的分析可以看到，Eureka通过设置适当的请求频率<strong>（拉取注册表30秒间隔，发送心跳30秒间隔）</strong>，可以保证一个大规模的系统每秒请求Eureka Server的次数在几百次。</p>\n	</li>\n	<li>\n	<p>同时通过纯内存的注册表，保证了所有的请求都可以在内存处理，确保了极高的性能</p>\n	</li>\n	<li>\n	<p>另外,多级缓存机制，确保了不会针对内存数据结构发生频繁的读写并发冲突操作，进一步提升性能。</p>\n	</li>\n</ul>\n\n<p>上述就是Spring Cloud架构中，Eureka作为微服务注册中心可以承载大规模系统每天千万级访问量的原理。</p>\n, 参数6:e81bc2dca42c4031be7d66fef4a71e16, 参数7:2c93dfab0e754006866f8ed486923a41, 参数8:0, 参数9:4, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:e94e738ed04f4471b673de155e393a0b, ','编辑博客',1,'2018-12-29 10:31:06','2018-12-29 10:31:06'),('c83a489cd0c7492c9c2cf9a5c5743e56','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/picture/add','POST','com.moxi.mogublog.admin.restapi.PictureRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@4cee3ce6]], 参数2:1c64848f38ca4dc39ae3e140d3925f4e,, 参数3:0927c1e18a8c4677b1cce28c17bf0382, ','增加图片',1,'2018-12-30 11:30:38','2018-12-30 11:30:38'),('d497cc36d5304229825d63d76b6894e5','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@5a0bcbdc]], 参数2:208692b2a7a242f4942993abb8eebf8b, 参数3:哥们，消息中间件在你们项目里是如何落地的？, 参数4:哥们，消息中间件在你们项目里是如何落地的？, 参数5:<p>来源：石杉的架构笔记</p>\n\n<h1><strong><strong>一、前情回顾</strong></strong></h1>\n\n<p>之前给大家聊了一下，面试时如果遇到消息中间件这个话题，面试官上来可能问的两个问题：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>你们的系统架构中为什么要引入消息中间件？</p>\n	</li>\n	<li>\n	<p>系统架构中引入消息中间件有什么缺点？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>关于这两个问题的回答，可以参见之前的两篇文章：</p>\n\n<ul>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件？</a>》</p>\n	</li>\n	<li>\n	<p>《&nbsp;<a href=\"http://www.moguit.cn/#/info?blogUid=bcdb3ee0332a440994216682cf850ed6\" target=\"_blank\">哥们，那你说说系统架构中引入消息中间件有什么缺点？</a>》</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>在问完这两个问题之后，不同风格的面试官可能会展开不同的发问。</p>\n\n<p>&nbsp;</p>\n\n<p>针对那种工作年限比较长的资深的同学，可能会开始就候选人所在公司使用的消息中间件，深入里面的技术细节，比如让你聊聊RocketMQ的架构原理和核心源码？</p>\n\n<p>&nbsp;</p>\n\n<p>但是另外一种面试风格，会先从你们的项目和业务入手进行考察，比如像下面这样：</p>\n\n<p>&nbsp;</p>\n\n<ul>\n	<li>\n	<p>消息中间件在你们生产项目里具体是哪个业务场景下落地的？</p>\n	</li>\n	<li>\n	<p>这个业务场景有什么技术挑战？</p>\n	</li>\n	<li>\n	<p>为什么必须要在这个业务场景里用消息中间件技术？</p>\n	</li>\n	<li>\n	<p>具体使用消息中间件的时候是怎么来用的？</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>好！这篇文章，咱们从第二种风格来聊聊。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>二、业务场景介绍</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>我们会落地到某个具体业务系统的某个场景下，看看如何使用消息中间件，然后其效果是什么。</p>\n\n<p>&nbsp;</p>\n\n<p>业务场景的话，咱们就用大家都很熟悉的<strong>电商业务</strong>为例，这里为了便于理解，对其做了一定的抽象和简化。</p>\n\n<p>&nbsp;</p>\n\n<p>大家还是来考虑一个下订单的业务流程，比如你下个订单，此时需要干几件事情：</p>\n\n<p>&nbsp;</p>\n\n<ol>\n	<li>\n	<p>更新订单状态为&ldquo;待发货&rdquo;（耗时20ms）</p>\n	</li>\n	<li>\n	<p>扣减商品库存（耗时100ms）</p>\n	</li>\n	<li>\n	<p>增加会员积分（耗时80ms）</p>\n	</li>\n	<li>\n	<p>附赠优惠券（耗时50ms）</p>\n	</li>\n	<li>\n	<p>仓储调度发货（耗时几十秒）。</p>\n	</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>说明一下：上述环节，为了便于大家理解，做了简化。实际真正复杂的电商系统里，整体环节和业务流程会比这个复杂很多倍，而且耗时也绝对不是上面那么简单的。</p>\n\n<p>&nbsp;</p>\n\n<p>老规矩！我们还是通过一张手绘图，来看看这整个的业务流程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144696893.png\" style=\"height:400px; width:675px\" /></p>\n\n<p>如上图，这个下订单的业务流程中：</p>\n\n<p>更新订单状态（20ms） + &nbsp;扣减商品库存（100ms） + &nbsp;增加会员积分（80ms） + &nbsp;附赠优惠券（50ms） = &nbsp;250ms。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，仅仅是这4个流程的话，也就200多毫秒的耗时。</p>\n\n<p>&nbsp;</p>\n\n<p>200多毫秒的耗时，对用户下单体验来说是非常快速的，几乎就是一瞬间就完成了，不会感到过多的停顿，也就是一下子就可以看到自己下单成功了。</p>\n\n<p>&nbsp;</p>\n\n<p>但是，如果加上那个调度仓储发货呢？</p>\n\n<p>&nbsp;</p>\n\n<p>那个环节需要读取大量的数据、使用多仓库/多货位的调度算法、还要跟C/S架构的仓储系统进行网络通信，因此我们这里假设这个环节可能会耗时数十秒。</p>\n\n<p>&nbsp;</p>\n\n<p>一旦加上那个调度仓储发货的环节到这个下单流程里，就可能导致用户要等页面卡顿几十秒后才会看到下单成功的提示，这个用户体验就相当的差了。</p>\n\n<p>&nbsp;</p>\n\n<p>按照之前一篇文章《<a href=\"http://www.moguit.cn/#/info?blogUid=3008b19a20cd46aba7b62d619e7c5700\" target=\"_blank\">哥们，你们的系统架构中为什么要引入消息中间件呢？</a>》的说法。对于这种场景，完全适合使用消息中间件来进行异步化调用。</p>\n\n<p>&nbsp;</p>\n\n<p>也就是说，订单服务对仓储调度发货，仅仅是发送一个消息到MQ里，然后仓储服务消费消息之后再慢慢的执行调度算法，然后分配商品发货任务给对应的仓库即可。</p>\n\n<p>&nbsp;</p>\n\n<p>这样的话，就可以把耗时几十秒的仓储调度发货的环节，从下单流程里摘除出去了。进而保证下单流程就仅仅是耗时200多毫秒而已。</p>\n\n<p>&nbsp;</p>\n\n<p>至于那个耗时几十秒的仓储调度发货环节，我们通过异步的方式慢慢执行即可，不会影响用户下单的体验。</p>\n\n<p>&nbsp;</p>\n\n<p>以上过程，我们同样来一张图，大家直观的感受一下：</p>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144724851.png\" style=\"height:408px; width:690px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong><strong>三、初步落地</strong></strong></p>\n\n<p>&nbsp;</p>\n\n<p>好！接下来我们就假设大家在实际生产中还没用过消息中间件，咱们从0开始，看看如何落地？</p>\n\n<p>&nbsp;</p>\n\n<p>对于已经在生产中使用过消息中间件的小伙伴，不妨也看看，权当复习，温故知新！</p>\n\n<p>&nbsp;</p>\n\n<p>我们以RabbitMQ为例，假如你用的消息中间件是RabbitMQ，那么我们对这个消息中间件应该如何安装和部署呢？</p>\n\n<p>&nbsp;</p>\n\n<p>很简单，RabbitMQ的官方文档里提供了非常详细的安装部署步骤，你可以在自己的笔记本电脑本地安装，也可以在公司的服务器上部署。</p>\n\n<p>&nbsp;</p>\n\n<p>现在假设你已经参考了官方文档并安装完成，那么接下来在代码层面应该怎么来引入RabbitMQ以及在系统里实现收发消息呢？</p>\n\n<p>&nbsp;</p>\n\n<p>下面通过一些HelloWorld级别的代码和一些简单的示例图，给大家演示一下RabbitMQ是如何收发消息的。</p>\n\n<p>&nbsp;</p>\n\n<p>对于很多在实际生产中使用过MQ的同学，这些代码可能对实际生产中使用过MQ的同学，显得太简单了。</p>\n\n<p>&nbsp;</p>\n\n<p>不过考虑到很多初学者可能连用都没有用过MQ，甚至是才听说消息中间件不久，所以笔者认为这些demo代码以及手工绘图，还是很有必要。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144746252.png\" style=\"height:412px; width:675px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144758533.png\" style=\"height:489px; width:676px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144769467.png\" style=\"height:629px; width:677px\" /></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144782745.png\" style=\"height:171px; width:678px\" /></p>\n\n<p>好！看完了代码，这个时候，我们可以通过一张图来想象一下两个服务之间的通信。<br />\n&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>订单服务你可以启动多个，不同的订单服务都可以往一个RabbitMQ的queue里推送消息。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务你也可以启动多个，多个仓储服务会采用<strong>round-robin</strong>的轮询算法，每个服务实例都可以从RabbitMQ queue里消费到一部分的消息。</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546144796282.png\" style=\"height:349px; width:623px\" /></p>\n\n<p>上面的图里，订单服务在MQ专业术语中叫做<strong>&ldquo;生产者&rdquo;</strong>，英文是&ldquo;Producer&rdquo;，意思就是这个服务是专门负责生产消息投递到MQ的。</p>\n\n<p>&nbsp;</p>\n\n<p>仓储服务在MQ专业术语中叫做<strong>&ldquo;消费者&rdquo;</strong>，英文是&ldquo;Consumer&rdquo;，意思就是这个服务专门是负责从MQ消费消息然后处理的。</p>\n\n<p>&nbsp;</p>\n\n<p>这个时候，这套异步通信的架构就可以跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>好了，到目前为止，虽然这个代码还存在不少问题，但是没关系，大体上我们已经给一些不太熟悉MQ技术的同学，从一个比较形象易于理解简化后的电商业务场景出发，通过HelloWorld级别的示例代码和手工绘图，将MQ这个技术落地跑起来了。</p>\n\n<p>&nbsp;</p>\n\n<p>更进一步，各位同学完全可以参照这个文章里的案例，思考一下：自己负责的项目里，有没有类似的业务场景可以使用MQ的？</p>\n\n<p>&nbsp;</p>\n\n<p>然后想办法在自己的项目里落地使用MQ的技术来做一下异步化，提升核心流程的性能。</p>\n\n<p>&nbsp;</p>\n\n<p>这样未来在跳槽面试的时候，才可以做到游刃有余，有自己的一套东西可以说。</p>\n\n<p><strong>END</strong></p>\n, 参数6:1c76b9848f5f4d71a5e88b20dbaf38f4, 参数7:e60df954efcd47c48463a504bb70bbe9, 参数8:1, 参数9:1, 参数10:0, 参数11:1, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:52b6106a19524aa8ab5543342e5152b9, ','编辑博客',1,'2018-12-30 12:50:20','2018-12-30 12:50:20'),('e610bc531fad45ce9a7a96309dea52bf','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/edit','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','edit','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:2c581c60ae6743a7a37bbe7543915483, 参数3:拜托！面试请不要再问我Spring Cloud底层原理！, 参数4:拜托！面试请不要再问我Spring Cloud底层原理！, 参数5:<p>本文转载自：https://blog.csdn.net/qq_42046105/article/details/83793787</p>\n\n<p>&nbsp;</p>\n\n<p><strong>概述</strong></p>\n\n<p>毫无疑问，Spring Cloud是目前微服务架构领域的翘楚，无数的书籍博客都在讲解这个技术。不过大多数讲解还停留在对Spring Cloud功能使用的层面，其底层的很多原理，很多人可能并不知晓。<strong>因此本文将通过大量的手绘图</strong>，给大家谈谈Spring Cloud微服务架构的底层原理。<br />\n<br />\n实际上，Spring Cloud是一个全家桶式的技术栈，包含了很多组件。本文先从其最核心的几个组件入手，来剖析一下其底层的工作原理。<strong>也就是Eureka、Ribbon、Feign、Hystrix、Zuul这几个组件。</strong></p>\n\n<p>&nbsp;</p>\n\n<h1><strong>一、业务场景介绍</strong></h1>\n\n<p>先来给大家说一个业务场景，假设咱们现在开发一个电商网站，要实现支付订单的功能，流程如下：</p>\n\n<ul>\n	<li>\n	<p>创建一个订单之后，如果用户立刻支付了这个订单，我们需要将订单状态更新为&ldquo;已支付&rdquo;</p>\n	</li>\n	<li>\n	<p>扣减相应的商品库存</p>\n	</li>\n	<li>\n	<p>通知仓储中心，进行发货</p>\n	</li>\n	<li>\n	<p>给用户的这次购物增加相应的积分</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>针对上述流程，<strong>我们需要有订单服务、库存服务、仓储服务、积分服务</strong>。整个流程的大体思路如下：</p>\n\n<ul>\n	<li>\n	<p>用户针对一个订单完成支付之后，就会去找订单服务，更新订单状态</p>\n	</li>\n	<li>\n	<p>订单服务调用库存服务，完成相应功能</p>\n	</li>\n	<li>\n	<p>订单服务调用仓储服务，完成相应功能</p>\n	</li>\n	<li>\n	<p>订单服务调用积分服务，完成相应功能</p>\n	</li>\n</ul>\n\n<p><strong>至此，整个支付订单的业务流程结束</strong></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>下图这张图，清晰表明了各服务间的调用过程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258601185.png\" style=\"height:333px; width:690px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>好！有了业务场景之后，咱们就一起来看看Spring&nbsp;Cloud微服务架构中，这几个组件如何相互协作，各自发挥的作用以及其背后的原理。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>二、Spring Cloud核心组件：Eureka</strong></p>\n\n<p><strong>咱们来考虑第一个问题</strong>：订单服务想要调用库存服务、仓储服务，或者是积分服务，怎么调用？</p>\n\n<ul>\n	<li>\n	<p>订单服务压根儿就不知道人家库存服务在哪台机器上啊！他就算想要发起一个请求，都不知道发送给谁，有心无力！</p>\n	</li>\n	<li>\n	<p>这时候，就轮到Spring Cloud Eureka出场了。Eureka是微服务架构中的注册中心，专门负责服务的注册与发现。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;咱们来看看下面的这张图，结合图来仔细剖析一下整个流程：&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542330274039.png\" style=\"height:396px; width:965px\" /></p>\n\n<p>如上图所示，库存服务、仓储服务、积分服务中都有一个Eureka Client组件，这个组件专门负责将这个服务的信息注册到Eureka Server中。说白了，就是告诉Eureka Server，自己在哪台机器上，监听着哪个端口。而Eureka Server是一个注册中心，里面有一个注册表，保存了各服务所在的机器和端口号</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>订单服务里也有一个Eureka Client组件，这个Eureka Client组件会找Eureka Server问一下：库存服务在哪台机器啊？监听着哪个端口啊？仓储服务呢？积分服务呢？然后就可以把这些相关信息从Eureka Server的注册表中拉取到自己本地缓存起来。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>这时如果订单服务想要调用库存服务，不就可以找自己本地的Eureka Client问一下库存服务在哪台机器？监听哪个端口吗？收到响应后，紧接着就可以发送一个请求过去，调用库存服务扣减库存的那个接口！同理，如果订单服务要调用仓储服务、积分服务，也是如法炮制。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>总结一下：</p>\n\n<ul>\n	<li>\n	<p><strong>Eureka</strong><strong>&nbsp;</strong><strong>Client：</strong>负责将这个服务的信息注册到Eureka Server中</p>\n	</li>\n	<li>\n	<p><strong>Eureka Server：</strong>注册中心，里面有一个注册表，保存了各个服务所在的机器和端口号</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>三、Spring Cloud核心组件：Feign</strong></h1>\n\n<p>现在订单服务确实知道库存服务、积分服务、仓库服务在哪里了，同时也监听着哪些端口号了。<strong>但是新问题又来了：难道订单服务要自己写一大堆代码，跟其他服务建立网络连接，然后构造一个复杂的请求，接着发送请求过去，最后对返回的响应结果再写一大堆代码来处理吗？</strong></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>这是上述流程翻译的代码片段，咱们一起来看看，体会一下这种绝望而无助的感受！！！</p>\n\n<p>&nbsp;</p>\n\n<p><strong>友情提示，前方高能：</strong></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258628966.png\" style=\"height:611px; width:673px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>看完上面那一大段代码，有没有感到后背发凉、一身冷汗？实际上你进行服务间调用时，如果每次都手写代码，代码量比上面那段要多至少几倍，所以这个事儿压根儿就不是地球人能干的。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>既然如此，那怎么办呢？别急，Feign早已为我们提供好了优雅的解决方案。来看看如果用Feign的话，你的订单服务调用库存服务的代码会变成啥样？</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258640136.png\" style=\"height:428px; width:673px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>看完上面的代码什么感觉？是不是感觉整个世界都干净了，又找到了活下去的勇气！没有底层的建立连接、构造请求、解析响应的代码，直接就是用注解定义一个 FeignClient接口，然后调用那个接口就可以了。人家Feign Client会在底层根据你的注解，跟你指定的服务建立连接、构造请求、发起靕求、获取响应、解析响应，等等。这一系列脏活累活，人家Feign全给你干了。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>那么问题来了，Feign是如何做到这么神奇的呢？很简单，<strong>Feign的一个关键机制就是使用了动态代理</strong>。咱们一起来看看下面的图，结合图来分析：</p>\n\n<ul>\n	<li>\n	<p>首先，如果你对某个接口定义了@FeignClient注解，Feign就会针对这个接口创建一个动态代理</p>\n	</li>\n	<li>\n	<p>接着你要是调用那个接口，本质就是会调用&nbsp;Feign创建的动态代理，这是核心中的核心</p>\n	</li>\n	<li>\n	<p>Feign的动态代理会根据你在接口上的@RequestMapping等注解，来动态构造出你要请求的服务的地址</p>\n	</li>\n	<li>\n	<p>最后针对这个地址，发起请求、解析响应</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542330312620.png\" style=\"height:270px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>四、Spring Cloud核心组件：</strong><strong>Ribbon</strong></h1>\n\n<p>说完了Feign，还没完。现在新的问题又来了，如果人家库存服务部署在了5台机器上，如下所示：</p>\n\n<ul>\n	<li>\n	<p>192.168.169:9000</p>\n	</li>\n	<li>\n	<p>192.168.170:9000</p>\n	</li>\n	<li>\n	<p>192.168.171:9000</p>\n	</li>\n	<li>\n	<p>192.168.172:9000</p>\n	</li>\n	<li>\n	<p>192.168.173:9000</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p><strong>这下麻烦了！</strong><strong>人家Feign怎么知道该请求哪台机器呢？</strong></p>\n\n<ul>\n	<li>\n	<p>这时Spring Cloud&nbsp;Ribbon就派上用场了。Ribbon就是专门解决这个问题的。它的作用是负载均衡，会帮你在每次请求时选择一台机器，均匀的把请求分发到各个机器上</p>\n\n	<p>&nbsp;</p>\n\n	<p>&nbsp;</p>\n	</li>\n	<li>\n	<p>Ribbon的负载均衡默认使用的最经典的Round&nbsp;Robin轮询算法。这是啥？简单来说，就是如果订单服务对库存服务发起10次请求，那就先让你请求第1台机器、然后是第2台机器、第3台机器、第4台机器、第5台机器，接着再来&mdash;个循环，第1台机器、第2台机器。。。以此类推。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;<strong>此外，Ribbon是和Feign以及Eureka紧密协作，完成工作的，具体如下：</strong></p>\n\n<ul>\n	<li>\n	<p>首先Ribbon会从&nbsp;Eureka Client里获取到对应的服务注册表，也就知道了所有的服务都部署在了哪些机器上，在监听哪些端口号。</p>\n	</li>\n	<li>\n	<p>然后Ribbon就可以使用默认的Round&nbsp;Robin算法，从中选择一台机器</p>\n	</li>\n	<li>\n	<p>Feign就会针对这台机器，构造并发起请求。</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>对上述整个过程，再来一张图，帮助大家更深刻的理解：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542330209181.png\" style=\"height:248px; width:800px\" /></p>\n\n<p>&nbsp;</p>\n\n<p><strong>五、Spring Cloud核心组件：Hystrix</strong></p>\n\n<p>在微服务架构里，一个系统会有很多的服务。以本文的业务场景为例：订单服务在一个业务流程里需要调用三个服务。现在假设订单服务自己最多只有100个线程可以处理请求，然后呢，积分服务不幸的挂了，每次订单服务调用积分服务的时候，都会卡住几秒钟，然后抛出&mdash;个超时异常。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>咱们一起来分析一下，这样会导致什么问题？</strong></p>\n\n<ol>\n	<li>\n	<p>如果系统处于高并发的场景下，大量请求涌过来的时候，订单服务的100个线程都会卡在请求积分服务这块。导致订单服务没有一个线程可以处理请求</p>\n	</li>\n	<li>\n	<p>然后就会导致别人请求订单服务的时候，发现订单服务也挂了，不响应任何请求了</p>\n	</li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>上面这个，就是<strong>微服务架构中恐怖的服务雪崩问题</strong>，如下图所示：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258783013.png\" style=\"height:471px; width:676px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>如上图，这么多服务互相调用，要是不做任何保护的话，某一个服务挂了，就会引起连锁反应，导致别的服务也挂。比如积分服务挂了，会导致订单服务的线程全部卡在请求积分服务这里，没有一个线程可以工作，瞬间导致订单服务也挂了，别人请求订单服务全部会卡住，无法响应。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>但是我们思考一下，就算积分服务挂了，订单服务也可以不用挂啊！</strong><strong>为什么？</strong></p>\n\n<ul>\n	<li>\n	<p>我们结合业务来看：支付订单的时候，只要把库存扣减了，然后通知仓库发货就OK了</p>\n	</li>\n	<li>\n	<p>如果积分服务挂了，大不了等他恢复之后，慢慢人肉手工恢复数据！为啥一定要因为一个积分服务挂了，就直接导致订单服务也挂了呢？不可以接受！</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>现在问题分析完了，如何解决？</strong></p>\n\n<p>这时就轮到Hystrix闪亮登场了。Hystrix是隔离、熔断以及降级的一个框架。啥意思呢？说白了，Hystrix会搞很多个小小的线程池，比如订单服务请求库存服务是一个线程池，请求仓储服务是一个线程池，请求积分服务是一个线程池。每个线程池里的线程就仅仅用于请求那个服务。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>打个比方：现在很不幸，积分服务挂了，会咋样？</strong></p>\n\n<p>当然会导致订单服务里的那个用来调用积分服务的线程都卡死不能工作了啊！但是由于订单服务调用库存服务、仓储服务的这两个线程池都是正常工作的，所以这两个服务不会受到任何影响。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>这个时候如果别人请求订单服务，订单服务还是可以正常调用库存服务扣减库存，调用仓储服务通知发货。只不过调用积分服务的时候，每次都会报错。<strong>但是如果积分服务都挂了，每次调用都要去卡住几秒钟干啥呢？</strong><strong>有意义吗？当然没有！</strong>所以我们直接对积分服务熔断不就得了，比如在5分钟内请求积分服务直接就返回了，不要去走网络请求卡住几秒钟，这个过程，就是所谓的熔断！</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>那人家又说，兄弟，积分服务挂了你就熔断，好歹你干点儿什么啊！别啥都不干就直接返回啊？</strong>没问题，咱们就来个降级：每次调用积分服务，你就在数据库里记录一条消息，说给某某用户增加了多少积分，因为积分服务挂了，导致没增加成功！这样等积分服务恢复了，你可以根据这些记录手工加一下积分。这个过程，就是所谓的降级。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>为帮助大家更直观的理解，接下来用一张图，梳理一下Hystrix隔离、熔断和降级的全流程：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258802533.png\" style=\"height:529px; width:689px\" /></p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<h1><strong>六、Spring Cloud核心组件：</strong><strong>Zuul</strong></h1>\n\n<p>说完了Hystrix，接着给大家说说最后一个组件：Zuul，也就是微服务网关。这个组件是负责网络路由的。不懂网络路由？行，那我给你说说，如果没有Zuul的日常工作会怎样？</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>假设你后台部署了几百个服务，现在有个前端兄弟，人家请求是直接从浏览器那儿发过来的。<strong>打个比方</strong>：人家要请求一下库存服务，你难道还让人家记着这服务的名字叫做inventory-service？部署在5台机器上？就算人家肯记住这一个，你后台可有几百个服务的名称和地址呢？难不成人家请求一个，就得记住一个？你要这样玩儿，那真是友谊的小船，说翻就翻！</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>上面这种情况，压根儿是不现实的。所以一般微服务架构中都必然会设计一个网关在里面，像android、ios、pc前端、微信小程序、H5等等，不用去关心后端有几百个服务，就知道有一个网关，所有请求都往网关走，网关会根据请求中的一些特征，将请求转发给后端的各个服务。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p>而且有一个网关之后，还有很多好处，比如可以做统一的降级、限流、认证授权、安全，等等。</p>\n\n<p>&nbsp;</p>\n\n<p>&nbsp;</p>\n\n<p><strong>七、总结：</strong></p>\n\n<p>最后再来总结一下，上述几个Spring&nbsp;Cloud核心组件，在微服务架构中，分别扮演的角色：</p>\n\n<ul>\n	<li>\n	<p><strong>Eureka</strong>：各个服务启动时，Eureka&nbsp;Client都会将服务注册到Eureka&nbsp;Server，并且Eureka&nbsp;Client还可以反过来从Eureka&nbsp;Server拉取注册表，从而知道其他服务在哪里</p>\n	</li>\n	<li>\n	<p><strong>Ribbon</strong>：服务间发起请求的时候，基于Ribbon做负载均衡，从一个服务的多台机器中选择一台</p>\n	</li>\n	<li>\n	<p><strong>Feign</strong>：基于Feign的动态代理机制，根据注解和选择的机器，拼接请求URL地址，发起请求</p>\n	</li>\n	<li>\n	<p><strong>Hystrix</strong>：发起请求是通过Hystrix的线程池来走的，不同的服务走不同的线程池，实现了不同服务调用的隔离，避免了服务雪崩的问题</p>\n	</li>\n	<li>\n	<p><strong>Zuul</strong>：如果前端、移动端要调用后端系统，统一从Zuul网关进入，由Zuul网关转发请求给对应的服务</p>\n	</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<p>以上就是我们通过一个电商业务场景，阐述了Spring&nbsp;Cloud微服务架构几个核心组件的底层原理。</p>\n\n<p>&nbsp;</p>\n\n<p><strong>文字总结还不够直观？没问题！</strong>我们将Spring Cloud的5个核心组件通过一张图串联起来，再来直观的感受一下其底层的架构原理：</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1542258843261.png\" style=\"height:470px; width:825px\" /></p>\n, 参数6:e81bc2dca42c4031be7d66fef4a71e16, 参数7:2c93dfab0e754006866f8ed486923a41, 参数8:0, 参数9:4, 参数10:0, 参数11:0, 参数12:陌溪_, 参数13:蘑菇博客, 参数14:760f5d83f561440c8ec0691c66ca0338, ','编辑博客',1,'2018-12-29 10:30:53','2018-12-29 10:30:53'),('fb7a61f46c42459192e4f6b7da388f2e','admin','1f01cd1d2f474743b241d74008b12333','116.1.3.204','/mogu_admin/blog/add','POST','com.moxi.mogublog.admin.restapi.BlogRestApi','add','参数1:SecurityContextHolderAwareRequestWrapper[ FirewalledRequest[ org.apache.catalina.connector.RequestFacade@446734d6]], 参数2:Java并发编程73道面试题, 参数3:Java并发编程73道面试题, 参数4:<p><strong>1、在java中守护线程和本地线程区别？</strong></p>\n\n<p>java中的线程分为两种：守护线程（Daemon）和用户线程（User）。</p>\n\n<p>任何线程都可以设置为守护线程和用户线程，通过方法Thread.setDaemon(bool on)；true则把该线程设置为守护线程，反之则为用户线程。Thread.setDaemon()必须在Thread.start()之前调用，否则运行时会抛出异常。</p>\n\n<p>两者的区别：&nbsp;<br />\n唯一的区别是判断虚拟机(JVM)何时离开，Daemon是为其他线程提供服务，如果全部的User Thread已经撤离，Daemon 没有可服务的线程，JVM撤离。也可以理解为守护线程是JVM自动创建的线程（但不一定），用户线程是程序创建的线程；比如JVM的垃圾回收线程是一个守护线程，当所有线程已经撤离，不再产生垃圾，守护线程自然就没事可干了，当垃圾回收线程是Java虚拟机上仅剩的线程时，Java虚拟机会自动离开。</p>\n\n<p>扩展：Thread Dump打印出来的线程信息，含有daemon字样的线程即为守护进程，可能会有：服务守护进程、编译守护进程、windows下的监听Ctrl+break的守护进程、Finalizer守护进程、引用处理守护进程、GC守护进程。<br />\n<br />\n<strong>2、线程与进程的区别？</strong></p>\n\n<p>进程是操作系统分配资源的最小单元，线程是操作系统调度的最小单元。</p>\n\n<p>一个程序至少有一个进程,一个进程至少有一个线程。<br />\n<br />\n<strong>3、什么是多线程中的上下文切换？</strong></p>\n\n<p>多线程会共同使用一组计算机上的CPU，而线程数大于给程序分配的CPU数量时，为了让各个线程都有执行的机会，就需要轮转使用CPU。不同的线程切换使用CPU发生的切换数据等就是上下文切换。<br />\n<br />\n<strong>4、死锁与活锁的区别，死锁与饥饿的区别？</strong></p>\n\n<p><strong>死锁</strong>：是指两个或两个以上的进程（或线程）在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。&nbsp;</p>\n\n<p>产生死锁的必要条件：&nbsp;</p>\n\n<ul>\n	<li>\n	<p>互斥条件：所谓互斥就是进程在某一时间内独占资源。</p>\n	</li>\n	<li>\n	<p>请求与保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放。&nbsp;</p>\n	</li>\n	<li>\n	<p>不剥夺条件:进程已获得资源，在末使用完之前，不能强行剥夺。&nbsp;&nbsp;</p>\n	</li>\n	<li>\n	<p>循环等待条件:若干进程之间形成一种头尾相接的循环等待资源关系。</p>\n	</li>\n</ul>\n\n<p><strong>活锁</strong>：任务或者执行者没有被阻塞，由于某些条件没有满足，导致一直重复尝试，失败，尝试，失败。</p>\n\n<p><strong>活锁</strong>和<strong>死锁</strong>的区别在于，处于活锁的实体是在不断的改变状态，所谓的&ldquo;活&rdquo;， 而处于死锁的实体表现为等待；活锁有可能自行解开，死锁则不能。</p>\n\n<p><strong>饥饿</strong>：一个或者多个线程因为种种原因无法获得所需要的资源，导致一直无法执行的状态。&nbsp;</p>\n\n<p>Java中导致饥饿的原因：&nbsp;</p>\n\n<ul>\n	<li>\n	<p>高优先级线程吞噬所有的低优先级线程的CPU时间。&nbsp;</p>\n	</li>\n	<li>\n	<p>线程被永久堵塞在一个等待进入同步块的状态，因为其他线程总是能在它之前持续地对该同步块进行访问。&nbsp;</p>\n	</li>\n	<li>\n	<p>线程在等待一个本身也处于永久等待完成的对象(比如调用这个对象的wait方法)，因为其他线程总是被持续地获得唤醒。</p>\n	</li>\n</ul>\n\n<p><strong>5、Java中用到的线程调度算法是什么？</strong></p>\n\n<p>采用时间片轮转的方式。可以设置线程的优先级，会映射到下层的系统上面的优先级上，如非特别需要，尽量不要用，防止线程饥饿。<br />\n<br />\n<strong>6、什么是线程组，为什么在Java中不推荐使用？</strong></p>\n\n<p>ThreadGroup类，可以把线程归属到某一个线程组中，线程组中可以有线程对象，也可以有线程组，组中还可以有线程，这样的组织结构有点类似于树的形式。</p>\n\n<p>为什么不推荐使用？因为使用有很多的安全隐患吧，没有具体追究，如果需要使用，推荐使用线程池。<br />\n<br />\n<strong>7、为什么使用Executor框架？</strong></p>\n\n<ol>\n	<li>\n	<p>每次执行任务创建线程 new Thread()比较消耗性能，创建一个线程是比较耗时、耗资源的。</p>\n	</li>\n	<li>\n	<p>调用 new Thread()创建的线程缺乏管理，被称为野线程，而且可以无限制的创建，线程之间的相互竞争会导致过多占用系统资源而导致系统瘫痪，还有线程之间的频繁交替也会消耗很多系统资源。</p>\n	</li>\n	<li>\n	<p>接使用new Thread() 启动的线程不利于扩展，比如定时执行、定期执行、定时定期执行、线程中断等都不便实现。</p>\n	</li>\n</ol>\n\n<p><strong>8、在Java中Executor和Executors的区别？</strong></p>\n\n<p>Executors 工具类的不同方法按照我们的需求创建了不同的线程池，来满足业务的需求。&nbsp;</p>\n\n<p>Executor 接口对象能执行我们的线程任务。&nbsp;</p>\n\n<p>ExecutorService接口继承了Executor接口并进行了扩展，提供了更多的方法我们能获得任务执行的状态并且可以获取任务的返回值。&nbsp;</p>\n\n<p>使用ThreadPoolExecutor 可以创建自定义线程池。&nbsp;</p>\n\n<p>Future 表示异步计算的结果，他提供了检查计算是否完成的方法，以等待计算的完成，并可以使用get()方法获取计算的结果。<br />\n<br />\n<strong>9、什么是原子操作？在Java Concurrency API中有哪些原子类(atomic classes)？</strong></p>\n\n<p>原子操作（atomic operation）意为&rdquo;不可被中断的一个或一系列操作&rdquo; 。&nbsp;</p>\n\n<p>处理器使用基于对缓存加锁或总线加锁的方式来实现多处理器之间的原子操作。&nbsp;</p>\n\n<p>在Java中可以通过锁和循环CAS的方式来实现原子操作。 CAS操作&mdash;&mdash;Compare &amp; Set，或是 Compare &amp; Swap，现在几乎所有的CPU指令都支持CAS的原子操作。<br />\n<br />\n原子操作是指一个不受其他操作影响的操作任务单元。原子操作是在多线程环境下避免数据不一致必须的手段。&nbsp;</p>\n\n<p>int++并不是一个原子操作，所以当一个线程读取它的值并加1时，另外一个线程有可能会读到之前的值，这就会引发错误。&nbsp;</p>\n\n<p>为了解决这个问题，必须保证增加操作是原子的，在JDK1.5之前我们可以使用同步技术来做到这一点。到JDK1.5，java.util.concurrent.atomic包提供了int和long类型的原子包装类，它们可以自动的保证对于他们的操作是原子的并且不需要使用同步。<br />\n<br />\njava.util.concurrent这个包里面提供了一组原子类。其基本的特性就是在多线程环境下，当有多个线程同时执行这些类的实例包含的方法时，具有排他性，即当某个线程进入方法，执行其中的指令时，不会被其他线程打断，而别的线程就像自旋锁一样，一直等到该方法执行完成，才由JVM从等待队列中选择一个另一个线程进入，这只是一种逻辑上的理解。<br />\n<br />\n原子类：AtomicBoolean，AtomicInteger，AtomicLong，AtomicReference&nbsp;</p>\n\n<p>原子数组：AtomicIntegerArray，AtomicLongArray，AtomicReferenceArray&nbsp;</p>\n\n<p>原子属性更新器：AtomicLongFieldUpdater，AtomicIntegerFieldUpdater，AtomicReferenceFieldUpdater&nbsp;</p>\n\n<p>解决ABA问题的原子类：AtomicMarkableReference（通过引入一个boolean来反映中间有没有变过），AtomicStampedReference（通过引入一个int来累加来反映中间有没有变过）<br />\n<br />\n<strong>10、Java Concurrency API中的Lock接口(Lock interface)是什么？对比同步它有什么优势？</strong></p>\n\n<p>Lock接口比同步方法和同步块提供了更具扩展性的锁操作。&nbsp;</p>\n\n<p>他们允许更灵活的结构，可以具有完全不同的性质，并且可以支持多个相关类的条件对象。</p>\n\n<p>它的优势有：</p>\n\n<ul>\n	<li>\n	<p>可以使锁更公平</p>\n	</li>\n	<li>\n	<p>可以使线程在等待锁的时候响应中断</p>\n	</li>\n	<li>\n	<p>可以让线程尝试获取锁，并在无法获取锁的时候立即返回或者等待一段时间</p>\n	</li>\n	<li>\n	<p>可以在不同的范围，以不同的顺序获取和释放锁</p>\n	</li>\n</ul>\n\n<p>整体上来说Lock是synchronized的扩展版，Lock提供了无条件的、可轮询的(tryLock方法)、定时的(tryLock带参方法)、可中断的(lockInterruptibly)、可多条件队列的(newCondition方法)锁操作。另外Lock的实现类基本都支持非公平锁(默认)和公平锁，synchronized只支持非公平锁，当然，在大部分情况下，非公平锁是高效的选择。<br />\n<br />\n<strong>11、什么是Executors框架？</strong></p>\n\n<p>Executor框架是一个根据一组执行策略调用，调度，执行和控制的异步任务的框架。</p>\n\n<p>无限制的创建线程会引起应用程序内存溢出。所以创建一个线程池是个更好的的解决方案，因为可以限制线程的数量并且可以回收再利用这些线程。利用Executors框架可以非常方便的创建一个线程池。<br />\n<br />\n<strong>12、什么是阻塞队列？阻塞队列的实现原理是什么？如何使用阻塞队列来实现生产者-消费者模型？</strong></p>\n\n<p>阻塞队列（BlockingQueue）是一个支持两个附加操作的队列。</p>\n\n<p>这两个附加的操作是：在队列为空时，获取元素的线程会等待队列变为非空。当队列满时，存储元素的线程会等待队列可用。</p>\n\n<p>阻塞队列常用于生产者和消费者的场景，生产者是往队列里添加元素的线程，消费者是从队列里拿元素的线程。阻塞队列就是生产者存放元素的容器，而消费者也只从容器里拿元素。</p>\n\n<p>JDK7提供了7个阻塞队列。分别是：&nbsp;</p>\n\n<p>ArrayBlockingQueue ：一个由数组结构组成的有界阻塞队列。&nbsp;</p>\n\n<p>LinkedBlockingQueue ：一个由链表结构组成的有界阻塞队列。&nbsp;</p>\n\n<p>PriorityBlockingQueue ：一个支持优先级排序的无界阻塞队列。&nbsp;</p>\n\n<p>DelayQueue：一个使用优先级队列实现的无界阻塞队列。&nbsp;</p>\n\n<p>SynchronousQueue：一个不存储元素的阻塞队列。&nbsp;</p>\n\n<p>LinkedTransferQueue：一个由链表结构组成的无界阻塞队列。&nbsp;</p>\n\n<p>LinkedBlockingDeque：一个由链表结构组成的双向阻塞队列。</p>\n\n<p>Java 5之前实现同步存取时，可以使用普通的一个集合，然后在使用线程的协作和线程同步可以实现生产者，消费者模式，主要的技术就是用好，wait ,notify,notifyAll,sychronized这些关键字。而在java 5之后，可以使用阻塞队列来实现，此方式大大简少了代码量，使得多线程编程更加容易，安全方面也有保障。&nbsp;</p>\n\n<p>BlockingQueue接口是Queue的子接口，它的主要用途并不是作为容器，而是作为线程同步的的工具，因此他具有一个很明显的特性，当生产者线程试图向BlockingQueue放入元素时，如果队列已满，则线程被阻塞，当消费者线程试图从中取出一个元素时，如果队列为空，则该线程会被阻塞，正是因为它所具有这个特性，所以在程序中多个线程交替向BlockingQueue中放入元素，取出元素，它可以很好的控制线程之间的通信。</p>\n\n<p>阻塞队列使用最经典的场景就是socket客户端数据的读取和解析，读取数据的线程不断将数据放入队列，然后解析线程不断从队列取数据解析。<br />\n<br />\n<strong>13、什么是Callable和Future?</strong></p>\n\n<p>Callable接口类似于Runnable，从名字就可以看出来了，但是Runnable不会返回结果，并且无法抛出返回结果的异常，而Callable功能更强大一些，被线程执行后，可以返回值，这个返回值可以被Future拿到，也就是说，Future可以拿到异步执行任务的返回值。&nbsp;</p>\n\n<p>可以认为是带有回调的Runnable。</p>\n\n<p>Future接口表示异步任务，是还没有完成的任务给出的未来结果。所以说Callable用于产生结果，Future用于获取结果。<br />\n<br />\n<strong>14、什么是FutureTask?使用ExecutorService启动任务。</strong></p>\n\n<p>在Java并发程序中FutureTask表示一个可以取消的异步运算。它有启动和取消运算、查询运算是否完成和取回运算结果等方法。只有当运算完成的时候结果才能取回，如果运算尚未完成get方法将会阻塞。一个FutureTask对象可以对调用了Callable和Runnable的对象进行包装，由于FutureTask也是调用了Runnable接口所以它可以提交给Executor来执行。<br />\n<br />\n<strong>15、什么是并发容器的实现？</strong></p>\n\n<p>何为同步容器：可以简单地理解为通过synchronized来实现同步的容器，如果有多个线程调用同步容器的方法，它们将会串行执行。比如Vector，Hashtable，以及Collections.synchronizedSet，synchronizedList等方法返回的容器。&nbsp;</p>\n\n<p>可以通过查看Vector，Hashtable等这些同步容器的实现代码，可以看到这些容器实现线程安全的方式就是将它们的状态封装起来，并在需要同步的方法上加上关键字synchronized。</p>\n\n<p>并发容器使用了与同步容器完全不同的加锁策略来提供更高的并发性和伸缩性，例如在ConcurrentHashMap中采用了一种粒度更细的加锁机制，可以称为分段锁，在这种锁机制下，允许任意数量的读线程并发地访问map，并且执行读操作的线程和写操作的线程也可以并发的访问map，同时允许一定数量的写操作线程并发地修改map，所以它可以在并发环境下实现更高的吞吐量。<br />\n<br />\n<strong>16、多线程同步和互斥有几种实现方法，都是什么？</strong></p>\n\n<p>线程同步是指线程之间所具有的一种制约关系，一个线程的执行依赖另一个线程的消息，当它没有得到另一个线程的消息时应等待，直到消息到达时才被唤醒。&nbsp;</p>\n\n<p>线程互斥是指对于共享的进程系统资源，在各单个线程访问时的排它性。当有若干个线程都要使用某一共享资源时，任何时刻最多只允许一个线程去使用，其它要使用该资源的线程必须等待，直到占用资源者释放该资源。线程互斥可以看成是一种特殊的线程同步。</p>\n\n<p>线程间的同步方法大体可分为两类：用户模式和内核模式。顾名思义，内核模式就是指利用系统内核对象的单一性来进行同步，使用时需要切换内核态与用户态，而用户模式就是不需要切换到内核态，只在用户态完成操作。&nbsp;</p>\n\n<p>用户模式下的方法有：原子操作（例如一个单一的全局变量），临界区。内核模式下的方法有：事件，信号量，互斥量。<br />\n<br />\n<strong>17、什么是竞争条件？你怎样发现和解决竞争？</strong></p>\n\n<p>当多个进程都企图对共享数据进行某种处理，而最后的结果又取决于进程运行的顺序时，则我们认为这发生了竞争条件（race condition）。<br />\n<br />\n<strong>18、你将如何使用thread dump？你将如何分析Thread dump？</strong></p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546140834234.png\" style=\"height:381px; width:567px\" /></p>\n\n<ul>\n	<li>\n	<p><strong>新建状态（New）&nbsp;</strong></p>\n\n	<p>用new语句创建的线程处于新建状态，此时它和其他Java对象一样，仅仅在堆区中被分配了内存。</p>\n	</li>\n	<li>\n	<p><strong>就绪状态（Runnable）&nbsp;</strong></p>\n\n	<p>当一个线程对象创建后，其他线程调用它的start()方法，该线程就进入就绪状态，Java虚拟机会为它创建方法调用栈和程序计数器。处于这个状态的线程位于可运行池中，等待获得CPU的使用权。</p>\n	</li>\n	<li>\n	<p><strong>运行状态（Running）&nbsp;</strong></p>\n\n	<p>处于这个状态的线程占用CPU，执行程序代码。只有处于就绪状态的线程才有机会转到运行状态。</p>\n	</li>\n	<li>\n	<p><strong>阻塞状态（Blocked）&nbsp;</strong></p>\n\n	<p>阻塞状态是指线程因为某些原因放弃CPU，暂时停止运行。当线程处于阻塞状态时，Java虚拟机不会给线程分配CPU。直到线程重新进入就绪状态，它才有机会转到运行状态。&nbsp;</p>\n\n	<p>阻塞状态可分为以下3种：</p>\n\n	<p>① 位于对象等待池中的阻塞状态（Blocked in object&rsquo;s wait pool）：当线程处于运行状态时，如果执行了某个对象的wait()方法，Java虚拟机就会把线程放到这个对象的等待池中，这涉及到&ldquo;线程通信&rdquo;的内容。</p>\n\n	<p>② 位于对象锁池中的阻塞状态（Blocked in object&rsquo;s lock pool）：当线程处于运行状态时，试图获得某个对象的同步锁时，如果该对象的同步锁已经被其他线程占用，Java虚拟机就会把这个线程放到这个对象的锁池中，这涉及到&ldquo;线程同步&rdquo;的内容。</p>\n\n	<p>③ 其他阻塞状态（Otherwise Blocked）：当前线程执行了sleep()方法，或者调用了其他线程的join()方法，或者发出了I/O请求时，就会进入这个状态。</p>\n	</li>\n	<li>\n	<p><strong>死亡状态（Dead）</strong></p>\n\n	<p>当线程退出run()方法时，就进入死亡状态，该线程结束生命周期。</p>\n	</li>\n</ul>\n\n<p>我们运行之前的那个死锁代码SimpleDeadLock.java，然后尝试输出信息(/*这是注释，作者自己加的*/)：</p>\n\n<pre>\n<code class=\"language-java\">/* 时间，jvm信息 */\n2017-11-01 17:36:28\nFull thread dump Java HotSpot(TM) 64-Bit Server VM (25.144-b01 mixed mode):\n\n/* 线程名称：DestroyJavaVM\n编号：#13\n优先级：5\n系统优先级：0\njvm内部线程id：0x0000000001c88800\n对应系统线程id（NativeThread ID）：0x1c18\n线程状态： waiting on condition [0x0000000000000000]  （等待某个条件）\n线程详细状态：java.lang.Thread.State: RUNNABLE  及之后所有*/\n\"DestroyJavaVM\" #13 prio=5 os_prio=0 tid=0x0000000001c88800 nid=0x1c18 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Thread-1\" #12 prio=5 os_prio=0 tid=0x0000000018d49000 nid=0x17b8 waiting for monitor entry [0x0000000019d7f000]\n/* 线程状态：阻塞（在对象同步上）\n    代码位置：at com.leo.interview.SimpleDeadLock$B.run(SimpleDeadLock.java:56)\n    等待锁：0x00000000d629b4d8 \n    已经获得锁：0x00000000d629b4e8*/\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at com.leo.interview.SimpleDeadLock$B.run(SimpleDeadLock.java:56)\n    - waiting to lock &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n\n\"Thread-0\" #11 prio=5 os_prio=0 tid=0x0000000018d44000 nid=0x1ebc waiting for monitor entry [0x000000001907f000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at com.leo.interview.SimpleDeadLock$A.run(SimpleDeadLock.java:34)\n    - waiting to lock &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n\n\"Service Thread\" #10 daemon prio=9 os_prio=0 tid=0x0000000018ca5000 nid=0x1264 runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C1 CompilerThread2\" #9 daemon prio=9 os_prio=2 tid=0x0000000018c46000 nid=0xb8c waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread1\" #8 daemon prio=9 os_prio=2 tid=0x0000000018be4800 nid=0x1db4 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"C2 CompilerThread0\" #7 daemon prio=9 os_prio=2 tid=0x0000000018be3800 nid=0x810 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Monitor Ctrl-Break\" #6 daemon prio=5 os_prio=0 tid=0x0000000018bcc800 nid=0x1c24 runnable [0x00000000193ce000]\n   java.lang.Thread.State: RUNNABLE\n    at java.net.SocketInputStream.socketRead0(Native Method)\n    at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\n    at java.net.SocketInputStream.read(SocketInputStream.java:171)\n    at java.net.SocketInputStream.read(SocketInputStream.java:141)\n    at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:284)\n    at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:326)\n    at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:178)\n    - locked &lt;0x00000000d632b928&gt; (a java.io.InputStreamReader)\n    at java.io.InputStreamReader.read(InputStreamReader.java:184)\n    at java.io.BufferedReader.fill(BufferedReader.java:161)\n    at java.io.BufferedReader.readLine(BufferedReader.java:324)\n    - locked &lt;0x00000000d632b928&gt; (a java.io.InputStreamReader)\n    at java.io.BufferedReader.readLine(BufferedReader.java:389)\n    at com.intellij.rt.execution.application.AppMainV2$1.run(AppMainV2.java:64)\n\n\"Attach Listener\" #5 daemon prio=5 os_prio=2 tid=0x0000000017781800 nid=0x524 runnable [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Signal Dispatcher\" #4 daemon prio=9 os_prio=2 tid=0x000000001778f800 nid=0x1b08 waiting on condition [0x0000000000000000]\n   java.lang.Thread.State: RUNNABLE\n\n\"Finalizer\" #3 daemon prio=8 os_prio=1 tid=0x000000001776a800 nid=0xdac in Object.wait() [0x0000000018b6f000]\n   java.lang.Thread.State: WAITING (on object monitor)\n    at java.lang.Object.wait(Native Method)\n    - waiting on &lt;0x00000000d6108ec8&gt; (a java.lang.ref.ReferenceQueue$Lock)\n    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)\n    - locked &lt;0x00000000d6108ec8&gt; (a java.lang.ref.ReferenceQueue$Lock)\n    at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)\n    at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)\n\n\"Reference Handler\" #2 daemon prio=10 os_prio=2 tid=0x0000000017723800 nid=0x1670 in Object.wait() [0x00000000189ef000]\n   java.lang.Thread.State: WAITING (on object monitor)\n    at java.lang.Object.wait(Native Method)\n    - waiting on &lt;0x00000000d6106b68&gt; (a java.lang.ref.Reference$Lock)\n    at java.lang.Object.wait(Object.java:502)\n    at java.lang.ref.Reference.tryHandlePending(Reference.java:191)\n    - locked &lt;0x00000000d6106b68&gt; (a java.lang.ref.Reference$Lock)\n    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)\n\n\"VM Thread\" os_prio=2 tid=0x000000001771b800 nid=0x604 runnable \n\n\"GC task thread#0 (ParallelGC)\" os_prio=0 tid=0x0000000001c9d800 nid=0x9f0 runnable \n\n\"GC task thread#1 (ParallelGC)\" os_prio=0 tid=0x0000000001c9f000 nid=0x154c runnable \n\n\"GC task thread#2 (ParallelGC)\" os_prio=0 tid=0x0000000001ca0800 nid=0xcd0 runnable \n\n\"GC task thread#3 (ParallelGC)\" os_prio=0 tid=0x0000000001ca2000 nid=0x1e58 runnable \n\n\"VM Periodic Task Thread\" os_prio=2 tid=0x0000000018c5a000 nid=0x1b58 waiting on condition \n\nJNI global references: 33\n\n\n/* 此处可以看待死锁的相关信息！ */\nFound one Java-level deadlock:\n=============================\n\"Thread-1\":\n  waiting to lock monitor 0x0000000017729fc8 (object 0x00000000d629b4d8, a java.lang.Object),\n  which is held by \"Thread-0\"\n\"Thread-0\":\n  waiting to lock monitor 0x0000000017727738 (object 0x00000000d629b4e8, a java.lang.Object),\n  which is held by \"Thread-1\"\n\nJava stack information for the threads listed above:\n===================================================\n\"Thread-1\":\n    at com.leo.interview.SimpleDeadLock$B.run(SimpleDeadLock.java:56)\n    - waiting to lock &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n\"Thread-0\":\n    at com.leo.interview.SimpleDeadLock$A.run(SimpleDeadLock.java:34)\n    - waiting to lock &lt;0x00000000d629b4e8&gt; (a java.lang.Object)\n    - locked &lt;0x00000000d629b4d8&gt; (a java.lang.Object)\n\nFound 1 deadlock.\n\n/* 内存使用状况，详情得看JVM方面的书 */\nHeap\n PSYoungGen      total 37888K, used 4590K [0x00000000d6100000, 0x00000000d8b00000, 0x0000000100000000)\n  eden space 32768K, 14% used [0x00000000d6100000,0x00000000d657b968,0x00000000d8100000)\n  from space 5120K, 0% used [0x00000000d8600000,0x00000000d8600000,0x00000000d8b00000)\n  to   space 5120K, 0% used [0x00000000d8100000,0x00000000d8100000,0x00000000d8600000)\n ParOldGen       total 86016K, used 0K [0x0000000082200000, 0x0000000087600000, 0x00000000d6100000)\n  object space 86016K, 0% used [0x0000000082200000,0x0000000082200000,0x0000000087600000)\n Metaspace       used 3474K, capacity 4500K, committed 4864K, reserved 1056768K\n  class space    used 382K, capacity 388K, committed 512K, reserved 1048576K\n</code></pre>\n\n<p><strong>19、为什么我们调用start()方法时会执行run()方法，为什么我们不能直接调用run()方法？</strong></p>\n\n<p>当你调用start()方法时你将创建新的线程，并且执行在run()方法里的代码。&nbsp;</p>\n\n<p>但是如果你直接调用run()方法，它不会创建新的线程也不会执行调用线程的代码，只会把run方法当作普通方法去执行。<br />\n<br />\n<strong>20、Java中你怎样唤醒一个阻塞的线程？</strong></p>\n\n<p>在Java发展史上曾经使用suspend()、resume()方法对于线程进行阻塞唤醒，但随之出现很多问题，比较典型的还是死锁问题。&nbsp;</p>\n\n<p>解决方案可以使用以对象为目标的阻塞，即利用Object类的wait()和notify()方法实现线程阻塞。&nbsp;</p>\n\n<p>首先，wait、notify方法是针对对象的，调用任意对象的wait()方法都将导致线程阻塞，阻塞的同时也将释放该对象的锁，相应地，调用任意对象的notify()方法则将随机解除该对象阻塞的线程，但它需要重新获取改对象的锁，直到获取成功才能往下执行；其次，wait、notify方法必须在synchronized块或方法中被调用，并且要保证同步块或方法的锁对象与调用wait、notify方法的对象是同一个，如此一来在调用wait之前当前线程就已经成功获取某对象的锁，执行wait阻塞后当前线程就将之前获取的对象锁释放。<br />\n<br />\n<strong>21、在Java中CycliBarriar和CountdownLatch有什么区别？</strong></p>\n\n<p>CyclicBarrier可以重复使用，而CountdownLatch不能重复使用。&nbsp;</p>\n\n<p>Java的concurrent包里面的CountDownLatch其实可以把它看作一个计数器，只不过这个计数器的操作是原子操作，同时只能有一个线程去操作这个计数器，也就是同时只能有一个线程去减这个计数器里面的值。&nbsp;</p>\n\n<p>你可以向CountDownLatch对象设置一个初始的数字作为计数值，任何调用这个对象上的await()方法都会阻塞，直到这个计数器的计数值被其他的线程减为0为止。&nbsp;</p>\n\n<p>所以在当前计数到达零之前，await 方法会一直受阻塞。之后，会释放所有等待的线程，await的所有后续调用都将立即返回。这种现象只出现一次&mdash;&mdash;计数无法被重置。如果需要重置计数，请考虑使用 CyclicBarrier。&nbsp;</p>\n\n<p>CountDownLatch的一个非常典型的应用场景是：有一个任务想要往下执行，但必须要等到其他的任务执行完毕后才可以继续往下执行。假如我们这个想要继续往下执行的任务调用一个CountDownLatch对象的await()方法，其他的任务执行完自己的任务后调用同一个CountDownLatch对象上的countDown()方法，这个调用await()方法的任务将一直阻塞等待，直到这个CountDownLatch对象的计数值减到0为止</p>\n\n<p>CyclicBarrier一个同步辅助类，它允许一组线程互相等待，直到到达某个公共屏障点 (common barrier point)。在涉及一组固定大小的线程的程序中，这些线程必须不时地互相等待，此时 CyclicBarrier 很有用。因为该 barrier 在释放等待线程后可以重用，所以称它为循环 的 barrier。<br />\n<br />\n<strong>22、什么是不可变对象，它对写并发应用有什么帮助？</strong></p>\n\n<p>不可变对象(Immutable Objects)即对象一旦被创建它的状态（对象的数据，也即对象属性值）就不能改变，反之即为可变对象(Mutable Objects)。&nbsp;</p>\n\n<p>不可变对象的类即为不可变类(Immutable Class)。Java平台类库中包含许多不可变类，如String、基本类型的包装类、BigInteger和BigDecimal等。&nbsp;</p>\n\n<p>不可变对象天生是线程安全的。它们的常量（域）是在构造函数中创建的。既然它们的状态无法修改，这些常量永远不会变。</p>\n\n<p>不可变对象永远是线程安全的。&nbsp;</p>\n\n<p>只有满足如下状态，一个对象才是不可变的；&nbsp;</p>\n\n<ul>\n	<li>\n	<p>它的状态不能在创建后再被修改；&nbsp;</p>\n	</li>\n	<li>\n	<p>所有域都是final类型；并且，&nbsp;</p>\n	</li>\n	<li>\n	<p>它被正确创建（创建期间没有发生this引用的逸出）。</p>\n	</li>\n</ul>\n\n<p><strong>23、什么是多线程中的上下文切换？</strong></p>\n\n<p>在上下文切换过程中，CPU会停止处理当前运行的程序，并保存当前程序运行的具体位置以便之后继续运行。从这个角度来看，上下文切换有点像我们同时阅读几本书，在来回切换书本的同时我们需要记住每本书当前读到的页码。在程序中，上下文切换过程中的&ldquo;页码&rdquo;信息是保存在进程控制块（PCB）中的。PCB还经常被称作&ldquo;切换桢&rdquo;（switchframe）。&ldquo;页码&rdquo;信息会一直保存到CPU的内存中，直到他们被再次使用。&nbsp;<br />\n上下文切换是存储和恢复CPU状态的过程，它使得线程执行能够从中断点恢复执行。上下文切换是多任务操作系统和多线程环境的基本特征。<br />\n<br />\n<strong>24、Java中用到的线程调度算法是什么？</strong></p>\n\n<p>计算机通常只有一个CPU,在任意时刻只能执行一条机器指令,每个线程只有获得CPU的使用权才能执行指令.所谓多线程的并发运行,其实是指从宏观上看,各个线程轮流获得CPU的使用权,分别执行各自的任务.在运行池中,会有多个处于就绪状态的线程在等待CPU,JAVA虚拟机的一项任务就是负责线程的调度,线程调度是指按照特定机制为多个线程分配CPU的使用权.</p>\n\n<p>有两种调度模型：分时调度模型和抢占式调度模型。&nbsp;</p>\n\n<p>分时调度模型是指让所有的线程轮流获得cpu的使用权,并且平均分配每个线程占用的CPU的时间片这个也比较好理解。</p>\n\n<p>java虚拟机采用抢占式调度模型，是指优先让可运行池中优先级高的线程占用CPU，如果可运行池中的线程优先级相同，那么就随机选择一个线程，使其占用CPU。处于运行状态的线程会一直运行，直至它不得不放弃CPU。</p>\n\n<p><strong>25、什么是线程组，为什么在Java中不推荐使用？</strong></p>\n\n<p>线程组和线程池是两个不同的概念，他们的作用完全不同，前者是为了方便线程的管理，后者是为了管理线程的生命周期，复用线程，减少创建销毁线程的开销。<br />\n<br />\n<strong>26、为什么使用Executor框架比使用应用创建和管理线程好？</strong></p>\n\n<p>为什么要使用Executor线程池框架&nbsp;</p>\n\n<ol>\n	<li>\n	<p>每次执行任务创建线程 new Thread()比较消耗性能，创建一个线程是比较耗时、耗资源的。&nbsp;</p>\n	</li>\n	<li>\n	<p>调用 new Thread()创建的线程缺乏管理，被称为野线程，而且可以无限制的创建，线程之间的相互竞争会导致过多占用系统资源而导致系统瘫痪，还有线程之间的频繁交替也会消耗很多系统资源。&nbsp;</p>\n	</li>\n	<li>\n	<p>直接使用new Thread() 启动的线程不利于扩展，比如定时执行、定期执行、定时定期执行、线程中断等都不便实现。</p>\n	</li>\n</ol>\n\n<p>使用Executor线程池框架的优点&nbsp;</p>\n\n<ol>\n	<li>\n	<p>能复用已存在并空闲的线程从而减少线程对象的创建从而减少了消亡线程的开销。&nbsp;</p>\n	</li>\n	<li>\n	<p>可有效控制最大并发线程数，提高系统资源使用率，同时避免过多资源竞争。&nbsp;</p>\n	</li>\n	<li>\n	<p>框架中已经有定时、定期、单线程、并发数控制等功能。&nbsp;</p>\n	</li>\n</ol>\n\n<p>综上所述使用线程池框架Executor能更好的管理线程、提供系统资源使用率。</p>\n\n<p><strong>27、java中有几种方法可以实现一个线程？</strong></p>\n\n<ul>\n	<li>\n	<p>继承 Thread 类</p>\n	</li>\n	<li>\n	<p>实现 Runnable 接口</p>\n	</li>\n	<li>\n	<p>实现 Callable 接口，需要实现的是 call() 方法</p>\n	</li>\n</ul>\n\n<p><strong>28、如何停止一个正在运行的线程？</strong></p>\n\n<ul>\n	<li>\n	<p>使用共享变量的方式&nbsp;</p>\n\n	<p>在这种方式中，之所以引入共享变量，是因为该变量可以被多个执行相同任务的线程用来作为是否中断的信号，通知中断线程的执行。</p>\n	</li>\n	<li>\n	<p>使用interrupt方法终止线程&nbsp;</p>\n\n	<p>如果一个线程由于等待某些事件的发生而被阻塞，又该怎样停止该线程呢？这种情况经常会发生，比如当一个线程由于需要等候键盘输入而被阻塞，或者调用Thread.join()方法，或者Thread.sleep()方法，在网络中调用ServerSocket.accept()方法，或者调用了DatagramSocket.receive()方法时，都有可能导致线程阻塞，使线程处于处于不可运行状态时，即使主程序中将该线程的共享变量设置为true，但该线程此时根本无法检查循环标志，当然也就无法立即中断。这里我们给出的建议是，不要使用stop()方法，而是使用Thread提供的interrupt()方法，因为该方法虽然不会中断一个正在运行的线程，但是它可以使一个被阻塞的线程抛出一个中断异常，从而使线程提前结束阻塞状态，退出堵塞代码。</p>\n	</li>\n</ul>\n\n<p><strong>29、notify()和notifyAll()有什么区别？</strong></p>\n\n<p>当一个线程进入wait之后，就必须等其他线程notify/notifyall,使用notifyall,可以唤醒所有处于wait状态的线程，使其重新进入锁的争夺队列中，而notify只能唤醒一个。</p>\n\n<p>如果没把握，建议notifyAll，防止notigy因为信号丢失而造成程序异常。</p>\n\n<p><strong>30、什么是Daemon线程？它有什么意义？</strong></p>\n\n<p>所谓后台(daemon)线程，是指在程序运行的时候在后台提供一种通用服务的线程，并且这个线程并不属于程序中不可或缺的部分。因此，当所有的非后台线程结束时，程序也就终止了，同时会杀死进程中的所有后台线程。</p>\n\n<p>反过来说， 只要有任何非后台线程还在运行，程序就不会终止。必须在线程启动之前调用setDaemon()方法，才能把它设置为后台线程。<strong>注意：</strong>后台进程在不执行finally子句的情况下就会终止其run()方法。</p>\n\n<p>比如：JVM的垃圾回收线程就是Daemon线程，Finalizer也是守护线程。</p>\n\n<p><strong>31、java如何实现多线程之间的通讯和协作？</strong></p>\n\n<p>中断和共享变量</p>\n\n<p><strong>32、什么是可重入锁（ReentrantLock）？</strong></p>\n\n<p>举例来说明锁的可重入性</p>\n\n<pre>\n<code class=\"language-java\">public class UnReentrant{\n    Lock lock = new Lock();\n    public void outer(){\n        lock.lock();\n        inner();\n        lock.unlock();\n    }\n    public void inner(){\n        lock.lock();\n        //do something\n        lock.unlock();\n    }\n}\n</code></pre>\n\n<p>outer中调用了inner，outer先锁住了lock，这样inner就不能再获取lock。其实调用outer的线程已经获取了lock锁，但是不能在inner中重复利用已经获取的锁资源，这种锁即称之为 不可重入可重入就意味着：线程可以进入任何一个它已经拥有的锁所同步着的代码块。</p>\n\n<p>synchronized、ReentrantLock都是可重入的锁，可重入锁相对来说简化了并发编程的开发。</p>\n\n<p><strong>33、当一个线程进入某个对象的一个synchronized的实例方法后，其它线程是否可进入此对象的其它方法？</strong></p>\n\n<p>如果其他方法没有synchronized的话，其他线程是可以进入的。</p>\n\n<p>所以要开放一个线程安全的对象时，得保证每个方法都是线程安全的。</p>\n\n<p><strong>34、乐观锁和悲观锁的理解及如何实现，有哪些实现方式？</strong></p>\n\n<p><strong>悲观锁：</strong>总是假设最坏的情况，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会阻塞直到它拿到锁。传统的关系型数据库里边就用到了很多这种锁机制，比如行锁，表锁等，读锁，写锁等，都是在做操作之前先上锁。再比如Java里面的同步原语synchronized关键字的实现也是悲观锁。</p>\n\n<p><strong>乐观锁：</strong>顾名思义，就是很乐观，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。乐观锁适用于多读的应用类型，这样可以提高吞吐量，像数据库提供的类似于write_condition机制，其实都是提供的乐观锁。在Java中java.util.concurrent.atomic包下面的原子变量类就是使用了乐观锁的一种实现方式CAS实现的。</p>\n\n<p>乐观锁的实现方式：&nbsp;</p>\n\n<ul>\n	<li>\n	<p>使用版本标识来确定读到的数据与提交时的数据是否一致。提交后修改版本标识，不一致时可以采取丢弃和再次尝试的策略。&nbsp;</p>\n	</li>\n	<li>\n	<p>java中的Compare and Swap即CAS ，当多个线程尝试使用CAS同时更新同一个变量时，只有其中一个线程能更新变量的值，而其它线程都失败，失败的线程并不会被挂起，而是被告知这次竞争中失败，并可以再次尝试。　CAS 操作中包含三个操作数 &mdash;&mdash; 需要读写的内存位置（V）、进行比较的预期原值（A）和拟写入的新值(B)。如果内存位置V的值与预期原值A相匹配，那么处理器会自动将该位置值更新为新值B。否则处理器不做任何操作。</p>\n	</li>\n</ul>\n\n<p>CAS缺点：&nbsp;&nbsp;</p>\n\n<ul>\n	<li>\n	<p><strong>ABA问题：</strong>&nbsp;</p>\n\n	<p>比如说一个线程one从内存位置V中取出A，这时候另一个线程two也从内存中取出A，并且two进行了一些操作变成了B，然后two又将V位置的数据变成A，这时候线程one进行CAS操作发现内存中仍然是A，然后one操作成功。尽管线程one的CAS操作成功，但可能存在潜藏的问题。从Java1.5开始JDK的atomic包里提供了一个类AtomicStampedReference来解决ABA问题。&nbsp;</p>\n	</li>\n	<li>\n	<p><strong>循环时间长开销大：&nbsp;</strong></p>\n\n	<p>对于资源竞争严重（线程冲突严重）的情况，CAS自旋的概率会比较大，从而浪费更多的CPU资源，效率低于synchronized。&nbsp;</p>\n	</li>\n	<li>\n	<p><strong>只能保证一个共享变量的原子操作：&nbsp;</strong></p>\n\n	<p>当对一个共享变量执行操作时，我们可以使用循环CAS的方式来保证原子操作，但是对多个共享变量操作时，循环CAS就无法保证操作的原子性，这个时候就可以用锁。</p>\n	</li>\n</ul>\n\n<p><strong>35、SynchronizedMap和ConcurrentHashMap有什么区别？</strong></p>\n\n<p>SynchronizedMap一次锁住整张表来保证线程安全，所以每次只能有一个线程来访为map。</p>\n\n<p>ConcurrentHashMap使用分段锁来保证在多线程下的性能。ConcurrentHashMap中则是一次锁住一个桶。ConcurrentHashMap默认将hash表分为16个桶，诸如get,put,remove等常用操作只锁当前需要用到的桶。这样，原来只能一个线程进入，现在却能同时有16个写线程执行，并发性能的提升是显而易见的。&nbsp;</p>\n\n<p>另外ConcurrentHashMap使用了一种不同的迭代方式。在这种迭代方式中，当iterator被创建后集合再发生改变就不再是抛出ConcurrentModificationException，取而代之的是在改变时new新的数据从而不影响原有的数据 ，iterator完成后再将头指针替换为新的数据 ，这样iterator线程可以使用原来老的数据，而写线程也可以并发的完成改变。</p>\n\n<p><strong>36、CopyOnWriteArrayList可以用于什么应用场景？</strong></p>\n\n<p>CopyOnWriteArrayList(免锁容器)的好处之一是当多个迭代器同时遍历和修改这个列表时，不会抛出ConcurrentModificationException。在CopyOnWriteArrayList中，写入将导致创建整个底层数组的副本，而源数组将保留在原地，使得复制的数组在被修改时，读取操作可以安全地执行。</p>\n\n<ol>\n	<li>\n	<p>由于写操作的时候，需要拷贝数组，会消耗内存，如果原数组的内容比较多的情况下，可能导致young gc或者full gc；&nbsp;</p>\n	</li>\n	<li>\n	<p>不能用于实时读的场景，像拷贝数组、新增元素都需要时间，所以调用一个set操作后，读取到数据可能还是旧的,虽然CopyOnWriteArrayList 能做到最终一致性,但是还是没法满足实时性要求；</p>\n	</li>\n</ol>\n\n<p>CopyOnWriteArrayList透露的思想&nbsp;</p>\n\n<ul>\n	<li>\n	<p>读写分离，读和写分开&nbsp;</p>\n	</li>\n	<li>\n	<p>最终一致性&nbsp;</p>\n	</li>\n	<li>\n	<p>使用另外开辟空间的思路，来解决并发冲突</p>\n	</li>\n</ul>\n\n<p><strong>37、什么叫线程安全？servlet是线程安全吗?</strong></p>\n\n<p>线程安全是编程中的术语，指某个函数、函数库在多线程环境中被调用时，能够正确地处理多个线程之间的共享变量，使程序功能正确完成。</p>\n\n<p>Servlet不是线程安全的，servlet是单实例多线程的，当多个线程同时访问同一个方法，是不能保证共享变量的线程安全性的。&nbsp;</p>\n\n<p>Struts2的action是多实例多线程的，是线程安全的，每个请求过来都会new一个新的action分配给这个请求，请求完成后销毁。&nbsp;</p>\n\n<p>SpringMVC的Controller是线程安全的吗？不是的，和Servlet类似的处理流程</p>\n\n<p>Struts2好处是不用考虑线程安全问题；Servlet和SpringMVC需要考虑线程安全问题，但是性能可以提升不用处理太多的gc，可以使用ThreadLocal来处理多线程的问题。</p>\n\n<p><strong>38、volatile有什么用？能否用一句话说明下volatile的应用场景？</strong></p>\n\n<p>volatile保证内存可见性和禁止指令重排。</p>\n\n<p>volatile用于多线程环境下的单次操作(单次读或者单次写)。</p>\n\n<p><strong>39、为什么代码会重排序？</strong></p>\n\n<p>在执行程序时，为了提供性能，处理器和编译器常常会对指令进行重排序，但是不能随意重排序，不是你想怎么排序就怎么排序，它需要满足以下两个条件：</p>\n\n<ul>\n	<li>\n	<p>在单线程环境下不能改变程序运行的结果；</p>\n	</li>\n	<li>\n	<p>存在数据依赖关系的不允许重排序</p>\n	</li>\n</ul>\n\n<p>需要注意的是：重排序不会影响单线程环境的执行结果，但是会破坏多线程的执行语义。</p>\n\n<p><strong>40、在java中wait和sleep方法的不同？</strong></p>\n\n<p>最大的不同是在等待时wait会释放锁，而sleep一直持有锁。Wait通常被用于线程间交互，sleep通常被用于暂停执行。</p>\n\n<p>直接了解的深入一点吧：&nbsp;</p>\n\n<p><img src=\"http://120.79.70.126:8600/ckEditorUploadImg/1546140795296.png\" style=\"height:410px; width:616px\" /></p>\n\n<p>在Java中线程的状态一共被分成6种：</p>\n\n<p><strong>初始态：NEW</strong></p>\n\n<p>创建一个Thread对象，但还未调用start()启动线程时，线程处于初始态。</p>\n\n<p><strong>运行态：RUNNABLE&nbsp;</strong></p>\n\n<p>在Java中，运行态包括就绪态和运行态。&nbsp;</p>\n\n<p>就绪态该状态下的线程已经获得执行所需的所有资源，只要CPU分配执行权就能运行。所有就绪态的线程存放在就绪队列中。&nbsp;</p>\n\n<p>运行态获得CPU执行权，正在执行的线程。由于一个CPU同一时刻只能执行一条线程，因此每个CPU每个时刻只有一条运行态的线程。</p>\n\n<p><strong>阻塞态</strong></p>\n\n<p>当一条正在执行的线程请求某一资源失败时，就会进入阻塞态。而在Java中，阻塞态专指请求锁失败时进入的状态。由一个阻塞队列存放所有阻塞态的线程。处于阻塞态的线程会不断请求资源，一旦请求成功，就会进入就绪队列，等待执行。PS：锁、IO、Socket等都资源。</p>\n\n<p><strong>等待态</strong></p>\n\n<p>当前线程中调用wait、join、park函数时，当前线程就会进入等待态。也有一个等待队列存放所有等待态的线程。线程处于等待态表示它需要等待其他线程的指示才能继续运行。进入等待态的线程会释放CPU执行权，并释放资源（如：锁）</p>\n\n<p><strong>超时等待态</strong></p>\n\n<p>当运行中的线程调用sleep(time)、wait、join、parkNanos、parkUntil时，就会进入该状态；它和等待态一样，并不是因为请求不到资源，而是主动进入，并且进入后需要其他线程唤醒；进入该状态后释放CPU执行权 和 占有的资源。与等待态的区别：到了超时时间后自动进入阻塞队列，开始竞争锁。</p>\n\n<p><strong>终止态</strong></p>\n\n<p>线程执行结束后的状态。</p>\n\n<p><strong>注意：</strong></p>\n\n<ul>\n	<li>\n	<p>wait()方法会释放CPU执行权 和 占有的锁。</p>\n	</li>\n	<li>\n	<p>sleep(long)方法仅释放CPU使用权，锁仍然占用；线程被放入超时等待队列，与yield相比，它会使线程较长时间得不到运行。</p>\n	</li>\n	<li>\n	<p>yield()方法仅释放CPU执行权，锁仍然占用，线程会被放入就绪队列，会在短时间内再次执行。</p>\n	</li>\n	<li>\n	<p>wait和notify必须配套使用，即必须使用同一把锁调用；</p>\n	</li>\n	<li>\n	<p>wait和notify必须放在一个同步块中调用wait和notify的对象必须是他们所处同步块的锁对象。</p>\n	</li>\n</ul>\n\n<p><strong>41、一个线程运行时发生异常会怎样？</strong></p>\n\n<p>如果异常没有被捕获该线程将会停止执行。Thread.UncaughtExceptionHandler是用于处理未捕获异常造成线程突然中断情况的一个内嵌接口。当一个未捕获异常将造成线程中断的时候JVM会使用Thread.getUncaughtExceptionHandler()来查询线程的UncaughtExceptionHandler并将线程和异常作为参数传递给handler的uncaughtException()方法进行处理。</p>\n\n<p><strong>42、如何在两个线程间共享数据？</strong></p>\n\n<p>在两个线程间共享变量即可实现共享。&nbsp;</p>\n\n<p>一般来说，共享变量要求变量本身是线程安全的，然后在线程内使用的时候，如果有对共享变量的复合操作，那么也得保证复合操作的线程安全性。</p>\n\n<p><strong>43、Java中notify 和 notifyAll有什么区别？</strong></p>\n\n<p>notify() 方法不能唤醒某个具体的线程，所以只有一个线程在等待的时候它才有用武之地。而notifyAll()唤醒所有线程并允许他们争夺锁确保了至少有一个线程能继续运行。</p>\n\n<p><strong>44、为什么wait, notify 和 notifyAll这些方法不在thread类里面？</strong></p>\n\n<p>一个很明显的原因是JAVA提供的锁是对象级的而不是线程级的，每个对象都有锁，通过线程获得。由于wait，notify和notifyAll都是锁级别的操作，所以把他们定义在Object类中因为锁属于对象。</p>\n\n<p><strong>45、什么是ThreadLocal变量？</strong></p>\n\n<p>ThreadLocal是Java里一种特殊的变量。每个线程都有一个ThreadLocal就是每个线程都拥有了自己独立的一个变量，竞争条件被彻底消除了。它是为创建代价高昂的对象获取线程安全的好方法，比如你可以用ThreadLocal让SimpleDateFormat变成线程安全的，因为那个类创建代价高昂且每次调用都需要创建不同的实例所以不值得在局部范围使用它，如果为每个线程提供一个自己独有的变量拷贝，将大大提高效率。首先，通过复用减少了代价高昂的对象的创建个数。其次，你在没有使用高代价的同步或者不变性的情况下获得了线程安全。</p>\n\n<p><strong>46、Java中interrupted 和 isInterrupted方法的区别？</strong></p>\n\n<p><strong>interrupt&nbsp;</strong></p>\n\n<p>interrupt方法用于中断线程。调用该方法的线程的状态为将被置为&rdquo;中断&rdquo;状态。&nbsp;<br />\n注意：线程中断仅仅是置线程的中断状态位，不会停止线程。需要用户自己去监视线程的状态为并做处理。支持线程中断的方法（也就是线程中断后会抛出interruptedException的方法）就是在监视线程的中断状态，一旦线程的中断状态被置为&ldquo;中断状态&rdquo;，就会抛出中断异常。</p>\n\n<p><strong>interrupted&nbsp;</strong></p>\n\n<p>查询当前线程的中断状态，并且清除原状态。如果一个线程被中断了，第一次调用interrupted则返回true，第二次和后面的就返回false了。</p>\n\n<p><strong>isInterrupted&nbsp;</strong></p>\n\n<p>仅仅是查询当前线程的中断状态</p>\n\n<p><strong>47、为什么wait和notify方法要在同步块中调用？</strong></p>\n\n<p>Java API强制要求这样做，如果你不这么做，你的代码会抛出IllegalMonitorStateException异常。还有一个原因是为了避免wait和notify之间产生竞态条件。</p>\n\n<p><strong>48、为什么你应该在循环中检查等待条件?</strong></p>\n\n<p>处于等待状态的线程可能会收到错误警报和伪唤醒，如果不在循环中检查等待条件，程序就会在没有满足结束条件的情况下退出。</p>\n\n<p><strong>49、Java中的同步集合与并发集合有什么区别？</strong></p>\n\n<p>同步集合与并发集合都为多线程和并发提供了合适的线程安全的集合，不过并发集合的可扩展性更高。在Java1.5之前程序员们只有同步集合来用且在多线程并发的时候会导致争用，阻碍了系统的扩展性。Java5介绍了并发集合像ConcurrentHashMap，不仅提供线程安全还用锁分离和内部分区等现代技术提高了可扩展性。</p>\n\n<p><strong>50、什么是线程池？ 为什么要使用它？</strong></p>\n\n<p>创建线程要花费昂贵的资源和时间，如果任务来了才创建线程那么响应时间会变长，而且一个进程能创建的线程数有限。为了避免这些问题，在程序启动的时候就创建若干线程来响应处理，它们被称为线程池，里面的线程叫工作线程。从JDK1.5开始，Java API提供了Executor框架让你可以创建不同的线程池。</p>\n\n<p><strong>51、怎么检测一个线程是否拥有锁？</strong></p>\n\n<p>在java.lang.Thread中有一个方法叫holdsLock()，它返回true如果当且仅当当前线程拥有某个具体对象的锁。<br />\n<br />\n<strong>52、你如何在Java中获取线程堆栈？</strong></p>\n\n<ul>\n	<li>\n	<p>kill -3 [java pid]&nbsp;</p>\n\n	<p>不会在当前终端输出，它会输出到代码执行的或指定的地方去。比如，kill -3 tomcat pid, 输出堆栈到log目录下。</p>\n	</li>\n	<li>\n	<p>Jstack [java pid]&nbsp;</p>\n\n	<p>这个比较简单，在当前终端显示，也可以重定向到指定文件中。&nbsp;</p>\n\n	<p>-JvisualVM：Thread Dump&nbsp;</p>\n\n	<p>不做说明，打开JvisualVM后，都是界面操作，过程还是很简单的。</p>\n	</li>\n</ul>\n\n<p><strong>53、JVM中哪个参数是用来控制线程的栈堆栈小的?</strong></p>\n\n<p>-Xss 每个线程的栈大小</p>\n\n<p><strong>54、Thread类中的yield方法有什么作用？</strong></p>\n\n<p>使当前线程从执行状态（运行状态）变为可执行态（就绪状态）。</p>\n\n<p>当前线程到了就绪状态，那么接下来哪个线程会从就绪状态变成执行状态呢？可能是当前线程，也可能是其他线程，看系统的分配了。</p>\n\n<p><strong>55、Java中ConcurrentHashMap的并发度是什么？</strong></p>\n\n<p>ConcurrentHashMap把实际map划分成若干部分来实现它的可扩展性和线程安全。这种划分是使用并发度获得的，它是ConcurrentHashMap类构造函数的一个可选参数，默认值为16，这样在多线程情况下就能避免争用。</p>\n\n<p>在JDK8后，它摒弃了Segment（锁段）的概念，而是启用了一种全新的方式实现,利用CAS算法。同时加入了更多的辅助变量来提高并发度，具体内容还是查看源码吧。</p>\n\n<p><strong>56、Java中Semaphore是什么？</strong></p>\n\n<p>Java中的Semaphore是一种新的同步类，它是一个计数信号。从概念上讲，从概念上讲，信号量维护了一个许可集合。如有必要，在许可可用前会阻塞每一个 acquire()，然后再获取该许可。每个 release()添加一个许可，从而可能释放一个正在阻塞的获取者。但是，不使用实际的许可对象，Semaphore只对可用许可的号码进行计数，并采取相应的行动。信号量常常用于多线程的代码中，比如数据库连接池。</p>\n\n<p><strong>57、Java线程池中submit() 和 execute()方法有什么区别？</strong></p>\n\n<p>两个方法都可以向线程池提交任务，execute()方法的返回类型是void，它定义在Executor接口中。</p>\n\n<p>而submit()方法可以返回持有计算结果的Future对象，它定义在ExecutorService接口中，它扩展了Executor接口，其它线程池类像ThreadPoolExecutor和ScheduledThreadPoolExecutor都有这些方法。</p>\n\n<p><strong>58、什么是阻塞式方法？</strong></p>\n\n<p>阻塞式方法是指程序会一直等待该方法完成期间不做其他事情，ServerSocket的accept()方法就是一直等待客户端连接。这里的阻塞是指调用结果返回之前，当前线程会被挂起，直到得到结果之后才会返回。此外，还有异步和非阻塞式方法在任务完成前就返回。</p>\n\n<p><strong>59、Java中的ReadWriteLock是什么？</strong></p>\n\n<p>读写锁是用来提升并发程序性能的锁分离技术的成果。</p>\n\n<p><strong>60、volatile 变量和 atomic 变量有什么不同？</strong></p>\n\n<p>Volatile变量可以确保先行关系，即写操作会发生在后续的读操作之前, 但它并不能保证原子性。例如用volatile修饰count变量那么 count++ 操作就不是原子性的。</p>\n\n<p>而AtomicInteger类提供的atomic方法可以让这种操作具有原子性如getAndIncrement()方法会原子性的进行增量操作把当前值加一，其它数据类型和引用变量也可以进行相似操作。</p>\n\n<p><strong>61、可以直接调用Thread类的run ()方法么？</strong></p>\n\n<p>当然可以。但是如果我们调用了Thread的run()方法，它的行为就会和普通的方法一样，会在当前线程中执行。为了在新的线程中执行我们的代码，必须使用Thread.start()方法。</p>\n\n<p><strong>62、如何让正在运行的线程暂停一段时间？</strong></p>\n\n<p>我们可以使用Thread类的Sleep()方法让线程暂停一段时间。需要注意的是，这并不会让线程终止，一旦从休眠中唤醒线程，线程的状态将会被改变为Runnable，并且根据线程调度，它将得到执行。</p>\n\n<p><strong>63、你对线程优先级的理解是什么？</strong></p>\n\n<p>每一个线程都是有优先级的，一般来说，高优先级的线程在运行时会具有优先权，但这依赖于线程调度的实现，这个实现是和操作系统相关的(OS dependent)。我们可以定义线程的优先级，但是这并不能保证高优先级的线程会在低优先级的线程前执行。线程优先级是一个int变量(从1-10)，1代表最低优先级，10代表最高优先级。</p>\n\n<p>java的线程优先级调度会委托给操作系统去处理，所以与具体的操作系统优先级有关，如非特别需要，一般无需设置线程优先级。</p>\n\n<p><strong>64、什么是线程调度器(Thread Scheduler)和时间分片(Time Slicing )？</strong></p>\n\n<p>线程调度器是一个操作系统服务，它负责为Runnable状态的线程分配CPU时间。一旦我们创建一个线程并启动它，它的执行便依赖于线程调度器的实现。&nbsp;<br />\n同上一个问题，线程调度并不受到Java虚拟机控制，所以由应用程序来控制它是更好的选择（也就是说不要让你的程序依赖于线程的优先级）。</p>\n\n<p>时间分片是指将可用的CPU时间分配给可用的Runnable线程的过程。分配CPU时间可以基于线程优先级或者线程等待的时间。</p>\n\n<p><strong>65、你如何确保main()方法所在的线程是Java 程序最后结束的线程？</strong></p>\n\n<p>我们可以使用Thread类的join()方法来确保所有程序创建的线程在main()方法退出前结束。</p>\n\n<p><strong>66、线程之间是如何通信的？</strong></p>\n\n<p>当线程间是可以共享资源时，线程间通信是协调它们的重要的手段。Object类中wait()\\notify()\\notifyAll()方法可以用于线程间通信关于资源的锁的状态。</p>\n\n<p><strong>67、为什么线程通信的方法wait(), notify()和notifyAll()被定义在Object 类里？</strong></p>\n\n<p>Java的每个对象中都有一个锁(monitor，也可以成为监视器) 并且wait()，notify()等方法用于等待对象的锁或者通知其他线程对象的监视器可用。在Java的线程中并没有可供任何对象使用的锁和同步器。这就是为什么这些方法是Object类的一部分，这样Java的每一个类都有用于线程间通信的基本方法。</p>\n\n<p><strong>68、为什么wait(), notify()和notifyAll ()必须在同步方法或者同步块中被调用？</strong></p>\n\n<p>当一个线程需要调用对象的wait()方法的时候，这个线程必须拥有该对象的锁，接着它就会释放这个对象锁并进入等待状态直到其他线程调用这个对象上的notify()方法。同样的，当一个线程需要调用对象的notify()方法时，它会释放这个对象的锁，以便其他在等待的线程就可以得到这个对象锁。由于所有的这些方法都需要线程持有对象的锁，这样就只能通过同步来实现，所以他们只能在同步方法或者同步块中被调用。</p>\n\n<p><strong>69、为什么Thread类的sleep()和yield ()方法是静态的？</strong></p>\n\n<p>Thread类的sleep()和yield()方法将在当前正在执行的线程上运行。所以在其他处于等待状态的线程上调用这些方法是没有意义的。这就是为什么这些方法是静态的。它们可以在当前正在执行的线程中工作，并避免程序员错误的认为可以在其他非运行线程调用这些方法。</p>\n\n<p><strong>70、如何确保线程安全？</strong></p>\n\n<p>在Java中可以有很多方法来保证线程安全&mdash;&mdash;同步，使用原子类(atomic concurrent classes)，实现并发锁，使用volatile关键字，使用不变类和线程安全类。</p>\n\n<p><strong>71、同步方法和同步块，哪个是更好的选择？</strong></p>\n\n<p>同步块是更好的选择，因为它不会锁住整个对象（当然你也可以让它锁住整个对象）。同步方法会锁住整个对象，哪怕这个类中有多个不相关联的同步块，这通常会导致他们停止执行并需要等待获得这个对象上的锁。</p>\n\n<p>同步块更要符合开放调用的原则，只在需要锁住的代码块锁住相应的对象，这样从侧面来说也可以避免死锁。</p>\n\n<p><strong>72、如何创建守护线程？</strong></p>\n\n<p>使用Thread类的setDaemon(true)方法可以将线程设置为守护线程，需要注意的是，需要在调用start()方法前调用这个方法，否则会抛出IllegalThreadStateException异常。</p>\n\n<p><strong>73、什么是Java Timer 类？如何创建一个有特定时间间隔的任务？</strong></p>\n\n<p>java.util.Timer是一个工具类，可以用于安排一个线程在未来的某个特定时间执行。Timer类可以用安排一次性任务或者周期任务。&nbsp;</p>\n\n<p>java.util.TimerTask是一个实现了Runnable接口的抽象类，我们需要去继承这个类来创建我们自己的定时任务并使用Timer去安排它的执行。&nbsp;</p>\n\n<p>目前有开源的Qurtz可以用来创建定时任务。</p>\n\n<p>本文来自：https://blog.csdn.net/qq_34039315/article/details/7854931</p>\n, 参数5:7e0e93ea6cdb44ae92e58f48e6496ed7,ca928e8718654aa5a802e2f69277b137, 参数6:0, 参数7:0, 参数8:0, 参数9:1, 参数10:陌溪_, 参数11:蘑菇博客, 参数12:e60df954efcd47c48463a504bb70bbe9, 参数13:16018de3271d4c5fbafb03c1b342fb82, ','增加博客',1,'2018-12-30 11:34:04','2018-12-30 11:34:04');

/*Table structure for table `t_tag` */

DROP TABLE IF EXISTS `t_tag`;

CREATE TABLE `t_tag` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `content` varchar(1000) DEFAULT NULL COMMENT '标签内容',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `click_count` int(11) DEFAULT '0' COMMENT '标签简介',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `sort` int(11) DEFAULT '0' COMMENT '排序字段，越大越靠前',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='标签表';

/*Data for the table `t_tag` */

insert  into `t_tag`(`uid`,`content`,`status`,`click_count`,`create_time`,`update_time`,`sort`) values ('0b51c75ed5744cdcadefe0ad947be9b6','数据库',1,0,'2018-12-29 10:34:16','2018-12-29 10:34:16',0),('1c76b9848f5f4d71a5e88b20dbaf38f4','RabbitMQ',1,0,'2018-10-25 20:42:52','2018-10-25 20:42:52',0),('1d1fd6d26c8e40a38637ef6126c45cd0','Linux',1,0,'2018-11-02 18:24:52','2018-11-02 18:24:52',0),('2f5779e877da48958c985d69b311d0d6','大数据',1,0,'2018-11-21 20:56:17','2018-11-21 20:56:17',0),('53c5a0f3142e4f54820315936f78383b','Spring Boot',1,1,'2018-09-21 20:11:06','2018-09-21 20:11:06',0),('5c939107ddb746b989156737805df625','机器学习',1,0,'2018-10-23 15:53:00','2018-10-23 15:53:00',0),('7e0e93ea6cdb44ae92e58f48e6496ed7','Java',1,1,'2018-09-21 20:12:52','2018-09-21 20:12:52',0),('8c9d43de144245eb8176854eca5ae244','AI',1,0,'2018-11-26 11:13:56','2018-11-26 11:13:56',0),('8d5ce3e0c0784b95adb7f9e7b76dca93','建站系统',1,0,'2018-11-15 15:53:24','2018-11-15 15:53:24',0),('a9a747d944c24845815356f72723ef8e','前端开发',1,2,'2018-09-20 14:51:39','2018-09-20 14:51:39',0),('ca928e8718654aa5a802e2f69277b137','面试',1,2,'2018-09-21 20:13:41','2018-09-21 20:13:41',0),('d3c3fc43f38445389c970ff0732a6586','机器学习',1,0,'2018-11-21 20:56:12','2018-11-21 20:56:12',0),('e2c7913050cf4ab9aa92902316aaf075','校园生活',1,1,'2018-09-21 20:13:51','2018-09-21 20:13:51',0),('e81bc2dca42c4031be7d66fef4a71e16','Spring Cloud',1,0,'2018-11-15 13:08:28','2018-11-15 13:08:28',0),('f90d3c2fd9434302951130e897a89164','Vue',1,1,'2018-09-21 20:09:50','2018-09-21 20:09:50',0);

/*Table structure for table `t_user` */

DROP TABLE IF EXISTS `t_user`;

CREATE TABLE `t_user` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `user_name` varchar(255) NOT NULL COMMENT '用户名',
  `pass_word` varchar(32) NOT NULL COMMENT '密码',
  `gender` tinyint(1) unsigned DEFAULT NULL COMMENT '性别(1:男2:女)',
  `avatar` varchar(100) DEFAULT NULL COMMENT '个人头像',
  `email` varchar(255) NOT NULL COMMENT '邮箱',
  `birthday` date DEFAULT NULL COMMENT '出生年月日',
  `mobile` varchar(50) DEFAULT NULL COMMENT '手机',
  `valid_code` varchar(50) DEFAULT NULL COMMENT '邮箱验证码',
  `summary` varchar(200) DEFAULT NULL COMMENT '自我简介最多150字',
  `login_count` int(11) unsigned DEFAULT '0' COMMENT '登录次数',
  `last_login_time` datetime DEFAULT NULL COMMENT '最后登录时间',
  `last_login_ip` varchar(50) DEFAULT '127.0.0.1' COMMENT '最后登录IP',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='用户表';

/*Data for the table `t_user` */

/*Table structure for table `t_visitor` */

DROP TABLE IF EXISTS `t_visitor`;

CREATE TABLE `t_visitor` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `user_name` varchar(255) DEFAULT NULL COMMENT '用户名',
  `email` varchar(255) NOT NULL COMMENT '邮箱',
  `login_count` int(11) unsigned DEFAULT '0' COMMENT '登录次数',
  `last_login_time` datetime DEFAULT NULL COMMENT '最后登录时间',
  `last_login_ip` varchar(50) DEFAULT '127.0.0.1' COMMENT '最后登录IP',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='游客表';

/*Data for the table `t_visitor` */

/*Table structure for table `t_web_config` */

DROP TABLE IF EXISTS `t_web_config`;

CREATE TABLE `t_web_config` (
  `uid` varchar(32) NOT NULL COMMENT '主键',
  `logo` varchar(255) NOT NULL COMMENT 'logo(文件UID)',
  `name` varchar(255) NOT NULL COMMENT '网站名称',
  `summary` varchar(255) NOT NULL COMMENT '介绍',
  `keyword` varchar(255) NOT NULL COMMENT '关键字',
  `author` varchar(255) NOT NULL COMMENT '作者',
  `record_num` varchar(255) NOT NULL COMMENT '备案号',
  `start_comment` varchar(1) DEFAULT '1' COMMENT '是否开启评论(0:否 1:是)',
  `status` tinyint(1) DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  `title` varchar(255) DEFAULT NULL COMMENT '标题',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

/*Data for the table `t_web_config` */

insert  into `t_web_config`(`uid`,`logo`,`name`,`summary`,`keyword`,`author`,`record_num`,`start_comment`,`status`,`create_time`,`update_time`,`title`) values ('a331e4933cf54afcbb8c0cb11ec0830e',',b8a7b24a3de8401597548e71c6b5d399','蘑菇博客','一个开源的个人博客','蘑菇博客','许志翔','赣ICP备18014504号','0',1,'2018-11-15 08:15:27','2018-11-15 08:15:27',NULL);

/*Table structure for table `t_web_visit` */

DROP TABLE IF EXISTS `t_web_visit`;

CREATE TABLE `t_web_visit` (
  `uid` varchar(32) NOT NULL COMMENT '主键',
  `user_uid` varchar(255) DEFAULT NULL COMMENT '用户uid',
  `ip` varchar(255) DEFAULT NULL COMMENT '访问ip地址',
  `behavior` varchar(255) DEFAULT NULL COMMENT '用户行为',
  `module_uid` varchar(255) DEFAULT NULL COMMENT '模块uid（文章uid，标签uid，分类uid）',
  `other_data` varchar(255) DEFAULT NULL COMMENT '附加数据(比如搜索内容)',
  `status` tinyint(1) NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Web访问记录表';

/*Data for the table `t_web_visit` */

insert  into `t_web_visit`(`uid`,`user_uid`,`ip`,`behavior`,`module_uid`,`other_data`,`status`,`create_time`,`update_time`) values ('0108ab7f15cc43a8adc0bd4de92f6aeb',NULL,'116.1.3.204','blog_content','c459e7c261884086b5e462fa4f26cc04',NULL,1,'2018-12-29 10:30:09','2018-12-29 10:30:09'),('01c0d1d15a844837b1b484b4b3f69c9b',NULL,'116.1.3.205','blog_content','086f5b8d6e464a5ca81a1a738b9f5612',NULL,1,'2018-12-17 10:06:45','2018-12-17 10:06:45'),('029f455392f54d059ef3833059aeb3cf',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-19 12:43:47','2018-12-19 12:43:47'),('05bd977d84e844a88df35596d3e3ba7b',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-19 12:44:03','2018-12-19 12:44:03'),('0695aec087fe49019d9f20df604b17f4',NULL,'116.1.3.204','blog_search',NULL,'阿里',1,'2018-12-19 21:15:27','2018-12-19 21:15:27'),('07c635a4b67a468bafab76fae5645de3',NULL,'116.1.3.204','blog_content','4000982427cb47edb8c626f409d5377d',NULL,1,'2018-12-22 16:19:24','2018-12-22 16:19:24'),('09c3329b2eed40b9961ca3cf55068863',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-20 15:15:16','2018-12-20 15:15:16'),('0a5f56fd04bb4e9eb27bd2b2e6c306b9',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-30 12:40:40','2018-12-30 12:40:40'),('0af5821f5bff4d4797acb65193dfa7ac',NULL,'111.59.124.148','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-22 11:38:14','2018-12-22 11:38:14'),('0e0abb7f8a3443438f2c6dfe35f657cf',NULL,'111.59.124.148','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-22 13:14:05','2018-12-22 13:14:05'),('13cbdd91654246f19eb2334edf955bdf',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-27 09:35:28','2018-12-27 09:35:28'),('15d008ae46284088a4cce16864bfd504',NULL,'116.1.3.204','blog_content','d5968d02f570411184cdfcc082d28dac',NULL,1,'2018-12-30 12:55:27','2018-12-30 12:55:27'),('169b0d8540ae4282b71d523a7971a48e',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-19 21:25:06','2018-12-19 21:25:06'),('176726fe400e4620aae2fd8cce8859ca',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-19 21:26:06','2018-12-19 21:26:06'),('179f93eaffb94a3fb003d27bc5e91b34',NULL,'116.1.3.204','blog_content','ffd8c8bfe7234bc6aed88d813e3b67ed',NULL,1,'2018-12-30 12:55:34','2018-12-30 12:55:34'),('1af32782c84c4220ba26b6115ddd9b20',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-24 22:33:57','2018-12-24 22:33:57'),('1b46a982d1d3458e8e23b6d56f055d45',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-19 21:15:23','2018-12-19 21:15:23'),('1d21ae66d9b141eb8a0c220c806048f8',NULL,'116.1.3.204','blog_content','80b7fb49e91d4930a7b5f0c084f12cbc',NULL,1,'2018-12-22 16:07:42','2018-12-22 16:07:42'),('1d41eead8f2b480a9c5f9f9f7d753fe0',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-19 21:25:57','2018-12-19 21:25:57'),('1eddf5cae0924642b3929b416eeaeffa',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-19 12:44:03','2018-12-19 12:44:03'),('21aba54deba24de594313bbfaa2f1d2e',NULL,'111.59.124.148','blog_content','80b7fb49e91d4930a7b5f0c084f12cbc',NULL,1,'2018-12-22 11:38:00','2018-12-22 11:38:00'),('21f23ec5dfd54f53a091c4c59d953237',NULL,'116.1.3.205','blog_sort','2c93dfab0e754006866f8ed486923a41',NULL,1,'2018-12-18 23:02:14','2018-12-18 23:02:14'),('22bf8a75febd4f5e972bc8ac894c5770',NULL,'116.1.3.205','blog_content','8a7a023fb6094a388dff50e478f295a9',NULL,1,'2018-12-16 18:24:02','2018-12-16 18:24:02'),('2663b042033145df8d78cf65c7d83928',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-16 12:45:11','2018-12-16 12:45:11'),('26c8973ef0b8473295e653250d97e50d',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-16 19:57:46','2018-12-16 19:57:46'),('280eea9528544cf7bbc803c781d4bd6c',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-26 21:04:24','2018-12-26 21:04:24'),('2913a72e562a4dee9af0d4bc22968e7f',NULL,'111.59.124.146','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-23 10:23:21','2018-12-23 10:23:21'),('3ad6a27e771a4f76aa60c39d8a199879',NULL,'116.1.3.204','blog_content','f346267364024e78844d459be2f6f528',NULL,1,'2018-12-30 11:02:38','2018-12-30 11:02:38'),('3c5982e3ad7b4e43b1abaeab3f355692',NULL,'116.1.3.204','blog_tag','5c939107ddb746b989156737805df625',NULL,1,'2018-12-19 12:43:55','2018-12-19 12:43:55'),('3d648abac5e440f5b5f1afe2fad0bd56',NULL,'116.1.3.204','blog_search',NULL,'Mysql',1,'2018-12-29 10:30:13','2018-12-29 10:30:13'),('3e91b6e3de7245a49ba25d34d8467bfe',NULL,'116.1.3.204','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-30 12:41:51','2018-12-30 12:41:51'),('3f21fda269bd4732aef65672bca5e4d9',NULL,'103.25.20.80','blog_tag','7e0e93ea6cdb44ae92e58f48e6496ed7',NULL,1,'2018-12-18 13:44:18','2018-12-18 13:44:18'),('3fce44f3b4fb4df49554985f25b3ec96',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-22 16:07:03','2018-12-22 16:07:03'),('40bae1051eea48718977f501cfa08a32',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-20 15:13:36','2018-12-20 15:13:36'),('416d9a44c56a4ff5a6916020e2dcd46e',NULL,'116.1.3.204','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-23 10:12:44','2018-12-23 10:12:44'),('47db98307f484a3da0bb94d693a8e65b',NULL,'116.1.3.204','blog_tag','ca928e8718654aa5a802e2f69277b137',NULL,1,'2018-12-23 10:12:55','2018-12-23 10:12:55'),('4bfeb86122574476b419121e1ca13eff',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-16 16:50:07','2018-12-16 16:50:07'),('4d739ffe3edb47099ff8816fddc1175d',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-18 08:56:55','2018-12-18 08:56:55'),('545aed2a6f9b4a7db82ee11001096ed5',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-24 22:33:09','2018-12-24 22:33:09'),('599f79d369f24fc5b01a3376708226a5',NULL,'116.1.3.205','blog_tag','ca928e8718654aa5a802e2f69277b137',NULL,1,'2018-12-17 10:06:31','2018-12-17 10:06:31'),('5a4968e0b0894abb9c14732b93554932',NULL,'221.219.205.182','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-25 11:10:41','2018-12-25 11:10:41'),('5cb634887c8e499da460b2726f8f5f40',NULL,'223.104.170.153','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-30 10:06:37','2018-12-30 10:06:37'),('5d45efe6b2d448e4b213f979169de0ff',NULL,'116.1.3.204','blog_content','80b7fb49e91d4930a7b5f0c084f12cbc',NULL,1,'2018-12-29 10:42:56','2018-12-29 10:42:56'),('5d5a7a5ecae04b0c82016509c0064ee2',NULL,'116.1.3.204','blog_tag','1c76b9848f5f4d71a5e88b20dbaf38f4',NULL,1,'2018-12-30 11:02:32','2018-12-30 11:02:32'),('5efddbc62f924167b1866663839d0965',NULL,'116.1.3.204','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-24 22:27:17','2018-12-24 22:27:17'),('5f32c4a2c5fb43f59d13c370e14aea4c',NULL,'116.1.3.204','blog_search',NULL,'Mysql',1,'2018-12-29 10:30:03','2018-12-29 10:30:03'),('5f9e43940d0b4347b6d1f362df4fe193',NULL,'111.59.124.148','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-21 13:06:19','2018-12-21 13:06:19'),('6343c55a3caa4870ab3c254043d529d6',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-19 21:26:10','2018-12-19 21:26:10'),('63ad9c0f59e7490a9a365595c090b605',NULL,'111.59.124.148','blog_tag','2f5779e877da48958c985d69b311d0d6',NULL,1,'2018-12-22 11:37:52','2018-12-22 11:37:52'),('68726427bec14b10b5da401406d6ac11',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-20 09:54:14','2018-12-20 09:54:14'),('6a3a73a0af0b4089822c148f7eb90b52',NULL,'116.1.3.205','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-16 18:23:49','2018-12-16 18:23:49'),('6a8b36b7910c40c29708efe84758fdc0',NULL,'116.1.3.204','blog_tag','ca928e8718654aa5a802e2f69277b137',NULL,1,'2018-12-22 16:19:19','2018-12-22 16:19:19'),('6c1da18447a743d6bb40c98ed58e6af6',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-22 16:07:36','2018-12-22 16:07:36'),('6c3474b49c84418fa699eeac40de1570',NULL,'116.1.3.204','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-19 19:48:00','2018-12-19 19:48:00'),('6e77f6c2f4e447d8a88cd72042cd4c15',NULL,'116.1.3.205','blog_content','08d759825ce945f1801ac08067d71bd8',NULL,1,'2018-12-16 18:24:07','2018-12-16 18:24:07'),('723b133882a44ac7bfc45797a503ef93',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-19 12:44:03','2018-12-19 12:44:03'),('73373fb72f1f4ef6b0eca0b38e51c5ea',NULL,'116.1.3.205','blog_search',NULL,'中间件',1,'2018-12-16 16:52:32','2018-12-16 16:52:32'),('769ebbdd65ba4d9ea6baf7a998e209ab',NULL,'116.1.3.205','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-16 19:20:54','2018-12-16 19:20:54'),('7b800bd77e0f4b3b805f61e2036f06d5',NULL,'116.1.3.204','blog_content','208692b2a7a242f4942993abb8eebf8b',NULL,1,'2018-12-30 12:45:54','2018-12-30 12:45:54'),('7bf3e981da0d49178f57fae3209389f9',NULL,'116.1.3.204','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-19 19:49:18','2018-12-19 19:49:18'),('7c9193afe8844698ae1fc652411e2c17',NULL,'116.1.3.204','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-27 09:35:17','2018-12-27 09:35:17'),('8181d57fb8c1483aabdcb684140c4bef',NULL,'116.1.3.204','blog_content','c459e7c261884086b5e462fa4f26cc04',NULL,1,'2018-12-29 10:29:56','2018-12-29 10:29:56'),('83a6570c8bac49ff9ebe750aae0b87dd',NULL,'116.1.3.204','blog_content','891ca107b434453790c49719e47c53a1',NULL,1,'2018-12-30 11:34:15','2018-12-30 11:34:15'),('84f2ee39e6c14f90856cb24d818d47fd',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-17 10:06:15','2018-12-17 10:06:15'),('8557c5ffb46c47feab31d1a260a12719',NULL,'223.104.170.153','blog_content','aca3f1f0528a4714a74493c6f0f28e22',NULL,1,'2018-12-30 10:06:33','2018-12-30 10:06:33'),('8a7f44c1cf834bdbb2b290081791834b',NULL,'116.1.3.205','blog_tag','e2c7913050cf4ab9aa92902316aaf075',NULL,1,'2018-12-17 10:06:30','2018-12-17 10:06:30'),('8a9442f10d0144c0be88cc366e1f6fc5',NULL,'116.1.3.204','blog_content','567c7e0fc0e44b608521eae8ba8d5b15',NULL,1,'2018-12-30 12:43:32','2018-12-30 12:43:32'),('8e6d4e1c6e464e0494cbd089b0effe1c',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-27 09:29:01','2018-12-27 09:29:01'),('900d2ba60f674c03967eaa788c7b4e73',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-19 21:25:01','2018-12-19 21:25:01'),('93e814f16dab4de791a3c77e7e70bed9',NULL,'116.1.3.204','blog_content','88f251b04fed4496b9b95e054efbc0c1',NULL,1,'2018-12-29 10:33:07','2018-12-29 10:33:07'),('94aab58add8d47d8b3d8de6f4cfd9384',NULL,'116.1.3.204','blog_content','208692b2a7a242f4942993abb8eebf8b',NULL,1,'2018-12-30 12:55:42','2018-12-30 12:55:42'),('9d31e877e0a74d049bd3295a43ca4f84',NULL,'116.1.3.205','blog_tag','53c5a0f3142e4f54820315936f78383b',NULL,1,'2018-12-17 10:06:27','2018-12-17 10:06:27'),('9dff261763b04e7c9406945437da776d',NULL,'116.1.3.205','blog_tag','5c939107ddb746b989156737805df625',NULL,1,'2018-12-17 10:06:21','2018-12-17 10:06:21'),('9f4f086c8c54407da2565a824abee6fa',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-18 11:36:33','2018-12-18 11:36:33'),('a0a436d7b59a47549938a2cccf7f7cd5',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-24 22:32:22','2018-12-24 22:32:22'),('a0cee3fadab74ebba198b2b70b8cc30c',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-18 08:56:47','2018-12-18 08:56:47'),('a425b0777b174622a7dacd9bb8e63901',NULL,'116.1.3.205','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-16 20:00:05','2018-12-16 20:00:05'),('a4c2f592c3684cde831a836575eefa79',NULL,'116.1.3.204','blog_content','d5968d02f570411184cdfcc082d28dac',NULL,1,'2018-12-29 10:43:05','2018-12-29 10:43:05'),('a86042839ab24e85af049b9ff4b43386',NULL,'116.1.3.204','blog_tag','5c939107ddb746b989156737805df625',NULL,1,'2018-12-19 12:43:59','2018-12-19 12:43:59'),('a93de4cb577242c6bad49651f956a6b6',NULL,'111.59.124.146','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-23 10:23:42','2018-12-23 10:23:42'),('a975e1e1d83e4ad4853241f8bde93ae1',NULL,'116.1.3.204','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-30 12:40:31','2018-12-30 12:40:31'),('aa188c0bbcfb40a0a749c84028220dbb',NULL,'223.104.170.153','blog_content','3008b19a20cd46aba7b62d619e7c5700',NULL,1,'2018-12-30 10:04:51','2018-12-30 10:04:51'),('ad3167409ba1423ca5caf2e1575f7d1e',NULL,'116.1.3.204','blog_tag','ca928e8718654aa5a802e2f69277b137',NULL,1,'2018-12-29 11:01:54','2018-12-29 11:01:54'),('ae1b4dc8fcc0405c8417bcc276cf0f8a',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-24 22:33:16','2018-12-24 22:33:16'),('affd517c0e714bdf845460e1f50d00b9',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-16 19:57:37','2018-12-16 19:57:37'),('b737799489224b4db20aabe59df77387',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-19 21:15:13','2018-12-19 21:15:13'),('b7d4bc12d32047dfa7e524d18db24db2',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-16 19:57:45','2018-12-16 19:57:45'),('b8f6342626ad4ab39ba58d47790b2675',NULL,'116.1.3.204','blog_content','aca3f1f0528a4714a74493c6f0f28e22',NULL,1,'2018-12-27 09:35:40','2018-12-27 09:35:40'),('b97da0254db148d2a79178c6ee13b948',NULL,'116.1.3.204','blog_content','cced8cef5ad8423494573ca2e337cd40',NULL,1,'2018-12-29 10:51:07','2018-12-29 10:51:07'),('bd06522922854943b75f53631b6bfcc0',NULL,'116.1.3.204','blog_tag','5c939107ddb746b989156737805df625',NULL,1,'2018-12-19 12:43:59','2018-12-19 12:43:59'),('c47a52a88d6040bea43bec3ec5d661ed',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-22 16:19:08','2018-12-22 16:19:08'),('c48787d302954830b4bf46510bdcc988',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-18 08:56:50','2018-12-18 08:56:50'),('c90ffec29dc8466da844b48afb81fdc6',NULL,'116.1.3.204','blog_content','e6b65558d5f14840b02f28efcde53779',NULL,1,'2018-12-29 11:01:42','2018-12-29 11:01:42'),('cbcb384c07424a1e9e2bc79b7c7ebea2',NULL,'116.1.3.204','blog_search',NULL,'备份',1,'2018-12-20 15:19:40','2018-12-20 15:19:40'),('cca5ee9ab0fd4f99afafed93fee673f3',NULL,'116.1.3.204','blog_content','c459e7c261884086b5e462fa4f26cc04',NULL,1,'2018-12-29 10:29:25','2018-12-29 10:29:25'),('d2f631eafcb445e19f3f0e1a9d2f4258',NULL,'116.1.3.204','blog_content','4000982427cb47edb8c626f409d5377d',NULL,1,'2018-12-20 15:19:42','2018-12-20 15:19:42'),('d7ab907c738b4749944d1f17bea0bff2',NULL,'116.1.3.204','blog_content','aca3f1f0528a4714a74493c6f0f28e22',NULL,1,'2018-12-29 10:32:35','2018-12-29 10:32:35'),('dd8eaae9d0e84499b7d6eecdd593c69f',NULL,'116.1.3.204','blog_content','a31ef259e0514245938d20b9e70b71ed',NULL,1,'2018-12-22 16:07:28','2018-12-22 16:07:28'),('df1151e093674fdbafceae0ab6b54581',NULL,'116.1.3.204','blog_content','aca3f1f0528a4714a74493c6f0f28e22',NULL,1,'2018-12-27 09:30:40','2018-12-27 09:30:40'),('e1cfdf5c3a344fea90b29d60c1e6b7fc',NULL,'116.1.3.204','blog_content','e6b65558d5f14840b02f28efcde53779',NULL,1,'2018-12-29 11:02:21','2018-12-29 11:02:21'),('e20d867ae2954cbf95eba57dbcab0625',NULL,'116.1.3.205','blog_content','1e1bc0784fcd44a8bef950d6156e2bd8',NULL,1,'2018-12-16 19:57:50','2018-12-16 19:57:50'),('e228245347b3456ab508f5fdccdca516',NULL,'116.1.3.205','blog_tag','2f5779e877da48958c985d69b311d0d6',NULL,1,'2018-12-17 10:06:25','2018-12-17 10:06:25'),('e625eb0cba2342e4b77f2b152e55ee48',NULL,'116.1.3.205','blog_content','8a7a023fb6094a388dff50e478f295a9',NULL,1,'2018-12-16 20:00:10','2018-12-16 20:00:10'),('e90f1dbf8ef1411e9bd38a6590c69e7b',NULL,'116.1.3.204','blog_content','1e1bc0784fcd44a8bef950d6156e2bd8',NULL,1,'2018-12-29 10:32:49','2018-12-29 10:32:49'),('e9e80e3fbc9f4b2592b60cac3f373fd7',NULL,'116.1.3.205','blog_tag','ca928e8718654aa5a802e2f69277b137',NULL,1,'2018-12-16 18:24:05','2018-12-16 18:24:05'),('ea8e31b95e1f40368fa2b38bf75ca5be',NULL,'116.1.3.204','blog_tag','5c939107ddb746b989156737805df625',NULL,1,'2018-12-19 12:43:59','2018-12-19 12:43:59'),('ed940479df314af08df89448d2ca1dec',NULL,'116.1.3.204','blog_tag','1c76b9848f5f4d71a5e88b20dbaf38f4',NULL,1,'2018-12-22 16:19:13','2018-12-22 16:19:13'),('edd446b1c3d048a7bb2210cf3a6e1b95',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-19 21:26:13','2018-12-19 21:26:13'),('f03c541b65044796b07879fcf867f3ea',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-18 22:56:49','2018-12-18 22:56:49'),('f1001d27a30b4c6c805b063fa4a55464',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-22 17:08:03','2018-12-22 17:08:03'),('f21c03391720453b94b97762d36ad07d',NULL,'223.104.170.153','blog_content','aca3f1f0528a4714a74493c6f0f28e22',NULL,1,'2018-12-30 10:06:26','2018-12-30 10:06:26'),('f9bdf7f3915842628c1b7891920212e9',NULL,'116.1.3.205','blog_content','6f0fc50433cf4a9194e01df4dcb56fb7',NULL,1,'2018-12-17 10:05:59','2018-12-17 10:05:59'),('f9e79906e1dd40d0beff963f85f8d5d1',NULL,'116.1.3.205','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-18 08:56:38','2018-12-18 08:56:38'),('fdf98cdd86e3470bae0cd80727f6413e',NULL,'116.1.3.204','blog_content','bcdb3ee0332a440994216682cf850ed6',NULL,1,'2018-12-27 08:45:39','2018-12-27 08:45:39'),('fe8bd1ace05e499b8542a542bfd6087e',NULL,'116.1.3.204','blog_content','7936b17678e84ddb81ac0af74f22c355',NULL,1,'2018-12-24 22:32:36','2018-12-24 22:32:36'),('fffe3d1391f9486daafd888c19f7176e',NULL,'116.1.3.204','blog_content','c459e7c261884086b5e462fa4f26cc04',NULL,1,'2018-12-29 10:51:49','2018-12-29 10:51:49');



DROP TABLE IF EXISTS `t_todo`;

CREATE TABLE `t_todo` (
  `uid` varchar(32) NOT NULL COMMENT '唯一uid',
  `admin_uid` varchar(32) DEFAULT NULL COMMENT '管理员uid',
  `text` varchar(255) DEFAULT NULL COMMENT '内容',
  `done` tinyint(1) unsigned NOT NULL DEFAULT '0' COMMENT '表示事项是否完成（0：未完成 1：已完成）',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '状态',
  `create_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '更新时间',
  PRIMARY KEY (`uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='代办事项表';



/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
